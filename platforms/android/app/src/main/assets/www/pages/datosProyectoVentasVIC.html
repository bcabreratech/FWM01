<style>  
    .FWM-span-form {
        color: #717D7E;
    }
        .list ul{
            top: 10px;
            padding-left: 16px;
        }
    .button {
        display: initial;
    }
    
    .md .button {
        text-decoration: none;
        font-family: 'ITC Avant Garde Gothic', sans-serif;
        font-weight: 600;
        font-size: 25px;
        color: #FFFFFF;
        padding-top: 15px;
        padding-bottom: 15px;
        padding-left: 20px;
        padding-right: 20px;
        border-radius: 100%;
    }
        .navbar .title{
            font-weight: bold;
            font-family: 'ITC Avant Garde Gothic', sans-serif;
            color: #fff;
        }
        .navbar a.link{
            color: white;
        }
        .navbar{
            background-color: #063E7F;
            height: 52px;
        }
    
        .navbar-inner{
            height: 52px;
        }
        .list .item-title{
            font-weight: bold;
            font-size: 16px;
            font-family: 'ITC Avant Garde Gothic', sans-serif;
            color: #717D7E;
        }
        .list .item-inner{
            font-weight: bold;
            font-size: 16px;
            font-family: 'ITC Avant Garde Gothic', sans-serif;
            color: #717D7E;
        }
        .list .item-content{
            padding-left: 0px;
        }
    
        .sheet-modal.modal-in{
            height: 80%;
        }

        #cajaB h1 {
        color: rgb(3, 3, 3);
        font-size: 12px;
        text-transform: uppercase;
        text-align: justify;
        line-height: 15px;
        margin: 8px 15px;
        margin-top: 25px;
        word-wrap: break-word;
        }

        #pregunta {
        position: relative ;
        display: flex;
        margin: 5px 15px;
        border:  0.5px solid #aaaeb3;
        box-sizing: border-box;
        background: #FAFAFA;
        }

        #pregunta input[type=radio] {
        margin: 8px 0;
        display: none;
        }

        #pregunta label {
        display: block;
        width: 179px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: 0.5s;
        background: #FFF;  

        }

        #preguntasi label:hover {
        background: #679ceb;
        }
        #preguntano label:hover {
        background: #679ceb;
        }

        #preguntasi input[type=radio]:checked + label {
        background: #063E7F;
        color: #FAFAFA;
        }
        #preguntano input[type=radio]:checked + label {
        background: #063E7F;
        color: #FAFAFA;
        }
    
    </style>
    <template>
            <div class="page" id="FWM-1">
                <!-- Navbar -->
                <div class="navbar" style="background-color: #063E7F;height: 52px;">
                    <div style="text-align: center;"><img src="img/logo-FWM.png" style="margin-top: 5px;" height="41.38px" alt="Logo Field"></div>
                    <div class="navbar-inner sliding" style="height: 52px;">
                        <div class="left">
                            <a href="#" onclick="regresarRecorridoVIC2();">
                                <span class="nav-text-regresar" id="nav-text-regresar-function">Regresar</span>
                            </a>
                        </div>
                    </div>
                </div>
                <!-- Contenido Formulario -->                                
                <div class="page-content">
                    <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;margin-top: 30px;">
                        <h2 class="FWN-titulo-2">Actividad Comercial</h2>
                        <div style="text-align: left;">     
                            <form class="list FWM-fixing-form"> 
                                <span class="span FWM-span-form">Tipo de visita:</span>
                                <div class="form-check form-check-inline" style="margin-top: 25px;">
                                    <input class="form-check-input" type="radio" name="inlineRadioOptions" id="V1" value="Visita presencial">
                                    <label class="FWM-span-form" for="inlineRadio1">Visita presencial</label>
                                    <input class="form-check-input" type="radio" name="inlineRadioOptions" id="V2" value="Llamada virtual">
                                    <label class="FWM-span-form" for="inlineRadio2">Conferencia virtual</label>
                                </div>
                                <br>
                            <!-- <span class="span FWM-span-form">Foto de evidencia:</span>
                                <div class="FWM-photo-container" style="margin-top: 15px;">
                                    <div class="border-capture">
                                        <a onclick="capturePhoto();">
                                            <img class="FWM-photo" src="img/camera.svg" id="photoIcon" width="45px" style="margin-left: 50px;"/>
                                        </a>
                                    </div>
                                    <img class="FWM-photo-hide" id="smallImage" src=""/>
                                    <input type="hidden" id="imagenC" name="imagenC"/>
                                </div> -->
                                <br>
                                <span class="span FWM-span-form">Acciones a realizar en visita: </span>
                                <div id = "actividad"></div>
                                <span class="span FWM-span-form">Nivel: </span>
                                <div id = "nivelesSelect"></div>
                                    <!-- <select class="FWM-input" name="niveles" id="niveles" >
                                        <option value="a" selected>Selecciona un nivel</option>
                                        <option value="0">Nivel 0 - Proyecto sin ningún avace</option>
                                        <option value="1">Nivel 1 - Se cuenta con datos como contacto, puesto, y tel/mail</option>
                                        <option value="2">Nivel 2 - Ya hubo contacto</option>
                                        <option value="3">Nivel 3 - En presentación y/o LIP</option>
                                        <option value="4">Nivel 4 - Propuesta/Negociación/Pruebas</option>
                                        <option value="5">Nivel 5 - Cierre y alta de datos</option>
                                    </select>  -->
                                <br>
                                <span class="span FWM-span-form">Actividad realizada en la visita: </span>
                                <textarea class ="FWM-input" id="pendiente_vendor" name="pendiente_vendor"  cols="30" rows="10" style="margin-top: 15px;"></textarea>
                            </form>
                            <!-- <div id="cajaB">
                                <h1 id="nombrePregunta">¿Desea subir el nivel?</h1>
                                <div id="pregunta">
                                  <div id="preguntano">
                                  <input type="radio" name="pregunta1" value="1" id="Res1-1"  >
                                  <label for="Res1-1">SI</label>
                                  </div>
                                  <div id="preguntasi">
                                  <input type="radio" name="pregunta1"  value="0" id="Res2-1"  >
                                  <label for="Res2-1">NO</label>
                                  </div>
                                </div>
                            </div>    -->
    
                            <div class="block grid-resizable-demo" style="margin-bottom: 70px; margin-top: 60px;">
                                <div class="row align-items-stretch" style="text-align: center;">
                                    <div class="col-100 medium-50" style="min-width: 50px; border-style: none;">
                                        <span class="resize-handler"></span>
                                        <a href="#" onclick="guardarActividadComercial();" style="background-color: #063E7F;" class="boton-equipo">Guardar Accion</a>
                                    </div>
                                </div>
                            </div>

                            <!-- <div class="block grid-resizable-demo" style="margin-bottom: 70px; margin-top: 60px;">
                                <div class="row align-items-stretch" style="text-align: center;">
                                    <div class="col-100 medium-50" style="min-width: 50px; border-style: none;">
                                        <span class="resize-handler"></span>
                                        <a href="#" onclick="guardarActividadComercialNivel();" style="background-color: #063E7F;" class="boton-equipo">Guardar Accion y subir de nivel</a>
                                    </div>
                                </div>
                            </div> -->
                    </div>
                    <!-- Fin contenido formulario -->
                </div>
            </div>
    </template>
    <script>
    return {
            on: {   
                pageInit: function () {   
                    
                var id_usuario = localStorage.getItem("id_usuario");
                var id_cedula = localStorage.getItem("IdCedula");
                var smartSelect = app.smartSelect.get('.smart-select');
                var proyecto = localStorage.getItem("IdProyecto");
                var Nom = 'Gestion-SE-VIC';
                app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
                    var content = JSON.parse(data);
                    var ACT = content[2];
                    var html ="";
                    html += `<select class='FWM-input' id='actividadSe' aria-label='Default select example'><option value='a' selected>Selecciona una actividad...</option>`;
                
                    for(let i = 0; i < ACT.length ;i++){
                        if(ACT[i].usuario == id_usuario){
                        html +=  ` <option value="${ACT[i].id_actividad}">${ACT[i].actividad}</option>`;
                        }
                    }
                    html += `</select>`;
                    $('#actividad').append(html); 
                
                });
                var arrayNiv = [];
                arrayNiv[0] = "Nivel 0 - Proyecto sin ningún avace";
                arrayNiv[1] = "Nivel 1 - Se cuenta con datos como contacto, puesto, y tel/mail";
                arrayNiv[2] = "Nivel 2 - Ya hubo contacto";
                arrayNiv[3] = "Nivel 3 - En presentación y/o LIP";
                arrayNiv[4] = "Nivel 4 - Propuesta/Negociación/Pruebas";
                arrayNiv[5] = "Nivel 5 - Cierre y alta de datos";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from ventas_bennetts WHERE id_cedula = ? ORDER BY nivel DESC",
                            [id_cedula],
                                function(tx, results){
                                    let length = results.rows.length;
                                    var item = results.rows.item(0);
                                        var nivelI = item.nivel;
                                        var tipo_visitac=item.tipo_visita;
                                        var nivelesS = "";
                                            nivelesS += ` <select class="FWM-input" name="niveles" id="niveles" >
                                        <option value="a" selected>Selecciona un nivel</option>`;
                                            for(let i = nivelI; i < 6 ; i++){
                                                if(nivelI){
                                                nivelesS +=  ` <option value="${i}">${arrayNiv[i]}</option>`;
                                                }else{
                                                    nivelesS +=  ` <option value="${0}">${arrayNiv[0]}</option>`;
                                                }
                                            }
                                            nivelesS += `</select>`;
                                            $('#nivelesSelect').append(nivelesS);  
                                        if (item.nivel==null){
                                                $('#niveles').val('a');
                                            }else{
                                                $("#niveles option[value='"+item.nivel+"']").attr("selected", true);
                                            }
                                            if (item.actividadSelect == null){
                                                $('#actividadSe').val('a');
                                            }else{
                                                $("#actividadSe option[value='"+item.actividadSelect+"']").attr("selected", true);
                                            }
                                            if(tipo_visitac=='Visita presencial'){
                                                $("#V1").prop("checked", true);
                                            }else if (tipo_visitac=='Llamada virtual'){
                                                $("#V2").prop("checked", true);
                                            }
                                            if (item.foto_visita==null){
                                            }
                                                else{
                                                var smallImage = document.getElementById('smallImage');
                                                smallImage.style.display = 'flex';
                                                smallImage.src = item.foto_visita;
                                                $('#imagenC').val(item.foto_visita);    
                                            }
                                            $('#pendiente_vendor').val(item.pendiente_vendedor);
                                            
                                },
                                    function(tx, error){
                                        console.log("Error: " + error.message);
                                        app.preloader.hide();  
                                    }
                    );  
                },
                    function(error){},
                    function(){}
            );
                // databaseHandler.db.transaction(
                //     function(tx){
                //         tx.executeSql(
                //             "Select * from ventas_bennetts WHERE id_proyecto = ?",
                //                 [proyecto],
                //                     function(tx, results){
                //                         let length = results.rows.length;
                //                         var item = results.rows.item(0);

                //                             // console.log(item.tipo_visita);
                //                             // var tipo_visitac=item.tipo_visita;
                //                             // console.log(item.foto_visita);
                //                             // if (item.foto_visita==null){
                //                             // }
                //                             //     else{
                //                             //     var smallImage = document.getElementById('smallImage');
                //                             //     smallImage.style.display = 'flex';
                //                             //     smallImage.src = item.foto_visita;
                //                             //     $('#imagenC').val(item.foto_visita);    
                //                             // }
                //                             if (item.nivel==null){
                //                                 $('#niveles').val(0);
                //                             }else{
                //                                 //console.log('niveles',item.nivel);
                //                                 // $('#niveles').val(item.nivel);
                //                                 $("#niveles option[value='"+item.nivel+"']").attr("selected", true);
                //                             }
                //                             // console.log(item.pendiente_vendedor);
                //                             // $('#pendiente_vendor').val(item.pendiente_vendedor);
                                            
                //                             // if(tipo_visitac=='Visita presencial'){
                //                             //     $("#V1").prop("checked", true);
                //                             // }else if (tipo_visitac=='Llamada virtual'){
                //                             //     $("#V2").prop("checked", true);
                //                             // }
                //                     },
                //                         function(tx, error){
                //                             console.log("Error: " + error.message);
                //                             app.preloader.hide();  
                //                         }
                //         );  
                //     },
                //         function(error){},
                //         function(){}
                // );                
            }
        }
    }
    </script>