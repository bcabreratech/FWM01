    var IdUsuario = localStorage.getItem("IdUsuario");
    $("#IdUsuario").val(IdUsuario);
    //Borrar variables de sesión y regresar a el Log-in
    function logaout(){
        window.localStorage.clear();
        window.location.href = "index.html";
    }
    //Bennetts Inicio
    function buscarClienteBennetts() {
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var estatus = 0;
        productHandler.addBennetts(id_usuario, nombre_usuario, fecha_llegada, geolocation, horario_programado, estatus);
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "Select MAX(id_cedula) as Id from cedulas_general",
              [],
              function (tx, results) {
                var item = results.rows.item(0);
                localStorage.setItem("IdCedula", item.Id);
                app.views.main.router.navigate({ name: "menuBennetts" });
                app.preloader.hide();
              },
              function (tx, error) {
                console.log("Error al guardar cedula: " + error.message);
                app.preloader.hide();
              }
            );
          },
          function (error) {},
          function () {}
        );
      }
      function continuarCedBennetts(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'menuBennetts'});
        } else if(tipo == 2){
            app.views.main.router.back('/recorridoBennetts2/', {force: true, ignoreCache: true, reload: true});
        }
      }
      function guardarDatosBennetts(){
        app.preloader.show('blue');
        if($("#division").val() == "0"){
          swal("", "Debes de llenar todos los campos" , "warning");
          app.preloader.hide();
          return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var division = $("#division").val();
        databaseHandler.db.transaction(
          function(tx){
            tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
            [division,id_cedula],
            function(tx, results){
              $("#division").css("background-color", "#FFFFFF");
              swal("","Se guardaron los datos correctamente", "success");
              app.preloader.hide();
            },
            function(tx, error){
              swal("Error al guardar", error.message, "error");
              app.preloader.hide();
            }
            );
          },
          function(error){},
          function(){}
        );

      }
      function guardarDatosBennetts2(){
        app.preloader.show('blue');
        if($("#nombre_comp").val() == "" || $("#almacen").val() == "0" || $("#empresa").val() == "0"){
          swal("", "Debes de llenar todos los campos" , "warning");
          app.preloader.hide();
          return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_comp = $("#nombre_comp").val();
        var almacen = $("#almacen").val();
        var empresa = $("#empresa").val();
        databaseHandler.db.transaction(
          function(tx){
            tx.executeSql("UPDATE inventario SET pareja_almacen = ?, almacen = ?, empresa = ? WHERE id_cedula = ?",
            [nombre_comp,almacen,empresa,id_cedula],
            function(tx, results){
                if(empresa == 1 && almacen == 1){
                    var inventario = "codigos_bennetts"
                } else if(empresa == 1 && almacen == 2){
                    var inventario = "codigos_bennetts2"
                } else if(empresa == 2 && almacen == 1){
                    var inventario = "codigos_bennetts3"
                } else {
                    var inventario = "codigos_bennetts4"
                }
                localStorage.setItem("almacen", inventario);
              $("#nombre_comp").css("background-color", "#FFFFFF");
              swal("","Se guardaron los datos correctamente", "success");
              app.preloader.hide();

            },
            function(tx, error){
              swal("Error al guardar", error.message, "error");
              app.preloader.hide();
            }
            );
          },
          function(error){},
          function(){}
        );

      }
      function datosCheckB(){
        var checkbox1 = document.getElementById("destruccion");
        var checkbox2 = document.getElementById("baja");
       checkbox1.onclick = function(){
       if(checkbox1.checked != false){
       checkbox2.checked =null; }
        }
       checkbox2.onclick = function(){
       if(checkbox2.checked != false){
       checkbox1.checked=null;
        }

        }
       }

    function actaBajaProducto(){
        app.preloader.show('blue');
        if($("#codigo").val() == "" || $("#descripcion").val() == "" || $("#cantidad").val() == "" || ($("#destruccion").prop("checked") == false && $("#baja").prop("checked") == false) || $("#motivo").val() == "" || $("#imagenC1").val() == "" || $("#imagenC2").val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var codigo_producto = $("#codigo").val();
        var descripcion_producto = $("#descripcion").val();
        var cantidad_producto = $("#cantidad").val();
        var motivo = $("#motivo").val();
        if ($("#destruccion").prop("checked") == true){
        var aplica = 1;
        } else {
        var aplica = 0;
        }
        var evidencia_foto_antes = $('#imagenC1').val();
        var evidencia_foto_despues = $('#imagenC2').val();
        var fechaR = new Date();
        var fecha = fechaR.getFullYear()+"-"+(fechaR.getMonth()+1)+"-"+fechaR.getDate()+" "+fechaR.getHours()+":"+fechaR.getMinutes()+":"+fechaR.getSeconds();
        databaseHandler.db.transaction(
            function(tx){

                tx.executeSql("INSERT INTO productos(id_cedula,codigo_producto,descripcion_producto,cantidad_producto,motivo, aplica, evidencia_foto_antes,evidencia_foto_despues,fecha) VALUES (?,?,?,?,?,?,?,?,?)",
                    [id_cedula,codigo_producto,descripcion_producto,cantidad_producto,motivo, aplica, evidencia_foto_antes,evidencia_foto_despues,fecha],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_producto) as Id from productos",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from productos where id_producto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        if(item.aplica ==1){
                                                        var valoraplica = "Destrucción";
                                                        } else{
                                                        var valoraplica = "Baja";
                                                        }
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#smallImage2").attr("src","img/blank.png");
                                                        $('#imagenC1').val("");
                                                        $('#imagenC2').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#photoIcon2").attr("src","img/camera.svg");
                                                        $("#tabla_productos tbody").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaBennetts("+ item.id_producto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + unescape(item.codigo_producto) + "</td><td style='text-align: center;'>" + unescape(item.descripcion_producto) + "</td><td style='text-align: center;'>" + unescape(item.cantidad_producto) + "</td><td style='text-align: center;'>" + unescape(item.motivo) + "</td><td style='text-align: center;'>" + valoraplica + "</td><td><img src='"+item.evidencia_foto_antes+"' width='60px' style='margin-top: 4px;'/></td><td><img src='"+item.evidencia_foto_despues+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $("#codigo").css("background-color","#ffffff");
                                                        $("#descripcion").css("background-color","#ffffff");
                                                        $("#cantidad").css("background-color","#ffffff");
                                                        $("#motivo").css("background-color","#ffffff");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();

                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function deleteForm() {
        document.getElementById("demo-form").reset();
    }
    function eliminarFilaBennetts(index, opc, contexto){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM productos WHERE id_producto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM conteo WHERE id_conteo = ?",
                        [index],
                        function(tx, results){
                            var table = $("#inventario").DataTable();
                            table.row($(contexto).parents('tr')).remove().draw();
                            swal("","El registro se elimino satisfactoriamente","success");
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarCierreBennetts() {
        if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#puesto").val() == "" || $("#correo").val() == ""){
          swal("", "Todos los campos son obligatorios", "warning");
          return false;
        }

        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var correo = $("#correo").val();
        var puesto = $("#puesto").val();
        var correo = $("#correo").val()
        var fecha = new Date();
        var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE datos_productos SET firma_cliente = ?, puesto = ?,correo = ? WHERE id_cedula = ?",
              [firmaCliente, puesto,correo, id_cedula],
              function (tx, results) {
                databaseHandler.db.transaction(
                  function (tx) {
                    tx.executeSql(
                      "UPDATE cedulas_general SET nombre_evalua = ?, horario_programado = ? WHERE id_cedula = ?",
                      [nombrefirma,puesto,id_cedula],
                      function (tx, results) {
                        swal("", "Guardado correctamente", "success");
                        app.views.main.router.back("/yamevoyBennetts/", {
                          force: true,
                          ignoreCache: true,
                          reload: true,
                        });
                      },
                      function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                      }
                    );
                  },
                  function (error) {},
                  function () {}
                );
              },
              function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
              }
            );
          },
          function (error) {},
          function () {}
        );
      }
      function terminarBajaBennetts() {
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
              [fecha_salida, ubicacion_salida, estatus, id_cedula],
              function (tx, results) {
                window.location.href = "./menu.html";
              },
              function (tx, error) {
                swal("Error al guardar", error.message, "error");
              }
            );
          },
          function (error) {},
          function () {}
        )
      }
      function terminarConteoBennetts() {
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
              [fecha_salida, ubicacion_salida, estatus, id_cedula],
              function (tx, results) {
                window.location.href = "./menu.html";
              },
              function (tx, error) {
                swal("Error al guardar", error.message, "error");
              }
            );
          },
          function (error) {},
          function () {}
        )
      }
      function generarBajaBennetts(){
        // let id_cedula = localStorage.getItem("IdCedula");
        // let foto_llegada = localStorage.getItem("foto_llegada");
        // let tipoCedula = "minutaCoordinador";
        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
        //             [tipoCedula,id_cedula],
        //             function(tx, results){
        //                 productHandler.addMinutaCoordinador(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoBennetts1'});
        //             },
        //             function(tx, error){
        //                 console.error("Error al actualizar el tipo de cedula: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    function generarInventarioBennetts(){
      let id_cedula = localStorage.getItem("IdCedula");
      let tipoCedula = "conteo";
      databaseHandler.db.transaction(
          function(tx){
              tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                  [tipoCedula,id_cedula],
                  function(tx, results){
                      productHandler.addConteo(id_cedula);
                      app.views.main.router.navigate({name: 'recorridoBennetts2'});
                  },
                  function(tx, error){
                      console.error("Error al actualizar el tipo de cedula: " + error.message);
                  }
              );
          },
          function(error){},
          function(){}
      );
    }
    function buscarCodigoBennetts(table,codigo){
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json", // y por cual era? XD perate culo dale shift+f6 si le distre? xd
            method: 'GET',
            dataType: 'json',
            //send "query" to server. Useful in case you generate response dynamically, deja inento en el mio para acordarme xd
            success: function (data) {
                var aux = 0;
                for (var i = 0; i < data.length; i++) {
                    if(data[i].CodigoSIAN == codigo || data[i].CodigoSAP == codigo){
                        aux =  aux + 1;
                        $("#inventario tbody").append("<tr id='fila" + i + "'><td style='text-align: center;'>" + unescape(data[i].CodigoSIAN) + "</td><td style='text-align: center;'>" + unescape(data[i].CodigoSAP) + "</td><td style='text-align: center;'>" + unescape(data[i].Descripcion) + "</td><td style='text-align: center;'>" + unescape(data[i].Existencia) + "</td><td><a href='#' onclick='eliminarFilaBennetts(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td></tr>");
                    }
                    table.row.add([
                        data[i].CodigoSIAN, '1', '1','1', '1', '1'
                      ]).draw();
                }
                if(aux == 0){
                    console.log("No lo encontré")
                }
            }
        });
    }
    function cantidadIngresada(inventario,id,id_conteo){
        $('input').blur();
        inventario = parseFloat(inventario);
        var valor = $("#"+id).val();
        var adicional = inventario / 2;
        var max = inventario + adicional;
        var min = inventario - adicional;
        if(valor == 0 && max == 0 && min ==0){

        } else {
            if(valor <= min || valor >= max){
                swal("Alerta!", "La cantidad de producto ingresada esta excediendo el rango del 50% de existencia." ,"warning");
            }
        }
        if(valor == parseInt(inventario)){
            var estatus = 1;
        } else {
            var estatus = 0;
        }
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE conteo SET fisico = ?,estatus_diferencia = ?,fecha_registro = ? WHERE id_conteo = ?",
                    [valor,estatus,fecha_registro,id_conteo],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function rotate(){
        if(localStorage.getItem("currentOrientation") == "portrait"){
            screen.orientation.lock('landscape');
            localStorage.setItem("currentOrientation", "landscape");
        } else {
            screen.orientation.lock('portrait');
            localStorage.setItem("currentOrientation", "portrait");
        }
    }
    function validateScan(){
        cordova.plugins.barcodeScanner.scan(
            function (result) {
                var texto =  result.text;
                var camera = app.popup.create({
                    content: `
                    <div class="popup" id="camera">
                        <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;margin-top:20px">
                            <a class="link popup-close">Cerrar</a>
                        </div>
                        <div id="log"></div>
                        <div class="app">
                            <div id="deviceready">
                                <pre style="display: inline-block;white-space: break-spaces;">${result.text}</pre>
                                <p>Formato: ${result.format}</p>
                            </div>
                        </div>
                    </div>
                    `,
                    on: {
                        open: function (popup) {},
                    }
                });
                camera.open();
            },
            function (error) {
                alert("Scanning failed: " + error);
            },
            {
                preferFrontCamera : false,
                showFlipCameraButton : true,
                showTorchButton : true,
                torchOn: false,
                saveHistory: false,
                prompt : "Coloca el codigo de barras en la zona marcada",
                resultDisplayDuration: 500,
                orientation : "portrait",
                disableAnimations : true,
                disableSuccessBeep: false
            }
          );
    }
    function insertConteo(id_cedula,id_conteo_general,numero_conteo,Codigo,SAP,ubicacion,Descripcion,Inventario,Familia,Costo_unitario,id_usuario){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT id_cedula FROM conteo WHERE id_cedula = ? AND (codigo_sap = ? OR codigo_proveedor = ?) AND ubicacion = ?",
                    [id_cedula,SAP,Codigo,ubicacion],
                    function(tx, results){
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO conteo(id_cedula,id_conteo_general,numero_conteo,codigo_proveedor,codigo_sap,ubicacion,descripcion,inventario,familia,costo_unitario,usuario,estatus_diferencia,enviado) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,'0')",
                                        [id_cedula,id_conteo_general,numero_conteo,Codigo,SAP,ubicacion,Descripcion,Inventario,Familia,Costo_unitario,id_usuario],
                                        function(tx, results){
                                            var id = results.insertId;
                                            var table = $('#inventario').DataTable();
                                            table.row.add([id,SAP,"<input type='number' id='item"+id+"' onchange='cantidadIngresada(\"" + Inventario + "\",this.id,"+id+")' placeholder='#' style='width:60px'>",Descripcion,Inventario,ubicacion,"<a href='#' class='remove' onclick='eliminarFilaBennetts(" + id + ",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a>"]).draw();
                                            $("#codigo").val("");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar el registro",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            swal(`El codigo ${SAP} ya fue escaneado`, `Ese producto ya fue escaneado en la ubicación ${ubicacion}, por favor actualiza la cantidad en el registro existente!` ,"warning");
                            $("#codigo").val("");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function searchAsin(codigo){
        var id_cedula = localStorage.getItem("IdCedula");
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                var aux = 0;
                var samecode = 0;
                let noencontrados;
                for (var j = 0; j < data.length; j++) {
                    if(data[j].CodigoSIAN == codigo || data[j].CodigoSAP == codigo){
                        aux =  aux + 1;
                        samecode ++;
                        var id_conteo_general = "1";
                        var numero_conteo = "1";
                        var id_usuario = localStorage.getItem("id_usuario");
                        if(codigo == ""){
                            return;
                        } else {
                            insertConteo(id_cedula,id_conteo_general,numero_conteo,data[j].CodigoSIAN,data[j].CodigoSAP,$('#ubicacion').val(),data[j].Descripcion,data[j].Existencia,data[j].Familia,data[j].Precio,id_usuario);
                        }
                        if(samecode == 2){
                            swal("Codigo duplicado","El codigo ingresado tiene 2 coincidencias en el catalogo de productos, por favor revisalo!.","warning");
                        }
                    }
                }
                if(aux == 0){
                  swal("Codigo No encontrado",`El codigo ${codigo} no esta en el catalogo de productos.`,"warning");
                  $("#codigo").val("");
                }
            }
        });
    }
    function searchSingle(codigo){
        var id_cedula = localStorage.getItem("IdCedula");
        var NomJson = localStorage.getItem("almacen");;
        app.request({
            url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
            method: 'GET',
            dataType: 'json',
            success: function (data) {
                var aux = 0;
                var samecode = 0;
                for (var i = 0; i < data.length; i++) {
                    if(data[i].CodigoSIAN == codigo || data[i].CodigoSAP == codigo){
                        aux =  aux + 1;
                        samecode++;
                        var id_conteo_general = "1";
                        var numero_conteo = "1";
                        var id_usuario = localStorage.getItem("id_usuario");
                        insertConteo(id_cedula,id_conteo_general,numero_conteo,data[i].CodigoSIAN,data[i].CodigoSAP,$('#ubicacion').val(),data[i].Descripcion,data[i].Existencia,data[i].Familia,data[i].Precio,id_usuario);
                        if(samecode == 2){
                            swal("Codigo duplicado","El codigo ingresado tiene 2 coincidencias en el catalogo de productos, por favor revíselo!.","warning");
                            $("#codigo").val("");
                        }
                    }
                }
                if(aux == 0){
                  swal("Codigo No encontrado","El codigo escaneado no esta en el catalogo de productos.","warning");
                  $("#codigo").val("");
                }
            }
        });
    }
    function llevarUbicacion(){
        var ubicacion = $("#ubicacion").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var almacen;
        var empresa;
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql(
                "Select * from inventario WHERE id_cedula = ?",
                [id_cedula],
                function(tx, results){
                  let length = results.rows.length;
                  for (var i = 0; i< length; i++){
                    var item = results.rows.item(i);
                    almacen = item.almacen;
                    empresa = item.empresa;
                  }
                },
                function(tx, error){
                  console.log("Error al guardar registro: " + error.message);
                  app.preloader.hide();
                }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT ubicacion FROM conteo WHERE ubicacion = ? AND (fisico IS NULL OR fisico = '') AND id_cedula = ?",
                    [ubicacion,id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            var conteo = new Array();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * from conteo WHERE id_cedula = ? AND ubicacion = ?",
                                        [id_cedula,ubicacion],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item3 = results.rows.item(i);
                                                conteo[i] = {'id_cedula': item3.id_cedula,'id_conteo_general': item3.id_conteo_general,'numero_conteo': item3.numero_conteo,'codigo_proveedor': item3.codigo_proveedor,'codigo_sap': item3.codigo_sap,'ubicacion': item3.ubicacion,'descripcion': item3.descripcion,'inventario': item3.inventario,'familia': item3.familia,'costo_unitario': item3.costo_unitario,'usuario': item3.usuario,'estatus_diferencia': item3.estatus_diferencia,'fisico': item3.fisico,'fecha_registro': item3.fecha_registro};
                                            }
                                            $("#ubicacion").val("");
                                            var table = $('#inventario').DataTable();
                                            table.search("").draw();
                                            $.ajax({
                                                type: "POST",
                                                async : true,
                                                url: "http://www.appbennetts.com/FWM2/app/guardarConteoInTime.php",
                                                dataType: 'html',
                                                data: {'conteo': JSON.stringify(conteo),'almacen':almacen,'empresa':empresa},
                                                success: function(respuesta){
                                                    if(respuesta == "CEDULA._.1"){
                                                        databaseHandler.db.transaction(
                                                            function(tx7){
                                                                tx7.executeSql(
                                                                    "UPDATE conteo SET enviado = 1 WHERE id_cedula = ? AND ubicacion = ?",
                                                                    [id_cedula,ubicacion],
                                                                    function(tx7, results){
                                                                        $("#filtrosUbicacion").css("display","none");
                                                                        swal("Ubicacion guardada", "Se acaba de enviar la Ubicacion!" ,"success");
                                                                    }
                                                                );
                                                            }
                                                        );

                                                    }
                                                },
                                                error: function(){
                                                    console.log("Error en la comunicacion con el servidor");
                                                }
                                            });
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            swal("Llena las cantidades", "No puedes finalizar la ubicacion actual y no tienes llenas todas las cantidades!" ,"warning");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function restorientation(){
        screen.orientation.lock('portrait');
        localStorage.setItem("currentOrientation", "portrait");
    }
    function validarInventario(){
        if(localStorage.getItem("almacen") == "no"){
          swal("Faltan datos","Para poder iniciar el conteo necesitas llenar datos generales.","warning");
        } else {
            app.views.main.router.back('/template2/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function eliminarubicacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var ubicacion = $("#ubicacion").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT ubicacion FROM conteo WHERE ubicacion = ? AND id_cedula = ?",
                    [ubicacion,id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            swal("No existen registros", "La ubicacion no tiene registros en la base de datos!" ,"warning");
                        } else {
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql("DELETE FROM conteo WHERE id_cedula = ? AND ubicacion = ?",
                                        [id_cedula,ubicacion],
                                        function(tx4, results){
                                            swal("Ubicacion eliminada", "Se eliminaron todos los registros de la ubicacion exitosamente!" ,"success");
                                            var table = $('#inventario').DataTable();
                                            var texto = '';
                                            var indexes = table
                                            .rows()
                                            .indexes()
                                            .filter( function ( value, index ) {
                                                return ubicacion === table.row(value).data()[5];
                                            });
                                            table.rows(indexes).remove().draw();
                                            table.search(texto).draw();
                                            $("#ubicacion").val('');
                                        },
                                        function(tx4, error){
                                            console.error("Error al eliminar cedula_general: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Bennetts Fin
    //DIPREC Inicio
    function buscarClienteDIPREC(){
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $('#id_cliente').val();
        var nombre_cliente = $("#nombre_cliente").val();
        var hora_programada = $("#horario_programado").val();
        var atencion = $("#persona_recibe").val();
        var direccion = $("#direccion").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var foto_llegada = $("#imagenC").val();
        var documentoIngresar = $("#documento_ingresar").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var estatus = 0;
        if(localStorage.getItem("IdCedula"))
        {
            app.preloader.hide();
            var cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [cedula],
                        function(tx5, results){
                            var item = results.rows.item(0);
                            if(nombre_cliente != item.nombre_cliente || foto_llegada != localStorage.getItem("foto_llegada")){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET id_usuario = ?,nombre_usuario = ?,fecha_entrada = ?,geolocalizacion_entrada = ?,id_cliente = ?,nombre_cliente = ?,horario_programado = ? WHERE id_cedula = ?",
                                            [id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,cedula],
                                            function(tx, results){
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                app.views.main.router.navigate({name: 'recorrido1'});
                            }
                        },
                        function(tx5, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else {
            var NomDescCli = "Clientes_DIPREC";
            if(foto_llegada != ''){
                app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: id_usuario}, function (data) {
                    var content = JSON.parse(data);
                    var aux = 0;
                    for(var i=0; i < content.length; i++){
                        for (var i = 0; i < content.length; i++) {
                            if(content[i].IdCte == id_cliente){
                                aux = 1;
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                localStorage.setItem("nombreCliente", nombre_cliente);
                                                localStorage.setItem("IdCte", id_cliente);
                                                localStorage.setItem("foto_llegada", foto_llegada);
                                                localStorage.setItem("atencion", atencion);
                                                localStorage.setItem("direccion", direccion);
                                                localStorage.setItem("documentoIngresar", documentoIngresar);
                                                localStorage.setItem("telefono", telefono);
                                                localStorage.setItem("correo", correo);
                                                app.views.main.router.navigate({name: 'menuDIPREC'});
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        }
                    }
                    if(aux == 0){
                        app.preloader.hide();
                        swal("Cliente no encontrado", "No se tiene registro de ese cliente, Por favor sincroniza tus datos!" ,"error");
                    }
                });
            } else {
                swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
    }
    function generarReporteTecnico(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let atencion = localStorage.getItem("atencion");
        let direccion = localStorage.getItem("direccion");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tipoCedula = "reporteTecnico";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addReporteTecnico(id_cedula,foto_llegada,nombre_cliente,direccion,telefono,atencion,correo);
                        app.views.main.router.navigate({name: 'recorridoDIPREC1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedDIPREC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoDIPREC1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoDIPREC3'});
        } else if(tipo == 3){
            let tipoCedula = "checklist_levantamiento";
            localStorage.setItem("TipoVisita", tipoCedula);
            app.views.main.router.navigate({ name: 'recorridoDIPREC2'});
        } else if(tipo == 4){
            let tipoCedula = "checklist_liberacion";
            localStorage.setItem("TipoVisita", tipoCedula);
            app.views.main.router.navigate({ name: 'recorridoDIPREC4'});
        } else if(tipo == 5){
            let tipoCedula = "checklist_inspeccion";
            localStorage.setItem("TipoVisita", tipoCedula);
            app.views.main.router.navigate({ name: 'recorridoDIPREC5'});
        }
    }

    function guardarDatosReporteTecnicoDIPREC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#atencion").val() == "" || $("#direccion").val() == "" || $("#telefono").val() == "" || $("#correo").val() == "" || $("#tipoServicio").val() == 0){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var cliente = $("#nombreCliente").val();
        var atencion = $("#atencion").val();
        var direccion = $("#direccion").val();
        var telefono = $("#telefono").val();
        var correo = $("#correo").val();
        var tipoServicio = $("#tipoServicio").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET nombre_cliente = ?,atencion = ?,direccion = ?,telefono = ?,email = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,atencion,direccion,telefono,correo,tipoServicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#atencion").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#telefono").css("background-color", "#FFFFFF");
                        $("#correo").css("background-color", "#FFFFFF");
                        $("#tipoServicio").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarEquipoDIPREC(){
        app.preloader.show('blue');
        if($("#nombreEquipo").val() == "" || $('#marca').val() == "0" || $('#modelo').val() == ""  || $('#noSerie').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#nombreEquipo").val();
        var marca = $('#marca').val();
        var modelo = $('#modelo').val();
        var noSerie = $('#noSerie').val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fase = 'antes';
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        //-------------
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select * from datos_equipo where equipo = ? AND marca = ? AND modelo = ? AND no_serie = ? AND id_cedula = ?",
                    [equipo,marca,modelo,noSerie,id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO datos_equipo(id_cedula,equipo,marca,modelo,no_serie,fecha_registro) VALUES (?,?,?,?,?,?)",
                                        [id_cedula,equipo,marca,modelo,noSerie,fecha_registro],
                                        function(tx, results){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                                                        [id_cedula,fase,foto,equipo,fecha_registro],
                                                        function(tx, results){
                                                            app.preloader.hide();
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                                                        [],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            var id_evidencia = item.Id;
                                                                            app.preloader.hide();
                                                                            //Consultar el producto
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                                                    [id_evidencia],
                                                                                        function(tx, results){
                                                                                            var item = results.rows.item(0);
                                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                                            $('#imagenC').val("");
                                                                                            $("#photoIcon").attr("src","img/camera.svg");

                                                                                            $("#nombreEquipo").css("background-color", "#FFFFFF");
                                                                                            $("#marca").css("background-color", "#FFFFFF");
                                                                                            $("#modelo").css("background-color", "#FFFFFF");
                                                                                            $("#noSerie").css("background-color", "#FFFFFF");

                                                                                            $("#tabla_reporteTecnico tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                                            $("#message-nr").css("display", "none");
                                                                                            $('.preloader').remove();
                                                                                            $('.infinite-scroll-preloader').remove();
                                                                                            app.preloader.hide();
                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                                            app.preloader.hide();
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){},
                                                                                function(){}
                                                                            );
                                                                        },
                                                                        function(tx, error){
                                                                            swal("Error al mostrar el registro guardada",error.message,"error");
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                            swal("","Registro guardado","success");
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            swal("Error al guardar plaga",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                                        [id_cedula,fase,foto,equipo,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");

                                                                            $("#nombreEquipo").css("background-color", "#FFFFFF");
                                                                            $("#marca").css("background-color", "#FFFFFF");
                                                                            $("#modelo").css("background-color", "#FFFFFF");
                                                                            $("#noSerie").css("background-color", "#FFFFFF");

                                                                            $("#tabla_reporteTecnico tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar el registro guardada",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function eliminarFilaDIPREC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_equipo WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_refacciones WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM zonas_coordinador WHERE id_zona = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM equipos_coordinador WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM observaciones WHERE id_acuerdo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM notas WHERE id_nota = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencias_diprec WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarRevisionDiprec(){
        app.preloader.show('blue');
        // if($("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#equipo").val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_antes(id_cedula,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarRefaccionDIPREC(){
        app.preloader.show('blue');
        if($("#refaccion").val() == "0" || $('#clave').val() == "" || $('#cantidad').val() == "" || $('#descripcion').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var refacion= $('#refaccion').val()
        var clave= $('#clave').val()
        var cantidad= $('#cantidad').val()
        var descripcion= $('#descripcion').val()
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_refacciones(id_cedula,fase,clave,cantidad,descripcion,foto,fecha_regristro) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula,refacion,clave,cantidad,descripcion,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_foto) as Id from evidencia_refacciones",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_refacciones where id_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#refacion").val("");
                                                        $("#clave").val("");
                                                        $("#cantidad").val("");
                                                        $("#descripcion").val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_refacciones tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.clave) + "</td><td style='text-align: center;'>" + unescape(item.cantidad) + "</td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar el registro guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado exitosamente","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarActividadesDIPREC(){
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        if($("#equipo").val() == "0" || ($('#recorrido1').prop("checked") == false && $('#recorrido2').prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        if($('#recorrido2').prop("checked") == true){
            if(($("#valvulas1").prop("checked") == true || $("#valvulas0").prop("checked") == true) && ($("#termostato1").prop("checked") == true || $("#termostato0").prop("checked") == true) && ($("#controlpresion1").prop("checked") == true || $("#controlpresion0").prop("checked") == true) && ($("#quemador1").prop("checked") == true || $("#quemador0").prop("checked") == true) && ($("#turbinas1").prop("checked") == true || $("#turbinas0").prop("checked") == true) && ($("#resistencias1").prop("checked") == true || $("#resistencias0").prop("checked") == true) && ($("#sondas1").prop("checked") == true || $("#sondas0").prop("checked") == true) && ($("#tarjetaselectronicas1").prop("checked") == true || $("#tarjetaselectronicas0").prop("checked") == true) && ($("#compresor1").prop("checked") == true || $("#compresor0").prop("checked") == true) && ($("#motordifusores1").prop("checked") == true || $("#motordifusores0").prop("checked") == true) && ($("#aspasmotor1").prop("checked") == true || $("#aspasmotor0").prop("checked") == true) && ($("#contactores1").prop("checked") == true || $("#contactores0").prop("checked") == true) && ($("#fugatuberia1").prop("checked") == true || $("#fugatuberia0").prop("checked") == true) && ($("#aislantetuberia1").prop("checked") == true || $("#aislantetuberia0").prop("checked") == true) && ($("#condensador1").prop("checked") == true || $("#condensador0").prop("checked") == true) && ($("#iluminacion1").prop("checked") == true || $("#iluminacion0").prop("checked") == true) && ($("#empaques1").prop("checked") == true || $("#empaques0").prop("checked") == true) && ($("#fugagas1").prop("checked") == true || $("#fugagas0").prop("checked") == true)){

            } else {
                swal("","Todos los campos son requeridos","warning");
                app.preloader.hide();
                return false;
            }
        }
        var equipo = $('#equipo').val()
        if($("#gabineteexterior").prop("checked") == true){
            var gabineteexteriorC = "1";
        } else {
            var gabineteexteriorC = "0";
        }
        if($("#gabineteinterior").prop("checked") == true){
            var gabineteinteriorC = "1";
        } else {
            var gabineteinteriorC = "0";
        }
        if($("#paneles").prop("checked") == true){
            var panelesC = "1";
        } else {
            var panelesC = "0";
        }
        if($("#quemadores").prop("checked") == true){
            var quemadoresC = "1";
        } else {
            var quemadoresC = "0";
        }
        if($("#parrillas").prop("checked") == true){
            var parrillasC = "1";
        } else {
            var parrillasC = "0";
        }
        if($("#vulvasespreas").prop("checked") == true){
            var vulvasespreasC = "1";
        } else {
            var vulvasespreasC = "0";
        }
        if($("#panelescontrol").prop("checked") == true){
            var panelescontrolC = "1";
        } else {
            var panelescontrolC = "0";
        }
        if($("#condensador").prop("checked") == true){
            var condensadorC = "1";
        } else {
            var condensadorC = "0";
        }
        if($("#evaporador").prop("checked") == true){
            var evaporadorC = "1";
        } else {
            var evaporadorC = "0";
        }
        if($("#motoresaspas").prop("checked") == true){
            var motoresaspasC = "1";
        } else {
            var motoresaspasC = "0";
        }
        if($("#compresor").prop("checked") == true){
            var compresorC = "1";
        } else {
            var compresorC = "0";
        }
        if($("#flautas").prop("checked") == true){
            var flautasC = "1";
        } else {
            var flautasC = "0";
        }
        if($("#sistemahidraulico").prop("checked") == true){
            var sistemahidraulicoC = "1";
        } else {
            var sistemahidraulicoC = "0";
        }
        if($("#sistemalavado").prop("checked") == true){
            var sistemalavadoC = "1";
        } else {
            var sistemalavadoC = "0";
        }
        if($("#empaques").prop("checked") == true){
            var empaquesC = "1";
        } else {
            var empaquesC = "0";
        }
        if($("#deteccionfugas").prop("checked") == true){
            var deteccionfugasC = "1";
        } else {
            var deteccionfugasC = "0";
        }
        if($("#ajusteelectrico").prop("checked") == true){
            var ajusteelectricoC = "1";
        } else {
            var ajusteelectricoC = "0";
        }
        if($("#lubricacionmovil").prop("checked") == true){
            var lubricacionmovilC = "1";
        } else {
            var lubricacionmovilC = "0";
        }
        if($("#revisionmodos").prop("checked") == true){
            var revisionmodosC = "1";
        } else {
            var revisionmodosC = "0";
        }
        if($("#filtroaire").prop("checked") == true){
            var filtroaireC = "1";
        } else {
            var filtroaireC = "0";
        }
        if($("#valvulas1").prop("checked") == true){
            var valvulasS = "1";
        } else if($("#valvulas0").prop("checked")){
            var valvulasS = "0";
        }
        if($("#termostato1").prop("checked") == true){
            var termostatoS = "1";
        } else if($("#termostato0").prop("checked")){
            var termostatoS = "0";
        }
        if($("#controlpresion1").prop("checked") == true){
            var controlpresionS = "1";
        } else if($("#controlpresion0").prop("checked")){
            var controlpresionS = "0";
        }
        if($("#sensorflama1").prop("checked") == true){
            var sensorflamaS = "1";
        } else if($("#sensorflama0").prop("checked")){
            var sensorflamaS = "0";
        }
        if($("#quemador1").prop("checked") == true){
            var quemadorS = "1";
        } else if($("#quemador0").prop("checked")){
            var quemadorS = "0";
        }
        if($("#turbinas1").prop("checked") == true){
            var turbinasS = "1";
        } else if($("#turbinas0").prop("checked")){
            var turbinasS = "0";
        }
        if($("#resistencias1").prop("checked") == true){
            var resistenciasS = "1";
        } else if($("#resistencias0").prop("checked")){
            var resistenciasS = "0";
        }
        if($("#sondas1").prop("checked") == true){
            var sondasS = "1";
        } else if($("#sondas0").prop("checked")){
            var sondasS = "0";
        }
        if($("#tarjetaselectronicas1").prop("checked") == true){
            var tarjetaselectronicasS = "1";
        } else if($("#tarjetaselectronicas0").prop("checked")){
            var tarjetaselectronicasS = "0";
        }
        if($("#compresor1").prop("checked") == true){
            var compresorS = "1";
        } else if($("#compresor0").prop("checked")){
            var compresorS = "0";
        }
        if($("#motordifusores1").prop("checked") == true){
            var motordifusoresS = "1";
        } else if($("#motordifusores0").prop("checked")){
            var motordifusoresS = "0";
        }
        if($("#aspasmotor1").prop("checked") == true){
            var aspasmotorS = "1";
        } else if($("#aspasmotor0").prop("checked")){
            var aspasmotorS = "0";
        }
        if($("#contactores1").prop("checked") == true){
            var contactoresS = "1";
        } else if($("#contactores0").prop("checked")){
            var contactoresS = "0";
        }
        if($("#fugatuberia1").prop("checked") == true){
            var fugatuberiaS = "1";
        } else if($("#fugatuberia0").prop("checked")){
            var fugatuberiaS= "0";
        }
        if($("#aislantetuberia1").prop("checked") == true){
            var aislantetuberiaS = "1";
        } else if($("#aislantetuberia1").prop("checked")){
            var aislantetuberiaS = "0";
        }
        if($("#condensador1").prop("checked") == true){
            var condensadorS = "1";
        } else if($("#condensador0").prop("checked")){
            var condensadorS = "0";
        }
        if($("#iluminacion1").prop("checked") == true){
            var iluminacionS = "1";
        } else if($("#iluminacion0").prop("checked")){
            var iluminacionS = "0";
        }
        if($("#empaques1").prop("checked") == true){
            var empaquesS = "1";
        } else if($("#empaques0").prop("checked")){
            var empaquesS = "0";
        }
        if($("#fugagas1").prop("checked") == true){
            var fugagaS = "1";
        } else if($("#fugagas0").prop("checked")){
            var fugagaS = "0";
        }
        if($("#fugagas1").prop("checked") == true){
            var valvulasS = "1";
        } else if($("#fugagas0").prop("checked")){
            var valvulasS = "0";
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO check_list(id_cedula,equipo,gabinete_exterior,gabinete_interior,quemadores,paneles,parillas,vulvas_espreas,paneles_control,condensador,evaporador,motores,compresor,flautas,sistema_hidraulico,sistema_lavado,empaques,dereccion_fugas,ajuste_electrico,libricacion,revision_operacion,filtro_aire) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,gabineteexteriorC,gabineteinteriorC,quemadoresC,panelesC,parrillasC,vulvasespreasC,panelescontrolC,condensadorC,evaporadorC,motoresaspasC,compresorC,flautasC,sistemahidraulicoC,sistemalavadoC,empaquesC,deteccionfugasC,ajusteelectricoC,lubricacionmovilC,revisionmodosC,filtroaireC],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO check_list2(id_cedula,equipo,vulvas,termostato,control_presion,sensor_flama,quemadores,turbinas,resistencias,sondas,tarjeta_electronica,compresor,motor_difusores,aspas,contractores,fuga_tuberia,aislante_tuberia,condfensador,iluminacion,empaques,fuga) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                    [id_cedula,equipo,valvulasS,termostatoS,controlpresionS,sensorflamaS,quemadorS,turbinasS,resistenciasS,sondasS,tarjetaselectronicasS,compresorS,motordifusoresS,aspasmotorS,contactoresS,fugatuberiaS,aislantetuberiaS,condensadorS,iluminacionS,empaquesS,fugagaS],
                                    function(tx, results){
                                        swal("","Comprobacion Guardada","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar el registro",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar el registro",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoDespuesDIPREC(){
        app.preloader.show('blue');
        if($("#equipo").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fase = 'despues';
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_equipo(id_cedula,fase,foto,equipo,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto,equipo,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_foto) as Id from evidencia_equipo",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_equipo where id_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_equipo_despues tbody").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar el registro guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarRevisionDespuesDiprec(){
        app.preloader.show('blue');
        // if($("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#equipo").val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $("#equipo").val();
        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_despues(id_cedula,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreReporteDIPREC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == "" || $("#puesto").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var puesto = $("#puesto").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyTecnicoDIPREC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarCierreMinutaDIPREC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#puesto").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        } else {
            if($("#coordinadorobra").text() == 'Entrega'){
                if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
                    swal("","Por favor, ingresa el motivo de tu calificacion","warning");
                    return false;
                }
            } else {

            }
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        if($("#coordinadorobra").text() == 'Entrega'){
            var calificacion = $("#eval").val();
            var comentarioCliente = $('#comentario_cliente').val();
        } else {
            var calificacion = "";
            var comentarioCliente = "";
        }

        var puesto = $("#puesto").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE minuta_coordinador SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyCoordinadorDIPREC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarTecnicoDIPREC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicio_tecnico SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMinutaCoordinador(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "minutaCoordinador";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMinutaCoordinador(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoDIPREC3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarDatosMinutaCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#empresa").val() =="0" || $("#coordinadorObra").val() == "0" || $("#nombreCliente").val() == "" || $("#proyecto").val() == "" || $("#coordinador").val() == "" || $("#direccion").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var empresa = $("#empresa").val();
        var coordinadorObra = $("#coordinadorObra").val();
        var nombreCliente = $("#nombreCliente").val();
        var proyecto = $("#proyecto").val();
        var coordinador = $("#coordinador").val();
        var direccion = $("#direccion").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ?,id_cliente = ? WHERE id_cedula = ?",
                    [nombreCliente,nombreCliente,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE minuta_coordinador SET empresa = ?,coordinador_obra = ?,nombre_cliente = ?,proyecto = ?,coordonador = ?,direccion = ? WHERE id_cedula = ?",
                                    [empresa,coordinadorObra,nombreCliente,proyecto,coordinador,direccion,id_cedula],
                                    function(tx, results){
                                        $("#empresa").css("background-color", "#FFFFFF");
                                        $("#coordinadorObra").css("background-color", "#FFFFFF");
                                        $("#nombreCliente").css("background-color", "#FFFFFF");
                                        $("#proyecto").css("background-color", "#FFFFFF");
                                        $("#coordinador").css("background-color", "#FFFFFF");
                                        $("#direccion").css("background-color", "#FFFFFF");
                                        swal("", "Se guardaron los datos correctamente" ,"success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarZonaDIPREC(){
        app.preloader.show('blue');
        if($("#zona").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO zonas_coordinador(id_cedula,nombre,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,zona,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_zona) as Id from zonas_coordinador",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from zonas_coordinador where id_zona = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_zona tbody").append("<tr id='fila"+ item.id_zona +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_zona +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nombre) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarEquipoCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#zona").val() == "0" || $('#equipo').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var equipo = $("#equipo").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO equipos_coordinador(id_cedula,zona,equipo,foto,fecha_registro) VALUES (?,?,?,?,?)",
                    [id_cedula,zona,equipo,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_equipo) as Id from equipos_coordinador",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from equipos_coordinador where id_equipo = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#tabla_equipo tbody").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaDIPREC("+ item.id_equipo +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.zona) + "</td><td style='text-align: center;'>" + unescape(item.equipo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarZonaEquipoDiprec(){
        app.preloader.show('blue');
        // if($("#zona").val() == "0" || $("#equipo").val() == "0" || $('#voltaje').val() == "" || ($("#voltaje1").prop("checked") == false && $("#voltaje2").prop("checked") == false) || $('#imagenC1').val() == "" || $('#corriente').val() == "" || ($("#corriente1").prop("checked") == false && $("#corriente2").prop("checked") == false) || $('#imagenC2').val() == "" || $('#fase').val() == "" || ($("#fase1").prop("checked") == false && $("#fase2").prop("checked") == false) || $('#imagenC3').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#tipogas').val() == "" || ($("#tipogas1").prop("checked") == false && $("#tipogas2").prop("checked") == false) || $('#imagenC4').val() == "" || $('#presiongas').val() == "" || ($("#presiongas1").prop("checked") == false && $("#presiongas2").prop("checked") == false) || $('#imagenC5').val() == "" || $('#presionvapor').val() == "" || ($("#presionvapor1").prop("checked") == false && $("#presionvapor2").prop("checked") == false) || $('#imagenC6').val() == "" || $('#temperaturaequipo').val() == "" || ($("#temperaturaequipo1").prop("checked") == false && $("#temperaturaequipo2").prop("checked") == false) || $('#imagenC7').val() == "" || $('#fallareportada').val() == ""){
        if($("#zona").val() == "0" || $("#equipo").val() == "0"){
            swal("","Los campos de Zona y Equipo son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var zona = $("#zona").val();
        var equipo = $("#equipo").val();

        var voltajeT = $("#voltaje").val();
        if($("#voltaje1").prop("checked") == true){
            var voltajeC = "1";
        } else if($("#voltaje0").prop("checked")){
            var voltajeC = "0";
        }
        var voltajeF = $('#imagenC1').val();
        var corrienteT = $("#corriente").val();
        if($("#corriente1").prop("checked") == true){
            var corrienteC = "1";
        } else if($("#corriente0").prop("checked")){
            var corrienteC = "0";
        }
        var corrienteF = $('#imagenC2').val();

        var faseT = $("#fase").val();
        if($("#fase1").prop("checked") == true){
            var faseC = "1";
        } else if($("#fase0").prop("checked")){
            var faseC = "0";
        }
        var faseF = $('#imagenC3').val();
        var tipogasT = $("#tipogas").val();
        if($("#tipogas1").prop("checked") == true){
            var tipogasC = "1";
        } else if($("#tipogas0").prop("checked")){
            var tipogasC = "0";
        }
        var tipogasF = $('#imagenC4').val();
        var presiongasT = $("#presiongas").val();
        if($("#presiongas1").prop("checked") == true){
            var presiongasC = "1";
        } else if($("#presiongas0").prop("checked")){
            var presiongasC = "0";
        }
        var presiongasF = $('#imagenC5').val();
        var presionvaporT = $("#presionvapor").val();
        if($("#presionvapor1").prop("checked") == true){
            var presionvaporC = "1";
        } else if($("#presionvapor0").prop("checked")){
            var presionvaporC = "0";
        }
        var presionvaporF = $('#imagenC6').val();
        var temperaturaequipoT = $("#temperaturaequipo").val();
        if($("#temperaturaequipo1").prop("checked") == true){
            var temperaturaequipoC = "1";
        } else if($("#temperaturaequipo0").prop("checked")){
            var temperaturaequipoC = "0";
        }
        var temperaturaequipoF = $('#imagenC7').val();
        var fallareportada = $('#fallareportada').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_coordinador(id_cedula,zona,equipo,voltaje,estado_voltaje,evidencia_voltaje,corriente,estado_corriente,evidencia_corriente,fases,estado_fase,evidencia_fase,tipo_gas,estado_gas,evidencia_gas,presion_gas,estado_presion_gas,evidencia_presion_gas,presion_vapor,estado_presion_vapor,evidencia_presion_vapor,temperatura,estado_temperatura,evidencia_estado_temperatura,falla_reportada) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,zona,equipo,voltajeT,voltajeC,voltajeF,corrienteT,corrienteC,corrienteF,faseT,faseC,faseF,tipogasT,tipogasC,tipogasF,presiongasT,presiongasC,presiongasF,presionvaporT,presionvaporC,presionvaporF,temperaturaequipoT,temperaturaequipoC,temperaturaequipoF,fallareportada],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Evidencia del equipo Guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarObservacionesCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#acuerdo").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#sourceP").val() == "Subida"){
            var acuerdo = $("#acuerdo").val() + " #$ S";
        } else {
            var acuerdo = $("#acuerdo").val() + " #$ C";
        }
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO observaciones(id_cedula,acuerdo,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,acuerdo,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_acuerdo) as Id from observaciones",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from observaciones where id_acuerdo = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $('#acuerdo').val("");
                                                        $("#textInput").text("Seleccione");
                                                        $("#sourceP").text("Camera");
                                                        $("#acuerdo").css("background-color", "white");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        item.acuerdo = item.acuerdo.split("#$");
                                                        item.acuerdo = item.acuerdo[0];
                                                        $("#tabla_acuerdo tbody").append("<tr id='fila"+ item.id_acuerdo +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_acuerdo +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_acuerdo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.acuerdo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarNotasCoordinadorDIPREC(){
        app.preloader.show('blue');
        if($("#nota").val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#sourceP").val() == "Subida"){
            var nota = $("#nota").val() + " #$ S";
        } else {
            var nota = $("#nota").val() + " #$ C";
        }

        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO notas(id_cedula,nota,foto,fecha_registro) VALUES (?,?,?,?)",
                    [id_cedula,nota,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_nota) as Id from notas",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from notas where id_nota = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $('#imagenC').val("");
                                                        $("#nota").val("");
                                                        $("#textInput").text("Seleccione");
                                                        $("#sourceP").text("Camera");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        item.nota = item.nota.split("#$");
                                                        item.nota = item.nota[0];
                                                        $("#tabla_notas tbody").append("<tr id='fila"+ item.id_nota +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_nota +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_nota +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nota) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function activarCheck1(valor){
        if($("#recorrido1").prop("checked") === true){
            $("#re1").css("display", "block");
        } else {
            $("#re1").css("display", "none");
        }
    }
    function activarCheck2(valor){
        if($("#recorrido2").prop("checked") === true){
            $("#re2").css("display", "block");
        } else {
            $("#re2").css("display", "none");
        }
    }
    function terminarCoordinadorDIPREC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE minuta_coordinador SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function editarFilaDiprec(index, opc){
        if(opc == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "SELECT acuerdo FROM observaciones WHERE id_acuerdo = ?",
                        [index],
                        function(tx, results){
                            var item = results.rows.item(0);
                            dynamicPopup.open();
                            item.acuerdo = item.acuerdo.split("#$");
                            var estado = item.acuerdo[1];
                            item.acuerdo = item.acuerdo[0];
                            $("#edit").val(item.acuerdo);
                            $("#option").val(index + "," + opc + "," + estado);
                        },
                        function(tx, error){
                            swal("Error al actualizar el registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "SELECT nota FROM notas WHERE id_nota = ?",
                        [index],
                        function(tx, results){
                            var item = results.rows.item(0);
                            dynamicPopup.open();
                            item.nota = item.nota.split("#$");
                            var estado = item.nota[1];
                            item.nota = item.nota[0];
                            $("#edit").val(item.nota);
                            $("#option").val(index + "," + opc + "," + estado);
                        },
                        function(tx, error){
                            swal("Error al actualizar el registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function FilaEditadaDiprec(){
        var options = $("#option").val();
        var opt = options.split(",");
        var text = $("#edit").val() + " #$ " + opt[2];
        if(opt[1] == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE observaciones SET acuerdo = ? WHERE id_acuerdo = ?",
                        [text,opt[0]],
                        function(tx, results){
                            $("#tabla_acuerdo tbody").remove();
                            $("#tabla_acuerdo").append("<tbody></tbody>");
                            var id_cedula = localStorage.getItem("IdCedula");
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from observaciones where id_cedula= ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if(length == 0){
                                                $("#message-nr").css("display", "block");
                                            } else {
                                                for(var i = 0; i< length; i++){
                                                    var item = results.rows.item(i);
                                                    item.acuerdo = item.acuerdo.split("#$");
                                                    item.acuerdo = item.acuerdo[0];
                                                    $("#tabla_acuerdo tbody").append("<tr id='fila"+ item.id_acuerdo +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_acuerdo +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_acuerdo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.acuerdo) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                }
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                    console.log("Consulta correcta");
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opt[1] == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE notas SET nota = ? WHERE id_nota = ?",
                        [text,opt[0]],
                        function(tx, results){
                            $("#tabla_notas tbody").remove();
                            $("#tabla_notas").append("<tbody></tbody>");
                            var id_cedula = localStorage.getItem("IdCedula");
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from notas where id_cedula= ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if(length == 0){
                                                $("#message-nr").css("display", "block");
                                            } else {
                                                for(var i = 0; i< length; i++){
                                                    var item = results.rows.item(i);
                                                    item.nota = item.nota.split("#$");
                                                    item.nota = item.nota[0];
                                                    $("#tabla_notas tbody").append("<tr id='fila"+ item.id_nota +"'><td style='display: flex;flex-direction: row;justify-content: space-around;align-items: flex-end;padding:0;'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_nota +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a><a href='#' onclick='editarFilaDiprec("+ item.id_nota +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.nota) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                }
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function editarFilaSuro(index, opc){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "SELECT nombre_grupo FROM grupos WHERE id_grupo = ?",
                    [index],
                    function(tx, results){
                        var item = results.rows.item(0);
                        PopupSuro.open();
                        $("#edit").val(item.nombre_grupo);
                        $("#option").val(index + "," + opc);
                        $("#lastValue").val(item.nombre_grupo);
                    },
                    function(tx, error){
                        swal("Error al actualizar el registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function FilaEditadaSuro(){
        var id_cedula = localStorage.getItem("IdCedula");
        var options = $("#option").val();
        var toSearch = $("#lastValue").val();
        var opt = options.split(",");
        var text = $("#edit").val();
        if(opt[1] == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE grupos SET nombre_grupo = ? WHERE id_grupo = ? AND id_cedula = ?",
                        [text,opt[0],id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE evidencia SET nombre_grupo = ? WHERE nombre_grupo = ? AND id_cedula = ? AND fases = 'durante'",
                                        [text,toSearch,id_cedula],
                                        function(tx, results){
                                            $("#tabla_grupos_uno tbody").remove();
                                            $("#tabla_grupos_uno").append("<tbody></tbody>");
                                            var id_cedula = localStorage.getItem("IdCedula");
                                            databaseHandler.db.transaction(
                                                function(tx1){
                                                    tx1.executeSql(
                                                        "Select * from grupos where id_cedula= ? AND fases = 'durante'",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            if(length == 0){
                                                                $("#message-nr").css("display", "block");
                                                            } else {
                                                                for(var i = 0; i< length; i++){
                                                                    var item = results.rows.item(i);
                                                                    $("#tabla_grupos_uno tbody").append("<tr id='fila"+ item.id_grupo +"'><td><a href='#' onclick='editarFilaSuro("+ item.id_grupo +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td> " + item.nombre_grupo + "</td></tr>");
                                                                    $("#message-nr").css("display", "none");
                                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                                }
                                                            }
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opt[1] == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE grupos SET nombre_grupo = ? WHERE id_grupo = ? AND id_cedula = ?",
                        [text,opt[0],id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE evidencia SET nombre_grupo = ? WHERE nombre_grupo = ? AND id_cedula = ? AND fases = 'fomites'",
                                        [text,toSearch,id_cedula],
                                        function(tx, results){
                                            $("#tabla_grupos_dos tbody").remove();
                                            $("#tabla_grupos_dos").append("<tbody></tbody>");
                                            databaseHandler.db.transaction(
                                                function(tx1){
                                                    tx1.executeSql(
                                                        "Select * from grupos where id_cedula= ? AND fases = 'fomites'",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            if(length == 0){
                                                                $("#message-nr2").css("display", "block");
                                                            } else {
                                                                for(var i = 0; i< length; i++){
                                                                    var item = results.rows.item(i);
                                                                    $("#tabla_grupos_dos tbody").append("<tr id='fila"+ item.id_grupo +"'><td><a href='#' onclick='editarFilaSuro("+ item.id_grupo +",2);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td> " + item.nombre_grupo + "</td></tr>");
                                                                    $("#message-nr2").css("display", "none");
                                                                    swal("", "Registro Actualizado Exitosamente!!" ,"success");
                                                                }
                                                            }
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    var dynamicPopup = app.popup.create({
        content: `
          <div class="popup FWM-half-modal">
            <div class="my-swipe-to-close-handler" style="padding-top:16px">
                <div class="FWM-bubble-close"></div>
            </div>
            <div class="block">
                <p style="margin:0">Edicion de registro:</p>
                <textarea class ="FWM-input-modal" id="edit" name="edit"  cols="30" rows="10"></textarea>
                <input type="hidden" id="option" name="option"/>
                <div class="FWM-button-modal-container">
                    <div class="FWM-button-modal popup-close" onclick="FilaEditadaDiprec()">Actualizar Registro</div>
                </div>
            </div>
          </div>
        `,
        swipeToClose: true,
        swipeHandler: '.my-swipe-to-close-handler',
        // Events
        on: {
          open: function (popup,text) {

          },
          opened: function (popup) {

          },
        }
    });
    dynamicPopup.on('close', function (popup) {});
    var PopupSuro = app.popup.create({
        content: `
          <div class="popup FWM-half-modal">
            <div class="my-swipe-to-close-handler" style="padding-top:16px">
                <div class="FWM-bubble-close"></div>
            </div>
            <div class="block">
                <p style="margin:0">Edicion de registro:</p>
                <textarea class ="FWM-input-modal" id="edit" name="edit"  cols="30" rows="10"></textarea>
                <input type="hidden" id="option" name="option"/>
                <input type="hidden" id="lastValue" name="lastValue"/>
                <div class="FWM-button-modal-container">
                    <div class="FWM-button-modal popup-close" onclick="FilaEditadaSuro()">Actualizar Registro</div>
                </div>
            </div>
          </div>
        `,
        swipeToClose: true,
        swipeHandler: '.my-swipe-to-close-handler',
        // Events
        on: {
          open: function (popup,text) {

          },
          opened: function (popup) {

          },
        }
    });
    PopupSuro.on('close', function (popup) {});
    function startFromProgramDIPREC(empresa,category,nombre_comercial,person_receive,direccion){
        localStorage.setItem("empresaD", empresa);
        localStorage.setItem("categoryD", category);
        localStorage.setItem("nombre_comercialD", nombre_comercial);
        localStorage.setItem("person_receiveD", person_receive);
        localStorage.setItem("direccionD", direccion);
        app.views.main.router.navigate({name: 'yallegueDIPREC2'});
    }
    function iniciarClienteDIPREC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = localStorage.getItem("nombre_comercialD");
        var tipoCedula = "minutaCoordinador";
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                var empresa = localStorage.getItem("empresaD");
                                                if(empresa == "ZUBRAUN, S.A. DE C.V"){
                                                    empresa = 1;
                                                } else if(empresa == "GASTRO CHEF DE MEXICO S.A. DE C.V"){
                                                    empresa = 2;
                                                } else if(empresa == "DIPREC S.A. DE C.V"){
                                                    empresa = 3;
                                                }
                                                var coordinador_obra = localStorage.getItem("categoryD");
                                                if(coordinador_obra == "Levantamiento"){
                                                    coordinador_obra = 1;
                                                } else if(coordinador_obra == "Instalación"){
                                                    coordinador_obra = 2;
                                                } else if(coordinador_obra == "Avance de Obra"){
                                                    coordinador_obra = 3;
                                                } else if(coordinador_obra == "Reunión"){
                                                    coordinador_obra = 4;
                                                } else if(coordinador_obra == "Capacitación"){
                                                    coordinador_obra = 5;
                                                } else if(coordinador_obra =="Entrega"){
                                                    coordinador_obra = 6;
                                                }
                                                var nombre_cliente = localStorage.getItem("nombre_comercialD");
                                                var proyecto = localStorage.getItem("person_receiveD");
                                                var coordonador = nombre_usuario;
                                                var direccion = localStorage.getItem("direccionD");
                                                productHandler.addMinutaCoordinadorr(id_cedula,foto_llegada,empresa,coordinador_obra,nombre_cliente,proyecto,coordonador,direccion);
                                                app.views.main.router.back('/recorridoDIPREC3/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function uploadPicture(input){
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onloadend = function (e) {
                $("body").append("<canvas id='tempCanvas' width='800' height='800' style='display:none'></canvas>");
                var canvas = document.getElementById("tempCanvas");
                var ctx = canvas.getContext("2d");
                var maxW = 800;
                var maxH = 800;
                var img = new Image;
                img.src = this.result;
                img.onload = function(){
                    var iw = img.width;
                    var ih = img.height;
                    var scale = Math.min((maxW/iw),(maxH/ih));
                    var iwScaled = iw*scale;
                    var ihScaled = ih*scale;
                    canvas.width = iwScaled;
                    canvas.height = ihScaled;
                    ctx.drawImage(img,0,0,iwScaled,ihScaled);
                    var base64image = canvas.toDataURL("image/jpeg");
                    $("#imagenC").val(base64image);
                    $("#sourceP").val("Subida");
                    $("#textInput").text(input.files[0].name);
                    $("#tempCanvas").remove();
                }
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    function generarLevantamientoDiprec(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "checklist_levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        localStorage.setItem("TipoVisita", tipoCedula);
                        productHandler.addLevantamientoDiprec(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoDIPREC2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarLiberacionDiprec(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "checklist_liberacion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        localStorage.setItem("TipoVisita", tipoCedula);
                        productHandler.addLevantamientoDiprec(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoDIPREC4'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDIPREC(){
        swal("","Guardado correctamente","success");
    }
    function generarInspeccionDiprec(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "checklist_inspeccion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        localStorage.setItem("TipoVisita", tipoCedula);
                        //productHandler.addMinutaCoordinador(id_cedula,foto_llegada);
                        app.views.main.router.navigate({name: 'recorridoDIPREC5'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function validaradios(id){
        var ids = id.split("-");
        var check = ids[1];
        if(check.includes('1')){
            var valCheck = document.getElementById(ids[0]+"-"+ids[1]).checked;
            if(valCheck ==true){
                var name = check.replace('1','0');
                var otherCheck = ids[0] + "-0";
                document.getElementById(otherCheck).checked = false;
            }
        }else{
            var valCheck = document.getElementById(ids[0]+"-"+ids[1]).checked;
            if(valCheck ==true){
                var name = check.replace('1','0');
                var otherCheck = ids[0] + "-1";
                document.getElementById(otherCheck).checked = false;
            }
        }
    }
    function muestra_diprec(id,valor){
        if (id == 1){
            if (valor){
                if(valor == 'Propia'){
                    $("#division-1").css("display","block");
                    $("#division-2").css("display","block");
                }else if(valor == 'Por el cliente'){
                    $("#division-1").css("display","block");
                    $("#division-2").css("display","none");
                }else{
                    $("#division-1").css("display","none");
                    $("#division-2").css("display","none");
                }   
            }
        }else{
            if (valor == 1){
                $("#division-"+id).css("display","block");
            }else{
                $("#division-"+id).css("display","none");
            }
        }
    }
    function muestra_diprec2(id,valor){
        if (valor == 1){
            $("#division-"+id).css("display","flex");
        }else{
            $("#division-"+id).css("display","none");
        }
    }
    function maspresiones(){
        $("#presiones").append(`
            <div style="display: flex;justify-content: space-around;margin-bottom: 15px;">
                <label class="text-divided-check">Salida<input type="number" id="16-33-input" name="Punto-110" class="multiple-input-divided-check" onchange="inputLleno(this.id,this.value);"></label>
                <label class="text-divided-check">Presión<input type="number" id="16-33-input" name="Punto-110" class="multiple-input-divided-check" onchange="inputLleno(this.id,this.value);"></label>
                <label class="text-divided-check">&nbsp;<input type="number" class="multiple-input-divided-check" style="border: 1px white !important;" readonly></label>
            </div>
        `);
    }
    function menospresiones(){
        console.log("remove + item");
    }
    function guardarDatosGeneralesDiprec(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var proyecto = $("#proyecto").val();
            var pedido = $("#pedido").val();
            var fecha = $("#fecha").val();
            var referencia = $("#referencia").val();
            var proyectos = $("#proyectos").val();
            var vendedor = $("#vendedor").val();
            var mombre = $("#mombre").val();
            var razon_social = $("#razon_social").val();
            var direccion = $("#direccion").val();
            var telefono = $("#telefono").val();
            var rfc = $("#rfc").val();
            var atencion = $("#atencion").val();
            var puesto = $("#puesto").val();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_generales_diprec SET proyecto = ?, pedido = ?, fecha = ?, referencia = ?, proyectos = ?, vendedor = ?, mombre = ?, razon_social = ?, direccion = ?, telefono = ?, rfc = ?, atencion = ?, puesto = ? WHERE id_cedula = ?",
                        [proyecto, pedido, fecha, referencia, proyectos, vendedor, mombre, razon_social, direccion, telefono, rfc, atencion, puesto,id_cedula],
                        function(tx, results){
                            console.log('res',results);
                            databaseHandler.db.transaction(
                                function(tx){
                                    console.log(proyecto ,id_cedula)
                                    tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                        [proyecto ,id_cedula],
                                        function(tx, results){
                                            swal("","Guardado correctamente","success");
                                            $('#proyecto').css("background-color", "#ffffff");
                                            $('#pedido').css("background-color", "#ffffff");
                                            $('#fecha').css("background-color", "#ffffff");
                                            $('#referencia').css("background-color", "#ffffff");
                                            $('#proyectos').css("background-color", "#ffffff");
                                            $('#vendedor').css("background-color", "#ffffff");
                                            $('#mombre').css("background-color", "#ffffff");
                                            $('#razon_social').css("background-color", "#ffffff");
                                            $('#direccion').css("background-color", "#ffffff");
                                            $('#telefono').css("background-color", "#ffffff");
                                            $('#rfc').css("background-color", "#ffffff");
                                            $('#atencion').css("background-color", "#ffffff");
                                            $('#puesto').css("background-color", "#ffffff");
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar datos generales: " + error.message);
                                        }
                                    );
                                },
                                function(error){
                                    console.error("Error al guardar datos generales: " + error.message);
                                },
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar datos generales: " + error.message);
                },
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarEvidenciaDiprec(recorrido){
        var id_cedula = localStorage.getItem("IdCedula");
        var comentario = $("#comentario").val();
        var foto = $("#imagenC").val();
        var area = $("#area").val();
        var fecha = new Date();
        var fechas = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(area == 0){
            swal("","Debes seleccionar una área", "warning");
            return false;
        }
        if(!foto){
            swal("","Debes tomar una foto", "warning");
            return false;
        }
        if(!comentario){
            comentario = 'Sin Comentarios';
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencias_diprec(id_cedula, comentario, foto, area, recorrido, fecha) VALUES (?,?,?,?,?,?)",
                    [id_cedula,comentario,foto,area,recorrido,fechas],
                    function(tx, results){
                    swal("","Se guardaron los datos correctamente", "success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql(
                                    "Select * from evidencias_diprec where id_cedula = ? ORDER BY id_evidencia DESC",
                                        [id_cedula],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaDIPREC("+item.id_evidencia +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + 
                                            item.area + "</td><td><img src='"+item.foto+
                                            "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentario
                                            + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                            $("#area").val(0)
                                            $("#comentario").val('');
                                            $("#comentario").css("background-color", "#FFFFFF");
                                            $("#smallImage").attr("src","img/blank.png");
                                            $("#photoIcon").attr("src","img/camera.svg");
                                            $("#imagenC").val('');
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error: " + error.message);
                                            app.preloader.hide();
                                        }
                                );
                            },
                                function(error){
                                    console.log("Error: " + error.message);
                                },
                                function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error: " + error.message);
            },
            function(){}
        );
    }
    function guardaCheckDiprec(id,fase){
        var campo = $("#"+id);
        var pregunta = $(campo).attr("name"); 
        
        if($(campo).get(0).tagName == 'INPUT'){
            if($(campo).get(0).type == 'radio'){
                if(id.includes("1")){
                    var val = "1";
                }else{
                    var val = "0";
                }
                guardaCheckDiprec1(val,pregunta,"radio",fase,id);
            }else if($(campo).get(0).type == 'checkbox'){
                if( $(campo).prop("checked") == true){
                    var val = "1";
                }else{
                    var val = "0";
                }
                guardaCheckDiprec1(val,id,"checkbox",fase,id);
            }else{
                var val = $(campo).val();
                var tipo = $(campo).get(0).tagName;
                guardaCheckDiprec1(val,id,tipo,fase,id);
            }
        }else{
            var tipo = $(campo).get(0).tagName;
            var val = $(campo).val();
            guardaCheckDiprec1(val,id,tipo,fase,id);
        }
    }
    function guardaCheckDiprec1(valor,pregunta,tipo,fase,id){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from checklist_diprec where id_cedula = ? AND pregunta = ? AND fase = ?",
                    [id_cedula,pregunta,fase],
                    function(tx, results){
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO checklist_diprec(id_cedula, pregunta ,valor, fase, tipo, id) VALUES (?,?,?,?,?,?)",
                                        [id_cedula, pregunta, valor, fase, tipo, id],
                                        function(tx, results){
                                            console.log('Inserta');
                                            //swal("", "Datos actualizados correctamente", "success");
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE checklist_diprec SET valor = ?, id = ? WHERE id_cedula = ? AND pregunta = ? AND fase = ?",
                                        [valor,id,id_cedula,pregunta,fase],
                                        function(tx, results){
                                            console.log('update');
                                            //swal("", "Datos actualizados correctamente", "success");
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        }
                    },
                    function(tx, error){console.log("Error: " + error.message);}
                );
            },
            function(error){console.log("Error: " + error.message);},function(){}
        );
    }
    function guardarCierreLevantamientoDIPREC(){
        if($("#NombreFirma").val() == ""){
            swal("","Debes indicar el nombre de la persona que te recibe","warning");
            return false;
        }
       
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_diprec SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyLevantaDiprec/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantaDIPREC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_diprec SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //DIPREC FIN
    //Inicio MerGroup
    function startFromProgramMer(id_visita,proyecto,sucursal,numero_orden,contratista,type_proyect,category,region,tower,id_cliente){
        localStorage.setItem("id_visita",id_visita);
        localStorage.setItem("proyecto",proyecto);
        localStorage.setItem("sucursal",sucursal);
        localStorage.setItem("numero_orden",numero_orden);
        localStorage.setItem("contratista",contratista);
        localStorage.setItem("type_proyect",type_proyect);
        localStorage.setItem("category",category);
        localStorage.setItem("region",region);
        localStorage.setItem("tower",tower);
        localStorage.setItem("id_cliente",id_cliente);
        app.views.main.router.back('/yallegueMerGroup2/', {force: true, ignoreCache: true, reload: true});
    }
    function iniciarClienteMer(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("id_cliente");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var id_visita = localStorage.getItem("id_visita");
        var proyecto = localStorage.getItem("proyecto");
        var sucursal = localStorage.getItem("sucursal");
        var numero_orden = localStorage.getItem("numero_orden");
        var contratista = localStorage.getItem("contratista");
        var type_proyect = localStorage.getItem("type_proyect");
        var category = localStorage.getItem("category");
        var region = localStorage.getItem("region");
        var tower = localStorage.getItem("tower");
        var tipoCedula = "reporteFotografico";
        var estatus = 0;
        var proceso = 1;
        if(foto_llegada != ''){
            if(proyecto != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,proyecto,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                productHandler.addreporteFotografico(id_cedula,id_visita,foto_llegada,numero_orden,proyecto,sucursal,contratista,type_proyect,region,tower,proceso)
                                                app.views.main.router.back('/recorridoMerGroup/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function tracking1(){
        app.views.main.router.navigate({
            name: "tracking-1",
        });
    }
    function tracking2(){
        app.views.main.router.navigate({
            name: "tracking-2",
        });
    }
    function tracking3(){
        app.views.main.router.navigate({
            name: "tracking-3",
        });
    }
    function tracking4(){
        app.views.main.router.navigate({
            name: "tracking-4",
        });
    }
    function buscarClienteMerGroup(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                app.views.main.router.navigate({name: 'recorridoMerGroup'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function guardarObservacionesMer(){
        app.preloader.show('blue');
        if($("#titulo").val() == "" || $('#imagenC').val() == ""){
            swal("","El titulo y la fotografia son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var titulo = $("#titulo").val();
        var observacion = $("#observacion").val();
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidenciaFotografica(id_cedula,titulo,observacion,foto,fecha_registro) VALUES (?,?,?,?,?)",
                    [id_cedula,titulo,observacion,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidenciaFotografica",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidenciaFotografica where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $('#imagenC').val("");
                                                        $("#titulo").val("");
                                                        $("#observacion").val("");
                                                        $("#titulo").css("background-color", "#FFFFFF");
                                                        $("#observacion").css("background-color", "#FFFFFF");
                                                        $("#tabla_evidencias tbody").append("<tr id='fila"+ item.id_evidencia +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.titulo) + "</td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Acuerdo guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreFotografiaMer(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteFotografico SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyMerGroup/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarReporteMer(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE reporteFotografico SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Fin MerGroup
    //Inicio PlatoLimpio
    function regeresarPLR1(){
        app.views.main.router.back('/recorridoPL1/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR2(){
        app.views.main.router.back('/recorridoPL2/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR3(){
        app.views.main.router.back('/recorridoPL3/', {force: true, ignoreCache: true, reload: true});
    }
    function buscarClientePlatoLimpio(){
            var id_usuario = localStorage.getItem("id_usuario");
            var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var geolocation = $("#geolocation").val();
            var id_cliente = "N/A";
            var horario_programado = fecha_llegada;
            var foto_llegada = $("#imagenC").val();
            var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
            var estatus = 0;
            if(foto_llegada != ''){
                if(nombre_cliente != ''){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    localStorage.setItem("IdCedula", item.Id);
                                    localStorage.setItem("nombreCliente", nombre_cliente);
                                    localStorage.setItem("foto_llegada", foto_llegada);
                                    app.views.main.router.navigate({name: 'menuPlatoLimpio'});
                                    app.preloader.hide();
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
        function generarCicloCharola() {
            let id_cedula = localStorage.getItem("IdCedula");
            let nombre_cliente = localStorage.getItem("nombreCliente");
            let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            let foto_llegada = localStorage.getItem("foto_llegada");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            let tipoCedula = "Plato Limpio";
            let direccion = localStorage.getItem("direccion");
            let correo = localStorage.getItem("correo");
            let sucursal = localStorage.getItem("sucursal");
            let proceso = 0;
            let recorrido = 0;
            let titulo = "foto_llegada";
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula, id_cedula],
                        function (tx, results) {
                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            let length = results.rows.length;
                                            if (length > 0) {
                                            var item = results.rows.item(i);
                                                app.views.main.router.navigate({ name: 'recorridoPL1' });
                                            }else{
                                                productHandler.addPL(id_cedula, nombre_cliente, correo);
                                                productHandler.PLFotos(id_cedula, recorrido, proceso,titulo, fecha_llegada, foto_llegada);
                                                app.views.main.router.navigate({ name: 'recorridoPL1' });
                                            }

                                        },
                                        function (tx, error) {
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );

                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) { },
                function () { }
            );

        }
        function FactorHumano(){
            let id_cedula = localStorage.getItem("IdCedula");
            let nombre_cliente = localStorage.getItem("nombreCliente");
            let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            let foto_llegada = localStorage.getItem("foto_llegada");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            let tipoCedula = "Plato Limpio";
            let direccion = localStorage.getItem("direccion");
            let correo = localStorage.getItem("correo");
            let sucursal = localStorage.getItem("sucursal");
            let proceso = 0;
            let recorrido = 0;
            let titulo = "foto_llegada";
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula, id_cedula],
                        function (tx, results) {

                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            let length = results.rows.length;
                                            if (length > 0) {
                                                var item = results.rows.item(i);
                                                app.views.main.router.navigate({name: 'recorridoPL2'});
                                            }else{
                                                productHandler.addPL(id_cedula, nombre_cliente, correo);
                                                productHandler.PLFotos(id_cedula, recorrido, proceso, titulo,fecha_llegada,  foto_llegada);
                                                app.views.main.router.navigate({name: 'recorridoPL2'});
                                            }

                                        },
                                        function (tx, error) {
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );


                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) { },
                function () { }
            );

        }
        function SanitizacionLava(){
            let id_cedula = localStorage.getItem("IdCedula");
            let nombre_cliente = localStorage.getItem("nombreCliente");
            let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            let foto_llegada = localStorage.getItem("foto_llegada");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            let tipoCedula = "Plato Limpio";
            let direccion = localStorage.getItem("direccion");
            let correo = localStorage.getItem("correo");
            let sucursal = localStorage.getItem("sucursal");
            let proceso = 0;
            let recorrido = 0;
            let titulo = "foto_llegada";
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula, id_cedula],
                        function (tx, results) {

                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            let length = results.rows.length;
                                            if (length > 0) {
                                                var item = results.rows.item(i);
                                                app.views.main.router.navigate({name: 'recorridoPL3'});
                                            }else{
                                                productHandler.addPL(id_cedula, nombre_cliente, correo);
                                                productHandler.PLFotos(id_cedula, recorrido, proceso,  titulo, fecha_llegada, foto_llegada);
                                                app.views.main.router.navigate({name: 'recorridoPL3'});
                                            }

                                        },
                                        function (tx, error) {
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );


                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }
        function regresarRecorridoPL1(){
            app.views.main.router.back('/recorridoPL1/', {force: true, ignoreCache: true, reload: true});
        }
        function guardarDGPL() {
            app.preloader.show('blue');
            if ($("#empresa").val() == "" || $("#canEmpleados").val() == "" || $("#fecAudi").val() == "" || $("#hora").val() == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var empresa = $("#empresa").val();
            var canEmpleados = $("#canEmpleados").val();
            var fecAudi = $("#fecAudi").val();
            var hora = $("#hora").val();
            var contacto = $("#contacto").val();
            var puesto = $("#puesto").val();
            var correo = $("#mail").val();
            var movil = $("#movil").val();
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET  DG_CEmpleados  = ? ,DG_Empresa = ?, DG_FechaA= ?,DG_HoraA = ?, DG_Contacto = ?, DG_Puesto = ?, DG_Correo = ?, DG_Movil = ? WHERE DG_ID_Cedula = ?",
                        [canEmpleados, empresa, fecAudi, hora, contacto, puesto, correo, movil, id_cedula],
                        function (tx, results) {
                            $("#empresa").css("background-color", "#FFFFFF");
                            $("#canEmpleados").css("background-color", "#FFFFFF");
                            $("#fecAudi").css("background-color", "#FFFFFF");
                            $("#puesto").css("background-color", "#FFFFFF");
                            $("#contacto").css("background-color", "#FFFFFF");
                            $("#mail").css("background-color", "#FFFFFF");
                            $("#movil").css("background-color", "#FFFFFF");

                            swal("", "Se guardaron los datos correctamente", "success");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }
        function guardarCCharolaPPL(tipo) {
            app.preloader.show('blue');
            if ($("#RespMD").val() == "" || $("#EscalaR").val() == "" || $("#areaOportunidad").val() == "" || $("#Comentarios").val() == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var RespMD = $("#RespMD").val();
            var EscalaR = $("#EscalaR").val();
            var areaOportunidad = $("#areaOportunidad").val();
            var Comentarios = $("#Comentarios").val();
            var id_cedula = localStorage.getItem("IdCedula");
            var etapa = $("#Etapa").val();
            $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('✘', '✔');
            });
            var jq = $('select[name="Etapa"] option:selected').text();
            var foto = $("#imagenC").val();
            var recorrido = 1;
            //var proceso= 1;
            var titulo = "" + jq;
            var fecha = new Date();
            var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            if (foto) {
                productHandler.PLFotos(id_cedula, recorrido, etapa, titulo, fecha_foto, foto);
            }
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Ciclo_Charola WHERE CC_ID_Cedula = ? and CC_Etapa =?",
                        [id_cedula, etapa],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                // console.log("Insert")
                                tx.executeSql("insert into Ciclo_Charola(CC_ID_Cedula,CC_tipo,CC_Etapa,CC_Escala,CC_Oportunidad,CC_Comentario,CC_Responsable) values(?,?,?,?,?,?,?)",
                                    [id_cedula, tipo, etapa, EscalaR, areaOportunidad, Comentarios, RespMD],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        //console.log("Registro de Ciclo_Charola exitosamente");
                                        $("#imagenC").val("");
                                        $("#smallImage").attr('src', 'img/blank.png');
                                        $("#photoIcon").attr("src", "img/camera.svg");
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Ciclo_Charola: " + error.message);
                                    }
                                );

                            } else {
                                //console.log("Update")
                                tx.executeSql("UPDATE Ciclo_Charola SET CC_Responsable = ?, CC_Escala = ?, CC_Oportunidad = ? ,CC_Comentario = ? WHERE CC_ID_Cedula = ? and CC_Etapa =?  ",
                                    [RespMD, EscalaR, areaOportunidad, Comentarios, id_cedula, etapa],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        $("#imagenC").val("");
                                        $("#smallImage").attr('src', 'img/blank.png');
                                        $("#photoIcon").attr("src", "img/camera.svg");
                                        // console.log("Registro de Ciclo_Charola exitosamente");
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Ciclo_Charola: " + error.message);
                                    }
                                );
                            }
                            $("#RespMD").css("background-color", "#FFFFFF");
                            $("#EscalaR").css("background-color", "#FFFFFF");
                            $("#areaOportunidad").css("background-color", "#FFFFFF");
                            $("#Comentarios").css("background-color", "#FFFFFF");
                            $("#IdCedula").css("background-color", "#FFFFFF");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );

        }
        function EtapasLP(id, value) {
            $("#tabla_ciclo_charola tbody").empty("");
            var id_cedula = localStorage.getItem("IdCedula");
            if (value == 1 || value == 12) {
                $(Protocolo).val("A,C")
            } else if (value == 2 || value == 3) {
                $(Protocolo).val("B,C")
            } else if (value == 4 || value == 9) {
                $(Protocolo).val("B,C,D")
            } else if (value == 5) {
                $(Protocolo).val("A,B,C,E")
            } else if (value == 6 || value == 7) {
                $(Protocolo).val("A,B,D")
            } else if (value == 8) {
                $(Protocolo).val("A,B,C,D")
            } else if (value == 10) {
                $(Protocolo).val("A")
            } else if (value == 11) {
                $(Protocolo).val("A,B,C")
            } else if (value == 13) {
                $(Protocolo).val("A,B")
            } else if (value == 14) {
                $(Protocolo).val("C,D")
            }
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql(
                        "Select * from Ciclo_Charola WHERE CC_ID_Cedula = ? and CC_Etapa = ?",
                        [id_cedula, value],
                        function (tx, results) {
                            let length = results.rows.length;
                            if (length > 0) {
                                for (var i = 0; i < length; i++) {
                                    var item = results.rows.item(i);
                                    $("#RespMD").val(item.CC_Responsable);
                                    $("#areaOportunidad").val(item.CC_Oportunidad)
                                    $("#Comentarios").val(item.CC_Comentario)
                                    $("#EscalaR").val(item.CC_Escala)
                                    $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                        return cambiar.replace('✘', '✔');
                                    });
                                    // $("#Etapa").css("background-color", "#66D654")
                                    databaseHandler.db.transaction(
                                        function (tx) {
                                            tx.executeSql(
                                                "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                                [id_cedula, 1, value],
                                                function (tx, results) {
                                                    let length = results.rows.length;
                                                    if (length > 0) {
                                                        for (var i = 0; i < length; i++) {
                                                            var item = results.rows.item(i);
                                                            $("#tabla_ciclo_charola tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                            $("#message-nr").hide();
                                                        }
                                                    } else {
                                                        $("#message-nr").show();
                                                    }

                                                },
                                                function (tx, error) {
                                                    console.log("Error al guardar registroPL: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function (error) { },
                                        function () { }
                                    );
                                }
                            } else {
                                $("#RespMD").val("");
                                $("#areaOportunidad").val("")
                                $("#Comentarios").val("")
                                $("#EscalaR").val("")
                                $("#imagenC").val("");
                                $("#smallImage").attr('src', 'img/blank.png');
                                $("#photoIcon").attr("src", "img/camera.svg");
                                $("#message-nr").show();
                                $("#tabla_ciclo_charola tbody").empty("");
                                // $("#Etapa").css("background-color", "red");
                                $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✔', '✘');
                                });

                            }
                        },
                        function (tx, error) {
                            console.log("Error al guardar registroPL: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );



        }
    function NombrePuesto(id, value) {
        var id_cedula = localStorage.getItem("IdCedula");
        $("#tabla_FH tbody").empty("");
        if (value == 1) {
            $(Actividades).val("Usuario final y principal riesgo a convertirse en víctima en caso de no cumplirse las  sanitización y posible portador")
            $(Tipo).val("Responsable del cumplimiento de cocina")
        } else if (value == 2) {
            $(Actividades).val("Responsable del cumplimiento a protocolos de sanitización dentro toda la empresa")
            $(Tipo).val("Responsivo")
        } else if (value == 3) {
            $(Actividades).val("Responsable de condiciones de prestaciones a todo colaborador")
            $(Tipo).val("Responsivo")
        } else if (value == 4) {
            $(Actividades).val("Responsable del cumplimiento de cocina")
            $(Tipo).val("Responsivo")
        } else if (value == 5) {
            $(Actividades).val("Responsable del cumplimiento protocolos de sanitización dentro del área de cocina");
            $(Tipo).val("Responsivo");
        } else if (value == 6 || value == 7 || value == 8 || value == 9) {
            $(Actividades).val("Responsable de la Correcta Operación/ Manipulación o Actividades directas  para el cumplimiento de la sanitización")
            $(Tipo).val(" Manipulación Directa Riesgo Crítico");
        } else if (value == 10) {
            $(Actividades).val("Responsable de la Correcta Operación/ Manipulación o Actividades directas  para el cumplimiento de la sanitización")
            $(Tipo).val(" Manipulación Eventual");
        } else if (value == 11) {
            $(Actividades).val(" ");
            $(Tipo).val(" ");
            $(Actividades).prop("disabled", false);
            $(Tipo).prop("disabled", false);


        }

        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select*from Factor_Humano WHERE FH_ID_Cedula = ? and FH_Puesto = ? ",
                    [id_cedula, value],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#ObservacionFH").val(item.FH_Observacion);
                                $("input[name=pregunta3][value=" + item.FH_Manuales + "]").prop("checked", true);
                                var cap = item.FH_Capacitacion;
                                var cap2 = cap.slice(0, -1);
                                var arrayCapacitacion = [];
                                arrayCapacitacion = cap2.split(",");
                                for (var j = 0; j < arrayCapacitacion.length; j++) {
                                    $("input[name=pregunta1][value=" + arrayCapacitacion[j] + "]").prop("checked", true);
                                }
                                var cer = item.FH_Certificacion;
                                var cer2 = cer.slice(0, -1);
                                var arrayCertificacion = [];
                                arrayCertificacion = cer2.split(",");
                                for (var k = 0; k < arrayCertificacion; k++) {
                                    $("input[name=pregunta2][value=" + arrayCertificacion[k] + "]").prop("checked", true);
                                }
                                $('select[name="Puesto"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                            [id_cedula, 2, value],
                                            function (tx, results) {
                                                let length = results.rows.length;
                                                if (length > 0) {
                                                    for (var i = 0; i < length; i++) {
                                                        var item = results.rows.item(i);
                                                        $("#tabla_FH tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                        $("#message-nr").hide();
                                                    }
                                                } else {
                                                    $("#message-nr").show();
                                                }
                                            }
                                        );
                                    }
                                );

                            }
                        } else {
                            $("#ObservacionFH").val("");
                            $("input[name=pregunta1]").prop("checked", false);
                            $("input[name=pregunta2]").prop("checked", false);
                            $("input[name=pregunta3]").prop("checked", false);
                            $("#tabla_FH tbody").empty("");
                            $("#imagenC").val("");
                            $("#smallImage").attr('src', 'img/blank.png');
                            $("#photoIcon").attr("src", "img/camera.svg");
                            $("#message-nr").show();
                            $('select[name="Puesto"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });

                        }
                    },
                );
            }
        );


    }
    function EquipoActual(id, value) {
        var id_cedula = localStorage.getItem("IdCedula");
        if (value == 9 || value == 11 || value == 12 || value == 13 || value == 15 || value == 16) {
            $(Boiler).hide();
            $(booster).hide();
            $(Lavaloza).hide();
            $('#SI1').show();
            $('#NO1').show();
            $('#Res1-11').show();
            $('#Res2-11').show();
            $('#SI2').show();
            $('#NO2').show();
            $('#Res1-12').show();
            $('#Res2-12').show();
            $('#SI3').show();
            $('#NO3').show();
            $('#Res1-13').show();
            $('#Res2-13').show();
            // $('pregunta1').css("display", "none");

        } else {
            $(Boiler).show();
            $(booster).show();
            $(Lavaloza).show();
            $('#SI1').hide();
            $('#NO1').hide();
            $('#Res1-11').hide();
            $('#Res2-11').hide();
            $('#SI2').hide();
            $('#NO2').hide();
            $('#Res1-12').hide();
            $('#Res2-12').hide();
            $('#SI3').hide();
            $('#NO3').hide();
            $('#Res1-13').hide();
            $('#Res2-13').hide();
            //$('pregunta1').css("display", "block");
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from Tipo_Sistema WHERE TS_ID_Cedula = ? and TS_Equipo =?",
                    [id_cedula, value],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                if (item.TS_Boiler == 1 || item.TS_Boiler == 2) {
                                    $("input[name=pregunta1][value=" + item.TS_Boiler + "]").prop("checked", true);
                                } else {
                                    $("#Boiler").val(item.TS_Boiler);
                                }
                                if (item.TS_Booster == 1 || item.TS_Booster == 2) {
                                    $("input[name=pregunta2][value=" + item.TS_Booster + "]").prop("checked", true);
                                } else {
                                    $("#booster").val(item.TS_Booster);
                                }
                                if (item.TS_Maquina === 1 || item.TS_Maquina === 2) {
                                    $("input[name=pregunta3][value=" + item.TS_Maquina + "]").prop("checked", true);
                                } else {
                                    $("#Lavaloza").val(item.TS_Maquina)
                                }
                                $("#Observaciones").val(item.TS_Observacion)
                                $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                                // $("#Etapa").css("background-color", "#66D654")
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                            [id_cedula, 3, value],
                                            function (tx, results) {
                                                let length = results.rows.length;
                                                if (length > 0) {
                                                    for (var i = 0; i < length; i++) {
                                                        var item = results.rows.item(i);
                                                        $("#tabla_TSS tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                        $("#message-nr").hide();
                                                    }
                                                } else {
                                                    $("#message-nr").show();
                                                }

                                            },
                                            function (tx, error) {
                                                console.log("Error al guardar registroPL: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function (error) { },
                                    function () { }
                                );
                            }
                        } else {
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $("#Boiler").val("");
                            $("input[name=pregunta2][value=1]").prop("checked", false);
                            $("input[name=pregunta2][value=2]").prop("checked", false);
                            $("#booster").val("");
                            $("input[name=pregunta3][value=1]").prop("checked", false);
                            $("input[name=pregunta3][value=2]").prop("checked", false);
                            $("#Lavaloza").val("");
                            $("#Observaciones").val("")
                            $("#imagenC").val("");
                            $("#smallImage").attr('src', 'img/blank.png');
                            $("#photoIcon").attr("src", "img/camera.svg");
                            $("#message-nr").show();
                            $("#tabla_TSS tbody").empty("");
                            $("#Boiler").css("background-color", "#FFFFFF");
                            $("#Lavaloza").css("background-color", "#FFFFFF");
                            $("#Observaciones").css("background-color", "#FFFFFF");
                            $("#booster").css("background-color", "#FFFFFF");
                            // $("#Etapa").css("background-color", "red");
                            $('select[name="Etapa"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });

                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { console.log("Error al guardar registroPL: " + error.message); },
            function () { }
        );
    }
    function fromPL10(id, value) {
        if (value == 1 || value == 2) {
            $(suciedad).hide();
            $(detergente).hide();
            $('#SI1').show();
            $('#NO1').show();
            $('#Res1-11').show();
            $('#Res2-11').show();
            $('#SI2').show();
            $('#NO2').show();
            $('#Res1-12').show();
            $('#Res2-12').show();
        } else {
            $(suciedad).show();
            $(detergente).show();
            $('#SI1').hide();
            $('#NO1').hide();
            $('#Res1-11').hide();
            $('#Res2-11').hide();
            $('#SI2').hide();
            $('#NO2').hide();
            $('#Res1-12').hide();
            $('#Res2-12').hide();
            // $(pregunta).css("display", "none");
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "select * from Resultado WHERE ID_Cedula = ? and Tipo = ?",
                    [id_cedula, value],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                if (item.Suciedad == 1 || item.Suciedad == 2) {
                                    $("input[name=pregunta1][value=" + item.Suciedad + "]").prop("checked", true);
                                } else {
                                    $("#suciedad").val(item.Suciedad);
                                }
                                if (item.Detergente == 1 || item.Detergente == 2) {
                                    $("input[name=pregunta2][value=" + item.Detergente + "]").prop("checked", true);
                                } else {
                                    $("#detergente").val(item.Detergente);
                                }

                                $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                            }
                        } else {
                            $("#suciedad").val("");
                            $("#detergente").val("");
                            $("#suciedad").css("background-color", "#FFFFFF");
                            $("#detergente").css("background-color", "#FFFFFF");
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $("input[name=pregunta2][value=1]").prop("checked", false);
                            $("input[name=pregunta2][value=2]").prop("checked", false);
                            $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );

    }
    var i = 0;
    function saveTempFoto(valor) {
        i++;
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if($('#imagenC').val()){
        if(valor == 1 || valor == 2){
            if ($('select[name="Etapa"] option:selected ').html().includes("✘")) {
                var text = $('select[name="Etapa"] option:selected ').html().split("✘")
            } else {
                var text = $('select[name="Etapa"] option:selected ').html().split("✔")
            }
            $("#tabla_ciclo_charola tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }else if(valor == 3){
            if ($('select[name="Puesto"] option:selected ').html().includes("✘")) {
                var text = $('select[name="Puesto"] option:selected ').html().split("✘")
            } else {
                var text = $('select[name="Puesto"] option:selected ').html().split("✔")
            }
            $("#tabla_FH tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }else if(valor == 6){
            if ($('select[name="Equipo"] option:selected ').html().includes("✘")) {
                var text = $('select[name="Equipo"] option:selected ').html().split("✘")
            } else {
                var text = $('select[name="Equipo"] option:selected ').html().split("✔")
            }
            $("#tabla_TSS tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }else if(valor == 8){
            if ($('select[name="Tomas"] option:selected ').html().includes("✘")) {
                var text = $('select[name="Tomas"] option:selected ').html().split("✘")
            } else {
                var text = $('select[name="Tomas"] option:selected ').html().split("✔")
            }
            $("#tabla_Rango tbody").append("<tr id='fila" + i + "'><td><a href='#' onclick='eliminarFila(" + i + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></><td><img src='" + $('#imagenC').val() + "' width='60px'/></td><td style='text-align: center;'>" + text[1] + "</td><td style='text-align: center;'>" + fecha_registro + "</td></tr>");
            $("#message-nr").css("display", "none");
        }
    }
    }
    function guardarFHPL() {
        app.preloader.show('blue');
        let capacitacion = "";
        $("input:checkbox[name=pregunta1]:checked").each(function () {
            capacitacion += this.value + ',';
        });
        var certificacion = "";
        $("input:checkbox[name=pregunta2]:checked").each(function () {
            certificacion += this.value + ',';
        });
        var manuales = $('input:radio[name=pregunta3]:checked').val();
        var observacion = $("#ObservacionFH").val();
        if (observacion == "" || capacitacion == "" || certificacion == "" || manuales == undefined) {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var puesto = $("#Puesto").val();
        $('select[name="Puesto"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('✘', '✔');
        });
        var jq = $('select[name="Puesto"] option:selected').text();
        var foto = $("#imagenC").val();
        var recorrido = 2;
        var titulo = "" + jq;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (foto) {
            productHandler.PLFotos(id_cedula, recorrido, puesto, titulo, fecha_foto, foto);
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Factor_Humano WHERE FH_ID_Cedula = ? and FH_Puesto = ? ",
                    [id_cedula, puesto],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Factor_Humano(FH_ID_Cedula,FH_Puesto , FH_Capacitacion, FH_Certificacion, FH_Observacion , FH_Manuales) values(?,?,?,?,?,?)",
                                [id_cedula, puesto, capacitacion, certificacion, observacion, manuales],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Factor_Humano: " + error.message);
                                }
                            );

                        } else {
                            tx.executeSql("UPDATE Factor_Humano SET FH_Capacitacion = ?, FH_Certificacion = ?, FH_Observacion = ? ,FH_Manuales = ? WHERE FH_ID_Cedula = ? and FH_Puesto = ?  ",
                                [capacitacion, certificacion, observacion, manuales, id_cedula, puesto],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Factor_Humano: " + error.message);
                                }
                            );
                        }
                        $("#RespMD").css("background-color", "#FFFFFF");
                        $("#EscalaR").css("background-color", "#FFFFFF");
                        $("#areaOportunidad").css("background-color", "#FFFFFF");
                        $("#Comentarios").css("background-color", "#FFFFFF");
                        $("#IdCedula").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarIEPL() {
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var modelo = $("#Modelo").val();
        var NS = $("#NS").val();
        var Ubicacion = $("#Ubicacion").val();
        var Fecha = $("#Fecha").val();
        let Uso = "";
        $("input:checkbox[name=pregunta1]:checked").each(function () {
            Uso += this.value + ',';
        });
        var Consumo = $("#Consumo").val();
        var Agua = $("#Agua").val();
        var Suminstro = $("#Suministro").val();
        if (Uso == "" || modelo == "" || NS == "" || Ubicacion == "" || Fecha == "" || Consumo == "" || Agua == "" || Suminstro == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Info_Equipo WHERE IE_ID_Cedula = ?  ",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Info_Equipo(IE_ID_Cedula,IE_Modelo , IE_NS , IE_Ubicacion , IE_Fecha ,IE_Uso,IE_Consumo ,IE_Agua, IE_Suministro) values(?,?,?,?,?,?,?,?,?)",
                                [id_cedula, modelo, NS, Ubicacion, Fecha, Uso, Consumo, Agua, Suminstro],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Info_Equipo: " + error.message);
                                }
                            );

                        } else {
                            tx.executeSql("UPDATE Info_Equipo SET IE_Modelo = ?, IE_NS = ?, IE_Ubicacion = ? ,IE_Fecha = ? ,IE_Uso = ? ,IE_Consumo =?, IE_Agua = ? , IE_Suministro = ? WHERE IE_ID_Cedula = ? ",
                                [modelo, NS, Ubicacion, Fecha, Uso, Consumo, Agua, Suminstro, id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Factor_Humano: " + error.message);
                                }
                            );
                        }
                        $("#Modelo").css("background-color", "#FFFFFF");
                        $("#NS").css("background-color", "#FFFFFF");
                        $("#Ubicacion").css("background-color", "#FFFFFF");
                        $("#Fecha").css("background-color", "#FFFFFF");
                        $("#Consumo").css("background-color", "#FFFFFF");
                        $("#Agua").css("background-color", "#FFFFFF");
                        $("#Suministro").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarCEPL(Fase) {
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        if (Fase == 1) {
            var CA = $("#CantidadA").val();
            var Ho = $("#Horario").val();
            if (CA == "" || Ho == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var Turno = $("#Turno").val();
            $('select[name="Turno"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('✘', '✔');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Capa_Equipo_A WHERE CE_ID_Cedula = ? and CE_Turno =?",
                        [id_cedula, Turno],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Capa_Equipo_A(CE_ID_Cedula ,CE_Turno , CE_Horario, CE_Cantidad) values(?,?,?,?)",
                                    [id_cedula, Turno, Ho, CA],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_A: " + error.message);
                                    }
                                );

                            } else {
                                tx.executeSql("UPDATE Capa_Equipo_A SET  CE_Horario = ?, CE_Cantidad = ?  WHERE CE_ID_Cedula = ? and CE_Turno =?",
                                    [Ho, CA, id_cedula, Turno],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_A: " + error.message);
                                    }
                                );
                            }
                            $("#Horario").css("background-color", "#FFFFFF");
                            $("#CantidadA").css("background-color", "#FFFFFF");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );

        } else if (Fase == 2) {
            var CA = $("#CantidadB").val();
            var Tipo = $("#Tipo").val();
            var Material = $("#Material").val();
            var Notas = $("#Notas").val();
            var Loz = $("#Lava").val();
            if (CA == "" || Tipo == "" || Material == "" || Notas == "" || Loz == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            var Utencilio = $("#Utencilio").val();
            $('select[name="Utencilio"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('✘', '✔');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Capa_Equipo_B WHERE CE_ID_Cedula = ? and CE_Utencilio =?",
                        [id_cedula, Turno],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Capa_Equipo_B(CE_ID_Cedula, CE_Utencilio , CE_Cantidad, CE_Tipo, CE_Material ) values(?,?,?,?,?)",
                                    [id_cedula, Utencilio, CA, Tipo, Material],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_B: " + error.message);
                                    }
                                );

                            } else {
                                tx.executeSql("UPDATE Capa_Equipo_A SET  CE_Cantidad = ?, CE_Tipo = ? , CE_Material = ? WHERE CE_ID_Cedula = ? and CE_Utencilio =?",
                                    [CA, Tipo, Material, id_cedula, Utencilio],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Capa_Equipo_A: " + error.message);
                                    }
                                );
                            }
                            tx.executeSql("UPDATE DG_PlatoL SET  DG_CE_Notas = ?, DG_CE_Lavaloza = ? where DG_ID_Cedula = ?",
                                [Notas, Loz, id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    // swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar DG_PlatoL: " + error.message);
                                }
                            );
                            $("#CantidadB").css("background-color", "#FFFFFF");
                            $("#Material").css("background-color", "#FFFFFF");
                            $("#Tipo").css("background-color", "#FFFFFF");
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );

        }
    }
    function CETurno(id, value) {
        var Turno = value;
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from  Capa_Equipo_A WHERE CE_ID_Cedula = ? and CE_Turno =?",
                    [id_cedula, Turno],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#CantidadA").val(item.CE_Cantidad);
                                $("#Horario").val(item.CE_Horario);
                                $('select[name="Turno"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                            }
                        } else {
                            $("#CantidadA").val("");
                            $("#Horario").val("");
                            $('select[name="Turno"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );

    }
    function CEUtencilio(id, value) {
        var Uten = value;
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from  Capa_Equipo_B WHERE CE_ID_Cedula = ? and CE_Utencilio =?",
                    [id_cedula, Uten],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#CantidadB").val(item.CE_Cantidad);
                                $("#Tipo").val(item.CE_Tipo);
                                $("#Material").val(item.CE_Material);
                                $('select[name="Utencilio"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                            }
                        } else {
                            $("#CantidadB").val("");
                            $("#Tipo").val("");
                            $("#Material").val("");
                            $('select[name="Utencilio"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarTSSPL() {
        app.preloader.show('blue');
        var Boiler = $("#Boiler").val();
        var Boiler2 = $("input:radio[name=pregunta1]:checked").val();
        var Boiler3;
        if (Boiler) {
            Boiler3 = Boiler;
        } else {
            Boiler3 = Boiler2;
        }
        var booster = $("#booster").val();
        var booster2 = $("input:radio[name=pregunta2]:checked").val();
        var booster3;
        if (booster) {
            booster3 = booster;
        } else {
            booster3 = booster2;
        }
        var Lavaloza = $("#Lavaloza").val();
        var Lavaloza2 = $("input:radio[name=pregunta3]:checked").val();
        var Lavaloza3;
        if (Lavaloza) {
            Lavaloza3 = Lavaloza;
        } else {
            Lavaloza3 = Lavaloza2;
        }
        var observacion = $("#Observaciones").val();
        if (observacion == "" || Lavaloza3 == "" || booster3 == "" || Boiler3 == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var Equipo = $("#Equipo").val();
        $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('✘', '✔');
        });
        var jq = $('select[name="Equipo"] option:selected').text();
        var foto = $("#imagenC").val();
        var recorrido = 3;
        var titulo = "" + jq;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (foto) {
            productHandler.PLFotos(id_cedula, recorrido, Equipo, titulo, fecha_foto, foto);
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Tipo_Sistema WHERE TS_ID_Cedula = ? and TS_Equipo =?",
                    [id_cedula, Equipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Tipo_Sistema(TS_ID_Cedula,TS_Equipo ,TS_Boiler  , TS_Booster , TS_Maquina , TS_Observacion ) values(?,?,?,?,?,?)",
                                [id_cedula, Equipo, Boiler3, booster3, Lavaloza3, observacion],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Ciclo_Charola: " + error.message);
                                }
                            );

                        } else {
                            tx.executeSql("UPDATE Tipo_Sistema SET TS_Equipo = ?, TS_Boiler = ?, TS_Booster = ? ,TS_Maquina = ? , TS_Observacion = ? WHERE TS_ID_Cedula = ? and TS_Equipo =?  ",
                                [Boiler3, booster3, Lavaloza3, observacion, id_cedula, Equipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    $("#imagenC").val("");
                                    $("#smallImage").attr('src', 'img/blank.png');
                                    $("#photoIcon").attr("src", "img/camera.svg");
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Ciclo_Charola: " + error.message);
                                }
                            );
                        }
                        $("#RespMD").css("background-color", "#FFFFFF");
                        $("#EscalaR").css("background-color", "#FFFFFF");
                        $("#areaOportunidad").css("background-color", "#FFFFFF");
                        $("#Comentarios").css("background-color", "#FFFFFF");
                        $("#IdCedula").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarPCAPL() {
        var Tipo = $('#Tipo').val();
        var Dureza = $('#Dureza').val();
        var Partes = $('#Partes').val();
        var Pregunta1 = $('input:radio[name=pregunta1]:checked').val();
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        if (Dureza == "" || Tipo == "" || Partes == "" || Pregunta1 == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('✘', '✔');
        });

        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ? and  PCA_Tipo =? ",
                    [id_cedula, Tipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Prueba_Calidad_Agua(PCA_ID_Cedula,PCA_Tipo,PCA_Dureza , PCA_Partes ,PCA_Sitema ) values(?,?,?,?,?)",
                                [id_cedula, Tipo, Dureza, Partes, Pregunta1],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Info_Equipo: " + error.message);
                                }
                            );

                        } else {
                            tx.executeSql("UPDATE Prueba_Calidad_Agua  SET  PCA_Dureza = ? ,PCA_Partes = ? ,PCA_Sitema = ? WHERE PCA_ID_Cedula = ? and  PCA_Tipo =?",
                                [Dureza, Partes, Pregunta1, id_cedula, Tipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Prueba_Calidad_Agua: " + error.message);
                                }
                            );
                        }

                        $("#Tipo").css("background-color", "#FFFFFF");
                        $("#Dureza").css("background-color", "#FFFFFF");
                        $("#Partes").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );

    }
    function checkTipo(val) {
        var id_cedula = localStorage.getItem("IdCedula");
        var tipo = $("#Tipo").val();
        var Dureza = $("#Dureza").val();
        var Partes = $("#Partes").val();
        var Pregunta1 = $("input:radio[name=pregunta1]:checked").val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "select *from Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ? and  PCA_Tipo =? ",
                    [id_cedula, val],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);

                                $("#Dureza").val(item.PCA_Dureza);
                                $("#Partes").val(item.PCA_Partes);
                                $("input[name=pregunta1][value=" + item.PCA_Sitema + "]").prop("checked", true);
                                $('select[name="T ipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                            }
                        } else {
                            $("#Dureza").val("");
                            $("#Partes").val("");
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarInsumo(fase) {
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        if (fase == 1) {
            var Equipo = $("#Equipo").val();
            var Marca = $("#Marca1").val();
            var Modelo = $("#Modelo1").val();
            var Dosificacion = $("#Dosificacion").val();
            if (Equipo == "" || Marca == "" || Modelo == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('✘', '✔');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Insumos_A WHERE ID_Cedula = ? and Equipo = ?  ",
                        [id_cedula, Equipo],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Insumos_A(ID_Cedula,Equipo, Marca, Modelo, Dosificador ) values(?,?,?,?,?)",
                                    [id_cedula, Equipo, Marca, Modelo, Dosificacion],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_A: " + error.message);
                                    }
                                );
                            } else {
                                tx.executeSql("UPDATE Insumos_A  SET Equipo = ?, Marca = ? ,Modelo = ?  Dosificador = ? WHERE ID_Cedula = ? and Equipo = ? ",
                                    [Equipo, Marca, Modelo, Dosificacion, id_cedula, Equipo],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_A: " + error.message);
                                    }
                                );
                            }
                            $("#Dosificacion").css("background-color", "#FFFFFF");
                            $("#Modelo1").css("background-color", "#FFFFFF");
                            $("#Marca1").css("background-color", "#FFFFFF");
                            // $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                            //     return cambiar.replace('✔' , '✘');
                            // });
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        } else if (fase == 2) {
            var Pregunta1 = $('input:radio[name=pregunta1]:checked').val();
            var Marca = $("#Marca").val();
            var Modelo = $("#Modelo").val();
            if (Pregunta1 == 1) {
                if (Marca == "" || Modelo == "") {
                    swal("", "Debes llenar todos los campos", "warning");
                    app.preloader.hide();
                    return false;
                }
            }
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Insumos_B WHERE ID_Cedula = ?  ",
                        [id_cedula],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Insumos_B(ID_Cedula, Dosificador, Marca, Modelo ) values(?,?,?,?)",
                                    [id_cedula, Pregunta1, Marca, Modelo],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_B: " + error.message);
                                    }
                                );

                            } else {
                                tx.executeSql("UPDATE Insumos_B  SET Dosificador = ?, Marca = ? ,Modelo = ?  WHERE ID_Cedula = ? ",
                                    [Pregunta1, Marca, Modelo, id_cedula],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_A: " + error.message);
                                    }
                                );
                            }

                            $("#Modelo").css("background-color", "#FFFFFF");
                            $("#Marca").css("background-color", "#FFFFFF");

                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        } else if (fase == 3) {
            var Horas = $("#Horas").val();
            var Cantidad = $("#Horario").val();
            if (Cantidad == "") {
                swal("", "Debes llenar todos los campos", "warning");
                app.preloader.hide();
                return false;
            }
            $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                return cambiar.replace('✘', '✔');
            });
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("select count(*) as Cuenta from Insumos_C WHERE ID_Cedula = ? and Horas = ?",
                        [id_cedula, Horas],
                        function (tx, results) {
                            var item = results.rows.item(0);
                            if (item.Cuenta == 0) {
                                tx.executeSql("insert into Insumos_C(ID_Cedula,Horas, Cantidad ) values(?,?,?)",
                                    [id_cedula, Horas, Cantidad],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se guardaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_C: " + error.message);
                                    }
                                );
                            } else {
                                tx.executeSql("UPDATE Insumos_C  SET Horas = ?, Cantidad = ? WHERE ID_Cedula = ? and Horas = ? ",
                                    [Horas, Cantidad, id_cedula, Horas],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        swal("", "Se actualizaron los datos correctamente", "success");
                                    },
                                    function (tx, error) {
                                        console.error("Error al registrar Insumos_C: " + error.message);
                                    }
                                );
                            }
                            $("#Horario").css("background-color", "#FFFFFF");
                            // $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                            //     return cambiar.replace('✔' , '✘');
                            // });
                            app.preloader.hide();
                        },
                        function (tx, error) {
                            swal("Error al guardar", error.message, "error");
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }
    }
    function DosificadorRES(RS) {
        if (RS == 1) {
            $('#Marca').show();
            $('#Modelo').show();
            $('#MarcaL').show();
            $('#ModeloL').show();
            $('#Boton').show();
        } else {
            $('#Boton').show();
            $('#Marca').hide();
            $('#Modelo').hide();
            $('#MarcaL').hide();
            $('#ModeloL').hide();
        }
    }
    function check(fase, value) {
        var id_cedula = localStorage.getItem("IdCedula");
        if (fase == 1) {
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql(
                        "Select * from  Insumos_A WHERE ID_Cedula = ? and  Equipo = ?",
                        [id_cedula, value],
                        function (tx, results) {
                            let length = results.rows.length;
                            if (length > 0) {
                                for (var i = 0; i < length; i++) {
                                    var item = results.rows.item(i);
                                    $("#Marca1").val(item.Marca);
                                    $("#Modelo1").val(item.Modelo);
                                    $("#Dosificacion").val(item.Dosificador);
                                    $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                        return cambiar.replace('✘', '✔');
                                    });
                                }
                            } else {
                                $("#Marca1").val("");
                                $("#Modelo1").val("");
                                $("#Dosificacion").val("");
                                $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✔', '✘');
                                });
                            }
                        },
                        function (tx, error) {
                            console.log("Error al guardar registroPL: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        } else if (fase == 2) {
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql(
                        "Select * from  Insumos_C WHERE ID_Cedula = ? and Horas =?",
                        [id_cedula, value],
                        function (tx, results) {
                            let length = results.rows.length;
                            if (length > 0) {
                                for (var i = 0; i < length; i++) {
                                    var item = results.rows.item(i);
                                    $("#Horas").val(item.Horas);
                                    $("#Horario").val(item.Cantidad);
                                    $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                                        return cambiar.replace('✘', '✔');
                                    });
                                }
                            } else {
                                $("#Horario").val("");
                                $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✔', '✘');
                                });
                            }
                        },
                        function (tx, error) {
                            console.log("Error al guardar registroPL: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function (error) { },
                function () { }
            );
        }

    }
    function guardarRangosPL() {
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        var Tomas = $("#Tomas").val();
        var Equipo = $("#Equipo").val();
        var TempE = $("#TemperaturaE").val();
        var PreE = $("#PresionE").val();
        var TempS = $("#TemperaturaS").val();
        var PreS = $("#PresionS").val();;
        var Pregunta3 = $("input:radio[name=pregunta1]:checked").val();
        var Hora = $("#Hora").val();;
        if (TempE == "" || TempS == "" || PreE == "" || PreS == "" || Hora == "" || Pregunta3 == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        $('select[name="Tomas"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('✘', '✔');
        });
        $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('✘', '✔');
        });
        var jq = $('select[name="Equipo"] option:selected').text();
        var foto = $("#imagenC").val();
        var recorrido = 3;
        var proceso = "" + Tomas + "" + Equipo;
        var titulo = "" + jq;
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if (foto) {
            productHandler.PLFotos(id_cedula, recorrido, proceso, titulo, fecha_foto, foto);
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Stress WHERE ID_Cedula = ? and Tomas = ? and Equipo = ?",
                    [id_cedula, Tomas, Equipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Stress(ID_Cedula ,Tomas , Equipo , Hora , TempeE , PreE , TempeS , PreS, Bitacora ) values(?,?,?,?,?,?,?,?,?)",
                                [id_cedula, Tomas, Equipo, Hora, TempE, PreE, TempE, PreS, Pregunta3],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Insumos_C: " + error.message);
                                }
                            );

                        } else {
                            tx.executeSql("UPDATE Stress  SET Hora = ?, TempeE = ? , PreE = ?, TempeS = ? , PreS = ?, Bitacora  = ? WHERE ID_Cedula = ? and Tomas = ? and Equipo = ?",
                                [Hora, TempE, PreE, TempE, PreS, Pregunta3, id_cedula, Tomas, Equipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Insumos_C: " + error.message);
                                }
                            );
                        }

                        $("#Horario").css("background-color", "#FFFFFF");
                        // $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                        //     return cambiar.replace('✔' , '✘');
                        // });
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function checkRangos(value) {
        $("#tabla_Rango tbody").empty("");
        var id_cedula = localStorage.getItem("IdCedula");
        var Tomas = $("#Tomas").val();
        var Equipo = $("#Equipo").val();
        var proceso = "" + Tomas + "" + Equipo;
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "select * from Stress WHERE ID_Cedula = ? and Tomas = ? and Equipo = ?",
                    [id_cedula, Tomas, Equipo],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length > 0) {
                            for (var i = 0; i < length; i++) {
                                var item = results.rows.item(i);
                                $("#TemperaturaE").val(item.TempeE);
                                $("#PresionE").val(item.PreE);
                                $("#TemperaturaS").val(item.TempeS);
                                $("#PresionS").val(item.PreS);
                                $("#Hora").val(item.Hora);
                                $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                                $('select[name="Tomas"] option:selected ').html(function (a, cambiar) {
                                    return cambiar.replace('✘', '✔');
                                });
                                $("input[name=pregunta1][value=" + item.Bitacora + "]").prop("checked", true);

                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "Select * from PL_Fotos WHERE F_ID_Cedula = ? and F_Recorrido = ? and F_Proceso = ?",
                                            [id_cedula, 3, proceso],
                                            function (tx, results) {
                                                let length = results.rows.length;
                                                if (length > 0) {
                                                    for (var i = 0; i < length; i++) {
                                                        var item = results.rows.item(i);
                                                        $("#tabla_Rango tbody").append("<tr id='fila" + item.F_ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.F_ID_Fotos + ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.F_Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.F_titulo + "</td><td style='text-align: center;'>" + item.F_FechaHora + "</td></tr>");
                                                        $("#message-nr").hide();
                                                    }
                                                } else {
                                                    $("#message-nr").show();
                                                }

                                            },
                                            function (tx, error) {
                                                console.log("Error al guardar registroPL: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function (error) { },
                                    function () { }
                                );
                            }
                        } else {
                            $("#TemperaturaE").val("");
                            $("#PresionE").val("");
                            $("#TemperaturaS").val("");
                            $("#PresionS").val("");
                            $("#Hora").val("");
                            $("#smallImage").attr('src', 'img/blank.png');
                            $("#photoIcon").attr("src", "img/camera.svg");
                            $("#message-nr").show();
                            $("#tabla_Rango tbody").empty("");
                            $("input[name=pregunta1][value=1]").prop("checked", false);
                            $("input[name=pregunta1][value=2]").prop("checked", false);
                            $('select[name="Equipo"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });
                            $('select[name="Tomas"] option:selected ').html(function (a, cambiar) {
                                return cambiar.replace('✔', '✘');
                            });
                        }
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarResLaPL() {
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        var Tipo = $("#Tipo").val();
        var Pregunta1 = $('input:radio[name=pregunta1]:checked').val();
        var Pregunta2 = $('input:radio[name=pregunta2]:checked').val();
        var Detergente = $("#detergente").val();
        var Suciedad = $("#suciedad").val();
        var DET, SUC;
        if (Pregunta2 == 1 || Pregunta2 == 2) {
            DET = Pregunta2;
        } else {
            DET = Detergente;
        }
        if (Pregunta1 == 1 || Pregunta1 == 2) {
            SUC = Pregunta1;
        } else {
            SUC = Suciedad;
        }
        if (SUC == "" || DET == "") {
            swal("", "Debes llenar todos los campos", "warning");
            app.preloader.hide();
            return false;
        }
        $('select[name="Tipo"] option:selected ').html(function (a, cambiar) {
            return cambiar.replace('✘', '✔');
        });
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from Resultado WHERE ID_Cedula = ? and Tipo = ?",
                    [id_cedula, Tipo],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into Resultado(ID_Cedula ,Tipo,Suciedad , Detergente  ) values(?,?,?,?)",
                                [id_cedula, Tipo, SUC, DET],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );

                        } else {
                            tx.executeSql("UPDATE Resultado  SET  Suciedad = ?, Detergente  = ? WHERE ID_Cedula = ? and Tipo = ? ",
                                [Pregunta1, Pregunta2, id_cedula, Tipo],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
                        }

                        $("#Horario").css("background-color", "#FFFFFF");
                        // $('select[name="Horas"] option:selected ').html(function (a, cambiar) {
                        //     return cambiar.replace('✔' , '✘');
                        // });
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarCierrePL() {
        if ($("#comentario_cliente").val() == "" || $("#signate").val() == "") {
            swal("", "Todos los campos son obligatorios", "warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var Comentario = $("#comentario_cliente").val();
        var calificacion = $("#eval").val();
        var fecha = new Date();
        var fecha_firma =
            fecha.getFullYear() +
            "-" +
            (fecha.getMonth() + 1) +
            "-" +
            fecha.getDate() +
            " " +
            fecha.getHours() +
            ":" +
            fecha.getMinutes() +
            ":" +
            fecha.getSeconds();
        var recorrido = 0;
        var proceso = 0;
        var titulo2 = "firma_cliente"
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE DG_PlatoL SET Nombre_R = ?,Comentarios_Cierre = ? WHERE DG_ID_Cedula = ?",
                    [nombrefirma, Comentario, id_cedula],
                    function (tx, results) {
                        productHandler.PLFotos(id_cedula, recorrido, proceso, titulo2,  fecha_firma, firmaCliente);
                        databaseHandler.db.transaction(
                            function (tx) {
                                tx.executeSql(
                                    "UPDATE cedulas_general SET nombre_evalua = ?, horario_programado = ?, calificacion = ? WHERE id_cedula = ?",
                                    [nombrefirma, fecha_firma, calificacion, id_cedula],
                                    function (tx, results) {
                                        swal("", "Guardado correctamente", "success");
                                        app.views.main.router.back("/yamevoyPL/", {
                                            force: true,
                                            ignoreCache: true,
                                            reload: true,
                                        });
                                    },
                                    function (tx, error) {
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function (error) { },
                            function () { }
                        );
                    },
                    function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function terminarPL() {
        var FirmaTec = $("#signate").val();
        var fotoSalida = $("#ImaCe").val();
        console.log("fotoSalida", fotoSalida);
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida =
            fecha.getFullYear() +
            "-" +
            (fecha.getMonth() + 1) +
            "-" +
            fecha.getDate() +
            " " +
            fecha.getHours() +
            ":" +
            fecha.getMinutes() +
            ":" +
            fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        var titulo = "Firma Tecnico"
        var titulo2 = "Foto Salida"
        var recorrido = 0;
        var proceso = 0;
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida, ubicacion_salida, estatus, id_cedula],
                    function (tx, results) {
                        productHandler.PLFotos(id_cedula, recorrido, proceso, titulo, fecha_salida,  FirmaTec);
                        productHandler.PLFotos(id_cedula, recorrido, proceso, titulo2, fecha_salida,  fotoSalida);
                        window.location.href = "./menu.html";
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                    }
                );
            },
            function (error) {
                console.log("Error al guardar", error.message, "error");
            },
            function () { }
        )
    }
    function TerminarRecorridoPL(Recorrido) {
        let id_cedula = localStorage.getItem("IdCedula");
        var CC = 0;
        var FH = 0;
        var SN = 0;
        if (Recorrido == 1) {
            CC = 1
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET CC = ? WHERE DG_ID_Cedula = ?",
                        [CC, id_cedula],
                        function (tx, results) {
                            DireccionarPL();
                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) {
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                },
                function () { }
            );
        } else if (Recorrido == 2) {
            FH = 1;
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET  FH = ? WHERE DG_ID_Cedula = ?",
                        [FH, id_cedula],
                        function (tx, results) {
                            DireccionarPL();

                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) {
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                },
                function () { }
            );
        } else if (Recorrido == 3) {
            SN = 1;
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("UPDATE DG_PlatoL SET  SN = ? WHERE DG_ID_Cedula = ?",
                        [SN, id_cedula],
                        function (tx, results) {
                            DireccionarPL();

                        },
                        function (tx, error) {
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function (error) {
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                },
                function () { }
            );
        }
    }
    function DireccionarPL() {
        let id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(i);
                        if (item.CC == 1 && item.FH == 1 && item.SN == 1) {
                            swal({
                                title: "Aviso",
                                text: "¿Quieres Finalizar la cedula?",
                                icon: "warning",
                                buttons: true,
                                dangerMode: true,
                            })
                                .then((RESP) => {
                                    if (RESP == true) {
                                        //app.views.main.router.navigate({name: 'cierrePL4'});
                                        app.views.main.router.back('/cierrePL4/', { force: true, reload: true });
                                    } else {
                                        //app.views.main.router.navigate({name: 'menuPlatoLimpio'});
                                    app.views.main.router.back('/menuPlatoLimpio/', { force: true,  reload: true });
                                    }
                                });

                        } else {
                            //app.views.main.router.navigate({name: 'menuPlatoLimpio'});
                        app.views.main.router.back('/menuPlatoLimpio/', { force: true, reload: true });
                        }

                    },
                    function (tx, error) {
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function continuarPL(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'menuPlatoLimpio'});
        }
    }
    function FactorHumano(){
        app.views.main.router.navigate({name: 'recorridoPL2'});
    }
    function SanitizacionLava(){
        app.views.main.router.navigate({name: 'recorridoPL3'});
    }
    function regeresarPLR1(){
        app.views.main.router.back('/recorridoPL1/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR2(){
        app.views.main.router.back('/recorridoPL2/', {force: true, ignoreCache: true, reload: true});
    }
    function regeresarPLR3(){
        app.views.main.router.back('/recorridoPL3/', {force: true, ignoreCache: true, reload: true});
    }
    function terminarCiclo1(){
        app.views.main.router.back('/menuPlatoLimpio/', {force: true, ignoreCache: true, reload: true});
    }
    //Fin PlatoLimpio
    //Inicio Servind
    function startFromProgramServ(id_visita,nombre_comercial,orden_servicio,sucursal,direccion,ciudad,telefono,correo,category,equip,mark,model,serie,id_cliente,fecha,description,type_equip){
        localStorage.setItem("id_visita",id_visita);
        localStorage.setItem("nombre_comercial",nombre_comercial);
        localStorage.setItem("orden_servicio",orden_servicio);
        localStorage.setItem("sucursal",sucursal);
        localStorage.setItem("direccion",direccion);
        localStorage.setItem("ciudad",ciudad);
        localStorage.setItem("telefono",telefono);
        localStorage.setItem("correo",correo);
        localStorage.setItem("category",category);
        localStorage.setItem("nombre_equipo",equip);
        localStorage.setItem("mark",mark);
        localStorage.setItem("model",model);
        localStorage.setItem("serie",serie);
        localStorage.setItem("id_cliente",id_cliente);
        localStorage.setItem("description",description);
        localStorage.setItem("type_equip",type_equip);
        localStorage.setItem("horario_programado", fecha);
        app.views.main.router.back('/yallegueServInd2/', {force: true, ignoreCache: true, reload: true});
    }
    function startFromProgramServ2(id_visita,nombre_comercial,orden_servicio,sucursal,direccion,ciudad,telefono,correo,category,equip,mark,model,serie,id_cliente,fecha,description,type_equip){
        localStorage.setItem("id_visita",id_visita);
        localStorage.setItem("nombre_comercial",nombre_comercial);
        localStorage.setItem("orden_servicio",orden_servicio);
        localStorage.setItem("sucursal",sucursal);
        localStorage.setItem("direccion",direccion);
        localStorage.setItem("ciudad",ciudad);
        localStorage.setItem("telefono",telefono);
        localStorage.setItem("correo",correo);
        localStorage.setItem("category",category);
        localStorage.setItem("nombre_equipo",equip);
        localStorage.setItem("mark",mark);
        localStorage.setItem("model",model);
        localStorage.setItem("serie",serie);
        localStorage.setItem("id_cliente",id_cliente);
        localStorage.setItem("description",description);
        localStorage.setItem("type_equip",type_equip);
        localStorage.setItem("horario_programado", fecha);
        localStorage.setItem("type_equip","");
        app.views.main.router.back('/yallegueServInd2/', {force: true, ignoreCache: true, reload: true});
    }
    function iniciarClienteServ(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = localStorage.getItem("horario_programado");
        var foto_llegada = $("#imagenC").val();
        var id_visita = localStorage.getItem("id_visita");
        var nombre_comercial = localStorage.getItem("nombre_comercial");
        var orden_servicio = localStorage.getItem("orden_servicio");
        var sucursal = localStorage.getItem("sucursal");
        var direccion = localStorage.getItem("direccion");
        var ciudad = localStorage.getItem("ciudad");
        var telefono = localStorage.getItem("telefono");
        var correo = localStorage.getItem("correo");
        var category = localStorage.getItem("category");
        var equipo = localStorage.getItem("nombre_equipo");
        var marca = localStorage.getItem("mark");
        var modelo = localStorage.getItem("model");
        var serie = localStorage.getItem("serie");
        var id_cliente = localStorage.getItem("id_cliente");
        var falla_reportada = localStorage.getItem("description");
        var type_equip = localStorage.getItem("type_equip");
        var nombre_cliente = nombre_comercial+" "+sucursal;
        if(category == "Correctivo"){
            tipoCedula = "Correctivo";
        }
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                if(tipoCedula == "Correctivo"){
                                                    let tipoCedulas = "correctivo";
                                                    localStorage.setItem("TipoVisita", tipoCedulas);
                                                    if(type_equip =='Frio'){
                                                        productHandler.addreporteFrio(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_comercial, sucursal, id_cliente,direccion, ciudad, telefono, correo, equipo, marca, modelo, serie,falla_reportada,type_equip);
                                                        app.views.main.router.navigate({name: 'recorridoServ1'});
                                                    }else if(type_equip =='Caliente'){
                                                        productHandler.addreporteFrio(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_comercial, sucursal, id_cliente,direccion, ciudad, telefono, correo, equipo, marca, modelo, serie,falla_reportada,type_equip);
                                                        app.views.main.router.navigate({name: 'recorridoServ2'});
                                                    }else if(type_equip =='Rational'){
                                                        productHandler.addreporteFrio(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_comercial, sucursal, id_cliente,direccion, ciudad, telefono, correo, equipo, marca, modelo, serie,falla_reportada,type_equip);
                                                        app.views.main.router.navigate({name: 'recorridoServ3'});
                                                    }else{
                                                        productHandler.addreporteFrio(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_comercial, sucursal, id_cliente,direccion, ciudad, telefono, correo, equipo, marca, modelo, serie,falla_reportada,type_equip);
                                                        app.views.main.router.navigate({name: 'menuservR'});
                                                    }
                                                }
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function eliminarFilaServ(index, opc){
    if(opc == 1) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM fotos_check WHERE id_foto = ?",
                    [index],
                    function(tx, results){
                        swal("","El registro se elimino satisfactoriamente","success");
                        $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if(opc == 2) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM fotos_diagnostico WHERE id_foto = ?",
                    [index],
                    function(tx, results){
                        swal("","El registro se elimino satisfactoriamente","success");
                        $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if(opc == 3) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM papeleta WHERE id_papeleta = ?",
                    [index],
                    function(tx, results){
                        swal("","El registro se elimino satisfactoriamente","success");
                        $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if(opc == 4) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM refacciones WHERE id_refaccion = ?",
                    [index],
                    function(tx, results){
                        swal("","El registro se elimino satisfactoriamente","success");
                        $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    if(opc == 5) {
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "DELETE FROM fotos_posteriores WHERE id_evidencia = ?",
                    [index],
                    function(tx, results){
                        swal("","El registro se elimino satisfactoriamente","success");
                        $("#fila" + index).remove();
                    },
                    function(tx, error){
                        swal("Error al eliminar registro",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    }
    function buscarClienteServInd(){
    var id_usuario = localStorage.getItem("id_usuario");
    var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geolocation = $("#geolocation").val();
    var id_cliente = $("#id_cliente").val();
    var horario_programado = $("#horario_programado").val();;
    var foto_llegada = $("#imagenC").val();
    var nombre_cliente = $("#nombre_comercial").val() + " " + $("#sucursal").val();
    var sucursal = $("#sucursal").val();
    var telefono = $("#telefono").val();
    var correo = $("#correo").val();
    var equipo = $("#equipo").val();
    var marca = $("#marca").val();
    var modelo = $("#modelo").val();
    var serie = $("#serie").val();
    var tipo_servicio = $("#tipo_servicio").val();
    var direccion = $("#direccion").val();
    var estatus = 0;

    // if(foto_llegada != ''){
        if(nombre_cliente != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            var item = results.rows.item(0);
                            localStorage.setItem("IdCedula", item.Id);
                            localStorage.setItem("nombreCliente", nombre_cliente);
                            localStorage.setItem("foto_llegada", foto_llegada);
                            localStorage.setItem("sucursal", sucursal);
                            localStorage.setItem("direccion", direccion);
                            localStorage.setItem("telefono", telefono);
                            localStorage.setItem("correo", correo);
                            app.views.main.router.navigate({name: 'menuServInd'});
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }/*
    } else {
        swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
        app.preloader.hide();
    }*/
    }

    function generarReporteServInd(){
        var id_cedula = localStorage.getItem("IdCedula");
        var type_equip = 'Caliente';
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET type_equipo = ? WHERE id_cedula = ?",
                    [type_equip,id_cedula],
                    function(tx, results){
                        localStorage.setItem("type_equip",type_equip);
                        app.views.main.router.navigate({name: 'recorridoServ2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function generarReporteServIndFrio(){
        var id_cedula = localStorage.getItem("IdCedula");
        var type_equip = 'Frio';
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET type_equipo = ? WHERE id_cedula = ?",
                    [type_equip,id_cedula],
                    function(tx, results){
                        localStorage.setItem("type_equip",type_equip);
                        app.views.main.router.navigate({name: 'recorridoServ1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function generarReporteServIndRational(){
        var id_cedula = localStorage.getItem("IdCedula");
        var type_equip = 'Rational';
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET type_equipo = ? WHERE id_cedula = ?",
                    [type_equip,id_cedula],
                    function(tx, results){
                        localStorage.setItem("type_equip",type_equip);
                        app.views.main.router.navigate({name: 'recorridoServ3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function continuarPapeleta(id_cedula,tipo){
    localStorage.setItem("IdCedula",id_cedula);
    if(tipo == 1){
        app.views.main.router.navigate({ name: 'papeletas'});
    }
    }
    function continuarCedServInd(id_cedula,tipo){
    localStorage.setItem("IdCedula",id_cedula);
    localStorage.setItem("Opcion", '1');
    if(tipo == 1){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select type_equipo from visita_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(item.type_equipo == 'Frio'){
                            app.views.main.router.navigate({ name: 'recorridoServ1'});
                        }else if(item.type_equipo == 'Caliente'){
                            app.views.main.router.navigate({ name: 'recorridoServ2'});
                        }else if(item.type_equipo == 'Rational'){
                            app.views.main.router.navigate({ name: 'recorridoServ3'});
                        }
                    },
                    function(tx, error){}
                );  
            }, function(error){},function(){}
        );
        let tipoCedulas = "correctivo";
        localStorage.setItem("TipoVisita", tipoCedulas);
    }
    // } else if(tipo == 2){
    //     app.views.main.router.navigate({ name: 'recorridoServ2'});
    //     let tipoCedulas = "correctivo";
    //     localStorage.setItem("TipoVisita", tipoCedulas);
    // } else if(tipo == 3){
    //     app.views.main.router.navigate({ name: 'recorridoServ3'});
    //     let tipoCedulas = "correctivo";
    //     localStorage.setItem("TipoVisita", tipoCedulas);
    // }else if(tipo == 4){
    //     app.views.main.router.navigate({ name: 'recorridoServ8'});
    //     let tipoCedulas = "PMP1Caliente";
    //     localStorage.setItem("TipoVisita", tipoCedulas);
    // }else if(tipo == 5){
    //     app.views.main.router.navigate({ name: 'recorridoServ7'});
    //     let tipoCedulas = "PMP1Frio";
    //     localStorage.setItem("TipoVisita", tipoCedulas);
    // }else if(tipo == 6){
    //     app.views.main.router.navigate({ name: 'menuServPMPSOEC'});
    //     let tipoCedulas = "PMP2";
    //     localStorage.setItem("TipoVisita", tipoCedulas);
    // }else if(tipo == 7){
    //     app.views.main.router.navigate({ name: 'recorridoServ6'});
    //     let tipoCedulas = "correctivo";
    //     localStorage.setItem("TipoVisita", tipoCedulas);
    // }else if(tipo == 8){
    //     app.views.main.router.navigate({ name: 'recorridoServ9'});
    //     let tipoCedulas = "PMP1Rational";
    //     localStorage.setItem("TipoVisita", tipoCedulas);
    // }
    }
    function checkAndSave(id,valor,parte){
    let id_cedula = localStorage.getItem("IdCedula");
    var currentId = id.split("-");
    if (parte==9){
        if(id.includes("1")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-2").prop("checked", false);
                //console.log("primerainst");//1-SI
                var correctoPMP='1';
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                valor = "0";
                var correctoPMP='3';
                //console.log("segundinst");//1-no
            }
        } else {
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                //console.log("tercer ints");//2-SI
                var correctoPMP='0';
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false){
                valor = "0";
                var correctoPMP='3';
                //console.log("cuartainst");//2-no
            }
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from diagnosticos_PMP WHERE id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO diagnosticos_PMP(id_cedula,diagnostico) VALUES (?,?)",
                                        [id_cedula, correctoPMP],
                                        function(tx, results){
                                            //console.log('Inserta');
                                            //swal("", "Datos actualizados correctamente", "success");
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE diagnosticos_PMP SET diagnostico = ? WHERE id_cedula = ?",
                                        [correctoPMP, id_cedula],
                                        function(tx, results){
                                            //console.log('update');
                                            //swal("", "Datos actualizados correctamente", "success");
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar checklits: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else if (parte == 3 || parte == 4 || parte == 10){
        if(id.includes("1")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-2").prop("checked", false);
                valor = "1";
                //console.log("primerainst");//1-SI
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                valor = "0";
                //console.log("segundinst");//1-no
            }
        } else {
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                valor = "0";
                //console.log("tercer ints");//2-No
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false){
                valor = "0";
                //console.log("cuartainst");//2-no
            }
        }
        if(parte == 3){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            if(results.rows.length == 0){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("INSERT INTO visita_servInd(id_cedula,filtro) VALUES (?,?)",
                                            [id_cedula, valor],
                                            function(tx, results){
                                                //console.log('Inserta');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE visita_servInd SET filtro = ? WHERE id_cedula = ?",
                                            [valor, id_cedula],
                                            function(tx, results){
                                                //console.log('update');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al guardar checklits: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(parte == 4){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            if(results.rows.length == 0){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("INSERT INTO visita_servInd(id_cedula,extracion) VALUES (?,?)",
                                            [id_cedula, valor],
                                            function(tx, results){
                                                //console.log('Inserta');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE visita_servInd SET extracion = ? WHERE id_cedula = ?",
                                            [valor, id_cedula],
                                            function(tx, results){
                                                //console.log('update');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al guardar checklits: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(parte == 10){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            if(results.rows.length == 0){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("INSERT INTO visita_servInd(id_cedula,nombre_comercial) VALUES (?,?)",
                                            [id_cedula, valor],
                                            function(tx, results){
                                                //console.log('Inserta');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE visita_servInd SET nombre_comercial = ? WHERE id_cedula = ?",
                                            [valor, id_cedula],
                                            function(tx, results){
                                                //console.log('update');
                                                //swal("", "Datos actualizados correctamente", "success");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al guardar checklits: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else{
        if(id.includes("1")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-2").prop("checked", false);
                $("#"+currentId[0]+"-3").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false && $("#"+currentId[0]+"-3").prop("checked") == false){
                valor = "0";
            }
        } else if(id.includes("2")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                $("#"+currentId[0]+"-3").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false && $("#"+currentId[0]+"-3").prop("checked") == false){
                valor = "0";
            }
        } else if(id.includes("3")){
            if($("#"+id).prop("checked") == true){
                $("#"+currentId[0]+"-1").prop("checked", false);
                $("#"+currentId[0]+"-2").prop("checked", false);
            }
            if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                valor = "0";
            }
        }
    }
    }
    function comentadiagnostico(){
    var id_cedula = localStorage.getItem("IdCedula");
    var comentario_cliente = $('#comentario_cliente').val();
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("SELECT * from diagnosticos_PMP WHERE id_cedula = ?",
            [id_cedula],
                function(tx, results){
                    if(results.rows.length == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO diagnosticos_PMP(id_cedula,comentario_cliente) VALUES (?,?)",
                                    [id_cedula, comentario_cliente],
                                    function(tx, results){
                                        //console.log('Inserta');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    } else {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE diagnosticos_PMP SET comentario_cliente = ? WHERE id_cedula = ?",
                                    [comentario_cliente, id_cedula],
                                    function(tx, results){
                                        //console.log('update');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    }
                },
                function(tx, error){
                    console.log("Error al guardar checklits: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );
    }
    function guardarFotoDiagnostico(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=="PMP1Caliente"){
        tipo='Caliente';
    }else if (tipoVisita=="PMP1Frio"){
        tipo='Frio';
    }else if (tipoVisita=="PMP1Rational"){
        tipo='Rational';
    }else if (tipoVisita=="PMP2"){
        tipo='Comedor Industrial';
    }else if (tipoVisita=="correctivo"){
        tipo='Correctivo';
    }else{tipo='HEB'}
    var id_cedula = localStorage.getItem("IdCedula");
    var foto = $("#imagenC").val();
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    if (foto){
        $("#tabla_diagnostico tbody").empty(""); 
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("insert into fotos_diagnostico(id_cedula,foto,fecha,tipo ) values(?,?,?,?)",
                [id_cedula,foto,fecha_llegada,tipo],
                function (tx, results) {
                    var item = results.rows.item(0);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select * from fotos_diagnostico where id_cedula = ? AND tipo = ? ORDER BY id_foto DESC",
                            [id_cedula, tipo],
                                function(tx, results){
                                    let length = results.rows.length;
                                    // console.log(length);
                                    if (length ==0){
                                        $('.preloader').remove();
                                        $('.infinite-scroll-preloader').remove();
                                    }else{
                                        $("#message-nr").css("display", "none");
                                        $("#imagenC").val("");                                            
                                        $("#smallImage").attr("src","img/blank.png");
                                        $("#photoIcon").attr("src","img/camera.svg");
                                        $('.preloader').remove();
                                        $('.infinite-scroll-preloader').remove();
                                        app.preloader.hide();
                                        for(var i = 0; i< length; i++){
                                            var item = results.rows.item(i);
                                            $("#tabla_diagnostico").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                            swal("", "Se guardo la foto", "success");
                                                        
                                        }
                                    }
                                
                                },
                                function(tx, error){
                                    console.log("Error al mostrar datos cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){console.log("Error al mostrar datos cedula: " + error.message);},
                        function(){}
                    );
                },
                function (tx, error) {
                    console.error("Error al registrar Resultado: " + error.message);
                }
                );
            },
            function (error) { },
            function () { });
    }else{
        swal("", "Debe de tomar fotografia" ,"warning");
    }
    }
    function guardarDatoscheckServind(){
    var id_cedula = localStorage.getItem("IdCedula");
    //console.log("guardardatso");
    var no_orden=$('#orden').val();
    var fecha=$('#fecha').val();
    var id_cliente=1;
    var cliente=$('#cliente').val();
    var suc_cliente=$('#suc_cliente').val();
    var direccion=$('#direccion').val();
    var ciudad=$('#ciudad').val();
    var telefono=$('#telefono').val();
    var correo=$('#correo').val();
    var tipo_servicio=$('#tipo_servicio').val();
    var nombre_comercial = cliente+" "+suc_cliente;
    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo && tipo_servicio){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_serv SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [no_orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [nombre_comercial ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");                                            
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
    }
    function guardarDatoscheckServind2(){
    var values = get_datos_completos();
    var quita_coma = values.response;
    var valido = values.valido;
    if (valido) {
        var id_cedula = localStorage.getItem("IdCedula");
        //console.log("guardardatso");
        var orden=$('#orden').val();
        var fecha=$('#fecha').val();
        var id_cliente=1;
        var cliente=$('#cliente').val();
        var suc_cliente=$('#suc_cliente').val();
        var direccion=$('#direccion').val();
        var ciudad=$('#ciudad').val();
        var telefono=$('#telefono').val();
        var correo=$('#correo').val();
        var equipo=$('#equipo').val();
        var marca=$('#marca').val();
        var modelo=$('#modelo').val();
        var serie=$('#serie').val();
        var ml='na';
        var tipo_servicio=$('#tipo_servicio').val();
        var nombre_comercial = cliente+" "+suc_cliente;

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, equipo = ?, marca = ?, modelo = ?, serie = ?, ml = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, equipo, marca, modelo, serie, ml, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [nombre_comercial ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#equipo').css("background-color", "#ffffff");
                                        $('#marca').css("background-color", "#ffffff");
                                        $('#modelo').css("background-color", "#ffffff");
                                        $('#serie').css("background-color", "#ffffff");
                                        $('#ml').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );  
    }else{
        swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
    }
    }
    function guardarDatoscheckServind3(){
    var values = get_datos_completos();
    var quita_coma = values.response;
    var valido = values.valido;
    if (valido) {
        var id_cedula = localStorage.getItem("IdCedula");
        //console.log("guardardatso");
        var no_orden=$('#orden').val();
        var fecha=$('#fecha').val();
        var id_cliente=1;
        var cliente=$('#cliente').val();
        var suc_cliente=$('#suc_cliente').val();
        var direccion=$('#direccion').val();
        var ciudad=$('#ciudad').val();
        var telefono=$('#telefono').val();
        var correo=$('#correo').val();
        var equipo=$('#equipo').val();
        var marca=$('#marca').val();
        var modelo=$('#modelo').val();
        var serie=$('#serie').val();
        var ml='na';
        var tipo_servicio=$('#tipo_servicio').val();
        var nombre_comercial = cliente+" "+suc_cliente;

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, equipo = ?, marca = ?, modelo = ?, serie = ?, ml = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [no_orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, equipo, marca, modelo, serie, ml, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [nombre_comercial ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#equipo').css("background-color", "#ffffff");
                                        $('#marca').css("background-color", "#ffffff");
                                        $('#modelo').css("background-color", "#ffffff");
                                        $('#serie').css("background-color", "#ffffff");
                                        $('#ml').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
        swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
    }
    }
    function guardarDatoscheckServind5(){
    var id_cedula = localStorage.getItem("IdCedula");
    //console.log("guardardatso");
    var no_orden=$('#orden').val();
    var fecha=$('#fecha').val();
    var id_cliente=1;
    var cliente=$('#cliente').val();
    var suc_cliente=$('#suc_cliente').val();
    var direccion=$('#direccion').val();
    var ciudad=$('#ciudad').val();
    var telefono=$('#telefono').val();
    var correo=$('#correo').val();
    var equipo=$('#equipo').val();
    var marca=$('#marca').val();
    var modelo=$('#modelo').val();
    var serie=$('#serie').val();
    var ml=$('#ml').val();
    var tipo_servicio=$('#tipo_servicio').val();
    var nombre_comercial = cliente+" "+suc_cliente;

    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo && equipo && marca && modelo && serie && ml && tipo_servicio){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_serv SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ?, equipo = ?, marca = ?, modelo = ?, serie = ?, ml = ?, tipo_servicio = ? WHERE id_cedula = ?",
                    [no_orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo, equipo, marca, modelo, serie, ml, tipo_servicio ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [nombre_comercial ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#equipo').css("background-color", "#ffffff");
                                        $('#marca').css("background-color", "#ffffff");
                                        $('#modelo').css("background-color", "#ffffff");
                                        $('#serie').css("background-color", "#ffffff");
                                        $('#ml').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
    }
    function datosDiagnostico(id,value){
    var id_cedula = localStorage.getItem("IdCedula");
    var como_encontro = $('#como_encontro').val();
    var volt = $('#volt').val();
    var amp = $('#amp').val();
    var wc = $('#wc').val();
    var tierra_fisica = $('#tierra_fisica').val();
    if (id=='como_encontro'){
        if (como_encontro){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET como_encontro = ? WHERE id_cedula = ?",
                        [como_encontro, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='volt'){
        if (volt){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET voltaje = ? WHERE id_cedula = ?",
                        [volt, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='amp'){
        if (amp){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET amp = ? WHERE id_cedula = ?",
                        [amp, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='wc'){
        if (wc){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET wc = ? WHERE id_cedula = ?",
                        [wc, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='tierra_fisica'){
        if (tierra_fisica){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET tierra_fisica = ? WHERE id_cedula = ?",
                        [tierra_fisica, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else if (id=='falla'){
        var falla = $('#falla').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET falla_reportada = ? WHERE id_cedula = ?",
                    [falla, id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else if (id=='otras_condiciones'){
        var otras_condiciones = $('#otras_condiciones').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET otras_condiciones = ? WHERE id_cedula = ?",
                    [otras_condiciones, id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    }
    function selectserv(val,op){
    if(val == 3){
        $("#div_otras_condiciones").css("display","block");
    }else{
        $("#div_otras_condiciones").css("display","none");
    }
    }
    function guardarDiagnosticoServ(clave){
    if($('#como_encontro').val() == 3){
        if($("#otras_condiciones").val()){}else{
            swal("", "Debes indicar en que condiciones se encontró el equipo." ,"warning");
            return false;
        }
    }
    var id_cedula = localStorage.getItem("IdCedula");
    var falla = $('#falla').val();
    var como_encontro = $('#como_encontro').val();
    var volt = $('#volt').val();
    var amp = $('#amp').val();
    var wc = $('#wc').val();
    var tierra_fisica = $('#tierra_fisica').val();
    if (clave == 1){
        if (como_encontro==0){
            swal("", "Todos los campos son requeridos." ,"warning");
        }else{
            if (falla && como_encontro && volt && amp && wc && tierra_fisica){
                swal("","Datos Guardados correctamente","success");
                app.views.main.router.back('/formServ2/', {force: true, ignoreCache: true, reload: true});
            }else{
                swal("", "Todos los campos son requeridos" ,"warning");
            }
        }
    }else if (clave == 2){
        if (como_encontro==0){
            swal("", "Todos los campos son requeridos." ,"warning");
        }else{
            if (falla && como_encontro && volt && amp && wc && tierra_fisica){
                swal("","Datos Guardados correctamente","success");
                app.views.main.router.back('/formServ12/', {force: true, ignoreCache: true, reload: true});
            }else{
                swal("", "Todos los campos son requeridos" ,"warning");
            }
        }
    }else{}
    }

    function requiereCotizacion(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
        var diag = '';
        var estado='';
        if($("#cotizacion-1").prop("checked") == true){
            $("#cotizacion").css("display","block")
            diag= 'Sí';
            estado="2";
        } else {
            $("#cotizacion").css("display","none")
            diag= 'No';
            estado="1";
        }
        if(TipoVisita=='PMP2'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET papeleta = ? WHERE id_datos = ?",
                        [diag,id_equipo],
                        function(tx, results){
                            estatus_os(estado,id_cedula);
                        },
                        function(tx, error){
                            console.error("Error al guardar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar: " + error.message);
                },
                function(){}
            );
        }else{
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET papeleta = ? WHERE id_cedula = ?",
                    [diag,id_cedula],
                    function(tx, results){
                        estatus_os(estado,id_cedula);
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }
    }
    function norequiereCotizacion(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var diag = '';
    var estado='';
    if($("#cotizacion-2").prop("checked") == true){
        $("#cotizacion").css("display","none")
        diag= 'No';
        estado="1";
    }
    if($("#cotizacion-3").prop("checked") == true){
        $("#cotizacion").css("display","block")
        diag= 'Pendiente';  
        estado ="3";
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET papeleta = ? WHERE id_datos = ?",
                    [diag,id_equipo],
                    function(tx, results){
                        estatus_os(estado,id_cedula);    
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET papeleta = ? WHERE id_cedula = ?",
                [diag,id_cedula],
                function(tx, results){
                    estatus_os(estado,id_cedula);
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }
    }

    function siviaticos(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var viatico = '';
    if($("#viaticos-1").prop("checked") == true){
        viatico= 'Sí';
    } else {
        viatico= 'No';
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET viaticos = ? WHERE id_datos = ?",
                    [viatico,id_equipo],
                    function(tx, results){
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET viaticos = ? WHERE id_cedula = ?",
                [viatico,id_cedula],
                function(tx, results){
                    
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }
    }

    function noviaticos(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var viatico = '';
    if($("#viaticos-2").prop("checked") == true){
        viatico= 'No';  
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET viaticos = ? WHERE id_datos = ?",
                    [viatico,id_equipo],
                    function(tx, results){
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET viaticos = ? WHERE id_cedula = ?",
                [viatico,id_cedula],
                function(tx, results){
                    
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }
    }

    function guardarReporteGeneralServ(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","El campo de nombre y firma son obligatorios","warning");
            return false;
        }
        // if($("#imagenC").val() == ""){
        //     swal("","Debes tomar la fotografía del sello para poder continuar","warning");
        //     return false;
        // }
        var foto_sello = $("#imagenC").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firma_cliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET firma_cliente = ?, fecha_cliente = ?, foto_sello = ? WHERE id_cedula = ?",
                    [firma_cliente,fecha_firma,foto_sello,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                                    [nombrefirma,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function verimg2(route){
    //console.log(route);
    localStorage.setItem("ruta", route);
    //app.views.main.router.navigate({ name: "verimgs2" });
    app.views.main.router.back('/verimgs2/', {force: true, ignoreCache: true, reload: true});
    }

    function regresarVerImg(){
    app.views.main.router.back('/menuServInd/', {force: true, ignoreCache: true, reload: true});
    window.localStorage.removeItem("ruta");
    }
    function mostrarHistoricoServ(){
    var historico = app.popup.create({
        content: `
            <div class="popup popup-historico" id="historico">
                    <br/>
                    <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                        <a id="closeP" class="link popup-close">X</a>
                    </div>
                <div class="app">
                    <div class="page">
                        <div class="page-content" style="background-color: #f6f7f9; ">
                            <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                <div style="text-align: left;">
                                    <div class="item-inner">
                                        <div class="block-title" style="text-align: center; font-size: 20px;"><h2 style="color:#505759;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">Histórico</h2></div>
                                    </div>
                                </div>
                                <div style="text-align: left;">
                        
                                <div class="card data-table">
                                    <div class="infinite-scroll-content">
                                        <table id="tabla_diagnostico7">
                                            <thead>
                                                <tr>
                                                    <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Tipo</th>
                                                    <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Hrs.</th>
                                                    <th class="numeric-cell" style="text-align: center;background-color: #063E7F;color: white;">Min.</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Abrillantado</td>
                                                    <td>01</td>
                                                    <td>23</td>
                                                </tr>
                                                <tr>
                                                    <td>Sin pastillas</td>
                                                    <td>0</td>
                                                    <td>23</td>
                                                </tr>
                                                <tr>
                                                    <td>Eco Ligero</td>
                                                    <td>01</td>
                                                    <td>19</td>
                                                </tr>
                                                <tr>
                                                    <td>Eco Medio/Intermedio</td>
                                                    <td>0</td>
                                                    <td>38</td>
                                                </tr>
                                                <tr>
                                                    <td>Rápido/Ligero</td>
                                                    <td>01</td>
                                                    <td>26</td>
                                                </tr>
                                                <tr>
                                                    <td>Eco Intenso</td>
                                                    <td>01</td>
                                                    <td>23</td>
                                                </tr>
                                                <tr>
                                                    <td>Normal Ligero</td>
                                                    <td>0</td>
                                                    <td>29</td>
                                                </tr>
                                                <tr>
                                                    <td>Normal Medio</td>
                                                    <td>1</td>
                                                    <td>00</td>
                                                </tr>
                                                <tr>
                                                    <td>Normal Intenso/Fuerte</td>
                                                    <td>02</td>
                                                    <td>00</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                </div>
                                <fwm></fwm>
                            </div> 
                        </div>
                    </div>
                </div>
            </div>
            `,
            on: {
                open: function (popup) {

                    
                },
            }
    });
    historico.open();
    }
    function showTPMV(){
    var manual = app.popup.create({
        content: `
            <div class="popup popup-Manual" id="camera">
                    <br/>
                    <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                        <a id="closeP" class="link popup-close">X</a>
                    </div>
                <div class="app">
                    <div class="page">
                        <div class="page-content" style="background-color: #f6f7f9; ">
                            <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                <div style="text-align: left;">
                                    <div class="item-inner">
                                        <div class="block-title" style="text-align: center; font-size: 20px;"><h2 style="color:#505759;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">TPM´s</h2></div>
                                    </div>
                                </div>
                                <div style="text-align: left;">
                                    <div class="list FWM-fixing-form">
                                        <span class="span FWM-span-form">Buscar TPMs:</span>
                                        <input type="text" class="FWM-input" id="manual"/>
                                        <input type="hidden" class="FWM-input" id="route"/>
                                    </div>
                                </div>
                                <fwm></fwm>
                            </div> 
                        </div>
                    </div>
                </div>
            </div>
            `,
            on: {
                open: function (popup) {

                    var NomJson = 'Serve_tpm';

                    self.autocompleteDropdownAjax = app.autocomplete.create({
                        inputEl: '#manual',
                        openIn: 'dropdown',
                        preloader: true, //enable preloader
                        valueProperty: 'id', //object's "value" property name
                        textProperty:  'name', //object's "text" property name
                        limit: 10, //limit to 20 results
                        dropdownPlaceholderText: 'Seleccionar TPM...',
                        source: function (query, render) {
                            var autocomplete = this;
                            var results = [];
                            if (query.length === 0) {
                                render(results);
                                return;
                            }
                            // Show Preloader
                            autocomplete.preloaderShow();
                            // Do Ajax request to Autocomplete data
                            app.request({
                                url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
                                method: 'GET',
                                dataType: 'json',
                                data: {
                                    query: query,
                                },success: function (data) {
                                    for (var i = 0; i < data.length; i++) {
                                        if (data[i].name.toLowerCase().indexOf(query.toLowerCase()) >= 0) results.push(data[i]);
                                    }
                                    autocomplete.preloaderHide();
                                    render(results);
                                }
                            }); 
                        }
                    });


                    $('#manual').change(function () {
                        var id = $("#manual").val();
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomJson+".json", function (data) {
                            var content2 = JSON.parse(data);
                            for(var x = 0; x < content2.length; x++) {
                                if(content2[x].id == id){
                                    $("#manual").val(content2[x].name);
                                    $("#route").val(content2[x].route);
                                    var route =$("#route").val();
                                    manual.close();
                                    verimg2(route);
                                }         
                            }
                        });
                    });

                    $('#manual').click(function () {
                        $("#manual").val('');
                        $('#route').val('');
                    });

                    $('#closeP').click(function () {
                        manual.close();
                    });
                },
            }
    });
    manual.open();
    }

    function showManual(){
    var manual = app.popup.create({
        content: `
            <div class="popup popup-Manual" id="camera">
                    <br/>
                    <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                        <a id="closeP" class="link popup-close">X</a>
                    </div>
                <div class="app">
                    <div class="page">
                        <div class="page-content" style="background-color: #f6f7f9; ">
                            <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                <div style="text-align: left;">
                                    <div class="item-inner">
                                        <div class="block-title" style="text-align: center; font-size: 20px;"><h2 style="color:#505759;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">Manuales</h2></div>
                                    </div>
                                </div>
                                <div style="text-align: left;">
                                    <div class="list FWM-fixing-form">
                                    
                                    <div class="list FWM-fixing-form" style="margin-top:10px">
                                    <a href="" target="_system" id="abrir1"><img src="img/iconsMenu/zona.svg" width="55.81pt" height="74.41pt">
                                    <p style="margin-top:0px;" class="bottom-third">Consular repositorio online</p>
                                    </a>
                                    </div>
                                </div>
                                <fwm></fwm>
                            </div> 
                        </div>
                    </div>
                </div>
            </div>`,
            on: {
                open: function (popup) {
                    var ruta2 = "https://drive.google.com/drive/folders/1iyOjr9xZBhJxnrYh4X18wFqYSd2LL3PZ?usp=sharing";
                    var NomJson = 'jsonArchivos_SerV';

                    $("#abrir1").click(function(){
                        var ruta_actual = app.views.main.router.url;
                        localStorage.setItem("RutaActual", ruta_actual);
                        localStorage.setItem("RutaManual", 1);
                        var id_cedula = localStorage.getItem("IdCedula");
                        localStorage.setItem("cedula2", id_cedula);
                        let tipoCedulas = localStorage.getItem("TipoVisita");
                        localStorage.setItem("TipoVisitas2", tipoCedulas);
                        manual.close(); 
                        window.location.href = ruta2;
                    });

                    self.autocompleteDropdownAjax = app.autocomplete.create({
                        inputEl: '#manualM',
                        openIn: 'dropdown',
                        preloader: true, //enable preloader
                        valueProperty: 'id', //object's "value" property name
                        textProperty:  'name', //object's "text" property name
                        limit: 10, //limit to 20 results
                        dropdownPlaceholderText: 'Seleccionar Manual...',
                        source: function (query, render) {
                            var autocomplete = this;
                            var results = [];
                            if (query.length === 0) {
                                render(results);
                                return;
                            }
                            // Show Preloader
                            autocomplete.preloaderShow();
                            // Do Ajax request to Autocomplete data
                            app.request({
                                url: cordova.file.dataDirectory + "jsons/"+NomJson+".json",
                                method: 'GET',
                                dataType: 'json',
                                data: {
                                    query: query,
                                },success: function (data) {
                                    for (var i = 0; i < data.length; i++) {
                                        if (data[i].name.toLowerCase().indexOf(query.toLowerCase()) >= 0) results.push(data[i]);
                                    }
                                    autocomplete.preloaderHide();
                                    render(results);
                                }
                            }); 
                        }
                    });

                    $('#manualM').change(function () {
                        var id = $("#manualM").val();
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomJson+".json", function (data) {
                            var content2 = JSON.parse(data);
                            for(var x = 0; x < content2.length; x++) {
                                if(content2[x].id == id){
                                    $("#manualM").val(content2[x].name);
                                    $("#routeM").val(content2[x].url);
                                    var route =$("#routeM").val();
                                    var ruta_actual = app.views.main.router.url;
                                    localStorage.setItem("RutaActual", ruta_actual);
                                    localStorage.setItem("RutaManual", 1);
                                    manual.close();
                                    window.location.href = route;
                                }         
                            }
                        });
                    });

                    $('#manualM').click(function () {
                        $("#manualM").val('');
                        $('#routeM').val('');
                    });

                    $('#closeP').click(function () {
                        manual.close();
                    });
                },
            }
    });
    manual.open();
    }

    function showPDFinApp(route){
    if (route == undefined){
        var pdf ="Manuales/OP-AMA-MICRO-AMC4080-00.pdf";
    }
    else{var pdf = "Manuales/"+route;}
    const documentPath = "file:///mnt/ext_sdcard/"+pdf;
    console.log(documentPath);
    cordova.plugins.fileOpener2.open(
        documentPath,
        'application/pdf', 
        {
            error : function(e){ console.log('Error status: ' + e.status + ' - Error message: ' + e.message);}, 
            success : function(){ } 
        } 
    );
    }
    function terminarReporteServ(){
    var id_cedula = localStorage.getItem("IdCedula");
    if($('#imagenC').val() == ""){
        swal("","La fotografia es obligatoria","warning");
        return false;
    }
    if($('#signate').val() == ""){
        swal("","La firma es obligatoria","warning");
        return false;
    }

    var foto_salida = $('#imagenC').val();
    var firma_tec = $('#signate').val();
    var fecha = new Date();
    var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var ubicacion_salida = $('#geolocation').val();
    var estatus = 1;

    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                [fecha_salida,ubicacion_salida,estatus,id_cedula],
                function(tx, results){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE visita_servInd SET firma_tecnico = ?, foto_salida = ? WHERE id_cedula = ?",
                                [firma_tec,foto_salida,id_cedula],
                                function(tx, results){
                                    window.location.href = "./menu.html";
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );    
                },
                function(tx, error){
                    swal("Error al guardar",error.message,"error");
                }
            );
        },
        function(error){},
        function(){}
    );
    }
    function terminarReporteServRe(){
    if($('#imagenC').val() == ""){
        swal("","La fotografia es obligatoria","warning");
        return false;
    }
    if($('#signate').val() == ""){
        swal("","La firma es obligatoria","warning");
        return false;
    }
    var id_cedula = localStorage.getItem("IdCedula");
    var foto_salida = $('#imagenC').val();
    var firma_tec = $('#signate').val();
    var fecha = new Date();
    var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var ubicacion_salida = $('#geolocation').val();
    var estatus = 1;
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                [fecha_salida,ubicacion_salida,estatus,id_cedula],
                function(tx, results){
                    databaseHandler.db.transaction(
                        function(tx){//firma_tecnico
                            tx.executeSql("UPDATE visita_servInd SET firma_tecnico = ?, foto_salida = ? WHERE id_cedula = ?",
                                [firma_tec,foto_salida,id_cedula],
                                function(tx, results){
                                    window.location.href = "./menu.html";
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                },
                function(tx, error){
                    swal("Error al guardar",error.message,"error");
                }
            );
        },
        function(error){},
        function(){}
    );
    }
    function checkSelect(val, id){
    //console.log(val, id);
    if (val==0){//#212121
        document.getElementById(id).style.setProperty('background-color', '#fff', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }else if(val==1){
        document.getElementById(id).style.setProperty('background-color', '#2BEB00', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }else if(val==2){
        document.getElementById(id).style.setProperty('background-color', 'yellow', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }else if(val==3){
        document.getElementById(id).style.setProperty('background-color', 'red', 'important');
        document.getElementById(id).style.setProperty('color', 'white', 'important');
        TomaEvidencia(id);
    }else if(val==4){
        document.getElementById(id).style.setProperty('background-color', 'gray', 'important');
        document.getElementById(id).style.setProperty('color', 'white', 'important');
        TomaEvidencia(id);
    }else if(val==5){
        document.getElementById(id).style.setProperty('background-color', '#EAEAEA', 'important');
        document.getElementById(id).style.setProperty('color', '#212121', 'important');
    }
    }

    function TomaEvidencia(id){
    var popEvidencia = app.popup.create({
        content: `
        <div class="sheet-modal my-sheet" id="sheet-modal" name="sheet">
        <div class="toolbar">
            <div class="toolbar-inner">
                <div class="left"></div>
                <div class="right"><a class="link" id="close_sheet" href="#">Cerrar</a></div>
            </div>
        </div>
        <div class="sheet-modal-inner">
            <div class="block">
                <h3 class="FWN-titulo-2">Agregar Evidencia</h3>
                <form class="list FWM-fixing-form"> 
                    <input type="hidden" id="inputEvidencia" value=`+id+`>
                    <input type="hidden" id="pasa" value="0">
                        <span class="span FWM-span-form">Observaciones:</span>
                        <textarea class ="FWM-input" id="falla" name="falla"  cols="30" rows="10" onchange="inputLleno(this.id,this.value)"></textarea>
                            <span class="span FWM-span-form">Foto:</span>
                                <div class="FWM-photo-container">
                                    <div class="border-capture">
                                        <a onclick="capturePhoto();">
                                            <img class="FWM-photo" src="img/camera.svg" id="photoIcon" width="45px" style="margin-left: 50px;"/>
                                        </a>
                                    </div>
                                    <img class="FWM-photo-hide" id="smallImage" src=""/>
                                    <input type="hidden" id="imagenC" name="imagenC"/>
                                </div>
                                <br>
                            <div class="block grid-resizable-demo" style="margin-bottom: 70px;">
                                <div class="row align-items-stretch" style="text-align: center;">
                                    <div class="col-100 medium-50" style="min-width: 50px; border-style: none;">
                                        <span class="resize-handler"></span>
                                        <a href="#" onclick="guardarEvidencia();" style="background-color: #063E7F;" class="boton-equipo">Guardar</a>
                                    </div>
                                </div>
                            </div>
                </form>
            </div>
        </div>
    </div>`,
    swipeToClose:false,
    closeByOutsideClick:false,
    closeByBackdropClick:false,
    closeOnEscape:false,
            on: {
                open: function (popup) {

                    $('#close_sheet').click(function () {
                        if($('#pasa').val()!=0){
                            app.sheet.close('#sheet-modal');
                        }else{
                            swal({
                                title: "Aviso",
                                text: "Aún no agregas una evidencia, ¿Estas seguro que deseas regresar?",
                                icon: "warning",
                                buttons: true,
                                dangerMode: false,
                            }).then((willGoBack) => {
                                if (willGoBack){
                                    app.sheet.close('#sheet-modal');
                                } else {}
                            });
                        }
                    });
                },
            }
    });
    popEvidencia.open();
    }

    function guardarEvidencia(){
    var id_cedula = localStorage.getItem("IdCedula");
    var foto = $("#imagenC").val();
    var observa = $("#falla").val();
    var data = $("#inputEvidencia").val().split("-");
    var pregunta = data[1];
    var fase = data[0];
    var fecha = new Date();
    var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var select = document.getElementById($("#inputEvidencia").val());
    var name = select.getAttribute("name");
    var data = name.split("-");
    var no_pregunta=data[1];
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){id_equ=0};
    if (observa){
        if (foto){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO fotos_check(id_cedula, foto, pregunta, fase,  observaciones, fecha_foto, no_pregunta,id_equipo) VALUES (?,?,?,?,?,?,?,?)",
                        [id_cedula, foto, pregunta, fase, observa, fecha_foto, no_pregunta,id_equ],
                        function(tx, results){
                            app.preloader.hide();
                            swal("","Datos guardados correctamente","success");
                            $('#pasa').val('1');
                            $('#imagenC').val("");
                            $('#falla').val("");
                            $('#falla').css("background-color", "#ffffff");
                            //app.sheet.close('#sheet-modal');
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from fotos_check where id_cedula = ? AND fase = ? ORDER BY id_foto DESC",
                                    [id_cedula, fase],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#smallImage").attr("src","img/blank.png");
                                            $("#photoIcon").attr("src","img/camera.svg");
                                            if (fase==1){
                                                $("#tabla_suministros").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase==2){
                                                $("#tabla_calentamiento").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 3){
                                                $("#tabla_electricos").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 4){
                                                $("#tabla_sensores").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 5){
                                                $("#tabla_microondas").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 6){
                                                $("#tabla_gabinete").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 7){
                                                $("#tabla_suministros").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 8){
                                                $("#tabla-refri").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 9){
                                                $("#tabla_control").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 10){
                                                $("#tabla_partes").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 11){
                                                $("#tabla_gabinete").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 12){
                                                $("#tabla_diagnostico").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 13){
                                                $("#tabla_diagnostico1").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 14){
                                                $("#tabla_diagnostico2").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 15){
                                                $("#tabla_diagnostico3").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 16){
                                                $("#tabla_diagnostico4").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 17){
                                                $("#tabla_diagnostico5").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 18){
                                                $("#tabla_diagnostico6").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 19){
                                                $("#tabla_diagnostico7").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 20){
                                                $("#tabla_diagnostico8").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 21){
                                                $("#tabla_diagnostico9").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 22){
                                                $("#tabla_hbe22").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 23){
                                                $("#tabla_hbe23").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 24){
                                                $("#tabla_hbe24").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 25){
                                                $("#tabla_hbe25").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 26){
                                                $("#tabla_hbe26").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 27){
                                                $("#tabla_hbe27").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 28){
                                                $("#tabla_hbe28").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 29){
                                                $("#tabla_hbe29").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 30){
                                                $("#tabla_hbe30").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 31){
                                                $("#tabla_hbe31").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 32){
                                                $("#tabla_hbe32").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 33){
                                                $("#tabla_hbe33").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 34){
                                                $("#tabla_hbe34").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 35){
                                                $("#tabla_hbe35").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 36){
                                                $("#tabla_hbe36").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 37){
                                                $("#tabla_hbe37").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 38){
                                                $("#tabla_hbe38").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 39){
                                                $("#tabla_hbe39").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }else if (fase == 40){
                                                $("#tabla_hbe40").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                            }
                                            if (fase <= 21){
                                                $("#message-nr").css("display", "none");
                                            }else{
                                                $("#message-nr"+fase).css("display", "none");
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            console.log("Error al mostrar datos cedula: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            app.preloader.hide();
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes tomar una fotografía" ,"warning");
        }
    }else{
        swal("", "Debes colocar un comentario" ,"warning");
    }
    }
    function refasinstaladas(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var refas = '';    
    if($("#refaccion-1").prop("checked") == true){
        $("#refacciones").css("display","block")
        refas='Sí';
    } else {
        $("#refacciones").css("display","none")
        refas='No';
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET refacciones = ? WHERE id_datos = ?",
                    [refas,id_equipo],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }
    else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET refacciones = ? WHERE id_cedula = ?",
                [refas,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );}
    }

    function refasnoinstaladas(){
    var id_cedula = localStorage.getItem("IdCedula");
    var TipoVisita = localStorage.getItem("TipoVisita");
    var id_equipo = localStorage.getItem("insertId");
    var refas = '';
    if($("#refaccion-2").prop("checked") == true){
        $("#refacciones").css("display","none")
        refas = 'No';
    }
    if(TipoVisita=='PMP2'){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET refacciones = ? WHERE id_datos = ?",
                    [refas,id_equipo],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else{
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET refacciones = ? WHERE id_cedula = ?",
                [refas,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );}
    }

    function regresarRecorridoServInd3(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=="PMP1Rational"){
        app.views.main.router.back('/recorridoServ9/', {force: true, ignoreCache: true, reload: true});
    }else{
        app.views.main.router.back('/recorridoServ3/', {force: true, ignoreCache: true, reload: true});
    }

    }


    function selectChanged(id1,val,puntos){
    var puntos1=100/puntos;
    var punto=puntos1.toFixed(2);
    var id=id1;
    var data = $("#"+id).attr("id").split("-");
    var idtpm=data[0];
    var i=data[1];
    let total=localStorage.getItem("avanceTPM");
    var totales=parseFloat(total);
    punto=parseFloat(punto);
        if (val==1){
            $('#'+idtpm+'-'+i+'-value').text(punto+'%');
            totales=totales+puntos1;
            total=totales.toFixed();
            localStorage.setItem("avanceTPM", totales);
            $('#total').text(total+'%');
        }else if (val==0){
            $('#'+idtpm+'-'+i+'-value').text('0%');
            totales=totales-puntos1;
            total=totales.toFixed();
            localStorage.setItem("avanceTPM", totales);
            $('#total').text(total+'%');
        }

    var id_cedula = localStorage.getItem("IdCedula");
    var valor=val;

    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("SELECT * from tpms WHERE id_cedula = ? AND id_tpm = ? AND pregunta_tpm = ?",
            [id_cedula,idtpm,i],
                function(tx, results){
                    if(results.rows.length == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO tpms(id_cedula,id_tpm,valor,pregunta_tpm) VALUES (?,?,?,?)",
                                    [id_cedula,idtpm,valor,i],
                                    function(tx, results){
                                        //console.log('Inserta');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    } else {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE tpms SET valor = ? WHERE id_cedula = ? AND id_tpm = ? AND pregunta_tpm = ?",
                                    [valor,id_cedula,idtpm,i],
                                    function(tx, results){
                                        //console.log('update');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    }
                },
                function(tx, error){
                    console.log("Error al guardar checklits: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );
    }

    function guardarSuministrosServind(no_preguntas, fase){
    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-select").val() == "0"){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
    }

    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-input").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
    }

    swal("", "Datos actualizados correctamente" ,"success");

    if (fase==1){
        app.views.main.router.back('/formServ3/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==2){
        app.views.main.router.back('/formServ4/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==3){
        app.views.main.router.back('/formServ5/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==4){
        app.views.main.router.back('/formServ6/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==5){
        app.views.main.router.back('/formServ7/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==6){
        app.views.main.router.back('/formServ8/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==7){
        app.views.main.router.back('/formServ13/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==8){
        app.views.main.router.back('/formServ14/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==9){
        app.views.main.router.back('/formServ15/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==10){
        app.views.main.router.back('/formServ17/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==11){
        app.views.main.router.back('/formServ18/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==12){
        app.views.main.router.back('/formServ22/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==13){
        app.views.main.router.back('/formServ23/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==14){
        app.views.main.router.back('/formServ24/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==15){
        app.views.main.router.back('/formServ25/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==16){
        app.views.main.router.back('/formServ26/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==17){
        app.views.main.router.back('/formServ27/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==18){
        app.views.main.router.back('/formServ28/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==19){
        app.views.main.router.back('/formServ29/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==20){
        app.views.main.router.back('/formServ30/', {force: true, ignoreCache: true, reload: true});
    }else if (fase==21){
        app.views.main.router.back('/formServ31/', {force: true, ignoreCache: true, reload: true});
    }
    }
    function guardarSelectServ(ids){
    var id_cedula = localStorage.getItem("IdCedula");
    var data = $("#"+ids).attr("id").split("-");
    var fase=data[0];
    var id=data[1];
    var tipo = data[2];
    if(tipo == 'check'){
        var valor =   $("#" + ids).prop('checked')
    }else{
        var valor = $("#" + ids).val();  
    }
    if (tipo == 'select' || tipo == 'input') {
        var select = document.getElementById(ids);
        var name = select.getAttribute("name");
        var data = name.split("-");
        var no_pregunta=data[1];
    }else{
        no_pregunta = '0';
    }
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    //console.log(data[0],data[1],$("#"+ids).val(),data[2]);
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("SELECT * from checklist_servind WHERE id_cedula = ? AND fase = ? AND pregunta = ? AND id_equipo = ? and tipo = ?",
            [id_cedula,fase,id,id_equ,tipo],
                function(tx, results){
                    var item = results.rows.item(0);
                    //console.log(item);
                    if(results.rows.length == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO checklist_servind(id_cedula,fase,pregunta,valor,tipo,no_pregunta,id_equipo) VALUES (?,?,?,?,?,?,?)",
                                    [id_cedula,fase,id,valor,tipo,no_pregunta,id_equ],
                                    function(tx, results){
                                        //console.log('Inserta');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){
                            }
                        );
                    } else {
                        
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE checklist_servind SET tipo = ?, valor = ?, id_equipo=? WHERE id_cedula = ? AND fase = ? AND pregunta = ? AND no_pregunta = ?",
                                    [tipo,valor,id_equ,id_cedula,fase,id,no_pregunta],
                                    function(tx, results){
                                        //console.log('update');
                                        //swal("", "Datos actualizados correctamente", "success");
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },function(error){},function(){}
                        );
                    }
                },
                function(tx, error){
                    console.log("Error al guardar checklits: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );
    }
    function Sidiagnostico(){
    var id_cedula = localStorage.getItem("IdCedula");
    var correcto = '';
    if($("#diagnostico-1").prop("checked") == true){
        correcto='Sí';
    } else {
    
        correcto='No';
    }
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET diagnotico_corecto = ? WHERE id_cedula = ?",
                [correcto,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }

    function Nodiagnostico(){
    var id_cedula = localStorage.getItem("IdCedula");
    var correcto = '';
    if($("#diagnostico-2").prop("checked") == true){
        correcto = 'No';
    }
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE visita_servInd SET diagnotico_corecto = ? WHERE id_cedula = ?",
                [correcto,id_cedula],
                function(tx, results){
                },
                function(tx, error){
                    console.error("Error al guardar: " + error.message);
                }
            );
        },
        function(error){
            console.error("Error al guardar: " + error.message);
        },
        function(){}
    );
    }

    function guardarEntregaServicio(){
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    var tipoVisita = localStorage.getItem("TipoVisita");
    var otras_condiciones = $("#otras_condiciones").val();
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();
    if(!id_equ){ id_equ = 0};    
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del diágnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        if($("#solucion-1").prop("checked") == true || $("#solucion-2").prop("checked") == true){}else{
            swal("", "Se debe marcar la opción si se resolvió el servicio en la primera visita" , "warning");
            return false;
        }
        if(entrega == 3){
            if(otras_condiciones){}else{
                swal("", "Describe las otras condiciones" , "warning");
                return false;
            }
        }
        if(tipoVisita == 'PMP2'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_datos = ?",
                        [comenta, trabajo, entrega ,id_equ],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ39/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ?, otras_condiciones2 = ? WHERE id_cedula = ?",
                        [comenta, trabajo, entrega,otras_condiciones ,id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            $('#otras_condiciones').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ19/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
    }

    function guardarEntregaServicio2(){
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    var tipoVisita = localStorage.getItem("TipoVisita");
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();
    var otras_condiciones = $("#otras_condiciones").val();
    if(!id_equ){ id_equ = 0};
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del diágnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        if($("#solucion-1").prop("checked") == true || $("#solucion-2").prop("checked") == true){}else{
            swal("", "Se debe marcar la opción si se resolvió el servicio en la primera visita" , "warning");
            return false;
        }
        if(entrega == 3){
            if(otras_condiciones){}else{
                swal("", "Describe las otras condiciones" , "warning");
                return false;
            }
        }
        if(tipoVisita == 'PMP2'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_datos = ?",
                        [comenta, trabajo, entrega ,id_equ],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ38/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ?,otras_condiciones2 = ? WHERE id_cedula = ?",
                        [comenta, trabajo, entrega,otras_condiciones ,id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#comentarios').css("background-color", "#ffffff");
                            $('#trabajo').css("background-color", "#ffffff");
                            $('#entrega_equipo').css("background-color", "#ffffff");
                            $('#otras_condiciones').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ9/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
    }

    function guardarPapeletaServ(){
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var id_cedula = localStorage.getItem("IdCedula");
    var noParteC = $('#numero_parteC').val();
    var descripcionC = $('#descripcionC').val();
    var prioridadC = $('#prioridadC').val();
    var cantidadC = $('#cantidadC').val();
    var foto = $("#imagenC").val();
    var motivo_pr = $("#motivo_pr").val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    if($("#cotizacion-1").prop("checked") == true){
        if(noParteC && descripcionC && motivo_pr){
            if (prioridadC == 0){
                swal("", "Todos los datos son requeridos, cuando la opción marcada de papeleta es 'Sí'" , "warning");
                return false;
            }else{
                if (cantidadC){
                    if (foto){
                        databaseHandler.db.transaction(
                            function(tx){//id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro
                                tx.executeSql("INSERT INTO papeleta(id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro, motivo_pr, id_equipo) VALUES (?,?,?,?,?,?,?,?,?)",
                                    [id_cedula, foto, noParteC, descripcionC, prioridadC, cantidadC, fecha_reg, motivo_pr, id_equ],
                                    function(tx, results){
                                        app.preloader.hide();
                                        swal("","Datos guardados correctamente","success");
                                        $("#numero_parteC").val('');
                                        $('#numero_parteC').css("background-color", "#ffffff");
                                        $("#descripcionC").val('');
                                        $('#descripcionC').css("background-color", "#ffffff");
                                        $("#prioridadC").val(0);
                                        $("#cantidadC").val('');
                                        $('#cantidadC').css("background-color", "#ffffff");
                                        $("#motivo_pr").val('');
                                        $("#motivo_pr").css("background-color", "#ffffff");
                                        $("#imagenC").val('');
                                        $("#smallImage").attr("src","img/blank.png");
                                        $("#photoIcon").attr("src","img/camera.svg");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from papeleta where id_cedula = ? ORDER BY id_papeleta DESC",
                                                [id_cedula],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        if (item.prioridad==1){
                                                            prioridad='Seguridad';
                                                        }else if (item.prioridad==2){
                                                            prioridad='Funcionalidad';
                                                        }else if (item.prioridad==3){
                                                            prioridad='Programa';
                                                        }
                                                        $("#table_papeleta").append("<tr id='fila"+ item.id_papeleta +
                                                            "'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ 
                                                            item.id_papeleta +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto_papeleta+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                            item.numero_parte + "</td><td style='text-align: center;'>" + 
                                                                item.descripcion + "</td><td style='text-align: center;'>" + 
                                                                prioridad + "</td><td style='text-align: center;'>" + 
                                                                item.motivo_pr + "</td><td style='text-align: center;'>" + 
                                                                item.cantidad + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        app.preloader.hide();
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Todos los datos son requeridos, cuando la opción marcada de papeleta es 'Sí'" , "warning");
                        return false;
                    }
                }else{
                    swal("", "Todos los datos son requeridos, cuando la opción marcada de papeleta es 'Sí'" , "warning");
                    return false;
                }
            }
        }else{
            swal("", "Todos los datos son requeridos, cuando la opción marcada de papeleta es 'Sí'" , "warning");
        }
    }
    if($("#cotizacion-3").prop("checked") == true){
        if(motivo_pr){
            if (prioridadC == 0){
                swal("", "Selecciona una prioridad" , "warning");
                return false;
            }else{
                if (foto){
                    databaseHandler.db.transaction(
                        function(tx){//id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro
                            tx.executeSql("INSERT INTO papeleta(id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro, motivo_pr, id_equipo) VALUES (?,?,?,?,?,?,?,?,?)",
                                [id_cedula, foto, noParteC, descripcionC, prioridadC, cantidadC, fecha_reg, motivo_pr, id_equ],
                                function(tx, results){
                                    app.preloader.hide();
                                    swal("","Datos guardados correctamente","success");
                                    $("#numero_parteC").val('');
                                    $('#numero_parteC').css("background-color", "#ffffff");
                                    $("#descripcionC").val('');
                                    $('#descripcionC').css("background-color", "#ffffff");
                                    $("#prioridadC").val(0);
                                    $("#cantidadC").val('');
                                    $('#cantidadC').css("background-color", "#ffffff");
                                    $("#motivo_pr").val('');
                                    $("#motivo_pr").css("background-color", "#ffffff");
                                    $("#imagenC").val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from papeleta where id_cedula = ? ORDER BY id_papeleta DESC",
                                            [id_cedula],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    if (item.prioridad==1){
                                                        prioridad='Seguridad';
                                                    }else if (item.prioridad==2){
                                                        prioridad='Funcionalidad';
                                                    }else if (item.prioridad==3){
                                                        prioridad='Programa';
                                                    }
                                                    $("#table_papeleta").append("<tr id='fila"+ item.id_papeleta +
                                                    "'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ 
                                                    item.id_papeleta +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                    item.foto_papeleta+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                    item.numero_parte + "</td><td style='text-align: center;'>" + 
                                                    item.descripcion + "</td><td style='text-align: center;'>" + 
                                                    prioridad + "</td><td style='text-align: center;'>" + 
                                                    item.motivo_pr + "</td><td style='text-align: center;'>" + 
                                                    item.cantidad + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                    app.preloader.hide();
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    app.preloader.hide();
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else{
                    swal("", "Favor de tomar una fotografía" , "warning");
                    return false;
                }
            }
        }else{
            swal("", "Describe el motivo de la Prioridad" , "warning");
        }
    }
    }

    function guardarRefasServ(){
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var noParte = $('#numero_parte').val();
    var descripcion = $('#descripcion').val();
    var parte = $('#parte').val();
    var foto_r = $("#imagenC1").val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

    if(noParte && descripcion && parte){
        if (foto_r){
            databaseHandler.db.transaction(
                function(tx){//id_refaccion, id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro
                    tx.executeSql("INSERT INTO refacciones(id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro, id_equipo) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, foto_r, noParte, descripcion, parte, fecha_reg, id_equ],
                        function(tx, results){
                            app.preloader.hide();
                            swal("","Datos guardados correctamente","success");
                            $("#numero_parte").val('');
                            $('#numero_parte').css("background-color", "#ffffff");
                            $("#descripcion").val('');
                            $('#descripcion').css("background-color", "#ffffff");
                            $("#parte").val('');
                            $('#parte').css("background-color", "#ffffff");
                            $("#imagenC1").val('');
                            $("#smallImage1").attr("src","img/blank.png");
                            $("#photoIcon1").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from refacciones where id_cedula = ? ORDER BY id_refaccion DESC",
                                    [id_cedula],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#tabla_refacciones").append("<tr id='fila"+ item.id_refaccion +
                                            "'><td><a href='#' onclick='eliminarFilaServ("+ 
                                            item.id_refaccion +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                            item.foto_refa +"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                            item.numero_parte + "</td><td style='text-align: center;'>" + 
                                            item.descripcion + "</td><td style='text-align: center;'>" + 
                                            item.parte + "</td></tr>");
                                            $("#message-nr1").css("display", "none");
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            console.log("Error al guardar cedula: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            app.preloader.hide();
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );

        }else{
            swal("", "Favor de tomar una fotografía" , "warning");
            return false;
        }
    }else{
        swal("", "Todos los datos son requeridos" , "warning");
    }
    }

    function guardarCotiza(){
        var tipoVisita = localStorage.getItem("TipoVisita");
        var id_cedula = localStorage.getItem("IdCedula");
        var horasT = $('#cantidadTotal').val();
        if (tipoVisita=='PMP2'){
            console.log('PMP2');
            app.views.main.router.back('/formServ36/', {force: true, ignoreCache: true, reload: true});
        }else{
            if (horasT==0){
                swal({
                    title: "Aviso",
                    text: "Tus horas totales estan en '0', ¿Estas seguro que deseas continuar?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: false,
                })
                .then((willGoBack) => {
                    if (willGoBack){
                        app.views.main.router.back('/formServ45/', {force: true, ignoreCache: true, reload: true});
                    }else{}
                });
            }else{
                //H_viaje, H_espera, H_trabajo, H_totales
                var H_viaje=$('#cantidadViaje').val()
                var H_espera=$('#cantidadEspera').val()
                var H_trabajo=$('#cantidadTrabajo').val()
                var H_totales=$('#cantidadTotal').val()
                var observaciones_papeleta = $("#observaciones_papeleta").val();
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ?,observaciones_papeleta = ? WHERE id_cedula = ?",
                            [H_viaje, H_espera, H_trabajo, H_totales, observaciones_papeleta, id_cedula],
                            function(tx, results){
                                swal("","Guardado correctamente","success");
                                $('#cantidadViaje').css("background-color", "#ffffff");
                                $('#cantidadEspera').css("background-color", "#ffffff");
                                $('#cantidadTrabajo').css("background-color", "#ffffff");
                                $('#cantidadTotal').css("background-color", "#ffffff");
                                    app.views.main.router.back('/formServ45/', {force: true, ignoreCache: true, reload: true});
                            },
                            function(tx, error){
                                console.error("Error al guardar entrega: " + error.message);
                            }
                        );
                    },
                    function(error){
                        console.error("Error al guardar entrega: " + error.message);
                    },
                    function(){}
                );
            }
        }
    }

    function Sumahoras(){
    if ($("#cantidadViaje").val()){}else{
        $("#cantidadViaje").val('00:00');
    }
    if ($("#cantidadEspera").val()){}else{
        $("#cantidadEspera").val('00:00');
    }
    if ($("#cantidadTrabajo").val()){}else{
        $("#cantidadTrabajo").val('00:00');
    }

    var fecha = new Date();
    $("#cantidadTotalTemp").val(fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate()+" "+"00:00");
    var horas_f=0;
    var minutos_f=0;
    if ($("#cantidadViaje").val()=='00:00'){}else{
        var val = $("#cantidadViaje").val();
        values = val.split(':');
        horas_f = parseInt(values[0])+horas_f;
        minutos_f = parseInt(values[1])+minutos_f;
    }

    if ($("#cantidadEspera").val()=='00:00'){}else{
        var val = $("#cantidadEspera").val();
        values = val.split(':');
        horas_f = parseInt(values[0])+horas_f;
        minutos_f = parseInt(values[1])+minutos_f;
    }

    if ($("#cantidadTrabajo").val()=='00:00'){}else{
        var val = $("#cantidadTrabajo").val();
        values = val.split(':');
        horas_f = parseInt(values[0])+horas_f;
        minutos_f = parseInt(values[1])+minutos_f;
    }
    SumarHOras(horas_f, minutos_f);
    }
    function SumarHOras(horas_f, minutos_f){
    var fecha_actual = $("#cantidadTotalTemp").val();
    fecha = new Date(fecha_actual);
    var fechas1 =fecha.setHours(fecha.getHours()+horas_f);
    if(minutos_f == 0){}else{
        fechas1 =fecha.setMinutes(fecha.getMinutes()+minutos_f);
    }
    fechas = new Date(fechas1);
    $("#cantidadTotalTemp").val(fechas.getFullYear() + "-" + (fechas.getMonth() + 1) + "-" + fechas.getDate()+" "+fechas.getHours() + ":" + fechas.getMinutes());
    var fecha_fin = $("#cantidadTotalTemp").val();
    fecha = new Date(fecha_fin);
    var horas = fecha.getHours();
    var minutos = fecha.getMinutes();

    if(minutos<10 && minutos>=0){
        minutos = '0'+minutos;
    }
    if(horas<10 && horas>=0){
        var horas = '0'+horas;
    }
    var H_totales = horas+":"+minutos;
    $("#cantidadTotal").val(H_totales);
    }
    function capturePhoto1() {
        var camera = localStorage.getItem("camera");
        if(camera == 0){
            var camera = app.popup.create({
                content: `
                <div class="popup" id="camera">
                    <div class="app">
                    <div id="deviceready camera-Field-frame">
                        <div class="top"></div>
                        <canvas id="camera-frame" style="display: none;"></canvas>
                        <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                        <img src="" id="phototaked">
                        <div class="camera">
                            <div class="take" id="take" onclick="onTake()">
                                <div class="bubble-take"></div>
                            </div>
                            <div class="select" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                        </div>
                        <div class="left-action">
                            <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                            <div class="cancel " id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        </div>
                        <div class="actions">
                            <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                            <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                            <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                        </div>
                        <div class="right-action">
                            <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                        </div>
                        <audio id="audio" controls style="display: none;">
                            <source type="audio/mp3" src="img/camera.mp3">
                        </audio>
                        <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                    </div>
                    <fwm></fwm>
                    </div>
                </div>
                `,
                on: {
                    open: function (popup) {
                        var permissions = cordova.plugins.permissions;
                        permissions.checkPermission(permissions.CAMERA, function( status ){
                            if (status.hasPermission){
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                    cameraStart(onPhotoDataSuccess1)
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }else{
                                permissions.requestPermission(permissions.CAMERA, success, error);
                                function error() {
                                    app.sheet.close('.popup')
                                    swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                                }
                                function success( status ){
                                    if(!status.hasPermission){
                                        error();
                                    } else {
                                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                        function empresaCargada(){
                                            cameraStart(onPhotoDataSuccess1)
                                        }
                                        function cargarEmpresa(url, callback){
                                            var pie = document.getElementsByTagName('fwm')[0];
                                            var script = document.createElement('script');
                                            script.type = 'text/javascript';
                                            script.src = url;
                                            script.id = "cameraSource";
                                            script.onload = callback;
                                            pie.appendChild(script);
                                        }
                                    }

                                }
                            }
                        });
                    },
                    opened: function (popup) {
                      localStorage.setItem("cameraField", "Active");
                    },
                    closed: function (popup) {
                      window.localStorage.removeItem("cameraField");
                    },
                }
            });
            camera.open();
        } else {
            navigator.camera.getPicture(onPhotoDataSuccess1, onFail, {
                quality: 100,
                destinationType: destinationType.DATA_URL,
                targetWidth: 500,
                targetHeight: 500,
                correctOrientation: true
            });
        }
    }
    function guardaEncuesta(){
    var fecha = new Date();
    var fecha_encuesta = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var id_cedula = localStorage.getItem("IdCedula");
    var recomienda=0;
    var RCcarita = 0;
    var CCcarita = 0;
    var ACcarita = 0;
    var SCcarita = 0;

    for(i = 1;i <= 10; i++){
        if($("#rat"+i).prop("checked") == true){
            recomienda=i;
        }
    }
    for(i = 1;i <= 10; i++){
        if($("#RCcarita"+i).prop("checked") == true){
            RCcarita=i;
        }
    }
    for(i = 1;i <= 10; i++){
        if($("#CCcarita"+i).prop("checked") == true){
            CCcarita=i;
        }
    }

    for(i = 1;i <= 10; i++){
        if($("#ACcarita"+i).prop("checked") == true){
            ACcarita=i;
        }
    }

    for(i = 1;i <= 10; i++){
        if($("#SCcarita"+i).prop("checked") == true){
            SCcarita=i;
        }
    }

    if (recomienda==0 || RCcarita==0 || CCcarita==0 || ACcarita==0 || SCcarita==0){
        //console.log("no");
        app.dialog.alert('Debes colocar una calificación en todos', 'Aviso');
    }else{
        app.preloader.show('blue');
        //console.log(recomienda,RCcarita, CCcarita, ACcarita, SCcarita);
        productHandler.encuestaservInd(id_cedula, recomienda,RCcarita,CCcarita,ACcarita,SCcarita,fecha_encuesta);
        app.preloader.hide();
        app.dialog.alert('Encuesta guardada', 'Confirmación');
        $("#encuesta").css("display", "none");
        $("#realizada").css("display", "block");
        $("#btnEncuesta").css("display", "none");
        $("#btnQR").css("display", "none");
        app.sheet.close('#SheetEncuesta');
    }
    }
    function guardarEntregaServicioF(){
    var id_cedula = localStorage.getItem("IdCedula");
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();        
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del diágnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ? WHERE id_cedula = ?",
                    [comenta, trabajo, entrega ,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#comentarios').css("background-color", "#ffffff");
                        $('#trabajo').css("background-color", "#ffffff");
                        $('#entrega_equipo').css("background-color", "#ffffff");
                        app.views.main.router.back('/formServ19/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
    }
    function guardarEntregaServicioR(){
    var id_cedula = localStorage.getItem("IdCedula");
    var comenta = $('#comentarios').val();
    var trabajo = $('#trabajo').val();
    var entrega = $('#entrega_equipo').val();  
    var otras_condiciones = $("#otras_condiciones").val();      
    if (comenta && trabajo){
        if ($("#diagnostico-1").prop("checked") == false && $("#diagnostico-2").prop("checked") == false){
            swal("", "Favor de contestar la pregunta del diágnostico" , "warning");
            return false;
            }
        if (entrega==0){
            swal("", "Selecciona como se entrego el equipo" , "warning");
            return false;
        }
        if($("#solucion-1").prop("checked") == true || $("#solucion-2").prop("checked") == true){}else{
            swal("", "Se debe marcar la opción si se resolvió el servicio en la primera visita" , "warning");
            return false;
        }
        if(entrega == 3){
            if(otras_condiciones){}else{
                swal("", "Describe las otras condiciones" , "warning");
                return false;
            }
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET comentarios_entrega = ?, trabajo_realizado = ?, como_entrego = ?, otras_condiciones2 = ? WHERE id_cedula = ?",
                    [comenta, trabajo, entrega,otras_condiciones,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#comentarios').css("background-color", "#ffffff");
                        $('#trabajo').css("background-color", "#ffffff");
                        $('#entrega_equipo').css("background-color", "#ffffff");
                        $('#otras_condiciones').css("background-color", "#ffffff");
                        app.views.main.router.back('/formServ32/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }else{
        swal("", "Escribe un comentario y el trabajo realizado" , "warning");
    }
    }
    function guardarCotiza1(){
        var id_cedula = localStorage.getItem("IdCedula");
        var tipoVisita = localStorage.getItem("TipoVisita");
        var horasT = $('#cantidadTotal').val();
        if (horasT==0){
            swal({
                title: "Aviso",
                text: "Tus horas totales estan en '0', ¿Estas seguro que deseas continuar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    if (tipoVisita=='PMP2'){
                        app.views.main.router.back('/formServ35/', {force: true, ignoreCache: true, reload: true});
                    }else{
                        app.views.main.router.back('/formServ44/', {force: true, ignoreCache: true, reload: true});
                    }
                } else {}
            });
        }else{
            //H_viaje, H_espera, H_trabajo, H_totales
            var H_viaje=$('#cantidadViaje').val()
            var H_espera=$('#cantidadEspera').val()
            var H_trabajo=$('#cantidadTrabajo').val()
            var H_totales=$('#cantidadTotal').val()
            var observaciones_papeleta = $("#observaciones_papeleta").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ?,observaciones_papeleta = ? WHERE id_cedula = ?",
                        [H_viaje, H_espera, H_trabajo, H_totales,observaciones_papeleta, id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#cantidadViaje').css("background-color", "#ffffff");
                            $('#cantidadEspera').css("background-color", "#ffffff");
                            $('#cantidadTrabajo').css("background-color", "#ffffff");
                            $('#cantidadTotal').css("background-color", "#ffffff");
                            if (tipoVisita=='PMP2'){
                                app.views.main.router.back('/formServ35/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/formServ44/', {force: true, ignoreCache: true, reload: true});
                            }
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }
    }
    function guardarCotiza2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var horasT = $('#cantidadTotal').val();
        if (horasT==0){
            swal({
                title: "Aviso",
                text: "Tus horas totales estan en '0', ¿Estas seguro que deseas continuar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    app.views.main.router.back('/formServ43/', {force: true, ignoreCache: true, reload: true});
                } else {}
            });
        }else{
            //H_viaje, H_espera, H_trabajo, H_totales
            var H_viaje=$('#cantidadViaje').val()
            var H_espera=$('#cantidadEspera').val()
            var H_trabajo=$('#cantidadTrabajo').val()
            var H_totales=$('#cantidadTotal').val()
            var observaciones_papeleta = $("#observaciones_papeleta").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ?,observaciones_papeleta = ? WHERE id_cedula = ?",
                        [H_viaje, H_espera, H_trabajo, H_totales,observaciones_papeleta, id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                            $('#cantidadViaje').css("background-color", "#ffffff");
                            $('#cantidadEspera').css("background-color", "#ffffff");
                            $('#cantidadTrabajo').css("background-color", "#ffffff");
                            $('#cantidadTotal').css("background-color", "#ffffff");
                            app.views.main.router.back('/formServ43/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al guardar entrega: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar entrega: " + error.message);
                },
                function(){}
            );
        }
    }
    function guardarDiagnosticoServRe(opcion){
    var id_cedula = localStorage.getItem("IdCedula");
    if(opcion == 5){
        if($("#viaticos-2").prop("checked") == true){
            var usb2 = 1;
            $("#viaticos-2").prop("checked",true);
            $("#viaticos-1").prop("checked",false);
        }else{
            $("#viaticos-1").prop("checked",false);
            $("#viaticos-2").prop("checked",false);
            var usb2 = 0;
        }
    }
    if(opcion == 4){
        if($("#viaticos-1").prop("checked") == true){
            var usb1 = 1;
            $("#viaticos-1").prop("checked",true);
            $("#viaticos-2").prop("checked",false);
        }else{
            $("#viaticos-2").prop("checked",false);
            $("#viaticos-1").prop("checked",false);
            var usb1 = 0;
        }
    }

    if(opcion == 1){
        var falla = $('#falla').val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from diagnostico_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into diagnostico_servInd(id_cedula,falla_en) values(?,?)",
                                [id_cedula,falla],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        } else {
                            tx.executeSql("UPDATE diagnostico_servInd  SET falla_en = ? WHERE id_cedula = ?",
                                [falla,id_cedula],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        }  
                    },
                    function (tx, error) {}
                );
            },
            function (error) { },
            function () { }
        );
    }else if(opcion == 2){
        var como = $( "select#Como-select option:checked" ).val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from diagnostico_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into diagnostico_servInd(id_cedula, diagnostico) values(?,?)",
                                [id_cedula,como],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        } else {
                            tx.executeSql("UPDATE diagnostico_servInd SET diagnostico = ? WHERE id_cedula = ?",
                                [como,id_cedula],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        }  
                    },
                    function (tx, error) {}
                );
            },
            function (error) { },
            function () { }
        );
    }else if(opcion == 3){
        var sw = $('#sw').val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from diagnostico_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into diagnostico_servInd(id_cedula, sw) values(?,?)",
                                [id_cedula,sw],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        } else {
                            tx.executeSql("UPDATE diagnostico_servInd SET sw = ? WHERE id_cedula = ?",
                                [sw,id_cedula],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        }  
                    },
                    function (tx, error) {}
                );
            },
            function (error) { },
            function () { }
        );
    }else{
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from diagnostico_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into diagnostico_servInd(id_cedula, usbInfo,usbHa) values(?,?,?)",
                                [id_cedula,usb1,usb2],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        } else {
                            tx.executeSql("UPDATE diagnostico_servInd  SET usbInfo  = ?, usbHa = ? WHERE id_cedula = ?",
                                [usb1,usb2,id_cedula],
                                function (tx, results) {},
                                function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                            );
                        }  
                    },
                    function (tx, error) {}
                );
            },
            function (error) { },
            function () { }
        );
    }
    }
    function equipoPMPCI(){
    /*console.log(results.insertId);
    localStorage.setItem("insertId", results.insertId); */
    var id_cedula=localStorage.getItem("IdCedula");
    var equipoPMP = $("#equipoPMP").val();
    if (equipoPMP==2){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_eq(id_cedula, fase) VALUES (?,?)",
                    [id_cedula,equipoPMP],
                    function(tx, results){
                        app.preloader.hide();
                        console.log(results.insertId);
                        localStorage.setItem("insertId", results.insertId);
                    // swal("","Datos guardados correctamente","success"); 
                    app.views.main.router.back('/recorridoServ10/', {force: true, reload: true});
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else if (equipoPMP==1){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_eq(id_cedula, fase) VALUES (?,?)",
                    [id_cedula,equipoPMP],
                    function(tx, results){
                        app.preloader.hide();
                        console.log(results.insertId);
                        localStorage.setItem("insertId", results.insertId);
                    // swal("","Datos guardados correctamente","success"); 
                    app.views.main.router.back('/recorridoServ11/', {force: true, reload: true});
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }   
    }
    function guardarDatosPMP(){
    //console.log("guardardatso");
    var id_cedula = localStorage.getItem("IdCedula");
    var orden=$('#orden').val();
    var fecha=$('#fecha').val();
    var id_cliente=1;
    var cliente=$('#cliente').val();
    var suc_cliente=$('#suc_cliente').val();
    var direccion=$('#direccion').val();
    var ciudad=$('#ciudad').val();
    var telefono=$('#telefono').val();
    var correo=$('#correo').val();

    if (orden && fecha && id_cliente && cliente && suc_cliente && direccion && ciudad && telefono && correo){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_serv SET no_orden = ?, fecha = ?, id_cliente = ?, cliente = ?, sucursal_cliente = ?, direccion = ?, ciudad = ?, telefono = ?, correo = ? WHERE id_cedula = ?",
                    [orden, fecha, id_cliente, cliente, suc_cliente, direccion, ciudad, telefono, correo ,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                    [cliente ,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#orden').css("background-color", "#ffffff");
                                        $('#fecha').css("background-color", "#ffffff");
                                        $('#cliente').css("background-color", "#ffffff");
                                        $('#suc_cliente').css("background-color", "#ffffff");
                                        $('#direccion').css("background-color", "#ffffff");
                                        $('#ciudad').css("background-color", "#ffffff");
                                        $('#telefono').css("background-color", "#ffffff");
                                        $('#correo').css("background-color", "#ffffff");
                                        $('#tipo_servicio').css("background-color", "#ffffff");
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar datos generales: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar datos generales: " + error.message);
                            },
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }else{
            swal("", "Todos los campos son requeridos" ,"warning");
    }    
    }
    function guardarDiagnosticoPMP(){
    var id_cedula = localStorage.getItem("IdCedula");
    var foto = $("#imagenC").val();
    var fase='diagnosticoPMP';
    var fecha = new Date();
    var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var comentario_cliente = $('#comentario_cliente').val();
    if($("#viaticos-1").prop("checked")){
        var funcionamiento = 1;
    }
    if($("#viaticos-2").prop("checked")){
        var funcionamiento = 0;
    }

    if (funcionamiento && foto && comentario_cliente){//id_cedula integer, foto blob, pregunta text, fase text, observaciones text, fecha_foto text, no_pregunta
        tx.executeSql("insert into fotos_check(id_cedula,foto, fase, fecha_foto) values(?,?,?,?)",
            [id_cedula,foto,fase,fecha_registro],
            function (tx, results) {
                $("#imagenC").val("");
                $("#smallImage").attr('src', 'img/blank.png');
                $("#photoIcon").attr("src", "img/camera.svg");
                swal("", "Se guardaron los datos correctamente", "success");
            },
            function (tx, error) {
                console.error("Error al registrar Resultado: " + error.message);
            }
        );
    }else{
        swal("", "Todos los campos son requeridos" ,"warning");
    }
    }
    function generarPMP1Caliente(){
    /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP_Caliente";
    let tipoCedulas = "PMP1Caliente";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    productHandler.addVisitaServ(id_cedula,tipoCedula);
                    productHandler.addreporteCaliente(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    localStorage.setItem("TipoVisita", tipoCedulas);
                    app.views.main.router.navigate({name: 'recorridoServ8'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
    }
    function generarPMP1Frio(){
    /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP_Frio";
    let tipoCedulas = "PMP1Frio";
    databaseHandler.db.transaction(
    function(tx){
        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
            [tipoCedula,id_cedula],
            function(tx, results){
                localStorage.setItem("TipoVisita", tipoCedulas);
                productHandler.addVisitaServ(id_cedula,tipoCedula);
                productHandler.addreporteFrio(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                localStorage.setItem("TipoVisita", tipoCedulas);
                app.views.main.router.navigate({name: 'recorridoServ7'});
            },
            function(tx, error){
                console.error("Error al actualizar el tipo de cedula: " + error.message);
            }
        );
    },
    function(error){},
    function(){}
    );
    }
    function generarPMP1Rational(){
    console.log('rational');/*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP_Rational";
    let tipoCedulas = "PMP1Rational";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    productHandler.addVisitaServ(id_cedula,tipoCedula);
                    productHandler.addreporteRatinal(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    app.views.main.router.navigate({name: 'recorridoServ9'});
                    localStorage.setItem("TipoVisita", tipoCedulas);
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );

    }
    function generarPMP2(){
    /*
    let id_visita = localStorage.getItem("id_visita");
    let nombre_comercial = localStorage.getItem("nombre_comercial");
    let ciudad = localStorage.getItem("store");
    let direccion = localStorage.getItem("direccion");
    let telefono = localStorage.getItem("telefono");
    let correo = localStorage.getItem("correo");
    let equipo = localStorage.getItem("equipo");
    let marca = localStorage.getItem("marca");
    let modelo = localStorage.getItem("modelo");
    let serie = localStorage.getItem("serie");*/
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    //let orden_servicio = localStorage.getItem("order_number");
    let orden_servicio = "OS321";
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "PMP";
    let tipoCedulas = "PMP2";
    databaseHandler.db.transaction(
    function(tx){
        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
            [tipoCedula,id_cedula],
            function(tx, results){
                productHandler.addVisitaServ(id_cedula,tipoCedula);
                productHandler.addreporteRatinal(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                localStorage.setItem("TipoVisita", tipoCedulas);
                app.views.main.router.navigate({name: 'menuServPMPSOEC'});
            },
            function(tx, error){
                console.error("Error al actualizar el tipo de cedula: " + error.message);
            }
        );
    },
    function(error){},
    function(){}
    );
    }
    function generarHEB(){
    let id_cedula = localStorage.getItem("IdCedula");
    let nombre_cliente = localStorage.getItem("nombreCliente");
    let foto_llegada = localStorage.getItem("foto_llegada");
    let sucursal = localStorage.getItem("sucursal");
    let orden_servicio = localStorage.getItem("order_number");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    let tipoCedula = "HEB";
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                [tipoCedula,id_cedula],
                function(tx, results){
                    productHandler.addVisitaServ(id_cedula,tipoCedula);
                    productHandler.addreporteRatinal(id_cedula, orden_servicio, fecha_llegada, foto_llegada, tipoCedula, nombre_cliente, sucursal);
                    app.views.main.router.navigate({name: 'recorridoServ6'});
                },
                function(tx, error){
                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                }
            );
        },
        function(error){},
        function(){}
    );
    }
    function GCheckPapeleta(nom,id){
    if ($("#"+id).prop("checked")){
        var pregunta = $('#'+id).val();
    }else{pregunta==0;}
    var id_equ = localStorage.getItem("insertId");
    var fase = localStorage.getItem("Faseeq");
    if(nom == 1){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET papeleta = ? WHERE id_datos = ?",
                    [pregunta,id_equ],
                    function(tx, results){
                        if(pregunta == 1){
                            $("#cotizacion-"+fase).css("display","block");
                            $("#cotizacion-3-"+fase).prop("checked", false);
                            $("#cotizacion-2-"+fase).prop("checked", false);
                        }else if (pregunta == 2){
                            $("#cotizacion-"+fase).css("display","none");
                            $("#cotizacion-3-"+fase).prop("checked", false);
                            $("#cotizacion-1-"+fase).prop("checked", false);
                        }else if(pregunta == 3){
                            $("#cotizacion-"+fase).css("display","block");
                            $("#cotizacion-2-"+fase).prop("checked", false);
                            $("#cotizacion-1-"+fase).prop("checked", false);
                        }else{
                            $("#cotizacion-"+fase).css("display","none");
                            $("#cotizacion-3-"+fase).prop("checked", false);
                            $("#cotizacion-2-"+fase).prop("checked", false);
                            $("#cotizacion-1-"+fase).prop("checked", false);
                        }
                        
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else if(nom == 2){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET refacciones = ? WHERE id_datos = ?",
                    [pregunta,id_equ],
                    function(tx, results){
                        if(pregunta == 1){
                            $("#refacciones-"+fase).css("display","block");
                            $("#cotizacion-5-"+fase).prop("checked", false);
                        }else if(pregunta == 2){
                            $("#refacciones-"+fase).css("display","none");
                            $("#cotizacion-4-"+fase).prop("checked", false);
                        }else{
                            $("#refacciones-"+fase).css("display","none");
                            $("#cotizacion-4-"+fase).prop("checked", false);
                            $("#cotizacion-5-"+fase).prop("checked", false);
                        }
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }else if(nom == 3){
        console.log('asas');
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET viaticos = ? WHERE id_datos = ?",
                    [pregunta,id_equ],
                    function(tx, results){  
                        if(pregunta == 1){
                            $("#cotizacion-6-"+fase).prop("checked", true);
                            $("#cotizacion-7-"+fase).prop("checked", false);
                        }else if(pregunta == 2){
                            $("#cotizacion-7-"+fase).prop("checked", true);
                            $("#cotizacion-6-"+fase).prop("checked", false);
                        } else{
                            $("#cotizacion-6-"+fase).prop("checked", false);
                            $("#cotizacion-7-"+fase).prop("checked", false);
                        }
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }   
    }
    function regresarRecorridoServInd4(){
    app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoServInd6(){
    app.views.main.router.back('/recorridoServ6/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoServComedor(){
    app.views.main.router.back('/menuServPMPSOEC/', {force: true, ignoreCache: true, reload: true});
    }
    function equipoinicio(id_datos,fase){
    console.log('id_datos',id_datos)
    console.log('fase',fase)
    localStorage.setItem("insertId", id_datos);
    localStorage.setItem("Faseeq", fase);
    app.views.main.router.back('/formServ34/', {force: true, ignoreCache: true, reload: true}); 
    }
    function equipoinicioPMP(id_datos,fase){
    console.log('id_datos',id_datos)
    console.log('fase',fase)
    localStorage.setItem("insertId", id_datos);
    localStorage.setItem("Faseeq", fase);
    if (fase==1){
        app.views.main.router.back('/recorridoServ11/', {force: true, ignoreCache: true, reload: true}); 
    }else if (fase==2){
        app.views.main.router.back('/recorridoServ10/', {force: true, ignoreCache: true, reload: true}); 
    }

    }
    function equipoeliminar(id_datos){
    console.log('id_datos',id_datos)
    swal({
        title: "Aviso",
        text: "Estas apunto de eliminar todos los datos del equipo, ¿Estas seguro continuar con la acción?",
        icon: "warning",
        buttons: true,
        dangerMode: true,
    })
    .then((willGoBack) => {
        if (willGoBack){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM datos_eq WHERE id_datos = ?",
                        [id_datos],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "DELETE FROM fotos_check WHERE id_equipo = ?",
                                        [id_datos],
                                        function(tx, results){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql(
                                                        "DELETE FROM checklist_servind WHERE id_equipo = ?",
                                                        [id_datos],
                                                        function(tx, results){
                                                            swal("","El registro se elimino satisfactoriamente","success");                     
                                                            $("#fila" + id_datos).remove();
                                                            app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true}); 
                                                        },
                                                        function(tx, error){
                                                            swal("Error al eliminar registro",error.message,"error");
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al eliminar registro",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }});
    }
    function guardarDiagnosticoHEB(){
    var id_cedula = localStorage.getItem("IdCedula");
    if($('input:radio[name=pregunta1]:checked').val() == 1 || $('input:radio[name=pregunta1]:checked').val() == 2){
        var pregunta = $('input:radio[name=pregunta1]:checked').val();
    } else {
        swal("","Para avanzar necesitas contestar la pregunta","warning");
        return false;
    }
    var comentario  = $("#cometario_cliente").val();

    if (comentario){
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("select count(*) as Cuenta from diagnostico_servIndHBE WHERE id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        var item = results.rows.item(0);
                        console.log(item);
                        if (item.Cuenta == 0) {
                            tx.executeSql("insert into diagnostico_servIndHBE(id_cedula,comentario,pregunta ) values(?,?,?)",
                                [id_cedula,comentario,pregunta],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se guardaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );

                        } else {
                            tx.executeSql("UPDATE diagnostico_servIndHBE  SET  comentario = ?, pregunta = ?  WHERE id_cedula = ?",
                                [comentario,pregunta,id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    swal("", "Se actualizaron los datos correctamente", "success");
                                },
                                function (tx, error) {
                                    console.error("Error al registrar Resultado: " + error.message);
                                }
                            );
                        }  
                        $('#cometario_cliente').css("background-color", "#ffffff");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }else{
        swal("", "Todos los campos son requeridos" ,"warning");
    }
    }
    function guardarFotoSERV(fase){
    console.log("Guardar foto FASE ",fase)
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");
    var foto = $("#imagenC"+fase).val();
    var no_pregunta = 0;
    var fecha = new Date();
    var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
    var fases = "";
    if ( fase==22){
        fases="?Cafetera Benn";
    }else if ( fase==23){
        fases="?Capuchinera";
    }else if ( fase == 24){
        fases="?Vitrina de postres";
    }else if ( fase == 25){
        fases="?Rostricero";
    }else if ( fase == 26){
        fases="?Conservador Caliente";
    }else if ( fase == 27){
        fases="?Molino de cafe";
    }else if ( fase == 28){
        fases="?Tostador";
    }else if ( fase == 29){
        fases="";
    }else if ( fase == 30){
        fases="?Vitrina Caliente";
    }else if ( fase == 31){
        fases="?Freidora";
    }else if ( fase == 32){
        fases="?Horno de pizza";
    }else if ( fase == 33){
        fases="?Plancha";
    }else if ( fase == 34){
        fases="?Vitrina Pizza";
    }else if ( fase == 35){
        fases="?Display de pollos";
    }else if ( fase == 36){
        fases="";
    }else if ( fase == 37){
        fases="?Refrigerador";
    }else if ( fase == 38){
        fases="?Mesa fria";
    }else if ( fase == 39){
        fases="?Congelador";
    }else if ( fase == 40){
        fases="?Fabricador de Hielo";
    }
    if (foto){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_check(id_cedula, foto,  fase,  observaciones, fecha_foto, no_pregunta,id_equipo) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula, foto, fase, fases, fecha_foto, no_pregunta,id_equ],
                    function(tx, results){
                        app.preloader.hide();
                        swal("","Datos guardados correctamente","success");
                        $('#imagenC'+fase).val("");
                        //app.sheet.close('#sheet-modal');
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from fotos_check where id_cedula = ? AND fase = ? ORDER BY id_foto DESC",
                                [id_cedula, fase],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        console.log('item',item)
                                        $("#smallImage"+fase).attr("src","img/blank.png");
                                        $("#photoIcon"+fase).attr("src","img/camera.svg");
                                    if (fase == 22){
                                            $("#tabla_hbe22").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 23){
                                            $("#tabla_hbe23").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 24){
                                            $("#tabla_hbe24").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 25){
                                            $("#tabla_hbe25").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 26){
                                            $("#tabla_hbe26").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 27){
                                            $("#tabla_hbe27").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 28){
                                            $("#tabla_hbe28").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 29){
                                            $("#tabla_hbe29").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 30){
                                            $("#tabla_hbe30").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 31){
                                            $("#tabla_hbe31").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 32){
                                            $("#tabla_hbe32").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 33){
                                            $("#tabla_hbe33").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 34){
                                            $("#tabla_hbe34").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 35){
                                            $("#tabla_hbe35").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 36){
                                            $("#tabla_hbe36").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 37){
                                            $("#tabla_hbe37").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 38){
                                            $("#tabla_hbe38").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 39){
                                            $("#tabla_hbe39").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }else if (fase == 40){
                                            $("#tabla_hbe40").append("<tr id='fila"+ item.id_foto +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.no_pregunta + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                        }
                                        $("#message-nr"+fase).css("display", "none");
                                        $('.preloader').remove();
                                        $('.infinite-scroll-preloader').remove();
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        console.log("Error al mostrar datos cedula: " + error.message);
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else{
        swal("", "Debes tomar una fotografía" ,"warning");
    }
    }
    function guardarequipoSERV(fase,no_preguntas){
    var id_cedula = localStorage.getItem("IdCedula");    
    var id_equ = localStorage.getItem("insertId");    
    var marca = $("#marcaeq").val();
    var modelo = $("#modeloeq").val();
    var serie = $("#serieeq").val();
    var id = $("#id").val();
    var volts = $("#volts").val();
    var amp = $("#amp").val();
    var tierra = $("#tierra").val();
    var capacidad = $("#capacidad").val();
    var obs = $("#obs"+fase).val();
    var estatus = $( "#estatuseq"+fase ).val();
    var num = 0;
    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-select").val() == "0"){
        num++;
        }
    }
    for(i = 1;i <= no_preguntas;i++){
        if($("#"+fase+"-"+i+"-input").val() == ""){
        num++;
        }
    }
    if(marca && modelo && serie && id && volts && amp && tierra && capacidad && obs){
        if(num != 0){
            swal({
                title: "Aviso",
                text: "Faltan campos por contestar, ¿Estas seguro que deseas continuar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE datos_eq SET marca = ? ,modelo = ?, serie = ?, numero_id = ?, volts = ?,amp = ?, tierra = ?, breaker = ? , observaciones = ?, estatus = ? WHERE id_datos= ? ",
                                [marca,modelo,serie,id,volts,amp,tierra,capacidad,obs,estatus,id_equ],
                                function(tx, results){
                                    swal("", "Se guardo los datos corrcetamnete", "success");
                                    app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true});
                                },
                                function(tx, error){
                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {}
            });
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_eq SET marca = ? ,modelo = ?, serie = ?, numero_id = ?, volts = ?,amp = ?, tierra = ?, breaker = ? , observaciones = ?, estatus = ?  WHERE id_datos= ? ",
                        [marca,modelo,serie,id,volts,amp,tierra,capacidad,obs,estatus,id_equ],
                        function(tx, results){
                            swal("", "Se guardo los datos corrcetamnete", "success");
                            app.views.main.router.back('/formServ33/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }else{
        swal("", "Faltan datos del equipo por llenar" ,"warning");
    }
    }
    function regresarmenuPMP(){
    app.views.main.router.navigate({name: 'formServ36'});
    }
    function guardarPapeletaServHEB(fase){
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var id_cedula = localStorage.getItem("IdCedula");
    var noParteC = $('#numero_parteC'+fase).val();
    var descripcionC = $('#descripcionC'+fase).val();
    var prioridadC = $('#prioridadC'+fase).val();
    var cantidadC = $('#cantidadC'+fase).val();
    var foto = $("#imagenC"+id_equ).val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

    if(noParteC && descripcionC){
        console.log('prioridadC',prioridadC)
        if (prioridadC == 0){
            swal("", "Selecciona una prioridad" , "warning");
            return false;
        }else{
            if (cantidadC){
                if (foto){
                    console.log("ENTRO")
                    databaseHandler.db.transaction(
                        function(tx){//id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro
                            tx.executeSql("INSERT INTO papeleta(id_cedula, foto_papeleta, numero_parte, descripcion, prioridad, cantidad, fecha_registro,id_equipo) VALUES (?,?,?,?,?,?,?,?)",
                                [id_cedula, foto, noParteC, descripcionC, prioridadC, cantidadC, fecha_reg,id_equ],
                                function(tx, results){
                                    app.preloader.hide();
                                    swal("","Datos guardados correctamente","success");
                                    $("#numero_parteC"+fase).val('');
                                    $('#numero_parteC'+fase).css("background-color", "#ffffff");
                                    $("#descripcionC"+fase).val('');
                                    $('#descripcionC'+fase).css("background-color", "#ffffff");
                                    $("#prioridadC"+fase).val(0);
                                    $("#cantidadC"+fase).val('');
                                    $('#cantidadC'+fase).css("background-color", "#ffffff");
                                    $("#imagenC"+id_equ).val('');
                                    $("#smallImage"+id_equ).attr("src","img/blank.png");
                                    $("#photoIcon"+id_equ).attr("src","img/camera.svg");
                                    console.log("INSERT")
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from papeleta where id_cedula = ? and id_equipo = ? ORDER BY id_papeleta DESC",
                                            [id_cedula,id_equ],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    if (item.prioridad==1){
                                                        prioridad='Seguridad';
                                                    }else if (item.prioridad==2){
                                                        prioridad='Funcionalidad';
                                                    }else if (item.prioridad==3){
                                                        prioridad='Programa';
                                                    }
                                                    $("#table_papeleta"+fase).append("<tr id='fila"+ item.id_papeleta +
                                                    "'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ 
                                                    item.id_papeleta +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                    item.foto_papeleta+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                    item.numero_parte + "</td><td style='text-align: center;'>" + 
                                                    item.descripcion + "</td><td style='text-align: center;'>" + 
                                                    prioridad + "</td><td style='text-align: center;'>" + 
                                                    item.cantidad + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                    app.preloader.hide();
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    app.preloader.hide();
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else{
                    swal("", "Favor de tomar una fotografía" , "warning");
                    return false;
                }
            }else{
                swal("", "Ingresa una Cantidad" , "warning");
                return false;
            }
        }
    }else{
        swal("", "Todos los datos son requeridos" , "warning");
    }
    }
    function guardarRefasServHEB(fase){
    var id_equ = localStorage.getItem("insertId");
    if(!id_equ){ id_equ = 0};
    var id_cedula = localStorage.getItem("IdCedula");
    var noParte = $('#numero_parte'+fase).val();
    var descripcion = $('#descripcion'+fase).val();
    var parte = $('#parte'+fase).val();
    var foto_r = $("#imagenC1"+id_equ).val();
    var fecha = new Date();
    var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

    if(noParte && descripcion && parte){
        if (foto_r){
            
            databaseHandler.db.transaction(
                function(tx){//id_refaccion, id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro
                    tx.executeSql("INSERT INTO refacciones(id_cedula, foto_refa, numero_parte, descripcion, parte, fecha_registro,id_equipo) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, foto_r, noParte, descripcion, parte, fecha_reg,id_equ],
                        function(tx, results){
                            app.preloader.hide();
                            swal("","Datos guardados correctamente","success");
                            $("#numero_parte").val('');
                            $('#numero_parte').css("background-color", "#ffffff");
                            $("#descripcion").val('');
                            $('#descripcion').css("background-color", "#ffffff");
                            $("#parte").val('');
                            $('#parte').css("background-color", "#ffffff");
                            $("#imagenC1"+id_equ).val('');
                            $("#smallImage1"+id_equ).attr("src","img/blank.png");
                            $("#photoIcon1"+id_equ).attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from refacciones where id_cedula = ? and id_equipo = ? ORDER BY id_refaccion DESC",
                                    [id_cedula,id_equ],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#tabla_refacciones"+fase).append("<tr id='fila"+ item.id_refaccion +
                                            "'><td><a href='#' onclick='eliminarFilaServ("+ 
                                            item.id_refaccion +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                            item.foto_refa +"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                            item.numero_parte + "</td><td style='text-align: center;'>" + 
                                            item.descripcion + "</td><td style='text-align: center;'>" + 
                                            item.parte + "</td></tr>");
                                            $("#message-nr1").css("display", "none");
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            console.log("Error al guardar cedula: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            app.preloader.hide();
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );

        }else{
            swal("", "Favor de tomar una fotografía" , "warning");
            return false;
        }
    }else{
        swal("", "Todos los datos son requeridos" , "warning");
    }
    }
    function equipoHEB(){
    var id_cedula = localStorage.getItem("IdCedula");
    var select = $( "#seleEquipo" ).val();
    localStorage.setItem("Faseeq", select);       
    if(select != 0){
        if(select != 29 && select != 36){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_eq(id_cedula,fase) VALUES (?,?)",
                    [id_cedula,select],
                    function(tx, results){
                        app.preloader.hide();
                        console.log(results.insertId);
                        localStorage.setItem("insertId", results.insertId);
                        // swal("","Datos guardados correctamente","success"); 
                        app.views.main.router.back('/formServ34/', {force: true, ignoreCache: true, reload: true}); 
                    },
                    function(tx, error){
                        app.preloader.hide();
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        }else{
            app.dialog.prompt("Ingrese nombre del equipo", 'FIELD',function (name) {
                var nombre_eq= name;
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO datos_eq(id_cedula,fase,nombre) VALUES (?,?,?)",
                            [id_cedula,select,nombre_eq],
                            function(tx, results){
                                app.preloader.hide();
                                console.log(results.insertId);
                                localStorage.setItem("insertId", results.insertId);
                                // swal("","Datos guardados correctamente","success"); 
                                app.views.main.router.back('/formServ34/', {force: true, ignoreCache: true, reload: true}); 
                            },
                            function(tx, error){
                                app.preloader.hide();
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
                });
        }
    }else{
        swal("", "Debes seleccionar equipo" ,"warning");
    } 
    }
    function guardarReporteGeneralServRe(){
    if($("#tecnico_apoyo").prop("checked") == true){
        var tecnico= 'Apoyo';
        change_tecnico(tecnico);
        app.views.main.router.back('/yamevoyserv3/', {force: true, reload: true});
    }else{
        var tecnico= 'Lider';
        change_tecnico(tecnico);
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","El campo de nombre y firma son obligatorios","warning");
            return false;
        }
        // if($("#imagenC").val() == ""){
        //     swal("","Debes tomar la fotografía del sello para poder continuar","warning");
        //     return false;
        // }
        var foto_sello = $("#imagenC").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET firma_cliente = ?, fecha_cliente = ?, foto_sello = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,foto_sello,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                                    [nombrefirma,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyserv3/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    }
    function guardarCotiza3(){
    var id_cedula = localStorage.getItem("IdCedula");
    var horasT = $('#cantidadTotal').val();
    console.log('Entro');
    if (horasT==0){
        swal({
            title: "Aviso",
            text: "Tus horas totales estan en '0', ¿Estas seguro que deseas continuar?",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                var tipoVisita = localStorage.getItem("TipoVisita");
                if (tipoVisita=='PMP2'){
                    app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                }else{
                    app.views.main.router.back('/cierreServInd4/', {force: true, ignoreCache: true, reload: true});
                }
            } else {}
        });
    }else{
        //H_viaje, H_espera, H_trabajo, H_totales
        var H_viaje=$('#cantidadViaje').val()
        var H_espera=$('#cantidadEspera').val()
        var H_trabajo=$('#cantidadTrabajo').val()
        var H_totales=$('#cantidadTotal').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ? WHERE id_cedula = ?",
                    [H_viaje, H_espera, H_trabajo, H_totales, id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#cantidadViaje').css("background-color", "#ffffff");
                        $('#cantidadEspera').css("background-color", "#ffffff");
                        $('#cantidadTrabajo').css("background-color", "#ffffff");
                        $('#cantidadTotal').css("background-color", "#ffffff");
                        var tipoVisita = localStorage.getItem("TipoVisita");
                        if (tipoVisita=='PMP2'){
                            app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                        }else{
                            app.views.main.router.back('/cierreServInd4/', {force: true, ignoreCache: true, reload: true});
                        }
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }
    }
    function guardarCotiza4(){
    var id_cedula = localStorage.getItem("IdCedula");
    var horasT = $('#cantidadTotal').val();
    console.log('Entro');
    if (horasT==0){
        swal({
            title: "Aviso",
            text: "Tus horas totales estan en '0', ¿Estas seguro que deseas continuar?",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
            } else {}
        });
    }else{
        //H_viaje, H_espera, H_trabajo, H_totales
        var H_viaje=$('#cantidadViaje').val()
        var H_espera=$('#cantidadEspera').val()
        var H_trabajo=$('#cantidadTrabajo').val()
        var H_totales=$('#cantidadTotal').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ? WHERE id_cedula = ?",
                    [H_viaje, H_espera, H_trabajo, H_totales, id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        $('#cantidadViaje').css("background-color", "#ffffff");
                        $('#cantidadEspera').css("background-color", "#ffffff");
                        $('#cantidadTrabajo').css("background-color", "#ffffff");
                        $('#cantidadTotal').css("background-color", "#ffffff");
                        app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }
    }
    function guardarDatoscheckServind4(){
    var id_cedula = localStorage.getItem("IdCedula");
    var id_equ = localStorage.getItem("insertId");    
    var equipo = $("#equipo").val();
    var marca = $("#marca").val();
    var modelo= $("#modelo").val();
    var serie= $("#serie").val();
    var ml= $("#ml").val();
    var volts= $("#volt").val();
    var amp= $("#amp").val();
    var wc= $("#wc").val();
    var tierra= $("#tierra").val();

    if(equipo && marca && modelo && serie && ml && volts && amp && wc && tierra){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_eq SET nombre = ?,marca = ? ,modelo = ?, serie = ?, ml = ?, volts = ?,amp = ?, tierra = ?,wc = ? WHERE id_datos= ? ",
                    [equipo, marca,modelo,serie,ml,volts,amp,tierra,wc,id_equ],
                    function(tx, results){
                        swal("", "Se guardo los datos correctamente", "success");
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else{
        swal("", "Faltan datos del equipo por llenar" ,"warning");
    }
    }
    function regresarRecorridoServInd1(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/recorridoServ7/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        app.views.main.router.back('/recorridoServ1/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='PMP2'){
        app.views.main.router.back('/recorridoServ10/', {force: true, ignoreCache: true, reload: true});
    }
    }
    function regresarRecorridoServInd2(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/recorridoServ8/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from visita_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        let length = results.rows.length;
                        var item = results.rows.item(0);
                        var tipo_servicio = item.type_equipo;
                        if (tipo_servicio == 'Caliente'){
                            app.views.main.router.back('/recorridoServ2/', {force: true, ignoreCache: true, reload: true});
                        }else if (tipo_servicio == 'Frio'){
                            app.views.main.router.back('/recorridoServ1/', {force: true, ignoreCache: true, reload: true});
                        }else if (tipo_servicio == 'Rational'){
                            app.views.main.router.back('/recorridoServ3/', {force: true, ignoreCache: true, reload: true});
                        }else if (tipo_servicio == 'HEB'){
                            app.views.main.router.back('/recorridoServ6/', {force: true, ignoreCache: true, reload: true});
                        }else if (tipo_servicio == 'PMP'){
                            app.views.main.router.back('/menuServPMPSOEC/', {force: true, ignoreCache: true, reload: true});
                        }
                    },
                    function(tx, error){
                        console.log("Error: " + error.message);
                    }
                );  
            },
            function(error){
                console.log("Error: " + error.message);
            },
            function(){}
        );
    }else if (tipoVisita=='PMP2'){
        app.views.main.router.back('/recorridoServ11/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/recorridoServ7/', {force: true, ignoreCache: true, reload: true});
    }
    else if (tipoVisita=='PMP1Rational'){
        app.views.main.router.back('/recorridoServ9/', {force: true, ignoreCache: true, reload: true});
    }
    }
    function regresardeEquipoPMP(){//Caliente
    app.views.main.router.back('/recorridoServ11/', {force: true, ignoreCache: true, reload: true});
    }
    function regresardeEquipoPMP1(){//Frio
    app.views.main.router.back('/recorridoServ10/', {force: true, ignoreCache: true, reload: true});
    }
    function moveDatosGenerales(){
    app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }
    function movedatosG(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else  if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        app.views.main.router.back('/formServ1/', {force: true, ignoreCache: true, reload: true});
    }
    }
    function movedatosG1(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else  if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='correctivo'){
        app.views.main.router.back('/formServ11/', {force: true, ignoreCache: true, reload: true});
    }else if (tipoVisita=='PMP1Rational'){
        app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
    }
    }
    function empezarPMP(){
    var tipoVisita = localStorage.getItem("TipoVisita");
    if (tipoVisita=='PMP1Caliente'){
        app.views.main.router.back('/formServ2/', {force: true, ignoreCache: true, reload: true});
    }else  if (tipoVisita=='PMP1Frio'){
        app.views.main.router.back('/formServ12/', {force: true, ignoreCache: true, reload: true});
    } else if (tipoVisita=='PMP2'){
        app.views.main.router.back('/formServ36/', {force: true, ignoreCache: true, reload: true});
    } else if (tipoVisita=='PMP1Rational'){
        app.views.main.router.back('/formServ21/', {force: true, ignoreCache: true, reload: true});
    }
    }
    function reprogramarVisitaServ(){
    var id_cedula = localStorage.getItem("IdCedula");
    var nombre_cliente= $('#suc_cliente').val();
    swal({
        title: "Aviso",
        text: "¿Estas seguro de querer Reprogramar la visita?",
        icon: "warning",
        buttons: true,
        dangerMode: true,
    })
    .then((RESP) => {
        if (RESP == true) {
            app.dialog.prompt("Para reprogramar la visita Ingresa la Sucursal del Cliente. (Respetando mayúsculas y minúsculas)", 'FIELD',function (name) {
                if(name == nombre_cliente){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE visita_servInd SET estatus_ced = 4 WHERE id_cedula = ?",
                                [id_cedula],
                                function(tx, results){
                                    swal("", "Visita reprogramada", "success");
                                },
                                function(tx, error){
                                    console.error("Error al guardar cierre: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                    
                }else{
                    swal("Error al reprogramar la visita.","La Sucursal del Cliente no coincide.","warning");
                }
            });
        } else {}
    });
    }
    function editarFilaServ(index, opc){
    if(opc == 1){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "SELECT * FROM papeleta WHERE id_papeleta = ?",
                    [index],
                    function(tx, results){
                        var item = results.rows.item(0);
                        PopupServ.open();
                        $("#numero_parteP").val(item.numero_parte);
                        $("#descripcionP").val(item.descripcion);
                        $("#prioridadP").val(item.prioridad);
                        $("#motivo_prP").val(item.motivo_pr);
                        $("#cantidadP").val(item.cantidad);
                        $("#id_papeletaP").val(item.id_papeleta);
                    },
                    function(tx, error){
                        swal("Error al actualizar el registro",error.message,"warning");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    }
    var PopupServ = app.popup.create({
    content: `
    <div class="popup FWM-half-modal">
        <div class="my-swipe-to-close-handler" style="padding-top:16px">
            <div class="FWM-bubble-close"></div>
        </div>
        <div class="block">
        <form class="list FWM-fixing-form" style="margin-bottom: 0;">
            <p style="margin-bottom: 10px;margin-top: 0; font-weight: bold;" class="FWN-titulo-2">Edicion de registro:</p>
            <span class="span FWM-span-form">Numero de parte:</span>
            <input type="text" class="FWM-input" id="numero_parteP" name="numero_parte" onchange="inputLleno(this.id,this.value)"/>
            <span class="span FWM-span-form">Descripcion:</span>
            <input type="text" class="FWM-input" id="descripcionP" name="descripcion" onchange="inputLleno(this.id,this.value)"/>
            <span class="span FWM-span-form">Prioridad:</span>
            <select id="prioridadP" style="height:40px;padding-left: 10px;font-size: 16px;font-family: 'ITC Avant Garde Gothic', sans-serif; background-color: white;border: 1px solid gray;border-radius: 8px;margin-bottom: 10px;">
                <option value="0">Seleccione una opcion</option>
                <option value="1">A: Seguridad</option>
                <option value="2">B: Funcionalidad</option>
                <option value="3">C: Programa</option>
            </select>
            <span class="span FWM-span-form">Motivo de la prioridad:</span>
            <textarea class ="FWM-input" id="motivo_prP" name="falla"  cols="30" rows="10" onchange="inputLleno(this.id,this.value)"></textarea>
            <span class="span FWM-span-form">Cantidad:</span>
            <input type="number" class="FWM-input" id="cantidadP" name="cantidadP" onchange="inputLleno(this.id,this.value)"/>
            <input type="hidden" id="id_papeletaP"/>
        </form>

            <div class="FWM-button-modal-container">
                <div class="FWM-button-modal popup-close" onclick="FilaEditadaServ()">Actualizar Registro</div>
            </div>
        </div>
    </div>
    `,
    swipeToClose: true,
    swipeHandler: '.my-swipe-to-close-handler',
    // Events
    on: {
    open: function (popup,text) {
        
    },
    opened: function (popup) {
        
    },
    }
    });
    PopupServ.on('close', function (popup) {});
    function FilaEditadaServ(){
        var id_cedula = localStorage.getItem("IdCedula");
        var id_papeleta = $("#id_papeletaP").val();
        var numero_parte = $("#numero_parteP").val();
        var descripcion = $("#descripcionP").val();
        var prioridad = $("#prioridadP").val();
        var motivo_pr = $("#motivo_prP").val();
        var cantidad = $("#cantidadP").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE papeleta SET numero_parte = ?, descripcion = ?, cantidad = ?, prioridad = ?, motivo_pr = ? WHERE id_papeleta = ?",
                    [numero_parte, descripcion, cantidad, prioridad, motivo_pr, id_papeleta],
                    function(tx, results){//Insert into papeleta
                        swal("","Guardado correctamente","success");
                        $("#id_papeletaP").val('');
                        $("#numero_parteP").val('');
                        $('#numero_parteP').css("background-color", "#ffffff");
                        $("#descripcionP").val('');
                        $('#descripcionP').css("background-color", "#ffffff");
                        $("#cantidadP").val('');
                        $('#cantidadP').css("background-color", "#ffffff");
                        $("#prioridadP").val(0);
                        $("#motivo_prP").val('');
                        $('#motivo_prP').css("background-color", "#ffffff");
                        $("#table_papeleta").empty(""); 
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from papeleta where id_cedula = ?",
                                [id_cedula],
                                    function(tx, results){
                                        let length = results.rows.length;
                                        if (length ==0){
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        }else{
                                            $("#message-nr").css("display", "none");
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                            for(var i = 0; i< length; i++){
                                                var item = results.rows.item(i);
                                                if (item.prioridad==1){
                                                    prioridad='Seguridad';
                                                }else if (item.prioridad==2){
                                                    prioridad='Funcionalidad';
                                                }else if (item.prioridad==3){
                                                    prioridad='Programa';
                                                }
                                                $("#table_papeleta").append("<tr id='fila"+ item.id_papeleta +
                                                "'><td id='tdaccion' style='align-items: center;padding: 0;justify-content: center;text-align: center;'><a href='#' onclick='eliminarFilaServ("+ 
                                                item.id_papeleta +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaServ("+ 
                                                item.id_papeleta +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td><img src='"+
                                                item.foto_papeleta+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                                item.numero_parte + "</td><td style='text-align: center;'>" + 
                                                    item.descripcion + "</td><td style='text-align: center;'>" + 
                                                    prioridad + "</td><td style='text-align: center;'>" + 
                                                    item.motivo_pr + "</td><td style='text-align: center;'>" + 
                                                    item.cantidad + "</td></tr>");
                                            }
                                        }
                                    },
                                    function(tx, error){
                                        console.log("Error al mostrar: " + error.message);
                                    }
                                );
                            },
                            function(error){console.log("Error al mostrar: " + error.message);},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar entrega: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar entrega: " + error.message);
            },
            function(){}
        );
    }
    function LlevarPapeletaServ(){
        swal({
            title: "Aviso",
            text: "¿Estas seguro de querer Enviar tu papaleta en este momento?.",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                swal("Enviando Papeleta!", "Este proceso no deberá tardar mucho!", "success");
                var id_cedula = localStorage.getItem("IdCedula");
                var id_servidor = $('#id_servidor').val();
                var fecha = new Date();
                var fecha_envio = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
            
                var papeleta = new Array();
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("SELECT * from papeleta WHERE id_cedula = ?",
                            [id_cedula],
                            function(tx, results){
                                var length = results.rows.length;
                                if (length == 0){
                                    swal({
                                        title: "Aviso",
                                        text: "Aún no tienes datos en la papaleta. ¿De verdad estas seguro de querer enviarla así?.",
                                        icon: "warning",
                                        buttons: true,
                                        dangerMode: false,
                                    })
                                    .then((willGoBack) => {
                                        if (willGoBack){
                                            databaseHandler.db.transaction(
                                                function(tx8){
                                                    tx8.executeSql(
                                                        "UPDATE visita_servInd SET estatus_ced = 6, fecha_papeleta= ? WHERE id_cedula = ?",
                                                        [fecha_envio,id_cedula],
                                                        function(tx8, results){
                                                            localStorage.setItem("sendFlag", 0);
                                                            swal("Enviado!", "Ya se envio tu papeleta!", "success");
                                                            window.location.href = "./menu.html";
                                                        }
                                                    );
                                                }
                                            );
                                        } else {}
                                    });
                                }else{
                                    for(var i = 0; i< length; i++){
                                        var item7 = results.rows.item(i);
                                        papeleta[i] = {'Valor':i,
                                        'cantidad':item7.cantidad,
                                        'descripcion': item7.descripcion,
                                        'fecha_registro': item7.fecha_registro,
                                        'foto_papeleta':item7.foto_papeleta,
                                        'id_papeleta':item7.id_papeleta,
                                        'numero_parte':item7.numero_parte,
                                        'prioridad':item7.prioridad,
                                        'motivo_pr':item7.motivo_pr,
                                        'id_cedula':id_servidor,
                                        'fecha_envio':fecha_envio};
                                    }
                                    $.ajax({
                                        type: "POST",
                                        async : true,
                                        url: "http://www.appbennetts.com/FWM2/app/guardarPapelServ.php",
                                        dataType: 'html',
                                        data: {'papeleta': JSON.stringify(papeleta)},
                                        success: function(respuesta){
                                            var respu1 = respuesta.split("._.");
                                            var dat1 = respu1[0];
                                            var dat2 = respu1[1];
                                            if(dat1 == "CEDULA"){
                                                if(dat2 > 0){
                                                    databaseHandler.db.transaction(
                                                        function(tx8){
                                                            tx8.executeSql(
                                                                "UPDATE visita_servInd SET estatus_ced = 5, fecha_papeleta= ? WHERE id_cedula = ?",
                                                                [fecha_envio,id_cedula],
                                                                function(tx8, results){
                                                                    localStorage.setItem("sendFlag", 0);
                                                                    localStorage.setItem("mensaje_papel", 1);
                                                                    swal("Enviado!", "Ya se envio tu papeleta!", "success");
                                                                    window.location.href = "./menu.html";
                                                                }
                                                            );
                                                        }
                                                    );
                                                }
                                            } else {
                                                AlmacenarError(respuesta);
                                            }
                                        },
                                        error: function(){
                                            console.log("Error en la comunicacion");
                                        }
                                    });
                                }
                            },
                            function(tx, error){
                                console.log("Error al consultar papeleta: " +error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );  
            } else {}
        });
    }
    function guardarHorasServ(){
        var tipoVisita = localStorage.getItem("TipoVisita");
        var id_cedula = localStorage.getItem("IdCedula");
        var comentarioG=$('#comentarios').val();
        var horasT = $('#cantidadTotal').val();
        if(comentarioG){
            if (horasT==0){
                swal({
                    title: "Aviso",
                    text: "Tus horas totales estan en '0', ¿Estas seguro que deseas continuar?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: false,
                })
                .then((willGoBack) => {
                    if (willGoBack){
                        var H_viaje=0;
                        var H_espera=0;
                        var H_trabajo=0;
                        var H_totales=0;
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ?, comentarios_entrega = ? WHERE id_cedula = ?",
                                    [H_viaje, H_espera, H_trabajo, H_totales,comentarioG, id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        $('#cantidadViaje').css("background-color", "#ffffff");
                                        $('#cantidadEspera').css("background-color", "#ffffff");
                                        $('#cantidadTrabajo').css("background-color", "#ffffff");
                                        $('#cantidadTotal').css("background-color", "#ffffff");
                                        $('#comentarios').css("background-color", "#ffffff");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql(
                                                    "Select * from visita_servInd WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        let length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        var tipo_servicio = item.type_equipo;
                                                        var esttaus_ced = item.estatus_ced
                                                        if (tipo_servicio == 'Caliente'){
                                                            var estatus_ced=item.estatus_ced;
                                                            if (estatus_ced == 4){
                                                                app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                                            }else{
                                                                app.views.main.router.back('/cierreServInd2/', {force: true, ignoreCache: true, reload: true});
                                                            }
                                                        }else if (tipo_servicio == 'Frio'){
                                                            var estatus_ced=item.estatus_ced;
                                                            if (estatus_ced == 4){
                                                                app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                                            }else{
                                                                app.views.main.router.back('/cierreServInd1/', {force: true, ignoreCache: true, reload: true});
                                                            }
                                                        }else if (tipo_servicio == 'Rational'){
                                                            var estatus_ced=item.estatus_ced;
                                                            if (estatus_ced == 4){
                                                                app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                                            }else{
                                                                app.views.main.router.back('/cierreServInd3/', {force: true, ignoreCache: true, reload: true});
                                                            }
                                                        }else if (tipo_servicio == 'HEB'){
                                                            app.views.main.router.back('/cierreServInd4/', {force: true, ignoreCache: true, reload: true});
                                                        }else if(tipo_servicio == 'PMP_Caliente' || tipo_servicio == 'PMP_Frio'){
                                                            app.views.main.router.back('/cierreServInd2/', {force: true, ignoreCache: true, reload: true});
                                                        }else if(tipo_servicio == 'PMP'){
                                                            app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                                                        }
                                                    },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                    }
                                                );  
                                            },
                                            function(error){
                                                console.log("Error: " + error.message);
                                            },
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar entrega: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error al guardar entrega: " + error.message);
                            },
                            function(){}
                        );
                    }else{}
                    });
                
            }else{
                var H_viaje=$('#cantidadViaje').val()
                var H_espera=$('#cantidadEspera').val()
                var H_trabajo=$('#cantidadTrabajo').val()
                var H_totales=$('#cantidadTotal').val()
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE visita_servInd SET H_viaje = ?, H_espera = ?, H_trabajo = ?, H_totales = ?, comentarios_entrega = ? WHERE id_cedula = ?",
                            [H_viaje, H_espera, H_trabajo, H_totales,comentarioG, id_cedula],
                            function(tx, results){
                                swal("","Guardado correctamente","success");
                                $('#cantidadViaje').css("background-color", "#ffffff");
                                $('#cantidadEspera').css("background-color", "#ffffff");
                                $('#cantidadTrabajo').css("background-color", "#ffffff");
                                $('#cantidadTotal').css("background-color", "#ffffff");
                                $('#comentarios').css("background-color", "#ffffff");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from visita_servInd WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                let length = results.rows.length;
                                                var item = results.rows.item(0);
                                                var estatus_ced=item.estatus_ced;
                                                var tipo_servicio = item.type_equipo;
                                                if (tipo_servicio == 'Caliente'){
                                                    if (estatus_ced == 4){
                                                        app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                                    }else{
                                                        app.views.main.router.back('/cierreServInd2/', {force: true, ignoreCache: true, reload: true});
                                                    }
                                                }else if (tipo_servicio == 'Frio'){
                                                    var estatus_ced=item.estatus_ced;
                                                    if (estatus_ced == 4){
                                                        app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                                    }else{
                                                        app.views.main.router.back('/cierreServInd1/', {force: true, ignoreCache: true, reload: true});
                                                    }
                                                }else if (tipo_servicio == 'Rational'){
                                                    var estatus_ced=item.estatus_ced;
                                                    if (estatus_ced == 4){
                                                        app.views.main.router.back('/yamevoyserv2/', {force: true, reload: true});
                                                    }else{
                                                        app.views.main.router.back('/cierreServInd3/', {force: true, ignoreCache: true, reload: true});
                                                    }
                                                }else if (tipo_servicio == 'HEB'){
                                                    app.views.main.router.back('/cierreServInd4/', {force: true, ignoreCache: true, reload: true});
                                                }else if(tipo_servicio == 'PMP_Caliente' || tipo_servicio == 'PMP_Frio'){
                                                    app.views.main.router.back('/cierreServInd2/', {force: true, ignoreCache: true, reload: true});
                                                }else if(tipo_servicio == 'PMP'){
                                                    app.views.main.router.back('/cierreServInd5/', {force: true, ignoreCache: true, reload: true});
                                                }
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                            }
                                        );  
                                    },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al guardar entrega: " + error.message);
                            }
                        );
                    },
                    function(error){
                        console.error("Error al guardar entrega: " + error.message);
                    },
                    function(){}
                );
            }
        }else{
            swal("", "Favor de ingresar un comentario general." , "warning");
        }
    }
    function moveReprogramado(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from visita_servInd WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        let length = results.rows.length;
                        var item = results.rows.item(0);
                        var estatus_ced=item.estatus_ced;
                        var tipo_servicio = item.type_equipo;
                        if (tipo_servicio == 'Caliente'){
                            if (estatus_ced == 4){
                                app.views.main.router.back('/formServ40/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/formServ1/', {force: true, ignoreCache: true, reload: true});
                            }
                        }else if (tipo_servicio == 'Frio'){
                            if (estatus_ced == 4){
                                app.views.main.router.back('/formServ40/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/formServ11/', {force: true, ignoreCache: true, reload: true});
                            }
                        }else if (tipo_servicio == 'Rational'){
                            if (estatus_ced == 4){
                                app.views.main.router.back('/formServ40/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/formServ20/', {force: true, ignoreCache: true, reload: true});
                            }
                        }else if (tipo_servicio == 'HEB'){
                            if (estatus_ced == 4){
                                app.views.main.router.back('/formServ40/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/diagnosticoHEB/', {force: true, ignoreCache: true, reload: true});
                            }
                        }else if(tipo_servicio == 'PMP_Caliente' || tipo_servicio == 'PMP_Frio'){
                            if (estatus_ced == 4){
                                app.views.main.router.back('/formServ40/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
                            }
                        }else if(tipo_servicio == 'PMP_Rational'){
                            if (estatus_ced == 4){
                                app.views.main.router.back('/formServ40/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/diagnosticoHEB3/', {force: true, ignoreCache: true, reload: true});
                            }
                        }else if(tipo_servicio == 'PMP'){
                            if (estatus_ced == 4){
                                app.views.main.router.back('/formServ41/', {force: true, ignoreCache: true, reload: true});
                            }else{
                                app.views.main.router.back('/diagnosticoHEB1/', {force: true, ignoreCache: true, reload: true});
                            }
                        }
                    },
                    function(tx, error){
                        console.log("Error: " + error.message);
                        app.preloader.hide();  
                    }
                );  
            },
            function(error){
                console.log("Error: " + error.message);
            },
            function(){}
        );
    }
    function guardarPapeletaPendienteServ(){
        var id_cedula = localStorage.getItem("IdCedula");
        var id_equ = localStorage.getItem("insertId");
        if(!id_equ){ id_equ = 0};
        var noParteC = $('#numero_parteC').val();
        var descripcionC = $('#descripcionC').val();
        var prioridadC = $('#prioridadC').val();
        var cantidadC = $('#cantidadC').val();
        //var foto = $("#imagenC").val();
        var motivo_pr = $("#motivo_pr").val();
        var fecha = new Date();
        var fecha_reg = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        if(noParteC && descripcionC && motivo_pr){
            if (prioridadC == 0){
                swal("", "Todos los datos son requeridos." , "warning");
                return false;
            }else{
                if (cantidadC){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO papeleta(id_cedula, numero_parte, descripcion, prioridad, cantidad, fecha_registro, motivo_pr, id_equipo) VALUES (?,?,?,?,?,?,?,?)",
                                    [id_cedula, noParteC, descripcionC, prioridadC, cantidadC, fecha_reg, motivo_pr, id_equ],
                                    function(tx, results){
                                        swal("","Datos guardados correctamente","success");
                                        $("#numero_parteC").val('');
                                        $('#numero_parteC').css("background-color", "#ffffff");
                                        $("#descripcionC").val('');
                                        $('#descripcionC').css("background-color", "#ffffff");
                                        $("#prioridadC").val(0);
                                        $("#cantidadC").val('');
                                        $('#cantidadC').css("background-color", "#ffffff");
                                        $("#motivo_pr").val('');
                                        $("#motivo_pr").css("background-color", "#ffffff");
                                        $("#table_papeleta").empty(""); 
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from papeleta where id_cedula = ?",
                                                [id_cedula],
                                                    function(tx, results){
                                                        let length = results.rows.length;
                                                        if (length ==0){
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }else{
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                            for(var i = 0; i< length; i++){
                                                                var item = results.rows.item(i);
                                                                if (item.prioridad==1){
                                                                    prioridad='Seguridad';
                                                                }else if (item.prioridad==2){
                                                                    prioridad='Funcionalidad';
                                                                }else if (item.prioridad==3){
                                                                    prioridad='Programa';
                                                                }
                                                                if(item.foto_papeleta){
                                                                    var foto="<img src='"+item.foto_papeleta+"' width='60px' style='margin-top: 4px;'/>";
                                                                }else{
                                                                    var foto = "Sin evidencia";
                                                                }
                                                                $("#table_papeleta").append("<tr id='fila"+ item.id_papeleta +
                                                                "'><td id='tdaccion' style='align-items: center;padding: 0;justify-content: center;text-align: center;'><a href='#' onclick='eliminarFilaServ("+ 
                                                                item.id_papeleta +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><a href='#' onclick='editarFilaServ("+ 
                                                                item.id_papeleta +",1);' style='border: none; outline:none;'><img src='img/editar.svg' width='27px' style='margin-top:10%'/></a></td><td>"+
                                                                foto+"</td><td style='text-align: center;'>" + 
                                                                item.numero_parte + "</td><td style='text-align: center;'>" + 
                                                                    item.descripcion + "</td><td style='text-align: center;'>" + 
                                                                    prioridad + "</td><td style='text-align: center;'>" + 
                                                                    item.motivo_pr + "</td><td style='text-align: center;'>" + 
                                                                    item.cantidad + "</td></tr>");
                                                            }
                                                        }
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al mostrar: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){console.log("Error al mostrar: " + error.message);},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        app.preloader.hide();
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                }else{
                    swal("", "Todos los datos son requeridos." , "warning");
                    return false;
                }
            }
        }else{
            swal("", "Todos los datos son requeridos." , "warning");
        }
    }
    function moveMenuServ(){
        var utlimahora="23:59:59";
        var fecha = new Date();
        var hora_actual = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var day = fecha.getDay();
        if (day == 6 && hora_actual > "14:00:00" || day == 0 && hora_actual < "23:59:59"){
            // console.log('sabado despues de las 2');
            // console.log('ó');
            // console.log('domingo antes de ser lunes');
            moveProgram();
        }else{
            moveProgram();
            // console.log('día habil');
            //app.views.main.router.navigate({ name: 'yallegueServInd'});
        }
    }
    function regresarpapeleta(){
        app.views.main.router.back('/continuar_papeleta/', {force: true, ignoreCache: true, reload: true});
    }
    function tecnico_apoyo(){
        if($("#tecnico_apoyo").prop("checked") == true){
            $("#cierre").css("display", "none");
            var tecnico= 'Apoyo';
            change_tecnico(tecnico);
        }else{
            $("#cierre").css("display", "block");
            var tecnico= 'Lider';
            change_tecnico(tecnico);
        }
    }
    function change_tecnico(tecnico){
        var id_cedula = localStorage.getItem("IdCedula");
        console.log(tecnico);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_serv SET tecnico = ? WHERE id_cedula = ?",
                    [tecnico ,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar datos generales: " + error.message);
            },
            function(){}
        );
    }
    function estatus_os(estatus,id_cedula){
        // console.log(estatus,id_cedula);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visita_servInd SET estatus_ced = ? WHERE id_cedula = ?",
                    [estatus,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error :" + error.message);
                    }
                );
            },
            function(error){console.error("Error :" + error.message);}
        );
    }
    function formatDate(date) {
        var d = new Date(date),
            month = '' + (d.getMonth() + 1),
            day = '' + d.getDate(),
            year = d.getFullYear();

        if (month.length < 2) 
            month = '0' + month;
        if (day.length < 2) 
            day = '0' + day;

        return [day, month, year].join('-');
    }
    function moveRational(){
        app.views.main.router.back('/formServ20/', {force: true, ignoreCache: true, reload: true});
    }
    function transformadorRational(opcion){
        var id_cedula=localStorage.getItem("IdCedula");
        if($("#transformadores_rational").prop("checked")==true){
            var transformadores_rational = 1;
        }else {
            var transformadores_rational = 0;
        }
        
        if($("#fusibles_rational").prop("checked")==true){
            var fusibles_rational = 1;
        }else {
            var fusibles_rational = 0;
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE visita_servInd SET transformadores_rational = ?, fusibles_rational = ? WHERE id_cedula = ?",
                    [transformadores_rational,fusibles_rational,id_cedula],
                    function (tx, results) {},
                    function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                );
            },
            function (error) { },
            function () { }
        );
    }
    function SistemadeGasServ(opcion){
        var id_cedula=localStorage.getItem("IdCedula");
        if($("#21-G20-check").prop("checked")==true){
            var Gas20 = 1;
        }else {
            var Gas20 = 0;
        }
        
        if($("#21-G30-check").prop("checked")==true){
            var Gas30 = 1;
        }else {
            var Gas30 = 0;
        }
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE visita_servInd SET gas_30 = ?, gas_20 = ? WHERE id_cedula = ?",
                    [Gas30,Gas20,id_cedula],
                    function (tx, results) {},
                    function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardar_observacion_rational(){
        var id_cedula=localStorage.getItem("IdCedula");
        var observacion_rational = $("#observacion_rational").val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE visita_servInd SET observacion_rational = ? WHERE id_cedula = ?",
                    [observacion_rational,id_cedula],
                    function (tx, results) {},
                    function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarFotosPosterioresServ(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if (foto){
            databaseHandler.db.transaction(
                function (tx) {
                    tx.executeSql("Insert into fotos_posteriores(id_cedula,foto,fecha_registro) values(?,?,?)",
                    [id_cedula,foto,fecha_registro],
                    function (tx, results) {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from fotos_posteriores where id_cedula = ? ORDER BY id_evidencia DESC",
                                [id_cedula],
                                    function(tx, results){
                                        let length = results.rows.length;
                                        $("#imagenC").val("");                                           
                                        $("#smallImage").attr("src","img/blank.png");
                                        $("#photoIcon").attr("src","img/camera.svg");
                                        $("#message-nr").css("display", "none");
                                        var item = results.rows.item(0);
                                        $("#tabla_diagnostico").append("<tr id='fila"+ item.id_evidencia +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaServ("+ item.id_evidencia +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                        swal("", "Se guardo la foto", "success");
                                    },
                                    function(tx, error){
                                        console.log("Error al mostrar datos cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){console.log("Error al mostrar datos cedula: " + error.message);},
                            function(){}
                        );
                    },
                    function (tx, error) {
                        console.error("Error al registrar Resultado: " + error.message);
                    }
                    );
                },
                function (error) { },
                function () { });
        }else{
            swal("", "Debes de tomar fotografia" ,"warning");
        }
    }    
    function form1ServInd(){
        app.views.main.router.back('/datosgeneralesServ1/', {force: true, ignoreCache: true, reload: true});
    }
    function llenaInputHoras(id,valor){
        if(id==1){
            var horas =$("#selec_h_viaje").val();
            var minutos = $("#selec_m_viaje").val();
            $("#cantidadViaje").val(horas+":"+minutos);
        }else if(id==2){
            var horas =$("#selec_h_espera").val();
            var minutos = $("#selec_m_espera").val();
            $("#cantidadEspera").val(horas+":"+minutos);
        }else if(id==3){
            var horas =$("#selec_h_trabajo").val();
            var minutos = $("#selec_m_trabajo").val();
            $("#cantidadTrabajo").val(horas+":"+minutos);
        }
        Sumahoras();
    }
    function clientSelected3(clientName,tipo_serv,orden_servicio){
        localStorage.setItem("orden_servicio",orden_servicio);
        localStorage.setItem("category",tipo_serv);
        app.views.main.router.navigate({name: 'calendar-page-serv'});
    }
    //Fin ServInd
    // Inicio MT
    function buscarClienteMT(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#IdCliente").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var puesto_contacto = $("#puesto_contacto").val();
        var telefono_contacto = $("#telefono_contacto").val();
        var correo_contacto = $("#correo_contacto").val();
        var horario_programado = fecha_llegada;
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var tipo = "Visita";
        var estatus = 0;
        if(nombre_cliente != ''){
            productHandler.addCedulaCompleta(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus,tipo);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            var item = results.rows.item(0);
                            localStorage.setItem("IdCedula", item.Id);
                            productHandler.addDatosMT(item.Id,nombre_cliente,nombre_contacto,puesto_contacto,telefono_contacto,correo_contacto);
                            app.views.main.router.navigate({name: 'recorridoMT1'});
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "El nombre del cliente es requerido, por favor colocalo para poder iniciar." ,"warning");
            app.preloader.hide();
        }
    }
    function regresarRecorridoMT1(){
        app.views.main.router.back('/recorridoMT1/', {force: true, ignoreCache: true, reload: true});
    }
    function continuarCedMT(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoMT1'});
        }
    }
    function terminarVisitaMT(){
        // var id_cedula = localStorage.getItem("IdCedula");
        // var fecha = new Date();
        // var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        // var ubicacion_salida = $('#geolocation').val();
        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
        //             [fecha_salida,ubicacion_salida,estatus,id_cedula],
        //             function(tx, results){
                        window.location.href = "./menu.html";
        //             },
        //             function(tx, error){
        //                 swal("Error al guardar",error.message,"error");
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    // Fin MT
       //Inicio Carnes Ideal
    function buscarClienteCI(){
        var division = localStorage.getItem("division");
        if(division == 1){
            if($("#id_visita").val()){
            }else{
                swal("","Debes seleccionar un cliente de la lista","warning");
                return false;
            }
            var foto_temp_caja = $("#imagenC1").val();
        }else{
            if($("#id_cliente").val()){
            }else{
                swal("","Debes seleccionar un cliente de la lista","warning");
                return false;
            }
            var foto_temp_caja = "na";
        }

        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        
            var id_visita = $("#id_visita").val();
            var documento = $("#documento").val();
            var comanda = $("#comanda").val();
            var fecha = $("#fecha").val();
            var contacto = $("#contacto").val();
            
            var id_cliente = $("#id_cliente").val();
            var nombre = $("#nombre_contacto").val();
            var telefono = $("#telefono").val();
            var correo = $("#correo").val();
            var medio_conocido = $("#medio_conocido").val();
            var otro_medio = $("#otro_medio").val();
            var potencia_kg = $("#potencia_kg").val();
            var negocio = $("#nombre").val();
            var ubicacion = $("#ubicacion").val();
            var medio_contacto = $("#medio_contacto").val();
            var problematica = $("#problematica").val();
            var proveedor_actual = $("#proveedor_actual").val();
            var potencia_correcta = $("#potencia_correcta").val();
            var ubicacion_correcta = $("#ubicacion_correcta").val();

        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        if(division == 1){}else{
            if(foto_llegada){
            }else{
                foto_llegada = "Sin foto venta";
            }
        }
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(foto_temp_caja != ''){
                if(nombre_cliente != ''){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    localStorage.setItem("IdCedula", item.Id);
                                    localStorage.setItem("nombre_contacto", nombre);
                                    localStorage.setItem("telefono", telefono);
                                    localStorage.setItem("correo", correo);
                                    localStorage.setItem("medio_conocido", medio_conocido);
                                    localStorage.setItem("otro_medio", otro_medio);
                                    localStorage.setItem("potencia_kg", potencia_kg);
                                    localStorage.setItem("negocio", negocio);
                                    localStorage.setItem("ubicacion", ubicacion);
                                    localStorage.setItem("medio_contacto", medio_contacto);
                                    localStorage.setItem("id_cliente", id_cliente);
                                    localStorage.setItem("problematica", problematica);
                                    localStorage.setItem("proveedor_actual", proveedor_actual);
                                    localStorage.setItem("potencia_correcta", potencia_correcta);
                                    localStorage.setItem("ubicacion_correcta", ubicacion_correcta); 
                                    localStorage.setItem("foto_llegada", foto_llegada); 
                                    
                                    localStorage.setItem("nombre_comercial", nombre_cliente);
                                    localStorage.setItem("documento", documento);
                                    localStorage.setItem("comanda", comanda);
                                    localStorage.setItem("fecha", fecha);
                                    localStorage.setItem("id_visita", id_visita);
                                    localStorage.setItem("contacto", contacto);
                                                                
                                    app.views.main.router.navigate({name: 'menuCI'});
                                    app.preloader.hide();
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    swal("Falta un campo", "El nombre del cliente es requerido, por favor colocalo para poder iniciar." ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "La fotografía de la temperatura de la caja es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function regresarRecorridoCI1(){
        app.views.main.router.back('/recorridoCI/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoCI2(){
        app.views.main.router.back('/recorridoCI2/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoCI4(){
        app.views.main.router.back('/recorridoCI4/', {force: true, ignoreCache: true, reload: true});
    }
    function temperaturaLlena(id,value){
        id = "#"+id;
        if(value > 4){
            $(id).css("background-color","#fb2c2c");
            $(id).css("color","white");
        } else {
            $(id).css("background-color","#E0F8F7");
            $(id).css("color","black");
        }
    }
    function generarEntregaCI(){
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_cliente = localStorage.getItem("nombre_comercial");
        var nombre_contacto = localStorage.getItem("contacto");
        //var nombre_contacto = "contacto";
        var foto_llegada = $("#imagenC").val();
        var foto_temp_caja = $("#imagenC1").val();
        var id_cliente = localStorage.getItem("id_cliente");
        var orden = localStorage.getItem("documento");
        var comanda = localStorage.getItem("comanda");
        var tipoCedula = "Entrega";
        productHandler.addDatosCI(id_cedula,nombre_cliente,nombre_contacto,foto_llegada,foto_temp_caja,orden,comanda);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        app.views.main.router.navigate({name: 'recorridoCI'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarVentaCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoCedula = "Venta";
        var nombre = localStorage.getItem("nombre_contacto");
        var telefono = localStorage.getItem("telefono");
        var correo = localStorage.getItem("correo");
        var medio_conocido = localStorage.getItem("medio_conocido");
        var otro_medio = localStorage.getItem("otro_medio");
        var potencia_kg = localStorage.getItem("potencia_kg");
        var negocio = localStorage.getItem("negocio");
        var ubicacion = localStorage.getItem("ubicacion");
        var medio_contacto = localStorage.getItem("medio_contacto");
        var id_cliente = localStorage.getItem("id_cliente");
        var proveedor_actual = localStorage.getItem("proveedor_actual");
        var problematica = localStorage.getItem("problematica");
        var potencia_correcta = localStorage.getItem("potencia_correcta");
        var ubicacion_correcta = localStorage.getItem("ubicacion_correcta");
        var foto_llegada = localStorage.getItem("foto_llegada");
        var muestras = false;
        var enviado = 1;
        productHandler.addDatosVentaCI(id_cedula,nombre,telefono,correo,medio_conocido,potencia_kg,negocio,ubicacion,medio_contacto,otro_medio,id_cliente,foto_llegada);
        productHandler.addDatosVisitaCI(id_cedula,proveedor_actual,problematica,potencia_correcta,ubicacion_correcta);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        var NomDescCli = "get_prospectos_ci_desc";
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
                            var content = JSON.parse(data);
                            var content4 = content[2];
                            var content5 = content[3];
                            for(var x = 0; x < content4.length; x++) {
                                if(content4[x].id == id_cliente){
                                    productHandler.addProductosCI(id_cedula,content4[x].producto,content4[x].precio,content4[x].kilos,content4[x].observaciones,content4[x].foto_producto,content4[x].fecha_registro,enviado);
                                }         
                            }
                            for(var x = 0; x < content5.length; x++) {
                                if(content5[x].id == id_cliente){
                                    productHandler.addfotosCi(id_cedula,content5[x].foto,content5[x].comentarios,content5[x].fecha_evidencia,content5[x].fase,content5[x].apartado,enviado);
                                }
                            }
                        });
                        app.views.main.router.navigate({name: 'recorridoCI2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function Prospecto_CI(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#IdCliente").val();
        
        var horario_programado = fecha_llegada;
        var nombre_cliente = "Nuevo Prospecto";
        var estatus = 0;
        productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                    [],
                    function(tx, results){
                        var item = results.rows.item(0);
                        localStorage.setItem("IdCedula", item.Id);
                        var tipoCedula = "Venta";
                        var id_cedula = item.Id;
                        productHandler.addDatosVentaCI1(id_cedula);
                        productHandler.addDatosVisitaCI1(id_cedula);
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        app.views.main.router.navigate({name: 'recorridoCI2'});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarPrimerVisitaCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
	        var potencia_correcta = 2;
            var ubicacion_correcta = 2;
            if($("#tipo_visita").val()==0){swal("","Debes seleccionar el tipo de visita","warning"); return false;}else{}
            if($("#tipo0-1").prop("checked") == true){
                potencia_correcta = 0;
            }else if($("#tipo1-1").prop("checked") == true){
                potencia_correcta = 1;
            }
            if(potencia_correcta == 2){
                swal("","Debes indicar si la potencia es correcta","warning"); return false;
            }
            if($("#tipo0-2").prop("checked") == true){
                ubicacion_correcta = 0;
            }else if($("#tipo1-2").prop("checked") == true){
                ubicacion_correcta = 1;
            }
            if(ubicacion_correcta == 2){
                swal("","Debes indicar si la ubicación es correcta","warning"); return false;
            }
            if($("#problematica").val()){}else{swal("","Debes llenar el campo de la problemática","warning"); return false;}
            var tipo_visita = $("#tipo_visita").val();
            var potencia = $("#potencia").val();
            var ubicacion = $("#ubicacion").val();
            var proveedor_actual = $("#proveedor_actual").val();
            var problematica = $("#problematica").val();
            var comentarios = "Foto de carta general";
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitas_ci SET tipo_visita = ?, potencia = ?, ubicacion = ?, proveedor_actual = ?, problematica = ?, potencia_correcta = ?, ubicacion_correcta = ? WHERE id_cedula = ?",
                        [tipo_visita, potencia, ubicacion, proveedor_actual, problematica, potencia_correcta, ubicacion_correcta,id_cedula],
                        function(tx, results){
                            if($("#imagenC").val()){
                                var foto =$("#imagenC").val();
                                databaseHandler.db.transaction(
                                    function(tx){//id_evidencia integer primary key,id_cedula integer,foto blob,comentarios text,fecha_evidencia text,fase text, apartado text
                                        tx.executeSql("INSERT INTO fotos_ci(id_cedula,foto,comentarios,fecha_evidencia,fase,apartado) VALUES (?,?,?,?,?,?)",
                                            [id_cedula,foto,comentarios,fecha_registro,2,2],
                                            function(tx, results){
                                                databaseHandler.db.transaction(
                                                    function(tx1){
                                                        tx1.executeSql(
                                                            "Select * from fotos_ci where id_cedula= ? AND fase = 2 AND apartado = 2 ORDER BY id_evidencia DESC",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var item = results.rows.item(0);
                                                                $("#VentasBennetts_content").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_evidencia + "</td></tr>");
                                                                $("#message-nr").css("display", "none");
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                            }
                                        );
                                    },function(error){},function(){
                                    }
                                );
                            }
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#potencia").css("background-color", "#FFFFFF");
                            $("#ubicacion").css("background-color", "#FFFFFF");
                            $("#proveedor_actual").css("background-color", "#FFFFFF");
                            $("#problematica").css("background-color", "#FFFFFF");
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                            $("#imagenC").val("");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarFotoFacturaCI(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC3").val();
        if(foto){
            var comentarios = "Foto factura";
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){//id_evidencia integer primary key,id_cedula integer,foto blob,comentarios text,fecha_evidencia text,fase text, apartado text
                    tx.executeSql("INSERT INTO fotos_ci(id_cedula,foto,comentarios,fecha_evidencia,fase,apartado) VALUES (?,?,?,?,?,?)",
                        [id_cedula,foto,comentarios,fecha_registro,4,1],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from fotos_ci where id_cedula= ? AND fase = 4 AND apartado = 1 ORDER BY id_evidencia DESC",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            var item = results.rows.item(0);
                                            $("#smallImage3").attr("src","img/blank.png");
                                            $("#photoIcon3").attr("src","img/camera.svg");
                                            $("#imagenC3").val('');
                                            swal("","Foto guardada correctamente","success");
                                            $("#facturas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaCi("+item.id_evidencia +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_evidencia + "</td></tr>");
                                            $("#message-nr").css("display", "none");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                        }
                    );
                },function(error){},function(){
                }
            );
        }else{
            swal("","Debes tomar una fotografía de la factura(s):", "warning");
        }
    }
    function guardarTemperaturaCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var anomalia = 2;
            
            if($("#tipo0").prop("checked") == true){
                anomalia = 0;
            }else if($("#tipo1").prop("checked") == true){
                anomalia = 1;
            }
            if(anomalia == 2){
                swal("","Debes indicar si existió alguna anomalía","warning");
            }else{
                var id_cedula = localStorage.getItem("IdCedula");
                var fecha = new Date();
                var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                var temp_entregado = $("#temp_entregado").val();
                var peso_cliente = $("#peso_cliente").val();
                var foto_temp_producto = $("#imagenC1").val();
                var foto_peso = $("#imagenC2").val();
                var foto='';
                var comentarios = '';
                if(foto_temp_producto){}else{
                    swal("","Debes tomar la fotografía de la temperatura del producto","warning");
                    return false;
                }
                if(anomalia == 1){
                    if($("#comunes_anomalias").val() == 0){
                        swal("","Debes seleccionar la anomalía","warning");
                        return false;
                    }else{
                        if($("#comunes_anomalias").val() == 'e'){
                            if($("#descripcion_anomalia").val()){}else{
                                swal("","Debes describir la anomalía","warning");
                                return false;
                            }    
                        }
                        if($("#imagenC3").val()){}else{
                            swal("","Falta tomar la fotografía de la anomalía","warning");
                            return false;
                        }
                    }
                    var comunes_anomalias = $("#comunes_anomalias option:selected").text();
                    var descripcion_anomalia = $("#descripcion_anomalia").val();
                    var foto = $("#imagenC3").val();
                    var comentarios = comunes_anomalias+" - "+descripcion_anomalia;
                    if($("#comunes_anomalias").val() == 'e'){
                        var comentarios = comunes_anomalias+" - "+descripcion_anomalia;
                    }else{
                        var comentarios = comunes_anomalias;
                    }
                }else{
                    var comunes_anomalias = 'N/A';
                    var descripcion_anomalia = 'N/A';
                    var comentarios ='Sin anomalía';
                }
                
                databaseHandler.db.transaction(
                    function(tx){//id_evidencia integer primary key,id_cedula integer,foto blob,comentarios text,fecha_evidencia text,fase text, apartado text
                        tx.executeSql("INSERT INTO fotos_entrega_ci(id_cedula,foto,comentarios,fecha_evidencia,temp_entregado,peso_cliente, anomalia, foto_temp_producto, foto_peso, comunes_anomalias, descripcion_anomalia) VALUES (?,?,?,?,?,?,?,?,?,?,?)",
                            [id_cedula,foto,comentarios,fecha_registro,temp_entregado, peso_cliente, anomalia, foto_temp_producto, foto_peso, comunes_anomalias, descripcion_anomalia],
                            function(tx, results){

                                databaseHandler.db.transaction(
                                    function(tx1){
                                        tx1.executeSql(
                                            "Select * from fotos_entrega_ci where id_cedula = ? ORDER BY id_evidencia_F DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var item = results.rows.item(0);
                                                $("#descripcion_anomalia").css("background-color", "#ffffff");
                                                $("#peso_cliente").css("background-color", "#ffffff");
                                                $("#temp_entregado").css("background-color", "#ffffff");
                                                $("#anomalias").css("display","none");
                                                $("#anomalia").css("display","none");
                                                $("#temp_entregado").val('');
                                                $("#peso_cliente").val('');
                                                $("#tipo1").prop("checked",false);
                                                $("#tipo0").prop("checked",false);
                                                $("#comunes_anomalias").val(0);
                                                $("#descripcion_anomalia").val('');
                                                $("#smallImage1").attr("src","img/blank.png");
                                                $("#photoIcon1").attr("src","img/camera.svg");
                                                $("#imagenC1").val('');
                                                $("#smallImage2").attr("src","img/blank.png");
                                                $("#photoIcon2").attr("src","img/camera.svg");
                                                $("#imagenC2").val('');
                                                $("#smallImage3").attr("src","img/blank.png");
                                                $("#photoIcon3").attr("src","img/camera.svg");
                                                $("#imagenC3").val('');
                                                swal("","Datos guardados correctamente","success");
                                                if(item.foto_peso){
                                                    var foto_peso = "<img src='"+item.foto_peso+"' width='60px' style='margin-top: 4px;'/>";
                                                }else{
                                                    var foto_peso = 'Sin evidencia';
                                                }
                                                $("#temperatura").append("<tr id='fila"+ item.id_evidencia_F +"'><td><a href='#' onclick='eliminarFilaCi("+item.id_evidencia_F +
                                                ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + item.temp_entregado + 
                                                " °C</td><td><img src='"+item.foto_temp_producto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.peso_cliente + 
                                                "</td><td>"+foto_peso+"</td><td style='text-align: center;'>" + item.comentarios +
                                                 "</td><td style='text-align: center;'>" + item.fecha_evidencia + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(error){}
                                );
                            },
                            function(tx, error){
                            }
                        );
                    },function(error){},function(error){
                    }
                );
            }
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function eliminarFilaCi(index, opcion){
        if(opcion == 1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_entrega_ci WHERE id_evidencia_F = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opcion == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_ci WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarCierreEntregaCI(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select * from fotos_ci where id_cedula= ? AND fase = 4 AND apartado = 1",
                    [id_cedula], function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                            swal("","Debes tomar evidencia de la(s) factura(s)", "warning");
                        }else{
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE datos_generales SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                                        [firmaCliente,fecha_firma,id_cedula],
                                        function(tx, results){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                                        [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                                        function(tx, results){
                                                            swal("","Guardado correctamente","success");
                                                            app.views.main.router.back('/yamevoyEntregaCI2/', {force: true, reload: true});
                                                        },
                                                        function(tx, error){
                                                            console.error("Error al guardar cierre: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    }
                );
            },
            function(error){},function(){}
        );
    }
    function pasaCierreCI(clave){
        var tab = localStorage.getItem("tab");
        if(tab == 3){
            if($("#NombreFirma").val() || $("#signate").val() || $("#eval").val()){
                swal({
                    title: "Aviso",
                    text: "¿Estas seguro que deseas regresar?. Se borraría la evaluación, firma y nombre de quien recibe.",
                    icon: "warning",
                    buttons: true,
                    dangerMode: false,
                }).then((willGoBack) => {
                    if (willGoBack){
                        simueveCierreCI(clave)
                        $("#NombreFirma").val('');
                        $("#signate").val('');
                        $("#eval").val('');
                        $("#comentario_cliente").val('');
                        $("#ImagenFirmaView").attr("src", "");
                        $("#VolverFirmar").css("display","none");
                        $("#span_star").html('');
                        var ratings = document.getElementsByClassName('rating');
                        for (var i = 0; i < ratings.length; i++) {
                            var r = new SimpleStarRating(ratings[i]);
                            ratings[i].addEventListener('rate', function(e) {
                                $("#eval").val(e.detail);
                            });
                        }
                    }
                });
            }else{
                simueveCierreCI(clave)
            }
        }else{
            simueveCierreCI(clave)
        }
    }
    function simueveCierreCI(clave){
        var id_cedula = localStorage.getItem("IdCedula");
        if(clave == 1){
            localStorage.setItem("tab",1);
            window.location.href = "#tab-1";
            $("#a_tab-1").css("color", "#007aff");
            $("#a_tab-2").css("color", "#505759");
            $("#a_tab-3").css("color", "#505759");
        }else{
            databaseHandler.db.transaction(
                function(tx1){
                    tx1.executeSql(
                        "Select * from fotos_ci where id_cedula= ? AND fase = 4 AND apartado = 1",
                        [id_cedula], function(tx, results){
                            var length = results.rows.length;
                            if(length == 0){
                                swal("","Debes tomar evidencia de la(s) factura(s)", "warning");
                            }else{
                                if(clave == 2){
                                    localStorage.setItem("tab",2);
                                    window.location.href = "#tab-2";
                                    $("#a_tab-2").css("color", "#007aff");
                                    $("#a_tab-1").css("color", "#505759");
                                    $("#a_tab-3").css("color", "#505759");
                                }else if(clave == 3){
                                    localStorage.setItem("tab",3);
                                    window.location.href = "#tab-3";
                                    $("#a_tab-3").css("color", "#007aff");
                                    $("#a_tab-1").css("color", "#505759");
                                    $("#a_tab-2").css("color", "#505759");
                                }
                            }
                        }
                    );
                },
                function(error){},function(){}
            );
        }
    }
    function terminarEntregaCI2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarEntregaCI(confirmacion_medidas){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var nombre_completo = $("#nombre_completo").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_ci SET foto_salida  = ?,confirmacion_medidas=?,nombre_completo = ? WHERE id_cedula = ?",
                    [foto_salida,confirmacion_medidas,nombre_completo,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedCI(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoCI'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoCI2'});
        } else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoCI4'});
        }
    }
    function eliminarFilaCI(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_entrega WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarProyecto(op){
        var id_cedula = localStorage.getItem("IdCedula");
        var metodo = $('#metodo').val();
        var grupo = $('#grupo').val();
        var nombre_proyecto = $('#nombre_proyecto').val();   
        var potencial = $('#potencial').val();
        var segmento = $('#segmento').val();
        var estrategia = $('#estrategia').val();
        var division = 1;
        var estatus = 0;
        var enviado = 0;
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_creacion = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate();
        var estatusEn = 1;
        if (nombre_proyecto!=''){
            if (potencial!=''){
                if(segmento!='0'){
                    var nivel = 0;
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Insert into proyectos_vic (id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,metodo,grupo,nivel,id_cedula) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                [id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,metodo,grupo,nivel,id_cedula],
                                function(tx, results){
                                    var id_proyecto = results.insertId;
                                    //Limpieza de campos
                                    $('#nombre_proyecto').val('');
                                    $('#potencial').val('');
                                    $('#segmentos').val('0');
                                    $('#Estrategias').val('0');
                                    $('#grupo').val('');
                                    $('#metodo').val('');
                                    //Traer el ultimo proyecto
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from proyectos_vic where id_usuario = ? ORDER BY id_proyecto DESC",
                                            [id_usuario],
                                                function(tx, results){
                                                    var length = results.rows.length;  
                                                    var item = results.rows.item(0);                                                                                  
                                                        //Inserta en ventas bennetts los datos del proyecto creado
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("UPDATE ventas_bennetts SET id_proyecto = ?, nivel = ? WHERE id_cedula = ?",
                                                                    [id_proyecto,nivel,id_cedula],
                                                                    function(tx, results){
                                                                        if(op==2){
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("UPDATE cedulas_general SET estatus = ?, fecha_salida = ?, id_cliente = ?,nombre_cliente = ? WHERE id_cedula = ?",
                                                                                        [estatusEn,fecha_creacion,id_proyecto,nombre_proyecto,id_cedula],
                                                                                        function(tx, results){                                                                   
                                                                                            swal("","El proyecto se guardo correctamente", "success"); 
                                                                                            window.location.href = "./menu.html";
                                                                                        },
                                                                                        function(tx, error){
                                                                                            swal("Error al guardar",error.message,"error");
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){},
                                                                                function(){}
                                                                            );
                                                                        }else{
                                                                            $("#proyectos").append("<option value="+item.id_proyecto+">"+item.nombre_proyecto+"</option>");
                                                                            app.sheet.close('.my-sheet')
                                                                            swal("","El proyecto se guardo correctamente", "success");
                                                                        }
                                                                    },
                                                                    function(tx, error){
                                                                        console.error("Error al actualizar: " + error.message);
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else {
                    app.dialog.alert('El segmento es requerido.', 'Aviso');
                }
            }else{
                app.dialog.alert('El potencial es requerido.', 'Aviso');
            }
        }else{
            app.dialog.alert('El nombre es requerido.', 'Aviso');
        }
    }
    function guardarDatosVentaCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            if($("#potencia_kg").val()==0){swal("","Debes seleccionar la potencia de KG","warning");return false;}
            if($("#medio_conocido").val()==0){swal("","Debes seleccionar el medio por el cual nos conoció","warning");return false;}
            if($("#medio_conocido").val()==6){
                if($("#otro_medio").val()){}else{
                    swal("","Debes indicar el medio por el cual nos conoció","warning");
                    return false;
                }
            }
            var nombre = $("#nombre").val();
            var telefono = $("#telefono").val();
            var medio_conocido = $("#medio_conocido").val();
            var otro_medio= $("#otro_medio").val();
            var potencia_kg = $("#potencia_kg").val();
            var negocio = $("#negocio").val();
            var ubicacion = $("#ubicacion").val();
            var medio_contacto = $("#medio_contacto").val();
            var correo = $("#correo").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_ventas SET nombre = ?, correo = ?, telefono = ?, medio_conocido = ?, potencia_kg = ?, negocio = ?, ubicacion = ?, medio_contacto = ?,otro_medio = ? WHERE id_cedula = ?",
                        [nombre,correo,telefono,medio_conocido,potencia_kg,negocio,ubicacion,medio_contacto,otro_medio,id_cedula],
                        function(tx, results){
                            $("#nombre").css("background-color", "#FFFFFF");
                            $("#telefono").css("background-color", "#FFFFFF");
                            $("#medio_conocido").css("background-color", "#FFFFFF");
                            $("#potencia_kg").css("background-color", "#FFFFFF");
                            $("#negocio").css("background-color", "#FFFFFF");
                            $("#ubicacion").css("background-color", "#FFFFFF");
                            $("#medio_contacto").css("background-color", "#FFFFFF");
                            $("#correo").css("background-color", "#FFFFFF");
                            $("#otro_medio").css("background-color", "#FFFFFF");
                            swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET nombre_cliente = ? WHERE id_cedula = ?",
                                        [negocio,id_cedula],
                                        function(tx, results){
                                        },
                                        function(tx, error){
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarActividadComercialCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        var foto_visita=$('#imagenC').val();
        var nivel = $('#niveles').val();
        var pendiente_vendedor=$('#pendiente_vendor').val();
        if($("#reparadoSi").prop("checked") == true){
            var actualizaNivel = "1";
        } else if($("#reparadoNo").prop("checked")){
            var actualizaNivel = "2";
        }
        if($('#V1').is(':checked') || $('#V2').is(':checked')){ 
            if($('#V1').is(':checked')){ 
                var tipo_visita=$('#V1').val();
            }else if ($('#V2').is(':checked')){
                var tipo_visita=$('#V2').val();
            }
            if(foto_visita){
                if(nivel != 0){
                    if(pendiente_vendedor){
                        //console.log(tipo_visita, nivel, pendiente_vendedor);
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE datos_ventas SET tipo_visita = ?, foto_visita = ?, nivel = ?, pendiente_vendedor= ?,nivel_sube = ?WHERE id_cedula = ?",
                                    [tipo_visita,foto_visita,nivel,pendiente_vendedor,actualizaNivel,id_cedula],
                                    function(tx, results){
                                    //console.log("actualizados datos de evidencia");
                                    swal("","Se guardaron los datos correctamente", "success");
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Todos los campos son requeridos para continuar", "warning");    
                    }
                }else{
                    swal("", "Favor de seleccionar una actividad", "warning");
                }
            }else{
                swal("", "La foto es requerida", "warning");
            }
        }else{
            swal("", "Favor de seleccionar el tipo de visita", "warning");
        }

    }
    function guardarMinutaCI(){
        var id_cedula = localStorage.getItem("IdCedula");
        var acciones = $("#acciones").val();
        var fecha_minuta = $("#fecha_minuta").val();
        if (acciones && fecha_minuta){
                app.preloader.show('blue');
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO minuta_ci(id_cedula,acciones,fecha_minuta) VALUES (?,?,?)",
                            [id_cedula,acciones,fecha_minuta],
                            function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#acciones').val('');
                                $('#fecha_minuta').val('');
                                $('#fecha_minuta').css("background-color", "#FFFFFF");
                                $('#acciones').css("background-color", "#FFFFFF");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from minuta_ci where id_cedula = ? ORDER BY id_minuta DESC",
                                        [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#minuta").append("<tr id='fila"+ item.id_minuta +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_minuta +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtema' style='text-align: center;'>" + item.acciones + "</td><td id='tdcompromiso' style='text-align: center;'>" + item.fecha_minuta + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al Mostrar los datos: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                        },
                            function(tx, error){
                                console.error("Error al guardar: " + error.message);
                                swal("","Ha ocurrido un error al guardar", "error");
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        }else{
            swal("", "Todos los campos son obligatorios", "warning");
        }
    }
    function generarRecuperacionCI(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoCedula = "Recuperacion";
        productHandler.addDatosVentaCI(id_cedula);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        app.views.main.router.navigate({name: 'recorridoCI3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarRutaCI(){
        var data = localStorage.getItem("ruta");
        if(data!= 'null'){ }else{
            swal("", "Aún no tienes ruta asignada para el día de hoy", "warning");
            return false;
        }
        var ruta = JSON.parse(data);
        var totalReg = ruta.length;
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = "Ruta";
        var tipoCedula = "Ruta";
        var foto_entrada = "Ruta";
        var id_cliente = "100001";
        var nombre_cliente = "Ruta | "+fecha.getDate()+"-"+(fecha.getMonth()+1)+"-"+fecha.getFullYear();
        var estatus = 0;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select MAX(vuelta) as vuelta from evidencias_carga where fecha = ?",
                    [fecha_actual],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var vueltas = item.vuelta;
                        if(vueltas){
                            vueltas = vueltas+1;
                        }else{
                            vueltas = 1;
                        }
                        if(foto_llegada != ''){
                            if(nombre_cliente != ''){
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                var id_cedula = item.Id;
                                                var sihayvisitas = false;
                                                productHandler.addDatosCIRuta(id_cedula,foto_entrada,id_cliente,nombre_cliente,nombre_usuario);
                                                for(i = 0;i <= totalReg-1;i++){
                                                    if(ruta[i].vuelta == vueltas){
                                                        sihayvisitas = true;
                                                        var nombre_comercial = ruta[i].nombre_comercial;
                                                        var id_visita = ruta[i].id_visita;
                                                        var documento = ruta[i].documento;
                                                        var comanda = ruta[i].comanda;
                                                        var kilos = ruta[i].kilos;
                                                        var fecha = fecha_actual;
                                                        var vuelta = ruta[i].vuelta;
                                                        productHandler.addCargaRutaCI(id_cedula,nombre_comercial,documento,comanda,kilos,vuelta,fecha);
                                                    }
                                                }
                                                if(sihayvisitas){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                                [tipoCedula,id_cedula],
                                                                function(tx, results){
                                                                    app.views.main.router.navigate({name: 'recorridoCI4'});
                                                                },
                                                                function(tx, error){
                                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                }else{
                                                    swal("", "Aún no tienes otra ruta asignada para el día de hoy", "warning");
                                                    return false;
                                                }
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                            }
                        } else {
                            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarRutaCI1(){
        var data = localStorage.getItem("ruta");
        if(data!= 'null'){ }else{
            swal("", "Aún no tienes ruta asignada para el día de hoy", "warning");
            return false;
        }
        var ruta = JSON.parse(data);
        var totalReg = ruta.length;
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = "Ruta";
        var tipoCedula = "Ruta";
        var foto_entrada = "Ruta";
        var id_cliente = "100001";
        var nombre_cliente = "Ruta | "+fecha.getDate()+"-"+(fecha.getMonth()+1)+"-"+fecha.getFullYear();
        var estatus = 0;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select MAX(vuelta) as vuelta from evidencias_carga where fecha = ?",
                    [fecha_actual],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var vueltas = item.vuelta;
                        if(vueltas){
                            vueltas = vueltas+1;
                        }else{
                            vueltas = 1;
                        }
                        if(foto_llegada != ''){
                            if(nombre_cliente != ''){
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                var id_cedula = item.Id;
                                                var sihayvisitas = false;
                                                productHandler.addDatosCIRuta(id_cedula,foto_entrada,id_cliente,nombre_cliente,nombre_usuario);
                                                for(i = 0;i <= totalReg-1;i++){
                                                    if(ruta[i].vuelta == vueltas){
                                                        if(ruta[i].id_user == id_usuario){
                                                            sihayvisitas = true;
                                                            var nombre_comercial = ruta[i].nombre_comercial;
                                                            var id_visita = ruta[i].id_visita;
                                                            var documento = ruta[i].documento;
                                                            var comanda = ruta[i].comanda;
                                                            var kilos = ruta[i].kilos;
                                                            var fecha = fecha_actual;
                                                            var vuelta = ruta[i].vuelta;
                                                            productHandler.addCargaRutaCI(id_cedula,nombre_comercial,documento,comanda,kilos,vuelta,fecha);
                                                        }
                                                    }
                                                }
                                                if(sihayvisitas){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                                [tipoCedula,id_cedula],
                                                                function(tx, results){
                                                                    app.views.main.router.navigate({name: 'recorridoCI4'});
                                                                },
                                                                function(tx, error){
                                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                }else{
                                                    swal("", "Aún no tienes otra ruta asignada para el día de hoy", "warning");
                                                    return false;
                                                }
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                            }
                        } else {
                            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function cierreCI(fase){
        if(fase == 1){
            app.views.main.router.navigate({name: 'cierreCI2'});
        }else if(fase == 2){
            if($("#tipo0").prop("checked") == true){
                $("#razon_cierre").css("display","block");
            }else{
                $("#razon_cierre").css("display","none");
            }
        }else if(fase == 3){
            if($("#tipo0").prop("checked") == true){
                $("#Comentarios").css("display","block");
            }else {
                $("#comentarios").val('');
                $("#Comentarios").css("display","none");
            }
        }else if(fase == 4){
            if($("#tipo1").prop("checked") == true){
                $("#anomalia").css("display","block");
            }else {
                $("#anomalia").css("display","none");
            }
        }else if(fase == 5){
            if($("#comunes_anomalias").val() == 'e'){
                $("#anomalias").css("display","block");
            }else {
                $("#anomalias").css("display","none");
            }
        }else if(fase == 6){
            if($("#tipo1-1").prop("checked") == true){
                $("#muestras").css("display","block");
            }else {
                $("#muestras").css("display","none");
            }
        }else if(fase == 7){
            if($("#medio_conocido").val() == 6){
                $("#div_otro_medio").css("display","block");
            }else{
                $("#div_otro_medio").css("display","none");
            }
        }else if(fase == 8){
            if($("#tipo1-4").prop("checked") == true){
                $("#div_pedido").css("display","block");
            }else {
                $("#div_pedido").css("display","none");
            }
        }else if(fase == 9){
            if($("#pagos").val() == 6){
                $("#div_pagos").css("display","block");
            }else{
                $("#div_pagos").css("display","none");
            }
        }
    }
    function TomaEvidenciaCI(id){
        var popEvidencia = app.popup.create({
            content: `
            <div class="sheet-modal my-sheet" id="sheet-modal" name="sheet">
            <div class="toolbar">
                <div class="toolbar-inner">
                    <div class="left"></div>
                    <div class="right"><a class="link" id="close_sheet" href="#">Cerrar</a></div>
                </div>
            </div>
            <div class="sheet-modal-inner">
                <div class="block">
                    <h3 class="FWN-titulo-2">Agregar Evidencia</h3>
                    <form class="list FWM-fixing-form"> 
                        <input type="hidden" id="inputEvidencia" value=`+id+`>
                        <input type="hidden" id="pasa" value="0">
                        <span class="span FWM-span-form">Foto:</span>
                            <div class="FWM-photo-container">
                                <div class="border-capture">
                                    <a onclick="capturePhoto();">
                                        <img class="FWM-photo" src="img/camera.svg" id="photoIcon" width="45px" style="margin-left: 50px;"/>
                                    </a>
                                </div>
                                <img class="FWM-photo-hide" id="smallImage" src=""/>
                                <input type="hidden" id="imagenC" name="imagenC"/>
                            </div>
                            <br>
                        <div class="block grid-resizable-demo" style="margin-bottom: 70px;">
                            <div class="row align-items-stretch" style="text-align: center;">
                                <div class="col-100 medium-50" style="min-width: 50px; border-style: none;">
                                    <span class="resize-handler"></span>
                                    <a href="#" onclick="guardarEvidenciaCI();" style="background-color: #063E7F;" class="boton-equipo">Guardar</a>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>`,
        swipeToClose:false,
        closeByOutsideClick:false,
        closeByBackdropClick:false,
        closeOnEscape:false,
                  on: {
                    open: function (popup) {
    
                        $('#close_sheet').click(function () {
                            if($('#pasa').val()!=0){
                                app.sheet.close('#sheet-modal');
                            }else{
                                swal({
                                    title: "Aviso",
                                    text: "Aún no agregas una evidencia, ¿Estas seguro que deseas regresar?",
                                    icon: "warning",
                                    buttons: true,
                                    dangerMode: false,
                                }).then((willGoBack) => {
                                    if (willGoBack){
                                        app.sheet.close('#sheet-modal');
                                    } else {}
                                });
                            }
                        });
                    },
                }
          });
          popEvidencia.open();
    }
    function guardarEvidenciaCI(){
        if($("#imagenC").val()){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC").val();
        var val = $("#inputEvidencia").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE evidencias_carga SET foto = ? WHERE id_cedula = ? AND id_entrega = ?",
                    [foto,id_cedula,val],
                    function(tx, results){
                        $("#pasa").val(1);
                        $("#VentasBennetts_content").empty("");
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "Select * from evidencias_carga where id_cedula= ?",
                                    [id_cedula],
                                    function(tx, results){
                                        var length = results.rows.length;
                                        if(length == 0){
                                            $("#message-nr").css("display", "block");
                                        } else {
                                            for(var i = 0; i< length; i++){
                                                var item = results.rows.item(i);
                                                    if(item.foto){
                                                        foto = "<img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/>";
                                                    }else{
                                                        foto = "<a href='#' onclick='TomaEvidenciaCI("+item.id_entrega+");' style='border: none; outline:none;'><img src='img/camera.svg' width='30px' /></a>";
                                                    }
                                                    if(item.peso_actual){
                                                        $("#VentasBennetts_content").append(`<tr id='fila"+ minuta +"'><td id='tdtema' style='text-align: center;'>` + item.no_pedido +`</td><td id='tdcompromiso' style='text-align: center;'>` + item.cliente + `</td><td id='tdcompromiso' style='text-align: center;'>` + item.descripcion + `</td><td id='tdcompromiso' style='text-align: center;'>` + item.peso_ruta + `</td><td id='tdfecha' style='text-align: center;'><input class="FWM-input" style="font-family: 'ITC Avant Garde Gothic', sans-serif;height: 40px;width: 100%;" type="text" id="peso_actual`+item.id_entrega+`" onchange="inputLleno(this.id,this.value),guardaPesoCI(`+item.id_entrega+`,this.value)" value="`+item.peso_actual+`"/></td> <td id='tdfecha' style='text-align: center;'>`+foto+`</td></tr>`);
                                                    }else{
                                                        $("#VentasBennetts_content").append(`<tr id='fila"+ minuta +"'><td id='tdtema' style='text-align: center;'>` + item.no_pedido +`</td><td id='tdcompromiso' style='text-align: center;'>` + item.cliente + `</td><td id='tdcompromiso' style='text-align: center;'>` + item.descripcion + `</td><td id='tdcompromiso' style='text-align: center;'>` + item.peso_ruta + `</td><td id='tdfecha' style='text-align: center;'><input class="FWM-input" style="font-family: 'ITC Avant Garde Gothic', sans-serif;height: 40px;width: 100%;" type="text" id="peso_actual`+item.id_entrega+`" onchange="inputLleno(this.id,this.value),guardaPesoCI(`+item.id_entrega+`,this.value)"/></td> <td id='tdfecha' style='text-align: center;'>`+foto+`</td></tr>`);
                                                    } 
                                                }   
                                                $("#message-nr").css("display", "none");
                                            }
                                            $('.preloader').remove();
                                            $('.infinite-scroll-preloader').remove();
                                        }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                        $("#imagenC").val('');
                        swal("","Se guardaron los datos correctamente", "success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        }else{
            swal("","Debes tomar una fotografía","warning");
        }
    }
    function guardaPesoCI(id,value){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE evidencias_carga SET peso_actual = ? WHERE id_cedula = ? AND id_entrega = ?",
                    [value,id_cedula,id],
                    function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#'+id).css("background-color", "#FFFFFF");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCargaRutaCI(){
        if($('#imagenC').val()){}else{
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($("#cumple_requisitos").prop("checked") == true){
            if($("#nombre_completo").val()){}else{swal("","Debes escribir tu nombre completo para poder terminar","warning");return false;}
            terminarEntregaCI(1);
        }else{
            swal("","Debes palomear la opción que estas cumpliendo con las medidas para poder continuar","warning");
        }
    }
    function GuardarvisitaCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var muestras = 2;
            var credito = 2;
                if($("#tipo0-1").prop("checked") == true){
                    muestras = 0;
                }else if($("#tipo1-1").prop("checked") == true){
                    muestras = 1;
                }

                if($("#tipo0-2").prop("checked") == true){
                    credito = 0;
                }else if($("#tipo1-2").prop("checked") == true){
                    credito = 1;
                }
            if(muestras == 2){
                swal("","Debes indicar las muestras","warning");
                return false;    
            }else{
                if(credito == 2){
                    swal("","Debes indicar las crédito","warning");
                    return false;
                }else{
                    if(muestras == 1){
                        if($("#imagenC2").val()){}else{swal("","Debes tomar una foto de la muestra","warning");return false;}
                        //if($("#imagenC3").val()){}else{swal("","Debes tomar una foto de la entrega de muestras","warning");return false;}
                    }
                    var id_cedula = localStorage.getItem("IdCedula");
                    var fecha = new Date();
                    var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                    var objetivo = $("#objetivo").val();
                    var resultado_visita = $("#resultado_visita").val();
                    databaseHandler.db.transaction(
                        function (tx) {
                            tx.executeSql("Select count(*) as Cuenta from visita_seguimiento WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                    var item = results.rows.item(0);
                                    if (item.Cuenta == 0) {
                                        tx.executeSql("Insert into visita_seguimiento(id_cedula, objetivo, muestras_check, credito_check, resultado_visita) values(?,?,?,?,?)",
                                            [id_cedula, objetivo, muestras, credito, resultado_visita],
                                            function (tx, results) {},
                                            function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                                        );
                                    } else {
                                        tx.executeSql("UPDATE visita_seguimiento SET objetivo = ?, muestras_check = ?, credito_check = ?, resultado_visita = ? WHERE id_cedula = ?",
                                            [objetivo, muestras, credito, resultado_visita,id_cedula],
                                            function (tx, results) {},
                                            function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                                        );
                                    }  
                                },
                                function (tx, error) {console.log(error)}
                            );
                        },
                        function (error) { },
                        function () { }
                    )
                    if(muestras == 1){
                        var foto1= $("#imagenC2").val();
                        var comentarios1 = $("#observaciones_muestras").val();
                        // var foto2= $("#imagenC3").val();
                        // var comentarios2 = $("#observaciones_muestras").val()+" (Entrega)";
                        if(comentarios1){}else{
                            comentarios1 = "Sin comentarios";
                        }
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO fotos_ci(id_cedula,foto,comentarios,fecha_evidencia,fase,apartado) VALUES (?,?,?,?,?,?)",
                                    [id_cedula,foto1,comentarios1,fecha_registro,3,1],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx1){
                                                tx1.executeSql(
                                                    "Select * from fotos_ci where id_cedula= ? AND fase = 3 AND apartado = 1 ORDER BY id_evidencia DESC",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        $("#muestras_table").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha_evidencia + "</td></tr>");
                                                        $("#smallImage2").attr("src","img/blank.png");
                                                        $("#photoIcon2").attr("src","img/camera.svg");
                                                        $("#imagenC2").val('');
                                                        $("#observaciones_muestras").val('');
                                                        $("#message-nr").css("display", "none");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                    }
                                );
                            },function(error){},function(){
                            }
                        );
                    }
                    $("#objetivo").css("background-color", "#FFFFFF");
                    $("#observaciones_muestras").css("background-color", "#FFFFFF");
                    $("#resultado_visita").css("background-color", "#FFFFFF");
                    swal("","Se guardaron los datos correctamente", "success");
                }
            }
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function GuardarCierre1CI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var credito = 2;
            var factura = 2;
            var pedido = 2;
            if($("#tipo0-2").prop("checked") == true){
                credito = 0;
            }else if($("#tipo1-2").prop("checked") == true){
                credito = 1;
            }
            if($("#tipo0-3").prop("checked") == true){
                factura = 0;
            }else if($("#tipo1-3").prop("checked") == true){
                factura = 1;
            }     
            if($("#tipo0-4").prop("checked") == true){
                pedido = 0;
            }else if($("#tipo1-4").prop("checked") == true){
                pedido = 1;
            }      
            if(credito == 2){
                swal("","Debes indicar la opción de crédito","warning");
                return false;    
            }else{
                if(factura == 2){
                    swal("","Debes indicar la opción de factura o remisión","warning");
                    return false;    
                }else{
                    if(pedido == 2){  
                        swal("","Debes indicar si se requiere pedido","warning");
                        return false;    
                    }else{
                        if(pedido == 1){
                            var values = get_datos_completos2('div_pedido');
                            var quita_coma = values.response;
                            var valido = values.valido;
                            if (valido) { 
                                if($("#pagos").val() == 6){
                                    if( $("#otro_pago").val()){}else{
                                        swal("","Debes describir cual sería el pago","warning");
                                        return false;  
                                    }
                                }
                                var producto = $("#producto").val();
                                var kg = $("#kg").val();
                                var pagos = $("#pagos").val();
                                var otro_pago = $("#otro_pago").val();
                                var dia_entrega = $("#dia_entrega").val();
                                var hora_entrega = $("#hora_entrega").val();
                                var direccion = $("#direccion").val();
                                var Observaciones = $("#Observaciones").val();
                                var id_cedula = localStorage.getItem("IdCedula");
                                var fecha = new Date();
                                var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
                               
                            }else{
                                swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
                                return false;
                            }
                            
                        }
                        var id_cedula = localStorage.getItem("IdCedula");
                        var documentos = $("#documentos").val();
                        var foto_doc = $("#imagenC").val();
                        var producto = $("#producto").val();
                        var kg = $("#kg").val();
                        var pagos = $("#pagos").val();
                        var otro_pago = $("#otro_pago").val();
                        var dia = $("#dia_entrega").val();
                        var hora = $("#hora_entrega").val();
                        var direccion = $("#direccion").val();
                        var observaciones = $("#Observaciones").val();
                        databaseHandler.db.transaction(
                            function (tx) {
                                tx.executeSql("Select count(*) as Cuenta from cierre_seguimiento_ci WHERE id_cedula = ?",
                                    [id_cedula],
                                    function (tx, results) {
                                        var item = results.rows.item(0);
                                        if (item.Cuenta == 0) {
                                            if(pedido == 0){
                                                tx.executeSql("Insert into cierre_seguimiento_ci(id_cedula,credito,documentos,foto_doc,factura,pedido) values(?,?,?,?,?,?)",
                                                    [id_cedula,credito,documentos,foto_doc,factura,pedido],
                                                    function (tx, results) {},
                                                    function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                                                );
                                            }else{
                                                tx.executeSql("Insert into cierre_seguimiento_ci(id_cedula,credito,documentos,foto_doc,factura,pedido,producto,kg,pagos,otro_pago,dia,hora,direccion,observaciones) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                                    [id_cedula,credito,documentos,foto_doc,factura,pedido,producto,kg,pagos,otro_pago,dia,hora,direccion,observaciones],
                                                    function (tx, results) {},
                                                    function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                                                );
                                            }
                                            
                                        } else {
                                            if(pedido == 0){
                                                tx.executeSql("UPDATE cierre_seguimiento_ci SET credito = ?,documentos = ?,foto_doc = ?,factura = ?,pedido = ? WHERE id_cedula = ?",
                                                    [credito,documentos,foto_doc,factura,pedido,id_cedula],
                                                    function (tx, results) {},
                                                    function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                                                );
                                            }else{
                                                tx.executeSql("UPDATE cierre_seguimiento_ci SET credito = ?,documentos = ?,foto_doc = ?,factura = ?,pedido = ?,producto = ?,kg = ?,pagos = ?,otro_pago = ?,dia = ?,hora = ?,direccion = ?,observaciones = ? WHERE id_cedula = ?",
                                                    [credito,documentos,foto_doc,factura,pedido,producto,kg,pagos,otro_pago,dia,hora,direccion,observaciones,id_cedula],
                                                    function (tx, results) {},
                                                    function (tx, error) {console.error("Error al registrar Resultado: " + error.message);}
                                                );
                                            }
                                        }  
                                        $("#documentos").css("background-color", "#FFFFFF");
                                        $("#producto").css("background-color", "#FFFFFF");
                                        $("#kg").css("background-color", "#FFFFFF");
                                        $("#otro_pago").css("background-color", "#FFFFFF");
                                        $("#dia_entrega").css("background-color", "#FFFFFF");
                                        $("#hora_entrega").css("background-color", "#FFFFFF");
                                        $("#direccion").css("background-color", "#FFFFFF");
                                        $("#Observaciones").css("background-color", "#FFFFFF");
                                        swal("","Se guardaron los datos correctamente", "success");
                                        app.views.main.router.back('/yamevoyEntregaCI/', {force: true, reload: true});
                                    },
                                    function (tx, error) {console.log(error)}
                                );
                            },
                            function (error) { },
                            function () { }
                        )
                    }
                }
            }
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarDatosGeneralesCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var nombre_cliente = $("#nombre_cliente").val();
            var orden = $("#orden").val();
            var nombre_contacto = $("#nombre_contacto").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_generales SET nombre_cliente = ?, orden = ?, nombre_contacto = ? WHERE id_cedula = ?",
                        [nombre_cliente,orden,nombre_contacto,id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#nombre_cliente").css("background-color", "#FFFFFF");
                            $("#orden").css("background-color", "#FFFFFF");
                            $("#nombre_contacto").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarEjecutarRutaCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var pesocon_taras = $("#pesocon_taras").val();
            var pesosin_taras = $("#pesosin_taras").val();
            var comentarios  = $("#comentarios").val();
            var total_coincide = 2;
            
                if($("#tipo0").prop("checked") == true){
                    total_coincide = 0;
                }else if($("#tipo1").prop("checked") == true){
                    total_coincide = 1;
                }
            if(total_coincide == 2){
                swal("","Debes indicar si hay coincidencia con el total","warning");    
            }else{
                if(total_coincide == 0){
                    if(comentarios){}else{
                        swal("", "Debes ingresar un comentario para poder guardar" ,"warning");
                        return false;
                    }
                }else{
                    comentarios = '';
                }
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datos_ci SET pesocon_taras = ?, pesosin_taras = ?, comentarios = ?, total_coincide = ? WHERE id_cedula = ?",
                            [pesocon_taras,pesosin_taras,comentarios,total_coincide,id_cedula],
                            function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $("#pesocon_taras").css("background-color", "#FFFFFF");
                                $("#pesosin_taras").css("background-color", "#FFFFFF");
                                $("#comentarios").css("background-color", "#FFFFFF");
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }
        } else {
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarEvidenciaCargaCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var temperatura_caja = $("#temperatura_caja").val();
            var foto_temp_caja = $("#imagenC1").val();
            var foto_caja_cargada = $("#imagenC2").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_ci SET temperatura_caja = ?,foto_temp_caja = ?, foto_caja_cargada = ? WHERE id_cedula = ?",
                        [temperatura_caja,foto_temp_caja,foto_caja_cargada,id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#temperatura_caja").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarProductosCI(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) { 
            var id_cedula = localStorage.getItem("IdCedula");
            var producto = $("#producto").val();
            var precio = $("#precio").val();
            var kilos = $("#kilos").val();
            var observaciones = $("#observaciones").val();
            var foto_producto = $("#imagenC").val();
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO prodcutos_ci(id_cedula,producto,precio,kilos,observaciones,foto_producto,fecha_registro) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula,producto,precio,kilos,observaciones,foto_producto,fecha_registro],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from prodcutos_ci where id_cedula= ? ORDER BY id_producto DESC",
                                        [id_cedula],//prodcutos_ci(id_producto integer primary key,id_cedula integer,producto text,precio text, kilos text,observaciones text, foto_producto blob)",
                                        function(tx, results){
                                            var length = results.rows.length;
                                            var item = results.rows.item(0);
                                            $("#VentasBennetts_content").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_producto +
                                            ",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + item.producto + 
                                            "</td><td style='text-align: center;'>" + item.kilos + "</td><td style='text-align: center;'>" + item.observaciones + "</td><td><img src='"+item.foto_producto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + 
                                            item.fecha_registro + "</td></tr>");
                                            $("#message-nr").css("display", "none");
                                            $("#producto").css("background-color", "#ffffff");
                                            $("#precio").css("background-color", "#ffffff");
                                            $("#kilos").css("background-color", "#ffffff");
                                            $("#observaciones").css("background-color", "#ffffff");
                                            $("#producto").val('');
                                            $("#precio").val('');
                                            $("#kilos").val('');
                                            $("#observaciones").val('');
                                            $("#imagenC").val('');
                                            $("#smallImage").attr("src","img/blank.png");
                                            $("#photoIcon").attr("src","img/camera.svg");
                                            swal("","Se guardaron los datos correctamente", "success");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                        }
                    );
                },function(error){},function(){
                }
            );
        } else {
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function irCierreVentasCI(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from minuta_ci where id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                            swal("", "Debes tener registros en minuta para poder entrar al cierre" ,"warning");
                        }else{
                            app.views.main.router.navigate({name: 'formCI10'});
                        }
                    },
                    function(tx, error){
                        console.log("Error al Mostrar los datos: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function startFromProgramCarnes(nombre_comercial,documento,comanda,contacto,fecha,facturas,id_visita){
        localStorage.setItem("nombre_comercial", nombre_comercial);
        localStorage.setItem("documento", documento);
        localStorage.setItem("comanda", comanda);
        localStorage.setItem("fecha", fecha);
        localStorage.setItem("facturas", facturas);
        localStorage.setItem("id_visita", id_visita);
        localStorage.setItem("contacto", contacto);
        app.views.main.router.navigate({name: 'yallegueCI2'});
    }
    function iniciarClienteCI(){
        var division = localStorage.getItem("division");
        if(division == 1){
            var foto_temp_caja = $("#imagenC1").val();
        }else{
            var foto_temp_caja = "na";
        }
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = 'na';
        var horario_programado = fecha_llegada;
        var nombre_cliente = localStorage.getItem("nombre_comercial");
        var nombre_contacto = localStorage.getItem("contacto");
        //var nombre_contacto = "contacto";
        var foto_llegada = $("#imagenC").val();
        var foto_temp_caja = $("#imagenC1").val();
        var id_cliente = localStorage.getItem("id_cliente");
        var orden = localStorage.getItem("documento");
        var comanda = localStorage.getItem("comanda");
        var estatus = 0;
        if(foto_llegada != ''){
            if(foto_temp_caja != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    localStorage.setItem("IdCedula", item.Id);
                                    var id_cedula = item.Id;
                                    var tipoCedula = "Entrega";
                                    productHandler.addDatosCI(id_cedula,nombre_cliente,nombre_contacto,foto_llegada,foto_temp_caja,orden,comanda);
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    app.views.main.router.navigate({name: 'recorridoCI'});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
            } else {
                swal("Falta un campo", "La fotografía de la temperatura de la caja es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function guardarazoncierre(){
        var id_cedula = localStorage.getItem("IdCedula");
        var porque_cierre = $("#porque_cierre").val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_ventas SET porque_cierre = ? WHERE id_cedula = ?",
                    [porque_cierre,id_cedula],
                    function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        app.views.main.router.back('/yamevoyEntregaCI/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarVentaCI(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;

        if($('#imagenC').val() == ""){
            swal("", "La fotografía es requerida para poder finalizar la visita" ,"warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_ventas SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function UpdateDataCI(key){
        var success = function(status) {
            console.log('Message: ' + status);
            $("#process").hide();
            $.ajax({
                type: "POST",
                async : true,
                url: "http://www.appbennetts.com/FWM2/app/ARCHIVOSJSONS/get_prospectos_ci_desc.php",
                dataType: 'html',
                success: function(respuesta){
                    window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function(oEntry) {
                        var jsonHijos = new download();
                        jsonHijos.Initialize({
                        fileSystem : cordova.file.dataDirectory,
                        folder: "jsons",
                        remove: false,
                        timeout: 0,
                        success: DownloaderSuccess,
                        error: DownloaderError,
                        headers: [
                            {
                            key : "Cache-Control",
                            Value: "no-store"
                            }
                        ]
                        });
                        jsonHijos.Get("http://appbennetts.com/FWM2/app/ARCHIVOSJSONS/get_prospectos_ci_desc.json");
                        function DownloaderSuccess() {}
                        function DownloaderError(err) {
                        console.log(err);
                        }
                    });
                },
                error: function(){
                    console.log("Error en la comunicacion con el servidor");
                }
            });
            $.ajax({
                type: "POST",
                async : true,
                url: "http://www.appbennetts.com/FWM2/app/ARCHIVOSJSONS/get_prospectos_ci.php",
                dataType: 'html',
                success: function(respuesta){
                    window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function(oEntry) {
                        var jsonHijos = new download();
                        jsonHijos.Initialize({
                        fileSystem : cordova.file.dataDirectory,
                        folder: "jsons",
                        remove: false,
                        timeout: 0,
                        success: DownloaderSuccess,
                        error: DownloaderError,
                        headers: [
                            {
                            key : "Cache-Control",
                            Value: "no-store"
                            }
                        ]
                        });
                        jsonHijos.Get("http://appbennetts.com/FWM2/app/ARCHIVOSJSONS/get_prospectos_ci.json");
                        function DownloaderSuccess() {
                            if(key == 0){}else{
                                var NomJson = 'get_prospectos_ci';
                                var length = 1;
                                var id = localStorage.getItem("id_usuario");
                                app.request.get(cordova.file.dataDirectory + "jsons/"+NomJson+".json", function (data) {
                                    var content = JSON.parse(data);
                                    for (var i = 0; i < content.length; i++) {
                                        if(content[i].usuario == id){
                                            length++;
                                        }
                                    }
                                    swal("Felicidades!", "Tu nuevo top se a actualizado a top "+length, "success");
                                });
                            }
                        }
                        function DownloaderError(err) {
                        console.log(err);
                        }
                    });
                },
                error: function(){
                    console.log("Error en la comunicacion con el servidor");
                }
            });
            localStorage.setItem("sendFlag", 0);
            swal("Enviado!", "Ya se envio tu visita!", "success");
        };
        var error = function(status) {
          $("#process").hide();
          console.log('Error: ' + status);
        };
        window.CacheClear(success, error);
    }
    //Fin Carnes Ideal
    //Inicio Proteus
    function buscarClienteProteus(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
        var orden_servicio = $("#orden_servicio").val();
        var id_visita = $("#id_visita").val();
        var razon_social = $("#razon_social").val();
        var ruc = $("#ruc").val();
        var local = $("#local").val();
        var direccion = $("#direccion").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var telefono1 = $("#telefono1").val();
        var telefono2 = $("#telefono2").val();
        var correo = $("#correo").val();

        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("orden_servicio", orden_servicio);
                                localStorage.setItem("id_visita", id_visita);
                                localStorage.setItem("razon_social", razon_social);
                                localStorage.setItem("ruc", ruc);
                                localStorage.setItem("local", local);
                                localStorage.setItem("direccion", direccion);
                                localStorage.setItem("nombre_contacto", nombre_contacto);
                                localStorage.setItem("telefono1", telefono1);
                                localStorage.setItem("telefono1", telefono1);
                                localStorage.setItem("correo", correo);
                                app.views.main.router.navigate({name: 'menuProteus'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarReposicionProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Reposicion";
        var tipo = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarPreventivoProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Preventivo";
        var tipo = 2;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarCorrectivoProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Correctivo";
        var tipo = 3;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus3/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function generarInstalacionProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let orden_servicio = localStorage.getItem("orden_servicio");
        let razon_social = localStorage.getItem("razon_social");
        let ruc = localStorage.getItem("ruc");
        let local = localStorage.getItem("local");
        let direccion = localStorage.getItem("direccion");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono1 = localStorage.getItem("telefono1");
        let telefono2 = localStorage.getItem("telefono2");
        let email = localStorage.getItem("email");
        let tipoCedula = "Instalacion";
        var tipo = 4;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,tipoCedula);
                        addequiposProteus(orden_servicio);
                        localStorage.setItem("tipoServicio", tipo);
                        app.views.main.router.back('/recorridoProteus4/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosGeneralesProteus(){
        //app.preloader.show('blue');
        if($("#orden_servicio").val() == "" || $("#razon_social").val() == "" || $("#ruc").val() == "" || $("#local").val() == "" || $("#direccion").val() == "" || $("#nombre_contacto").val() == "" || $("#telefono1").val() == "" || $("#telefono2").val() == "" || $("#email").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var orden_servicio = $("#orden_servicio").val();
        var razon_social = $("#razon_social").val();
        var ruc = $("#ruc").val();
        var local = $("#local").val();
        var direccion = $("#direccion").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var telefono1 = $("#telefono1").val();
        var telefono2 = $("#telefono2").val();
        var email = $("#email").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_proteus SET orden_servicio =?,razon_social =?,ruc =?,local =?,direccion =?,nombre_contacto =?,telefono1 =?,telefono2 =?,email = ? WHERE id_cedula = ?",
                    [orden_servicio,razon_social,ruc,local,direccion,nombre_contacto,telefono1,telefono2,email,id_cedula],
                    function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $("#orden_servicio").css("background-color", "#FFFFFF");
                        $("#razon_social").css("background-color", "#FFFFFF");
                        $("#ruc").css("background-color", "#FFFFFF");
                        $("#local").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#nombre_contacto").css("background-color", "#FFFFFF");
                        $("#telefono1").css("background-color", "#FFFFFF");
                        $("#telefono2").css("background-color", "#FFFFFF");
                        $("#email").css("background-color", "#FFFFFF");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedProteus(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoProteus1'});
        }else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoProteus2'});
        }else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoProteus3'});
        }else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoProteus4'});
        }
    }
    function regresarProteus(){
        var servicio = localStorage.getItem("tipoServicio");
        if(servicio == 1){
            app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
        }else if(servicio == 2){
            app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
        }else if(servicio == 3){
            app.views.main.router.back('/recorridoProteus3/', {force: true, ignoreCache: true, reload: true});
        }else if (servicio == 4){
            app.views.main.router.back('/recorridoProteus4/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardarEquipoProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_cliente = 1;
        let modelo = $('select[name="modelo"] option:selected').text();
        let marca = $('select[name="contenedor"] option:selected').text();
        let contenedor=$("#contenedor").val();
        let modelos=$("#modelo").val();
        let ubicacion = $("#ubicacion").val();
        if (modelos== 0){
            swal("", "Debes seleccionar un modelo" ,"warning");
        }else{
            if (contenedor== 'Selecciona un modelo primero'){
                swal("", "Debes seleccionar un contenedor" ,"warning");
            }else{
                if (ubicacion){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE datos_equipos_proteus SET ubicacion=? WHERE id_equipo = ?",
                                [ubicacion, modelos],
                                function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $("#ubicacion").css("background-color", "#FFFFFF");
                                    $("#ubicacion").val('');
                                    $("#tabla_equipos").empty("");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ? AND ubicacion <> ''",
                                            [id_cedula],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    for(var i = 0; i< length; i++){
                                                        var item = results.rows.item(i);
                                                        $("#tabla_equipos").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_equipo +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" +
                                                            item.modelo + "</td><td style='text-align: center;'>" +
                                                            item.marca + "</td><td style='text-align: center;'>" +
                                                            item.ubicacion + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                    }
                                                    $("#modelo").html("<option value='0'>Seleccione una opción</option>");
                                                    $("#contenedor").val('Selecciona un modelo primero');
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ? AND ubicacion == ''",
                                                            [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    for(var i = 0; i< length; i++){
                                                                        var item = results.rows.item(i);
                                                                        $("#modelo").append("<option value='"+item.id_equipo+"'>"+item.modelo+"</option>");
                                                                    }
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error:" + error.message);
                                                                    app.preloader.hide();
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.log("Error:" + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                    app.preloader.hide();
                                }
                            );
                        },function(error){},function(){
                        }
                    );
                }else{
                    swal("", "Indica la ubicación del equipo" ,"warning");
                }
            }
        }
    }
    function guardarReposicionProteus(){
        var clave = $("#clave").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var equipo = $('select[name="equipo"] option:selected').text();
        var ubicacion = $("#ubicacion").val();
        var kit_micro = $("#kit").val();
        var micro_activados = $("#microorganismos").val();
        var nivelador = $("#nivelador").val();
        var observaciones = $("#observaciones").val();
        var imagenC = $("#imagenC").val();
        var imagenC2 = $("#imagenC2").val();
        var fecha = new Date();
        var fecha_reg = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        if (clave == 1){//niveladorPH
            if(nivelador){
            }else{
                swal("", "Debes llenar el campo de Nivelador" ,"warning");
                return false;
            }
        }else if (clave == 2){//microorganismos Unidades
            if(kit_micro){
            }else{
                swal("", "Debes llenar el campo de Kit de Microorganismos" ,"warning");
                return false;
            }
        }else if (clave == 3){//microorganismos Litros
            if(micro_activados){
            }else{
                swal("", "Debes llenar el campo de Microorganismos activados" ,"warning");
                return false;
            }
        }

        if(observaciones){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from reposicion_proteus WHERE id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            if(results.rows.length == 0){
                                databaseHandler.db.transaction(
                                    function(tx){//id_cedula text,kit_micro text,micro_activados text,nivelador text,observaciones text)",
                                        tx.executeSql("INSERT INTO reposicion_proteus(id_cedula,kit_micro,micro_activados,nivelador,observaciones) VALUES (?,?,?,?,?)",
                                            [id_cedula,kit_micro,micro_activados,nivelador,observaciones],
                                            function(tx, results){
                                                swal("","Se guardaron los datos correctamente", "success");
                                                $("#ubicacion").css("background-color", "#FFFFFF");
                                                $("#kit").css("background-color", "#FFFFFF");
                                                $("#microorganismos").css("background-color", "#FFFFFF");
                                                $("#nivelador").css("background-color", "#FFFFFF");
                                                $("#observaciones").css("background-color", "#FFFFFF");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){
                                    }
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE reposicion_proteus SET kit_micro = ?,micro_activados = ?,nivelador = ?,observaciones = ? WHERE id_cedula = ?",
                                            [kit_micro, micro_activados, nivelador, observaciones, id_cedula],
                                            function(tx, results){
                                                swal("","Se guardaron los datos correctamente", "success");
                                                $("#ubicacion").css("background-color", "#FFFFFF");
                                                $("#kit").css("background-color", "#FFFFFF");
                                                $("#microorganismos").css("background-color", "#FFFFFF");
                                                $("#nivelador").css("background-color", "#FFFFFF");
                                                $("#observaciones").css("background-color", "#FFFFFF");
                                            },
                                            function(tx, error){
                                                swal("Error al guardar",error.message,"error");
                                                app.preloader.hide();
                                            }
                                        );
                                    },function(error){},function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error:" + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
            if (imagenC2){
                var comentario1 = "Presinto de Seguridad";
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ? AND page = 3 ",
                        [id_cedula],
                            function(tx, results){
                                var item = results.rows.item(0);
                                if(results.rows.length == 0){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, foto, fecha,page,comentario) VALUES (?,?,?,?,?)",
                                                [id_cedula,imagenC2,fecha_reg,3,comentario1],
                                                function(tx, results){
                                                },
                                                function(tx, error){
                                                }
                                            );
                                        },function(error){},function(){
                                        }
                                    );
                                } else {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE evidencias_proteus SET foto = ?,fecha = ?, comentario = ? WHERE id_cedula = ? AND page = 3",
                                                [imagenC2, fecha_reg, comentario1, id_cedula],
                                                function(tx, results){
                                                },
                                                function(tx, error){
                                                }
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            },
                            function(tx, error){
                                console.log("Error:" + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }
        }else{
            swal("", "Debes colocar una observación para poder guardar" ,"warning");
        }
    }
    function guardarEvidenciaProteus(){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        var comentario = $("#comentario").val();
        var page = 1;
        if (foto){
            if(comentario){}else{comentario='Sin comentario'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, comentario, foto, fecha,page) VALUES (?,?,?,?,?)",
                        [id_cedula,comentario, foto, fecha_registro, page],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from evidencias_proteus where id_cedula = ? AND page=? ORDER BY id_evidencia DESC",
                                            [id_cedula,page],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentario
                                                + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#comentario").val('');
                                                $("#comentario").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();
                                            }
                                    );
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotografía es requerida" ,"warning");
        }
    }
    function eliminarFilaProteus(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencias_proteus WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 2 || opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_proteus WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM datos_equipos_proteus WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        else if(opc == 4) {
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "UPDATE datos_equipos_proteus SET ubicacion='' WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                            swal("","El registro se elimino satisfactoriamente","success");
                            $("#fila" + index).remove();
                            $("#modelo").html("<option value='0'>Seleccione una opción</option>");
                            $("#contenedor").html("<option value='0'>Selecciona un modelo primero</option>");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ? AND ubicacion == ''",
                                    [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item = results.rows.item(i);
                                                $("#modelo").append("<option value='"+item.id_equipo+"'>"+item.modelo+"</option>");
                                            }
                                        },
                                        function(tx, error){
                                            console.log("Error:" + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function selectProteus(){
        var modelo = $("#modelo").val();
        if (modelo==0){
            $("#contenedor").val('Selecciona un modelo primero');
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_equipo = ?",
                    [modelo],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(0);
                                $("#contenedor").val(item.marca);
                            }
                        },
                        function(tx, error){
                            console.log("Error:" + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarChecklistProteus(fase,apartado){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if (apartado==1){
            var foto =$("#imagenC").val();
        }else {
            var foto =$("#imagenC"+apartado).val();
        }
        if(foto){
            if(fase ==5 ){
                if(apartado == 6){
                    //console.log('foto antes del servicio');
                    var comentario = "Foto antes del servicio";
                    var page = 2;
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ? AND page = ?",
                            [id_cedula,page],
                                function(tx, results){
                                    if(results.rows.length == 0){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, comentario, foto, fecha,page) VALUES (?,?,?,?,?)",
                                                    [id_cedula,comentario, foto, fecha_registro, page],
                                                    function(tx, results){
                                                        //console.log('Inserta');
                                                        swal("", "Foto guardada correctamente", "success");
                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },function(error){},function(){}
                                        );
                                    } else {
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE evidencias_proteus SET foto = ?, fecha = ? WHERE id_cedula = ? AND page = ?",
                                                    [foto,fecha_registro,id_cedula,page],
                                                    function(tx, results){
                                                        //console.log('update');
                                                        swal("", "Foto actualizada correctamente", "success");
                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },function(error){},function(){}
                                        );
                                    }
                                },
                                function(tx, error){
                                    console.log("Error al guardar checklits: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else if(apartado == 5){
                    //console.log('foto de la observación');
                    var observacion = $("#observaciones").val();
                    var comentario = "Foto de la observación._.";
                    var page = 6;
                    var observaciones = comentario+observacion;
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ? AND page = ?",
                            [id_cedula,page],
                                function(tx, results){
                                    if(results.rows.length == 0){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, comentario, foto, fecha,page) VALUES (?,?,?,?,?)",
                                                    [id_cedula,observaciones, foto, fecha_registro, page],
                                                    function(tx, results){
                                                        //console.log('Inserta');
                                                        $("#observaciones").css("background-color", "#FFFFFF");
                                                        swal("", "Foto guardada correctamente", "success");
                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },function(error){},function(){}
                                        );
                                    } else {
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE evidencias_proteus SET foto = ?, fecha = ?, comentario = ? WHERE id_cedula = ? AND page = ?",
                                                    [foto,fecha_registro,observaciones,id_cedula,page],
                                                    function(tx, results){
                                                        //console.log('update');
                                                        $("#observaciones").css("background-color", "#FFFFFF");
                                                        swal("", "Foto actualizada correctamente", "success");
                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },function(error){},function(){}
                                        );
                                    }
                                },
                                function(tx, error){
                                    console.log("Error al guardar checklits: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else if(apartado == 7){
                    //console.log('foto de la observación');
                    var comentario = "Foto después del servicio";
                    var page = 7;
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ? AND page = ?",
                            [id_cedula,page],
                                function(tx, results){
                                    if(results.rows.length == 0){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, comentario, foto, fecha,page) VALUES (?,?,?,?,?)",
                                                    [id_cedula,comentario, foto, fecha_registro, page],
                                                    function(tx, results){
                                                        //console.log('Inserta');
                                                        swal("", "Foto guardada correctamente", "success");
                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },function(error){},function(){}
                                        );
                                    } else {
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE evidencias_proteus SET foto = ?, fecha = ? WHERE id_cedula = ? AND page = ?",
                                                    [foto,fecha_registro,id_cedula,page],
                                                    function(tx, results){
                                                        //console.log('update');
                                                        swal("", "Foto actualizada correctamente", "success");
                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },function(error){},function(){}
                                        );
                                    }
                                },
                                function(tx, error){
                                    console.log("Error al guardar checklits: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }
            }else{
                databaseHandler.db.transaction(
                    function(tx){//id_cedula, fase text,apartado text, foto blob, fecha
                        tx.executeSql("INSERT INTO fotos_proteus(id_cedula, fase, apartado, foto, fecha) VALUES (?,?,?,?,?)",
                            [id_cedula,fase, apartado,foto, fecha_registro],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from fotos_proteus where id_cedula = ? ORDER BY id_foto DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    var apartado = '';
                                                    if(item.fase==1 && item.apartado == 1){
                                                        apartado='Limpieza interna del bidon/tanque';
                                                    }else if(item.fase==1 && item.apartado == 2){
                                                        apartado='Limpieza de filtros';
                                                    }else if(item.fase==1 && item.apartado == 3){
                                                        apartado='Limpieza de módulo de calor';
                                                    }else if(item.fase==1 && item.apartado == 4){
                                                        apartado='Limpieza interna de mangueras';
                                                    }else if(item.fase==2 && item.apartado == 1){
                                                        apartado='Revisión de sistema de dispensación';
                                                    }else if(item.fase==2 && item.apartado == 2){
                                                        apartado="Revisión de LED's";
                                                    }else if(item.fase==3 && item.apartado == 1){
                                                        apartado='Foto de la trampa de grasa abierta';
                                                    }else if(item.fase==3 && item.apartado == 2){
                                                        apartado='Foto de la salida de la trampa de grasa';
                                                    }else if(item.fase==3 && item.apartado == 3){
                                                        apartado='Punto de muestreo';
                                                    }else if(item.fase==4 && item.apartado == 1){
                                                        apartado='Limpieza del equipo por fuera';
                                                    }else if(item.fase==4 && item.apartado == 2){
                                                        apartado='Limpieza del equipo por dentro';
                                                    }else if(item.fase==4 && item.apartado == 3){
                                                        apartado='Limpieza de filtros';
                                                    }
                                                    if(item.fase==1){
                                                        $("#tabla_fotos").append("<tr id='fila"+ item.id_foto +"'><td style='padding-left: 25px;padding-right: 25px;'><a href='#' onclick='eliminarFilaProteus("+item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='padding: 10px;'><img src='"+item.foto+
                                                        "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;padding-left: 18px;padding-right: 18px;'>" + apartado
                                                        + "</td><td style='text-align: center;padding-left: 10px;padding-right: 10px;'>" + item.fecha + "</td></tr>");
                                                    }else if(item.fase==2){
                                                        $("#tabla_fotos1").append("<tr id='fila"+ item.id_foto +"'><td style='padding-left: 25px;padding-right: 25px;'><a href='#' onclick='eliminarFilaProteus("+item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='padding: 10px;'><img src='"+item.foto+
                                                        "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;padding-left: 18px;padding-right: 18px;'>" + apartado
                                                        + "</td><td style='text-align: center;padding-left: 10px;padding-right: 10px;'>" + item.fecha + "</td></tr>");
                                                    }else if(item.fase==3){
                                                        $("#tabla_fotos2").append("<tr id='fila"+ item.id_foto +"'><td style='padding-left: 25px;padding-right: 25px;'><a href='#' onclick='eliminarFilaProteus("+item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='padding: 10px;'><img src='"+item.foto+
                                                        "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;padding-left: 18px;padding-right: 18px;'>" + apartado
                                                        + "</td><td style='text-align: center;padding-left: 10px;padding-right: 10px;'>" + item.fecha + "</td></tr>");
                                                    }else if(item.fase==4){
                                                        $("#tabla_fotos").append("<tr id='fila"+ item.id_foto +"'><td style='padding-left: 25px;padding-right: 25px;'><a href='#' onclick='eliminarFilaProteus("+item.id_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='padding: 10px;'><img src='"+item.foto+
                                                        "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;padding-left: 18px;padding-right: 18px;'>" + apartado
                                                        + "</td><td style='text-align: center;padding-left: 10px;padding-right: 10px;'>" + item.fecha + "</td></tr>");
                                                    }
                                                    if (item.apartado==1){
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#imagenC").val('');
                                                    }else{
                                                        $("#smallImage"+item.apartado).attr("src","img/blank.png");
                                                        $("#photoIcon"+item.apartado).attr("src","img/camera.svg");
                                                        $("#imagenC"+item.apartado).val('');
                                                    }
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                },
                                                function(tx, error){
                                                    console.log("Error: " + error.message);
                                                    app.preloader.hide();
                                                }
                                        );
                                    },
                                        function(error){
                                            console.log("Error: " + error.message);
                                        },
                                        function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){
                        console.error("Error: " + error.message);
                    },
                    function(){}
                );
            }
        }else{
            swal("", "La fotografía es requerida para poder guardar" ,"warning");
        }
    }
    function capturePhoto2() {
        navigator.camera.getPicture(onPhotoSucceess2, onPhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess2(imageData) {
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onPhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhoto3() {
        navigator.camera.getPicture(onPhotoSucceess3, onPhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess3(imageData) {
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onPhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhoto4() {
        navigator.camera.getPicture(onPhotoSucceess4, onPhotoFail4, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess4(imageData) {
        var smallImage = document.getElementById('smallImage4');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC4").val(nameima);
        $("#photoIcon4").attr("src","img/reload.svg");
    }
    function onPhotoFail4(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhoto5() {
        navigator.camera.getPicture(onPhotoSucceess5, onPhotoFail5, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess5(imageData) {
        var smallImage = document.getElementById('smallImage5');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC5").val(nameima);
        $("#photoIcon5").attr("src","img/reload.svg");
    }
    function onPhotoFail5(message) {
        swal("Error al tomar foto:",message,"error");
    }

 function fallosProteus(id,fase){
    var id_cedula = localStorage.getItem("IdCedula");
    var ids = id.split("_");
    var fallo='';
    if(ids[1] == "1"){
        if($("#"+id).prop("checked") == true){
            $("#fallos_2").prop("checked", false);
            $("#comentarios").css("display","block");
        }else{
            $("#fallos_2").prop("true", false);
            $("#comentarios").css("display","none");
        }
    }else{
        if($("#"+id).prop("checked") == true){
            $("#fallos_1").prop("checked", false);
            if(fase == 2){
                $("#comentarios").css("display","none");
            }
        }else{
            $("#fallos_1").prop("true", false);
            $("#comentarios").css("display","block");
        }
    }
    if($("#fallos_1").prop("checked") == true){
        fallo='Si';
    }else if($("#fallos_2").prop("checked") == true){
        fallo='No';
    }
    if(fallo){
        if (fase==1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_limpieza SET fallos = ? WHERE id_cedula = ?",
                        [fallo, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }else if (fase==2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_revision SET fallos = ? WHERE id_cedula = ?",
                        [fallo, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }
    }
}
    function componente(id, fase){
        var id_cedula = localStorage.getItem("IdCedula");
        var ids = id.split("_");
        var componente='';
        if(ids[1] == "1"){
            if($("#"+id).prop("checked") == true){
                $("#componente_2").prop("checked", false);
            }else{
                $("#componente_2").prop("true", false);
            }
        }else{
            if($("#"+id).prop("checked") == true){
                $("#componente_1").prop("checked", false);
            }else{
                $("#componente_1").prop("true", false);
            }
        }
        if($("#componente_1").prop("checked") == true){
            componente='Si';
            $("#piezas").css("display", "block");
            $("#piezas1").css("display", "block");
        }else if($("#componente_2").prop("checked") == true){
            componente='No';
            $("#piezas").css("display", "none");
            $("#piezas").val('');
            $("#piezas1").css("display", "none");
        }
        if(componente){
            if (fase==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_limpieza SET componente = ? WHERE id_cedula = ?",
                            [componente, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }else if (fase==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_revision SET componente = ? WHERE id_cedula = ?",
                            [componente, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }
        }
    }
    function guardaDatosCheckProteus(id,fase){
        var id_cedula = localStorage.getItem("IdCedula");
        if(id=='comentarios'){
            var comentario = $("#"+id).val();
            if (fase==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_limpieza SET comentarios = ? WHERE id_cedula = ?",
                            [comentario, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }else if (fase==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_revision SET comentarios = ? WHERE id_cedula = ?",
                            [comentario, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }
        }else if (id=='piezas'){
            var piezas = $("#"+id).val();
            if (fase==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_limpieza SET piezas = ? WHERE id_cedula = ?",
                            [piezas, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }else if (fase==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE check_revision SET piezas = ? WHERE id_cedula = ?",
                            [piezas, id_cedula],
                            function(tx, results){
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                                app.preloader.hide();
                            }
                        );
                    },function(error){},function(){}
                );
            }
        }else if (id=='observaciones'){
            var observaciones = $("#"+id).val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_revision SET observaciones = ? WHERE id_cedula = ?",
                        [observaciones, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }
    }
    function formRevisionProteus(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from check_limpieza WHERE id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO check_limpieza(id_cedula) VALUES (?)",
                                        [id_cedula],
                                        function(tx, results){
                                            app.views.main.router.navigate({ name: 'formProteus2'});
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){
                                }
                            );
                        } else {
                            app.views.main.router.navigate({ name: 'formProteus2'});
                        }
                    },
                    function(tx, error){
                        console.log("Error:" + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function formEvidenciasProteus(check){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from check_revision WHERE id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO check_revision(id_cedula) VALUES (?)",
                                        [id_cedula],
                                        function(tx, results){
                                            if(check==1){
                                                app.views.main.router.navigate({ name: 'formProteus3'});
                                            }else{
                                                app.views.main.router.navigate({ name: 'formProteus8'});
                                            }
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){
                                }
                            );
                        } else {
                            if(check==1){
                                app.views.main.router.navigate({ name: 'formProteus3'});
                            }else{
                                app.views.main.router.navigate({ name: 'formProteus8'});
                            }
                        }
                    },
                    function(tx, error){
                        console.log("Error:" + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function fuenteProteus(id){
        var id_cedula = localStorage.getItem("IdCedula");
        var ids = id.split("_");
        var fuente='';
        if(ids[1] == "1"){
            if($("#"+id).prop("checked") == true){
                $("#fuente_2").prop("checked", false);
            }else{
                $("#fuente_2").prop("true", false);
            }
        }else{
            if($("#"+id).prop("checked") == true){
                $("#fuente_1").prop("checked", false);
            }else{
                $("#fuente_1").prop("true", false);
            }
        }
        if($("#fuente_1").prop("checked") == true){
            fuente='Si';
        }else if($("#fuente_2").prop("checked") == true){
            fuente='No';
        }
        if(fuente){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_revision SET fuente = ? WHERE id_cedula = ?",
                        [fuente, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }
    }
    function funcionamientoProteus(id){
        var id_cedula = localStorage.getItem("IdCedula");
        var ids = id.split("_");
        var funcionamiento='';
        if(ids[1] == "1"){
            if($("#"+id).prop("checked") == true){
                $("#funcionamiento_2").prop("checked", false);
            }else{
                $("#funcionamiento_2").prop("true", false);
            }
        }else{
            if($("#"+id).prop("checked") == true){
                $("#funcionamiento_1").prop("checked", false);
            }else{
                $("#funcionamiento_1").prop("true", false);
            }
        }
    }
    function guardarMmtoCorrectivo(){
        var id_cedula = localStorage.getItem("IdCedula");
        var reparacion = $("#reparacion").val();
        var funcionamiento = '';
        if($("#funcionamiento_1").prop("checked") == true){
            funcionamiento='Si';
        }else if($("#funcionamiento_2").prop("checked") == true){
            funcionamiento='No';
        }else{
            funcionamiento = '';
        }
        if (reparacion){
            if(funcionamiento != ''){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("SELECT * from mmto_correctivo WHERE id_cedula = ?",
                        [id_cedula],
                            function(tx, results){
                                var item = results.rows.item(0);
                                if(results.rows.length == 0){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("INSERT INTO mmto_correctivo(id_cedula,reparacion,funcionamiento) VALUES (?,?,?)",
                                                [id_cedula,reparacion,funcionamiento],
                                                function(tx, results){
                                                    swal("","Se guardaron los datos correctamente", "success");
                                                    $("#reparacion").css("background-color", "#FFFFFF");
                                                },
                                                function(tx, error){
                                                    swal("Error al guardar",error.message,"error");
                                                    app.preloader.hide();
                                                }
                                            );
                                        },function(error){},function(){
                                        }
                                    );
                                } else {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE mmto_correctivo SET reparacion = ?, funcionamiento = ? WHERE id_cedula = ?",
                                                [reparacion, funcionamiento, id_cedula],
                                                function(tx, results){
                                                    swal("","Se guardaron los datos correctamente", "success");
                                                    $("#reparacion").css("background-color", "#FFFFFF");
                                                },
                                                function(tx, error){
                                                    swal("Error al guardar",error.message,"error");
                                                    app.preloader.hide();
                                                }
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            },
                            function(tx, error){
                                console.log("Error:" + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }
            else{
                swal("", "Falta indicar si se válido el funcionamiento." ,"warning");
            }
        }else{
            swal("", "Debes describir la reparación a realizar." ,"warning");
        }
    }
    function guardarCierreProteus(){
        var dni ='';
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#cargo").val() == ""){
            swal("","Falta agregar el cargo","warning");
            return false;
        }
        if($("#dni").val() == ""){}else{dni=$("#dni").val();}
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var cargo = $("#cargo").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_proteus SET firma_cliente = ?,fecha_cliente = ?,cargo = ?,dni = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,cargo,dni,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyProteus/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarProteus(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;

        if($('#imagenC').val() == ""){
            swal({
                title: "Aviso",
                text: "La foto de salida esta vacía, ¿Estas seguro que deseas continuar así?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE datos_generales_proteus SET foto_salida = ? WHERE id_cedula = ?",
                                [foto_salida,id_cedula],
                                function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                                [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                                function(tx, results){
                                                    window.location.href = "./menu.html";
                                                },
                                                function(tx, error){
                                                    swal("Error al guardar",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {}
            });
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_proteus SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarProteuscheck(fase){
        var id_cedula = localStorage.getItem("IdCedula");
        var paso=0, paso1=0, paso2=0, paso3=0, paso4=0;
        if (fase == 1){
            databaseHandler.db.transaction(
                function(tx1){
                    tx1.executeSql(
                        "Select * from fotos_proteus where id_cedula= ? AND fase=1 AND apartado IN (2)",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            if (length == 0){}else{paso=1;}
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from fotos_proteus where id_cedula= ? AND fase=1 AND apartado IN (4)",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if (length == 0){}else{paso1=1;}
                                            if(paso == 0 || paso1 == 0){
                                                swal({
                                                    title: "Aviso",
                                                    text: "Aun no agregas evidencias en el apartado de: Limpieza de filtros y/o Limpieza Interna de mangueras. ¿Estas seguro que deseas regresar?",
                                                    icon: "warning",
                                                    buttons: true,
                                                    dangerMode: false,
                                                })
                                                .then((willGoBack) => {
                                                    if (willGoBack){
                                                        app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                    } else {}
                                                });
                                            } else {
                                                app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                            }
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.log("Error al consultar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if (fase == 2){
            databaseHandler.db.transaction(
                function(tx1){
                    tx1.executeSql(
                        "Select * from fotos_proteus where id_cedula= ? AND fase=2 AND apartado IN (1)",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            if (length == 0){}else{paso=1;}
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from fotos_proteus where id_cedula= ? AND fase=2 AND apartado IN (2)",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if (length == 0){}else{paso1=1;}
                                            if(paso == 0 || paso1 == 0){
                                                swal({
                                                    title: "Aviso",
                                                    text: "Aun no agregas evidencias en el apartado de: Revisión de sistema de dispensación y/o Revisión de LED's. ¿Estas seguro que deseas regresar?",
                                                    icon: "warning",
                                                    buttons: true,
                                                    dangerMode: false,
                                                })
                                                .then((willGoBack) => {
                                                    if (willGoBack){
                                                        app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                    } else {}
                                                });
                                            } else {
                                                app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                            }
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.log("Error al consultar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if (fase == 3){
            databaseHandler.db.transaction(
                function(tx1){
                    tx1.executeSql(
                        "Select * from fotos_proteus where id_cedula= ? AND fase=3 AND apartado IN (1)",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            if (length == 0){}else{paso=1;}
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "Select * from fotos_proteus where id_cedula= ? AND fase=3 AND apartado IN (2)",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            if (length == 0){}else{paso1=1;}
                                            databaseHandler.db.transaction(
                                                function(tx1){
                                                    tx1.executeSql(
                                                        "Select * from fotos_proteus where id_cedula= ? AND fase=3 AND apartado IN (3)",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            if (length == 0){}else{paso2=1;}
                                                            if(paso == 0 || paso1 == 0 || paso2 == 0){
                                                                swal({
                                                                    title: "Aviso",
                                                                    text: "Aun no agregas evidencias en el apartado de: Foto de la trampa de grasa abierta, Foto de la salida de la trampa de grasa y/o Punto de muestreo. ¿Estas seguro que deseas regresar?",
                                                                    icon: "warning",
                                                                    buttons: true,
                                                                    dangerMode: false,
                                                                })
                                                                .then((willGoBack) => {
                                                                    if (willGoBack){
                                                                        app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                                    } else {}
                                                                });
                                                            } else {
                                                                app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                            }
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.log("Error al consultar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if (fase == 4){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from datos_equipos_proteus WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            let length = results.rows.length;
                            var cont=0;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(0);
                                var modelo = item.modelo;
                                if (modelo == 'Nivelador de pH'){
                                    databaseHandler.db.transaction(
                                        function(tx1){
                                            tx1.executeSql(
                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (1)",
                                                [id_cedula],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    if (length == 0){}else{paso=1;}
                                                    databaseHandler.db.transaction(
                                                        function(tx1){
                                                            tx1.executeSql(
                                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (2)",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    paso1=1;
                                                                    databaseHandler.db.transaction(
                                                                        function(tx1){
                                                                            tx1.executeSql(
                                                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (3)",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    var length = results.rows.length;
                                                                                    paso2=1;
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx1){
                                                                                            tx1.executeSql(
                                                                                                "Select * from evidencias_proteus where id_cedula= ? AND page = 7",
                                                                                                [id_cedula],
                                                                                                function(tx, results){
                                                                                                    var length = results.rows.length;
                                                                                                    if (length == 0){}else{paso3=1;}
                                                                                                    databaseHandler.db.transaction(
                                                                                                        function(tx1){
                                                                                                            tx1.executeSql(
                                                                                                                "Select * from evidencias_proteus where id_cedula= ? AND page = 2",
                                                                                                                [id_cedula],
                                                                                                                function(tx, results){
                                                                                                                    var length = results.rows.length;
                                                                                                                    if (length == 0){}else{paso4=1;}
                                                                                                                    if(paso == 0 || paso1 == 0 || paso2 == 0 || paso3 == 0 || paso4 == 0){
                                                                                                                        swal({
                                                                                                                            title: "Aviso",
                                                                                                                            text: "Aun no agregas evidencias en el apartado de: Foto antes del servico, Limpieza del equipo por fuera o Foto después del servicio. ¿Estas seguro que deseas regresar?",
                                                                                                                            icon: "warning",
                                                                                                                            buttons: true,
                                                                                                                            dangerMode: false,
                                                                                                                        })
                                                                                                                        .then((willGoBack) => {
                                                                                                                            if (willGoBack){
                                                                                                                                app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                                                                                                                            } else {}
                                                                                                                        });
                                                                                                                    } else {
                                                                                                                        app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                                                                                                                    }
                                                                                                                },
                                                                                                                function(tx, error){
                                                                                                                    console.log("Error al consultar: " + error.message);
                                                                                                                }
                                                                                                            );
                                                                                                        },
                                                                                                        function(error){},
                                                                                                        function(){}
                                                                                                    );
                                                                                                },
                                                                                                function(tx, error){
                                                                                                    console.log("Error al consultar: " + error.message);
                                                                                                }
                                                                                            );
                                                                                        },
                                                                                        function(error){},
                                                                                        function(){}
                                                                                    );
                                                                                },
                                                                                function(tx, error){
                                                                                    console.log("Error al consultar: " + error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.log("Error al consultar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }else if(modelo.includes('Proteus GT')){
                                    databaseHandler.db.transaction(
                                        function(tx1){
                                            tx1.executeSql(
                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (1)",
                                                [id_cedula],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    if (length == 0){}else{paso=1;}
                                                    databaseHandler.db.transaction(
                                                        function(tx1){
                                                            tx1.executeSql(
                                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (2)",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    if (length == 0){}else{paso1=1;}
                                                                    databaseHandler.db.transaction(
                                                                        function(tx1){
                                                                            tx1.executeSql(
                                                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (3)",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    var length = results.rows.length;
                                                                                    if (length == 0){}else{paso2=1;}
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx1){
                                                                                            tx1.executeSql(
                                                                                                "Select * from evidencias_proteus where id_cedula= ? AND page = 7",
                                                                                                [id_cedula],
                                                                                                function(tx, results){
                                                                                                    var length = results.rows.length;
                                                                                                    if (length == 0){}else{paso3=1;}
                                                                                                    databaseHandler.db.transaction(
                                                                                                        function(tx1){
                                                                                                            tx1.executeSql(
                                                                                                                "Select * from evidencias_proteus where id_cedula= ? AND page = 2",
                                                                                                                [id_cedula],
                                                                                                                function(tx, results){
                                                                                                                    var length = results.rows.length;
                                                                                                                    if (length == 0){}else{paso4=1;}
                                                                                                                    if(paso == 0 || paso1 == 0 || paso2 == 0 || paso3 == 0 || paso4 == 0){
                                                                                                                        swal({
                                                                                                                            title: "Aviso",
                                                                                                                            text: "Aun no agregas evidencias en el apartado de: Foto antes del servico, Limpieza del equipo por fuera, Limpieza del equipo por dentro, Limpieza de filtros o Foto después del servicio. ¿Estas seguro que deseas regresar?",
                                                                                                                            icon: "warning",
                                                                                                                            buttons: true,
                                                                                                                            dangerMode: false,
                                                                                                                        })
                                                                                                                        .then((willGoBack) => {
                                                                                                                            if (willGoBack){
                                                                                                                                app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                                                                                                                            } else {}
                                                                                                                        });
                                                                                                                    } else {
                                                                                                                        app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                                                                                                                    }
                                                                                                                },
                                                                                                                function(tx, error){
                                                                                                                    console.log("Error al consultar: " + error.message);
                                                                                                                }
                                                                                                            );
                                                                                                        },
                                                                                                        function(error){},
                                                                                                        function(){}
                                                                                                    );
                                                                                                },
                                                                                                function(tx, error){
                                                                                                    console.log("Error al consultar: " + error.message);
                                                                                                }
                                                                                            );
                                                                                        },
                                                                                        function(error){},
                                                                                        function(){}
                                                                                    );
                                                                                },
                                                                                function(tx, error){
                                                                                    console.log("Error al consultar: " + error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.log("Error al consultar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }else if(modelo.includes('Manual')){
                                    databaseHandler.db.transaction(
                                        function(tx1){
                                            tx1.executeSql(
                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (1)",
                                                [id_cedula],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    if (length == 0){}else{paso=1;}
                                                    databaseHandler.db.transaction(
                                                        function(tx1){
                                                            tx1.executeSql(
                                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (2)",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    if (length == 0){}else{paso1=1;}
                                                                    databaseHandler.db.transaction(
                                                                        function(tx1){
                                                                            tx1.executeSql(
                                                                                "Select * from fotos_proteus where id_cedula= ? AND fase=4 AND apartado IN (3)",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    var length = results.rows.length;
                                                                                    paso2=1;
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx1){
                                                                                            tx1.executeSql(
                                                                                                "Select * from evidencias_proteus where id_cedula= ? AND page = 7",
                                                                                                [id_cedula],
                                                                                                function(tx, results){
                                                                                                    var length = results.rows.length;
                                                                                                    if (length == 0){}else{paso3=1;}
                                                                                                    databaseHandler.db.transaction(
                                                                                                        function(tx1){
                                                                                                            tx1.executeSql(
                                                                                                                "Select * from evidencias_proteus where id_cedula= ? AND page = 2",
                                                                                                                [id_cedula],
                                                                                                                function(tx, results){
                                                                                                                    var length = results.rows.length;
                                                                                                                    if (length == 0){}else{paso4=1;}
                                                                                                                    if(paso == 0 || paso1 == 0 || paso2 == 0 || paso3 == 0 || paso4 == 0){
                                                                                                                        swal({
                                                                                                                            title: "Aviso",
                                                                                                                            text: "Aun no agregas evidencias en el apartado de: Foto antes del servico, Limpieza del equipo por fuera, Limpieza del equipo por dentro o Foto después del servicio. ¿Estas seguro que deseas regresar?",
                                                                                                                            icon: "warning",
                                                                                                                            buttons: true,
                                                                                                                            dangerMode: false,
                                                                                                                        })
                                                                                                                        .then((willGoBack) => {
                                                                                                                            if (willGoBack){
                                                                                                                                app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                                                                                                                            } else {}
                                                                                                                        });
                                                                                                                    } else {
                                                                                                                        app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                                                                                                                    }
                                                                                                                },
                                                                                                                function(tx, error){
                                                                                                                    console.log("Error al consultar: " + error.message);
                                                                                                                }
                                                                                                            );
                                                                                                        },
                                                                                                        function(error){},
                                                                                                        function(){}
                                                                                                    );
                                                                                                },
                                                                                                function(tx, error){
                                                                                                    console.log("Error al consultar: " + error.message);
                                                                                                }
                                                                                            );
                                                                                        },
                                                                                        function(error){},
                                                                                        function(){}
                                                                                    );
                                                                                },
                                                                                function(tx, error){
                                                                                    console.log("Error al consultar: " + error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.log("Error al consultar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                            }
                        },
                        function(tx, error){
                            console.log("Error : " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function addequiposProteus(os){
        var id_cedula = localStorage.getItem("IdCedula");
        app.preloader.show('blue');
        var NomDescCli = "equipo_proteus";
        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
            var content = JSON.parse(data);
            for (var i = 0; i < content.length; i++) {
                if(content[i].os == os){
                    var modelo = content[i].modelo;
                    var id_cliente = content[i].id_cliente;
                    var contenedor = content[i].contenedor;
                    var ubicacion = content[i].ubicacion;
                    var unidades = content[i].unidades;
                    productHandler.addEquipoProteus(id_cedula,id_cliente,modelo,contenedor,ubicacion);
                    if (modelo == 'Nivelador de pH'){
                        //$("#div_nivelador").css("display", "block");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO reposicion_proteus(id_cedula, nivelador) VALUES (?,?)",
                                    [id_cedula, unidades],
                                    function(tx, results){
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error: " + error.message);
                            },
                            function(){}
                        );
                    }else if(modelo.includes('Proteus GT')){
                        //$("#div_microorganismosU").css("display", "block");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO reposicion_proteus(id_cedula, kit_micro) VALUES (?,?)",
                                [id_cedula, unidades],
                                    function(tx, results){
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error: " + error.message);
                            },
                            function(){}
                        );
                    }else if(modelo.includes('Manual')){
                        //$("#div_microorganismosL").css("display", "block");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO reposicion_proteus(id_cedula, micro_activados) VALUES (?,?)",
                                [id_cedula, unidades],
                                    function(tx, results){
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){
                                console.error("Error: " + error.message);
                            },
                            function(){}
                        );
                    }
                }
            }
            app.preloader.hide();
        });
    }
    function guardarEvidenciaProteus2(fase){
        if(fase == 1){
            let id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var foto = $("#imagenC4").val();
            var comentario = "Estado del equipo Antes de la Inspección";
            var page = 5;
            if (foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ? AND page = 5 ",
                        [id_cedula],
                            function(tx, results){
                                var item = results.rows.item(0);
                                if(results.rows.length == 0){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, foto, fecha,page,comentario) VALUES (?,?,?,?,?)",
                                                [id_cedula,foto,fecha_registro,5,comentario],
                                                function(tx, results){
                                                    swal("","Guardado correctamente","success");
                                                },
                                                function(tx, error){
                                                }
                                            );
                                        },function(error){},function(){
                                        }
                                    );
                                } else {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE evidencias_proteus SET foto = ?,fecha = ? WHERE id_cedula = ? AND page = 5",
                                                [foto, fecha_registro, id_cedula],
                                                function(tx, results){
                                                    swal("","Guardado correctamente","success");
                                                },
                                                function(tx, error){
                                                }
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            },
                            function(tx, error){
                                console.log("Error:" + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "La fotografía es requerida" ,"warning");
            }
        }else if(fase == 2){
            let id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var foto = $("#imagenC3").val();
            var comentario = "Estado del equipo Despues de la Inspección";
            var page = 4;
            if (foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ? AND page = 4 ",
                        [id_cedula],
                            function(tx, results){
                                var item = results.rows.item(0);
                                if(results.rows.length == 0){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, foto, fecha,page,comentario) VALUES (?,?,?,?,?)",
                                                [id_cedula,foto,fecha_registro,4,comentario],
                                                function(tx, results){
                                                    swal("","Guardado correctamente","success");
                                                },
                                                function(tx, error){
                                                }
                                            );
                                        },function(error){},function(){
                                        }
                                    );
                                } else {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE evidencias_proteus SET foto = ?,fecha = ? WHERE id_cedula = ? AND page = 4",
                                                [foto, fecha_registro, id_cedula],
                                                function(tx, results){
                                                    swal("","Guardado correctamente","success");
                                                },
                                                function(tx, error){
                                                }
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            },
                            function(tx, error){
                                console.log("Error:" + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "La fotografía es requerida" ,"warning");
            }
        }
    }
    function guardarEvidenciaProteus1(page){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        var comentario = $("#comentario").val();
        if (foto){
            if(comentario){}else{comentario='Sin comentario'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO evidencias_proteus(id_cedula, comentario, foto, fecha, page) VALUES (?,?,?,?,?)",
                        [id_cedula,comentario, foto, fecha_registro,page],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from evidencias_proteus where id_cedula = ? AND page = ? ORDER BY id_evidencia DESC",
                                            [id_cedula,page],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentario
                                                + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#comentario").val('');
                                                $("#comentario").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();
                                            }
                                    );
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotografía es requerida" ,"warning");
        }
    }

    function startFromProgramProteus(id_visita,id_cliente,nombre_comercial,local,horario_programado,social_reason,direction,contact_name,phone1,email,category,description,ruc){
        localStorage.setItem("id_visita", id_visita);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("nombre_comercial", nombre_comercial);
        localStorage.setItem("local", local);
        localStorage.setItem("social_reason", social_reason);
        localStorage.setItem("direction", direction);
        localStorage.setItem("contact_name", contact_name);
        localStorage.setItem("phone1", phone1);
        localStorage.setItem("email", email);
        localStorage.setItem("category", category);
        localStorage.setItem("description", description);
        localStorage.setItem("ruc", ruc);
        app.views.main.router.navigate({name: 'yallegueProteus2'});
    }

    function iniciarClienteProteus(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_visita = localStorage.getItem("id_visita");
        var id_cliente = localStorage.getItem("id_cliente");
        var nombre_cliente = localStorage.getItem("nombre_comercial");
        var local = localStorage.getItem("local");
        var social_reason = localStorage.getItem("social_reason");
        var direction = localStorage.getItem("direction");
        var contact_name = localStorage.getItem("contact_name");
        var phone1 = localStorage.getItem("phone1");
        var email = localStorage.getItem("email");
        var ruc = localStorage.getItem("ruc");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var tipoCedula = localStorage.getItem("category");
        var orden_servicio = "OS-"+id_visita;
        console.log('tipoCedula',tipoCedula)
        if(tipoCedula == "Instalacion"){
            tipoCedula = "Instalacion";
        } else if(tipoCedula == "Mantenimiento Preventivo"){
            tipoCedula = "Preventivo";
        } else if(tipoCedula == "Mantenimiento Correctivo"){
            tipoCedula = "Correctivo";
        } else if(tipoCedula == "Reposicion"){
            tipoCedula = "Reposicion";
        }
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                productHandler.addDatosGenerales(id_cedula,orden_servicio,foto_llegada,social_reason,ruc,local,direction,contact_name,phone1,"0",email,tipoCedula);
                                                if(tipoCedula == "Reposicion"){
                                                    localStorage.setItem("tipoServicio", "1");
                                                    addequiposProteus(orden_servicio);
                                                    app.views.main.router.back('/recorridoProteus1/', {force: true, ignoreCache: true, reload: true});
                                                } else if(tipoCedula == "Preventivo"){
                                                    addequiposProteus(orden_servicio);
                                                    localStorage.setItem("tipoServicio", "2");
                                                    app.views.main.router.back('/recorridoProteus2/', {force: true, ignoreCache: true, reload: true});
                                                } else if(tipoCedula == "Correctivo"){
                                                    addequiposProteus(orden_servicio);
                                                    localStorage.setItem("tipoServicio", "3");
                                                    app.views.main.router.back('/recorridoProteus3/', {force: true, ignoreCache: true, reload: true});
                                                } else if(tipoCedula == "Instalacion"){
                                                    addequiposProteus(orden_servicio);
                                                    localStorage.setItem("tipoServicio", "4");
                                                    app.views.main.router.back('/recorridoProteus4/', {force: true, ignoreCache: true, reload: true});
                                                }
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function clearSelected(){
        $('#estrategia option[value=""]').prop("selected", false);
        $('#Estrategias option[value=""]').prop("selected", false);
    }
    function capturePhoto6() {
        navigator.camera.getPicture(onPhotoSucceess6, onPhotoFail6, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess6(imageData) {
        var smallImage = document.getElementById('smallImage6');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC6").val(nameima);
        $("#photoIcon6").attr("src","img/reload.svg");
    }
    function onPhotoFail6(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhoto7() {
        navigator.camera.getPicture(onPhotoSucceess7, onPhotoFail7, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onPhotoSucceess7(imageData) {
        var smallImage = document.getElementById('smallImage7');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC7").val(nameima);
        $("#photoIcon7").attr("src","img/reload.svg");
    }
    function onPhotoFail7(message) {
        swal("Error al tomar foto:",message,"error");
    }
    //Fin Proteus
    //Inicio Bennetts2
    function buscarClienteBennetts2(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();;
        var foto_llegada = $("#imagenC").val();
        var horario_programado = fecha_llegada;
        var nombre_cliente = $("#cliente-Field").val();
        var id_visita = $("#id_visita").val();
        var factura = $("#factura").val();
        var fecha_factura = $("#fecha_factura").val();
        var importe = $("#importe").val();
        var movimiento = $("#movimiento").val();

        var estatus = 0;

        var calle = $('#calle').val();
        var bloque = $('#bloque').val();
        var ciudad = $('#ciudad').val();
        var no_calle = $('#no_calle').val();
        var cp = $('#cp').val();
        var pais = $('#pais').val();
        var codigo = $('#codigo').val();
        var revision_lunes = $('#revision_lunes').val();
        var revision_martes = $('#revision_martes').val();
        var revision_miercoles = $('#revision_miercoles').val();
        var revision_jueves = $('#revision_jueves').val();
        var revision_viernes = $('#revision_viernes').val();
        var contrarecibo = $('#contrarecibo').val();
        var entrada_almacen = $('#entrada_almacen').val();
        var folio_mercancia = $('#folio_mercancia').val();
        var id_reglas = $('#id_reglas').val();
        var acuse_soporte = $('#acuse_soporte').val();
        var firma_bennetts = $('#firma_bennetts').val();
        var firma_key = $('#firma_key').val();
        var recibido_bennetts = $('#recibido_bennetts').val();
        var recibido_key = $('#recibido_key').val();
        var orden_compra = $('#orden_compra').val();
        var otro = $('#otro').val();
        var pago_lunes = $('#pago_lunes').val();
        var pago_martes = $('#pago_martes').val();
        var pago_miercoles = $('#pago_miercoles').val();
        var pago_jueves = $('#pago_jueves').val();
        var pago_viernes = $('#pago_viernes').val();
        var proceso_pago = $('#proceso_pago').val();
        var estado = $('#estado').val();

        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("INSERT INTO cobranza(id_cedula,foto_inicio,id_visita,id_cliente,cliente,calle,bloque,ciudad,no_calle,cp,pais,codigo,revision_lunes,revision_martes,revision_miercoles,revision_jueves,revision_viernes,contrarecibo,entrada_almacen,folio_mercancia,id_reglas,acuse_soporte,firma_bennetts,firma_key,recibido_bennetts,recibido_key,orden_compra,otro,pago_lunes,pago_martes,pago_miercoles,pago_jueves,pago_viernes,proceso_pago,estado,vuelta) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                            [item.Id,foto_llegada,id_visita,id_cliente,nombre_cliente,calle,bloque,ciudad,no_calle,cp,pais,codigo,revision_lunes,revision_martes,revision_miercoles,revision_jueves,revision_viernes,contrarecibo,entrada_almacen,folio_mercancia,id_reglas,acuse_soporte,firma_bennetts,firma_key,recibido_bennetts,recibido_key,orden_compra,otro,pago_lunes,pago_martes,pago_miercoles,pago_jueves,pago_viernes,proceso_pago,estado,estatus],
                                            function(tx, results){
                                                localStorage.setItem("IdCedula", item.Id);
                                                let tipoCedula = "Cobranza";
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                            [tipoCedula,item.Id],
                                                            function(tx, results){
                                                                //var cliente = $("#IdCte").val();
                                                                ingresaDocumentos2(id_cliente,item.Id);
                                                                app.views.main.router.navigate({name: 'recorridoBennetts2-1'});
                                                                app.preloader.hide();
                                                            },
                                                            function(tx, error){
                                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );

                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function regresarRecorridoBennetts21(){
        app.views.main.router.back('/recorridoBennetts2-1/', {force: true, ignoreCache: true, reload: true});
    }
    function guardarEvidenciaBennetts2(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var observacion = $("#observacion").val();
        var foto = $("#imagenC").val();
        if (foto){
            if(observacion){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO evidenciaCobranza(id_cedula,foto,observacion,fecha_registro) VALUES (?,?,?,?)",
                            [id_cedula,foto,observacion,fecha_registro],
                            function(tx, results){
                                app.preloader.hide();
                                swal("","Datos guardados correctamente","success");
                                $("#observacion").val('');
                                $('#observacion').css("background-color", "#ffffff");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from evidenciaCobranza where id_cedula = ? ORDER BY id_evidencia DESC",
                                        [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#observacion").val('');
                                                $("#observacion").css("background-color", "#FFFFFF");
                                                $("#imagenC").val('');
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#table_insumos").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaBennetts2("+
                                                item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                                item.observacion+ "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                app.preloader.hide();
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("","Debes ingresar una observación","warning");
                app.preloader.hide();
            }
        }else{
            swal("","Debes tomar una fotografia","warning");
            app.preloader.hide();
        }
    }
    function SirealizadoBennetts2(val,id_doc){
        var id_cedula = localStorage.getItem("IdCedula");
        if(val == 'Si'){
            var correcto = '';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE documentos SET realizado = ?,porque=? WHERE id_documentos = ?",
                        [val,correcto,id_doc],
                        function(tx, results){
                            $("#table_docs").empty();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from documentos WHERE id_cedula = ?",
                                        [id_cedula],
                                        function(tx, results){
                                            let length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item = results.rows.item(i);
                                                if(item.realizado == 'Si'){
                                                    select1=''; select2 = 'selected'; select3='';
                                                }else if(item.realizado == 'No'){
                                                    select1=''; select2 = ''; select3='selected';
                                                }else{
                                                    select1='selected'; select2 = ''; select3='';
                                                }
                                                if(item.porque != undefined){
                                                    porque = item.porque;
                                                }else{porque = '';}
                                                $("#table_docs").append("<tr id='fila"+ item.id_documentos +"'><td>"+item.no_documentos+"</td><td>"+
                                                    item.importe_app+"</td><td style='text-align: center;'>" + item.movimiento_realizado+
                                                    "</td><td style='text-align: center;'><select id='realizado' name='"+item.id_documentos+
                                                    "' onchange='SirealizadoBennetts2(this.value,this.name)' class='FWM-input input-with-value' style='text-align:center;padding-left: 0px !important;'><option value='0'"+
                                                    select1+">Elige</option><option value='Si'"+select2+">Si</option><option value='No'"+
                                                    select3+">No</option></select></td><td style='text-align: center;'>" + porque+
                                                    "</td></tr>");
                                                    $("#message-nr1").css("display", "none");
                                            }
                                        },
                                        function(tx, error){
                                            console.log("Error al mostar datos: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al guardar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al guardar: " + error.message);
                },
                function(){}
            );
        }else if(val=='No'){
            app.dialog.prompt("Favor de ingresar el motivo por el cuál no se realizó", 'FIELD',function (name) {
                var correcto= name;
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE documentos SET realizado = ?,porque=? WHERE id_documentos = ?",
                            [val,correcto,id_doc],
                            function(tx, results){
                                $("#table_docs").empty();
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from documentos WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                let length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item = results.rows.item(i);
                                                    if(item.realizado == 'Si'){
                                                        select1=''; select2 = 'selected'; select3='';
                                                    }else if(item.realizado == 'No'){
                                                        select1=''; select2 = ''; select3='selected';
                                                    }else{
                                                        select1='selected'; select2 = ''; select3='';
                                                    }
                                                    if(item.porque != undefined){
                                                        porque = item.porque;
                                                    }else{porque = '';}
                                                    $("#table_docs").append("<tr id='fila"+ item.id_documentos +"'><td>"+item.no_documentos+"</td><td>"+
                                                        item.importe_app+"</td><td style='text-align: center;'>" + item.movimiento_realizado+
                                                        "</td><td style='text-align: center;'><select id='realizado' name='"+item.id_documentos+
                                                        "' onchange='SirealizadoBennetts2(this.value,this.name)' class='FWM-input input-with-value' style='text-align:center;padding-left: 0px !important;'><option value='0'"+
                                                        select1+">Elige</option><option value='Si'"+select2+">Si</option><option value='No'"+
                                                        select3+">No</option></select></td><td style='text-align: center;'>" + porque+
                                                        "</td></tr>");
                                                        $("#message-nr1").css("display", "none");
                                                }
                                            },
                                            function(tx, error){
                                                console.log("Error al mostar datos: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al guardar: " + error.message);
                            }
                        );
                    },
                    function(error){
                        console.error("Error al guardar: " + error.message);
                    },
                    function(){}
                );
            });
        }
    }
    function NorealizadoBennetts2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var correcto = '';
        $("#porqueC").css("display","block")
        $("#realizo-1").prop("checked", false);
        if($("#realizo-2").prop("checked") == true){
            correcto = 'No';
        } else {
            $("#porqueC").css("display","none")
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cobranza SET realizado = ? WHERE id_cedula = ?",
                    [correcto,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){
                console.error("Error al guardar: " + error.message);
            },
            function(){}
        );
    }
    function continuarCedBennetts2(id_cedula,tipo){
        localStorage.setItem("Opcion", '1');
        localStorage.setItem("IdCedula", id_cedula);
        if (tipo == 1){
            app.views.main.router.back('/recorridoBennetts2-1/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardarCierreBennetts2(){
        if($("#na_firma").prop("checked") == true){
            if($("#NombreFirma").val() == ""){
                swal("","Debes ingresar el nombre de quien recibe el servicio","warning");
                return false;
            }
            var firmaCliente = '';
            var calificacion = '';
            var comentarioCliente = '';
        }else{
            if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
                swal("","Todos los campos son obligatorios","warning");
                return false;
            }
            if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
                swal("","Por favor, ingresa el motivo de tu calificacion","warning");
                return false;
            }
        }
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
          databaseHandler.db.transaction(
            function (tx) {
              tx.executeSql(
                "UPDATE cobranza SET firma_cliente = ?, fecha_cliente = ? WHERE id_cedula = ?",
                [firmaCliente, fecha_firma,id_cedula],
                function (tx, results) {
                  databaseHandler.db.transaction(
                    function (tx) {
                      tx.executeSql(
                        "UPDATE cedulas_general SET nombre_evalua = ?,calificacion = ?,comentario_cliente = ? WHERE id_cedula = ?",
                        [nombrefirma,calificacion,comentarioCliente,id_cedula],
                        function (tx, results) {
                          swal("", "Guardado correctamente", "success");
                          app.views.main.router.back("/yamevoyBennetts2-1/", {
                            force: true,
                            ignoreCache: true,
                            reload: true,
                          });
                        },
                        function (tx, error) {
                          console.error("Error al guardar cierre: " + error.message);
                        }
                      );
                    },
                    function (error) {},
                    function () {}
                  );
                },
                function (tx, error) {
                  console.error("Error al guardar cierre: " + error.message);
                }
              );
            },
            function (error) {},
            function () {}
          );
    }
    function terminarServicioBennetts21(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cobranza SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function llegadaOfiBennetts2(){
        var id_usuario = localStorage.getItem("id_usuario");
        var foto = $("#imagenC").val();
        var geolocation = $("#geolocation").val();
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var hora = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ofi = $("#id_visita").val();
        if (ofi){
            var estatus = 6;
        }else{
            var estatus = 0;
        }
        if (foto){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO control (id_usuario, fecha, hora_oficina, geolocalizacion_oficina, foto_oficina, estatus) VALUES (?,?,?,?,?,?)",
                        [id_usuario, fecha_actual, hora, geolocation, foto, estatus],
                        function(tx, results){
                            window.location.href = "./menu.html";
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function ArranqueBennetts2(){
        var id_usuario = localStorage.getItem("id_usuario");
        var foto = $("#imagenC").val();
        var geolocation = $("#geolocation").val();
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var hora = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var estatus = 2;
        if (foto){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE control SET hora_arranque = ?, geolocalizacion_arranque = ?, foto_arranque = ?, estatus = ? WHERE id_usuario = ? AND fecha = ?",
                        [hora, geolocation, foto, estatus, id_usuario, fecha_actual],
                        function(tx, results){
                            window.location.href = "./menu.html";
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function enviarHorasBennetts(){
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from control WHERE id_usuario = ? AND fecha = ?",
                    [id_usuario, fecha_actual],
                    function(tx, results){
                        let length = results.rows.length;
                        if (length == 0){
                        }else{
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                var estado = item.estatus;
                                if (estado == 0){
                                    swal("","Enviando...","success");
                                    var datos = new Array();
                                    datos[0] = {'id_usuario':id_usuario,'fecha':item.fecha,'hora_oficina':item.hora_oficina,'geolocalizacion_oficina':item.geolocalizacion_oficina,'foto_oficina':item.foto_oficina};
                                    $.ajax({
                                        type: "POST",
                                        async : true,
                                        url: "http://www.appbennetts.com/FWM2/app/guardarEnvioHorasBennetts.php?clave=1",
                                        dataType: 'html',
                                        data: {'datos': JSON.stringify(datos)},
                                        success: function(respuesta){
                                            if(respuesta == 'oki1'){
                                                databaseHandler.db.transaction(
                                                    function(tx7){
                                                        tx7.executeSql(
                                                            "UPDATE control SET estatus = 1 WHERE fecha = ? AND id_usuario = ?",
                                                            [fecha_actual,id_usuario],
                                                            function(tx7, results){
                                                                swal("","Registro de llegada Oficina guardado correctamente","success");
                                                            }
                                                        );
                                                    }
                                                );
                                            }
                                        },
                                        error: function(){
                                            console.log("Error en la comunicacion con el servidor");
                                        }
                                    });
                                }else if (estado == 6){
                                    swal("","Enviando...","success");
                                    var datos = new Array();
                                    datos[0] = {'id_usuario':id_usuario,'fecha':item.fecha,'hora_oficina':item.hora_oficina,'geolocalizacion_oficina':item.geolocalizacion_oficina,'foto_oficina':item.foto_oficina};
                                    $.ajax({
                                        type: "POST",
                                        async : true,
                                        url: "http://www.appbennetts.com/FWM2/app/guardarEnvioHorasBennetts.php?clave=1",
                                        dataType: 'html',
                                        data: {'datos': JSON.stringify(datos)},
                                        success: function(respuesta){
                                            if(respuesta == 'oki1'){
                                                databaseHandler.db.transaction(
                                                    function(tx7){
                                                        tx7.executeSql(
                                                            "UPDATE control SET estatus = 7 WHERE fecha = ? AND id_usuario = ?",
                                                            [fecha_actual,id_usuario],
                                                            function(tx7, results){
                                                                swal("","Registro de regreso a Oficina guardado correctamente","success");
                                                            }
                                                        );
                                                    }
                                                );
                                            }
                                        },
                                        error: function(){
                                            console.log("Error en la comunicacion con el servidor");
                                        }
                                    });
                                }
                            }
                        }
                    },
                    function(tx, error){
                        console.log("Error al mostar datos: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function enviarHorasBennetts2(){
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from control WHERE id_usuario = ? AND fecha == ?",
                    [id_usuario, fecha_actual],
                    function(tx, results){
                        let length = results.rows.length;
                        if (length == 0){
                        }else{
                            var item = results.rows.item(0);
                            var estado = item.estatus;
                            var horas = item.hora_arranque;
                            if (estado == 2){
                                if(horas){
                                    swal("","Enviando...","success");
                                    var datos = new Array();
                                    datos[0] = {'id_usuario':id_usuario,
                                        'fecha':item.fecha,
                                        'hora_arranque':item.hora_arranque,
                                        'geolocalizacion_arranque':item.geolocalizacion_arranque,
                                        'foto_arranque':item.foto_arranque
                                    };
                                    $.ajax({
                                        type: "POST",
                                        async : true,
                                        url: "http://www.appbennetts.com/FWM2/app/guardarEnvioHorasBennetts.php?clave=3",
                                        dataType: 'html',
                                        data: {'datos': JSON.stringify(datos)},
                                        success: function(respuesta){
                                            if(respuesta == 'oki1'){
                                                databaseHandler.db.transaction(
                                                    function(tx7){
                                                        tx7.executeSql(
                                                            "UPDATE control SET estatus = 3 WHERE fecha = ? AND id_usuario = ?",
                                                            [fecha_actual,id_usuario],
                                                            function(tx7, results){
                                                                swal("","Registro de arranque cobranza guardado correctamente","success");
                                                            }
                                                        );
                                                    }
                                                );
                                            }
                                        },
                                        error: function(){
                                            console.log("Error en la comunicacion con el servidor");
                                        }
                                    });
                                }
                            }else if(estado == 4){
                                    if(horas){
                                        swal("","Enviando...","success");
                                        var datos = new Array();
                                        datos[0] = {'id_usuario':id_usuario,
                                            'fecha':item.fecha,
                                            'hora_cierre':item.hora_cierre,
                                            'geolocalizacion_cierre':item.geolocalizacion_cierre,
                                            'foto_cierre':item.foto_cierre
                                        };
                                        $.ajax({
                                            type: "POST",
                                            async : true,
                                            url: "http://www.appbennetts.com/FWM2/app/guardarEnvioHorasBennetts.php?clave=4",
                                            dataType: 'html',
                                            data: {'datos': JSON.stringify(datos)},
                                            success: function(respuesta){
                                                if(respuesta == 'oki1'){
                                                    databaseHandler.db.transaction(
                                                        function(tx7){
                                                            tx7.executeSql(
                                                                "UPDATE control SET estatus = 5 WHERE fecha = ? AND id_usuario = ?",
                                                                [fecha_actual,id_usuario],
                                                                function(tx7, results){
                                                                    swal("","Cierre de ruta registrada correctamente","success");
                                                                }
                                                            );
                                                        }
                                                    );
                                                }
                                            },
                                            error: function(){
                                                console.log("Error en la comunicacion con el servidor");
                                            }
                                        });
                                    }

                            }else if (estado == 0){
                                swal("","Enviando...","success");
                                var datos = new Array();
                                datos[0] = {'id_usuario':id_usuario,
                                    'fecha':item.fecha,
                                    'hora_oficina':item.hora_oficina,
                                    'geolocalizacion_oficina':item.geolocalizacion_oficina,
                                    'foto_oficina':item.foto_oficina,
                                    'hora_arranque':item.hora_arranque,
                                    'geolocalizacion_arranque':item.geolocalizacion_arranque,
                                    'foto_arranque':item.foto_arranque
                                };
                                $.ajax({
                                    type: "POST",
                                    async : true,
                                    url: "http://www.appbennetts.com/FWM2/app/guardarEnvioHorasBennetts.php?clave=2",
                                    dataType: 'html',
                                    data: {'datos': JSON.stringify(datos)},
                                    success: function(respuesta){
                                        if(respuesta == 'oki1'){
                                            databaseHandler.db.transaction(
                                                function(tx7){
                                                    tx7.executeSql(
                                                        "UPDATE control SET estatus = 2 WHERE fecha = ? AND id_usuario = ?",
                                                        [fecha_actual,id_usuario],
                                                        function(tx7, results){
                                                            swal("","Registro de arranque cobranza guardado correctamente","success");
                                                        }
                                                    );
                                                }
                                            );
                                        }
                                    },
                                    error: function(){
                                        console.log("Error en la comunicacion con el servidor");
                                    }
                                });
                            }
                        }
                    },
                    function(tx, error){
                        console.log("Error al mostar datos: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function consultaHorasPendientes(){
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from control WHERE id_usuario = ? AND fecha = ? AND (estatus = 0 OR estatus = 6)",
                    [id_usuario, fecha_actual],
                    function(tx, results){
                        let length = results.rows.length;
                        if (length == 0){
                        }else{
                            enviarHorasBennetts();
                        }
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql(
                                    "Select * from control WHERE id_usuario = ? AND fecha = ? AND (estatus = 2 OR estatus = 4)",
                                    [id_usuario, fecha_actual],
                                    function(tx, results){
                                        let length = results.rows.length;
                                        if (length == 0){
                                        }else{
                                            enviarHorasBennetts2();
                                        }
                                    },
                                    function(tx, error){
                                        console.log("Error al mostar datos: " + error.message);
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.log("Error al mostar datos: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function consultaHorasAtrasadas(){
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from control WHERE id_usuario = ? AND fecha <> ? AND estatus = 0",
                    [id_usuario, fecha_actual],
                    function(tx, results){
                        let length = results.rows.length;
                        var item = results.rows.item(0);
                        if (length == 0){
                        }else{
                            enviarHorasBennetts2();
                        }
                    },
                    function(tx, error){
                        console.log("Error al mostar datos: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function ingresaDocumentos(cliente,id_cedula, facturas1){
        var facturas = facturas1.replaceAll('._.', '"');
        var content2 = JSON.parse(facturas);
            for(var x = 0; x < content2.length; x++) {
                no_documentos = content2[x].factura;
                importe = content2[x].importe;
                movimiento_realizado = content2[x].movimiento;
                productHandler.addDocumentosBennetts2(id_cedula,no_documentos,importe,movimiento_realizado);
            }
    }
    function eliminarFilaBennetts2(index, opc){//nueva
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidenciaCobranza WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function vueltaenfalsobennetts2(){//nueva
        app.dialog.prompt("Favor de describir el motivo de la vuelta en falso", 'FIELD',function (result) {
            var id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var estatus = 1;
            var vuelta = 1;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cobranza SET motivo_vuelta  = ?,vuelta = ? WHERE id_cedula = ?",
                        [result,vuelta,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,estatus = ? WHERE id_cedula = ?",
                                        [fecha_salida,estatus,id_cedula],
                                        function(tx, results){
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        });
    }
    function regreso_A_Ofi(){
        $("#llegada").css("display","block");
        $("#btn_llegada").css("display","block");
        $("#listo").css("display","none");
        $("#btn_listo").css("display","none");
        $("#input_cliente").css("display","none");
        $("#regreso_ofi").css("display","none");
        $("#cierre").css("display","none");
        $("#btn_cierre").css("display","none");
        $("#id_visita").val(2);
    }
    function startFromProgramBennetts2(id_cliente,nombre_comercial,facturas,calle,bloque,ciudad,no_calle,cp,pais,codigo,revision_lunes,revision_martes,revision_miercoles,revision_jueves,revision_viernes,contrarecibo,entrada_almacen,folio_mercancia,id_reglas,acuse_soporte,firma_bennetts,firma_key,recibido_bennetts,recibido_key,orden_compra,otro,pago_lunes,pago_martes,pago_miercoles,pago_jueves,pago_viernes,proceso_pago,estado){
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("nombre_comercial", nombre_comercial);
        localStorage.setItem("calle", calle);
        localStorage.setItem("bloque", bloque);
        localStorage.setItem("ciudad", ciudad);
        localStorage.setItem("no_calle", no_calle);
        localStorage.setItem("cp", cp);
        localStorage.setItem("pais", pais);
        localStorage.setItem("codigo", codigo);
        localStorage.setItem("revision_lunes", revision_lunes);
        localStorage.setItem("revision_martes", revision_martes);
        localStorage.setItem("revision_miercoles", revision_miercoles);
        localStorage.setItem("revision_jueves", revision_jueves);
        localStorage.setItem("revision_viernes", revision_viernes);
        localStorage.setItem("contrarecibo", contrarecibo);
        localStorage.setItem("entrada_almacen", entrada_almacen);
        localStorage.setItem("folio_mercancia", folio_mercancia);
        localStorage.setItem("id_reglas", id_reglas);
        localStorage.setItem("acuse_soporte", acuse_soporte);
        localStorage.setItem("firma_bennetts", firma_bennetts);
        localStorage.setItem("firma_key", firma_key);
        localStorage.setItem("recibido_bennetts", recibido_bennetts);
        localStorage.setItem("recibido_key", recibido_key);
        localStorage.setItem("orden_compra", orden_compra);
        localStorage.setItem("otro", otro);
        localStorage.setItem("pago_lunes", pago_lunes);
        localStorage.setItem("pago_martes", pago_martes);
        localStorage.setItem("pago_miercoles", pago_miercoles);
        localStorage.setItem("pago_jueves", pago_jueves);
        localStorage.setItem("pago_viernes", pago_viernes);
        localStorage.setItem("proceso_pago", proceso_pago);
        localStorage.setItem("estado", estado);
        localStorage.setItem("facturas", facturas);
        app.views.main.router.navigate({name: 'yallegueBennetts2-2'});
    }
    function iniciarClienteBennetts2(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var nombre_cliente = localStorage.getItem("nombre_comercial");
        var id_visita = localStorage.getItem("id_visita");
        var id_cliente = localStorage.getItem("id_cliente");
        var calle = localStorage.getItem("calle");
        var bloque = localStorage.getItem("bloque");
        var ciudad = localStorage.getItem("ciudad");
        var no_calle = localStorage.getItem("no_calle");
        var cp = localStorage.getItem("cp");
        var pais = localStorage.getItem("pais");
        var codigo = localStorage.getItem("codigo");
        var revision_lunes = localStorage.getItem("revision_lunes");
        var revision_martes = localStorage.getItem("revision_martes");
        var revision_miercoles = localStorage.getItem("revision_miercoles");
        var revision_jueves = localStorage.getItem("revision_jueves");
        var revision_viernes = localStorage.getItem("revision_viernes");
        var contrarecibo = localStorage.getItem("contrarecibo");
        var entrada_almacen = localStorage.getItem("entrada_almacen");
        var folio_mercancia = localStorage.getItem("folio_mercancia");
        var id_reglas = localStorage.getItem("id_reglas");
        var acuse_soporte = localStorage.getItem("acuse_soporte");
        var firma_bennetts = localStorage.getItem("firma_bennetts");
        var firma_key = localStorage.getItem("firma_key");
        var recibido_bennetts = localStorage.getItem("recibido_bennetts");
        var recibido_key = localStorage.getItem("recibido_key");
        var orden_compra = localStorage.getItem("orden_compra");
        var otro = localStorage.getItem("otro");
        var pago_lunes = localStorage.getItem("pago_lunes");
        var pago_martes = localStorage.getItem("pago_martes");
        var pago_miercoles = localStorage.getItem("pago_miercoles");
        var pago_jueves = localStorage.getItem("pago_jueves");
        var pago_viernes = localStorage.getItem("pago_viernes");
        var proceso_pago = localStorage.getItem("proceso_pago");
        var estado = localStorage.getItem("estado");

        var facturas = localStorage.getItem("facturas");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();

        var tipoCedula = localStorage.getItem("category");
        tipoCedula = "Cobranza";

        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("INSERT INTO cobranza(id_cedula,foto_inicio,id_visita,id_cliente,cliente,calle,bloque,ciudad,no_calle,cp,pais,codigo,revision_lunes,revision_martes,revision_miercoles,revision_jueves,revision_viernes,contrarecibo,entrada_almacen,folio_mercancia,id_reglas,acuse_soporte,firma_bennetts,firma_key,recibido_bennetts,recibido_key,orden_compra,otro,pago_lunes,pago_martes,pago_miercoles,pago_jueves,pago_viernes,proceso_pago,estado,vuelta) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                            [id_cedula,foto_llegada,id_visita,id_cliente,nombre_cliente,calle,bloque,ciudad,no_calle,cp,pais,codigo,revision_lunes,revision_martes,revision_miercoles,revision_jueves,revision_viernes,contrarecibo,entrada_almacen,folio_mercancia,id_reglas,acuse_soporte,firma_bennetts,firma_key,recibido_bennetts,recibido_key,orden_compra,otro,pago_lunes,pago_martes,pago_miercoles,pago_jueves,pago_viernes,proceso_pago,estado,estatus],
                                            function(tx, results){
                                                localStorage.setItem("IdCedula", item.Id);
                                                let tipoCedula = "Cobranza";
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                            [tipoCedula,item.Id],
                                                            function(tx, results){
                                                                ingresaDocumentos(id_cliente,item.Id,facturas);
                                                                app.views.main.router.navigate({name: 'recorridoBennetts2-1'});
                                                                app.preloader.hide();
                                                            },
                                                            function(tx, error){
                                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );

                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function cierreRutaBennetts2(){
        swal({
            title: "Aviso",
            text: "¿Estas seguro de querer cerrar tu ruta?",
            icon: "warning",
            buttons: true,
            dangerMode: false,
        })
        .then((willGoBack) => {
            if (willGoBack){
                $("#cierre").css("display","block");
                $("#btn_cierre").css("display","block");
                $("#listo").css("display","none");
                $("#btn_listo").css("display","none");
                $("#input_cliente").css("display","none");
                $("#regreso_ofi").css("display","none");
                $("#llegada").css("display","none");
                $("#btn_llegada").css("display","none");
            }
        });
    }
    function oficinabennetts2(){
        localStorage.setItem("ubicacion","ofi")
        app.views.main.router.navigate({name: 'yallegueBennetts2'});
    }
    function cierrebennetts2(){
        localStorage.setItem("ubicacion","fin_ruta")
        app.views.main.router.navigate({name: 'yallegueBennetts2'});
    }
    function cierreRutasBennetts2(){
        var id_usuario = localStorage.getItem("id_usuario");
        var foto = $("#imagenC").val();
        var geolocation = $("#geolocation").val();
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var hora = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var estatus = 4;
        if (foto){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE control SET hora_cierre = ?, geolocalizacion_cierre = ?, foto_cierre = ?, estatus = ? WHERE id_usuario = ? AND fecha = ?",
                        [hora, geolocation, foto, estatus, id_usuario, fecha_actual],
                        function(tx, results){
                            window.location.href = "./menu.html";
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function ingresaDocumentos2(cliente,id_cedula){
        var NomDescCli = 'cobranza_bennetts2';
        var fecha = new Date();
        var fecha_actual = fecha.getFullYear()+"-"+('0'+(fecha.getMonth()+1)).slice(-2)+"-"+('0'+fecha.getDate()).slice(-2);
        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
            var content2 = JSON.parse(data);
            for(var x = 0; x < content2.length; x++) {
                if(content2[x].IdCliente == cliente){
                    if(content2[x].fecha == fecha_actual){
                        no_documentos = content2[x].no_documentos;
                        importe = content2[x].importe;
                        movimiento_realizado = content2[x].movimiento_realizado;
                        productHandler.addDocumentosBennetts2(id_cedula,no_documentos,importe,movimiento_realizado);
                    }
                }
            }
        });
    }
    //Fin Bennetts2
    //inicio BennettsL
    function buscarClienteBennettsL(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var foto_llegada = $("#imagenC").val();
        var nocliente = $("#id_cliente").val();
        var razon_social = $("#nombre_cliente").val();
        //nuevo
        var rol = localStorage.getItem("rol");
        var roles = rol.split("-");
        var horario_programado = fecha_llegada;
        var estatus = 0;
        if (roles[1] == 'EB'){
            var reglas = $("#reglas1").val();
        }else{
            var calle = $("#calle").val();
            var colonia = $("#colonia").val();
            var no_exterior = $("#no_exterior").val();
            var codigo_postal = $("#codigo_postal").val();
            var estado = $("#estado").val();
            var ciudad = $("#ciudad").val();
        }
            if(foto_llegada != ''){
                if(nocliente != ''){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,nocliente,razon_social,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function (tx) {
                            tx.executeSql(
                            "Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function (tx, results) {
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("social_reason", razon_social);
                                localStorage.setItem("id_cliente", nocliente);
                                ///nuevos
                                if (roles[1] == 'EB'){
                                    localStorage.setItem("facturas",reglas);
                                    if(localStorage.getItem("division") == 1){
                                        generarBennettsLLogistica()
                                    } else if(localStorage.getItem("division") == 2){
                                        generarBennettsServicioTecnico()
                                    }
                                }else if(roles[1] == 'KEY'){
                                    //localStorage.setItem("ruc",reglas2);
                                    localStorage.setItem("codigoPostal",codigo_postal);
                                    localStorage.setItem("calle",calle);
                                    localStorage.setItem("colonia",colonia);
                                    localStorage.setItem("no_exterior",no_exterior);
                                    localStorage.setItem("estado",estado);
                                    localStorage.setItem("ciudad",ciudad);
                                    app.views.main.router.navigate({ name: "menuBennettsL" });
                                }else if(roles[1] == 'SURO'){
                                    if(localStorage.getItem("division") == 4){
                                        generarBennettsLLogistica()
                                    }
                                }
                            },
                            function (tx, error) {
                                console.log("Error al guardar cedula: " + error.message);
                            }
                            );
                        },
                        function (error) {},
                        function () {}
                    );
                } else {
                    swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
    }
    function generarBennettsLLogistica(){
        var rol = localStorage.getItem("rol");
        var roles = rol.split("-");

        let tipoCedula = "logistica";
        let id_cedula = localStorage.getItem("IdCedula");
        let razon_social = localStorage.getItem("social_reason");
        let nocliente = localStorage.getItem("id_cliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        if (roles[1] == 'EB'){
            var reglas = localStorage.getItem("facturas");
            var reglas_des = reglas.split("._.");
            var acceso_proveedor = '';
            var correo1  = 0;
            var correo1_campo = '';
            var otro_med1  = 0;
            var otro_med1_campo = '';
            var correo2  = 0;
            var correo2_campo = '';
            var otro_med2  = 0;
            var otro_med2_campo = '';
            var dias_anticipacion = '';
            var persona_autorizada = '';
            var chaleco = 0;
            var dias_solicitud= '';
            var nombre_recibe = '';
            var segundo_nombre= '';
            var apellido= '';
            var puesto= '';
            var correo= '';
            var telefono_1= '';
            var telefono_2 = '';
            var calle= '';
            var no_exterior= '';
            var no_interior = '';
            var colonia= '';
            var ciudad= '';
            var cp= '';
            var alcadia= '';
            var estado= '';

            if(reglas_des[2]){  nombre_recibe = reglas_des[2]+'*';  /*content2[x].FirstName;*/ } 
            if(reglas_des[3]){  segundo_nombre = reglas_des[3]+'*'; /*content2[x].MiddleName;*/}
            if(reglas_des[4]){ apellido = reglas_des[4]+'*';} /*content2[x].LastName;*/ 
            if(reglas_des[5]){ puesto = reglas_des[5]+'*';}//content2[x].Position;
            if(reglas_des[6]){ correo = reglas_des[6]+'*';}//content2[x].E_MailL;
            if(reglas_des[7]){ telefono_1 = reglas_des[7]+'*';}//content2[x].Tel1;
            if(reglas_des[8]){ telefono_2 = reglas_des[8]+'*';}//content2[x].Tel2;
            if(reglas_des[9]){ calle = reglas_des[9]+'*';}//content2[x].Street;
            if(reglas_des[10]){ no_exterior = reglas_des[10]+'*';}//content2[x].StreetNo;
            if(reglas_des[11]){ no_interior = reglas_des[11]+'*';}//content2[x].Building;
            if(reglas_des[12]){ colonia = reglas_des[12]+'*';}//content2[x].Block;
            if(reglas_des[13]){ ciudad = reglas_des[13]+'*';}//content2[x].City;
            if(reglas_des[14]){ cp = reglas_des[14]+'*';}//content2[x].ZipCode;
            if(reglas_des[15]){ alcadia = reglas_des[15]+'*';}//content2[x].County;
            if(reglas_des[16]){ estado = reglas_des[16]+'*';}//content2[x].State;

            if(reglas_des[17]){
                var OC_copias = reglas_des[17]+'*';//content2[x].U_Copias_OC;
                if(OC_copias != 0){
                    var OC = 1;
                }else{
                    var OC = 0;
                }
            }else{
                var OC = 0;
            }
            if(reglas_des[18]){
                var factura_copias = reglas_des[18]+'*';//content2[x].U_Copias_FB;
                if(factura_copias != 0){
                    var factura = 1;
                }else{
                    var factura = 0;
                }
            }else{
                var factura = 0;
            }
            if(reglas_des[19]){
                var SUA_copias = reglas_des[19]+'*';//content2[x].U_Copias_SUA;
                if(SUA_copias != 0){
                    var SUA = 1;
                }else{
                    var SUA = 0;
                }
            }else{
                var SUA = 0;
            }
            if(reglas_des[20]){
                var TIA_copias = reglas_des[20]+'*';//content2[x].U_Copias_TIA;
                if(TIA_copias != 0){
                    var TIA = 1;
                }else{
                    var TIA = 0;
                }
            }else{
                var TIA = 0;
            }
            if(reglas_des[21]){
                var otro_doc_copias = reglas_des[21]+'*';//content2[x].U_Otros;
                if(otro_doc_copias != 0){
                    var otro_doc = 1;
                }else{
                    var otro_doc = 0;
                }
            }else{
                var otro_doc = 0;
            }
            var dias = '';

            if(reglas_des[22] == 'Y'){
                dias = dias+"L,";
            }
            if(reglas_des[23] == 'Y'){
                dias = dias+"Ma,";
            }
            if(reglas_des[24] == 'Y'){
                dias = dias+"Mi,";
            }
            if(reglas_des[25] == 'Y'){
                dias = dias+"J,";
            }
            if(reglas_des[26] == 'Y'){
                dias = dias+"V,";
            }
            if(reglas_des[27] == 'Y'){
                dias = dias+"S";
            }
            var horas_I = reglas_des[28];//content2[x].U_HorariosLV;
            var horas_F = reglas_des[28];//content2[x].U_HorariosLV;
            var horasS_I = reglas_des[29];//content2[x].U_HorarioS;
            var horasS_F = reglas_des[29];//content2[x].U_HorarioS;
            if(reglas_des[30]){
                var permiso = 1;//content2[x].U_PEntrega;
            }else{
                var permiso = 0;
            }

            if(reglas_des[31]){
                var medio1  = 1;//content2[x].U_PEntrega;
                var medio1_campo = reglas_des[31]+'*';//content2[x].U_MedioP;
            }else{
                var medio1 = 0;
                var medio1_campo = reglas_des[31];//content2[x].U_MedioP;
            }

            //var dias_solicitud = reglas_des[32];//content2[x].U_TEntrega;
            if(reglas_des[33]){
                var cita = 1;
            }else{
                var cita = 0;
            }

            if(reglas_des[34]){
                var medio2 = 1;
                var medio2_campo =  reglas_des[34]+'*';//content2[x].U_MCita;
            }else{
                var medio2 = 0;
            }
            if(reglas_des[35]){//content2[x].U_EA;
                var entrada_almacen = 1;
            }else{
                var entrada_almacen = 0;
            }
            if(reglas_des[36]){//content2[x].U_Folio;
                var folio_recepcion = 1;
            }else{
                var folio_recepcion = 0;
            }
            if(reglas_des[37]){//content2[x].U_CR;
                var contra_recibo = 1;
            }else{
                var contra_recibo = 0;
            }
            if(reglas_des[38]){//content2[x].U_Firma;
                var firma_sello = 1;
            }else {
                var firma_sello = 0;
            }
            if(reglas_des[39]){//content2[x].U_Recibido;
                var recibido_factura = 1;
            }else {
                var recibido_factura = 0;
            }
            if(reglas_des[40]){//content2[x].U_SelloCte;
                var sello_cliente = 1;
            }else {
                var sello_cliente = 0;
            }
            if(reglas_des[41]){//content2[x].U_OC;
                var oc3 = 1;
            }else {
                var oc3 = 0;
            }
            if(reglas_des[42]){//content2[x].U_ID;
                var id3 = 1;
            }else{
                var id3 = 0;
            }
            if(reglas_des[43]){//content2[x].U_Otro;
                var otro3 = 1;
            }else{
                var otro3 = 0;
            }
            if(reglas_des[44]){//content2[x].U_Ninguno;
                var ninguno = 1;
            }else{
                var ninguno = 0;
            }
            if(reglas_des[45]){//content2[x].U_Cofia;
                var cofia = 1;
            }else {
                var cofia = 0;
            }
            if(reglas_des[46]){//content2[x].U_Calzado;
                var zapato_seguridad = 1;
            }else {
                var zapato_seguridad = 0;
            }
            if(reglas_des[47]){//content2[x].U_U_Otros;
                var otro4 = 1;
            }else {
                var otro4 = 0;
            }
            var otros_requisitos = '';
            if(reglas_des[48]){otros_requisitos = reglas_des[48];}//content2[x].U_U_DesOtros
            
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            productHandler.addBennettsL(id_cedula,foto_llegada,nocliente,razon_social,nombre_recibe,segundo_nombre,apellido,puesto,correo,telefono_1,telefono_2, calle,no_exterior,no_interior,colonia,ciudad,cp,alcadia,estado,acceso_proveedor, OC, OC_copias, factura, factura_copias, SUA, SUA_copias, TIA, TIA_copias, otro_doc, otro_doc_copias, permiso, correo1, correo1_campo, medio1, medio1_campo, otro_med1, otro_med1_campo, dias_solicitud, cita, correo2, correo2_campo, medio2, medio2_campo, otro_med2, otro_med2_campo, dias_anticipacion, entrada_almacen, folio_recepcion, contra_recibo, firma_sello, recibido_factura, persona_autorizada, sello_cliente, oc3, id3, otro3, ninguno, cofia, zapato_seguridad, chaleco, otro4, otros_requisitos,dias, horas_I, horas_F, horasS_I, horasS_F)
                            app.views.main.router.navigate({ name: "recorridoBennettsL1" });
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            let codigoPostal = localStorage.getItem("codigoPostal");
            let ciudad = localStorage.getItem("ciudad");
            let calle = localStorage.getItem("calle");
            let colonia = localStorage.getItem("colonia");
            let no_exterior = localStorage.getItem("no_exterior");
            let estado = localStorage.getItem("estado");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            //productHandler.addBennettsL(id_cedula,foto_llegada,nocliente,razon_social);
                            productHandler.addBennettsL2(id_cedula,foto_llegada,nocliente,razon_social,codigoPostal,ciudad,calle,colonia,no_exterior,estado);
                            app.views.main.router.navigate({ name: "recorridoBennettsL1" });
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function generarBennettsServicioTecnico(){
        var rol = localStorage.getItem("rol");
        var roles = rol.split("-");

        let tipoCedula = "servicio_tecnico";
        let id_cedula = localStorage.getItem("IdCedula");
        let razon_social = localStorage.getItem("social_reason");
        let nocliente = localStorage.getItem("id_cliente");
        let foto_llegada = localStorage.getItem("foto_llegada");

        if (roles[1] == 'EB'){
            var reglas = localStorage.getItem("facturas");
            var reglas_des = reglas.split("._.");
            var acceso_proveedor = '';
            var correo1  = 0;
            var correo1_campo = '';
            var otro_med1  = 0;
            var otro_med1_campo = '';
            var correo2  = 0;
            var correo2_campo = '';
            var otro_med2  = 0;
            var otro_med2_campo = '';
            var dias_anticipacion = '';
            var persona_autorizada = '';
            var chaleco = 0;
            var dias_solicitud= '';
            var nombre_recibe = '';
            var segundo_nombre= '';
            var apellido= '';
            var puesto= '';
            var correo= '';
            var telefono_1= '';
            var telefono_2 = '';
            var calle= '';
            var no_exterior= '';
            var no_interior = '';
            var colonia= '';
            var ciudad= '';
            var cp= '';
            var alcadia= '';
            var estado= '';
            console.log('REG',reglas_des);
            console.log('Puesto',reglas_des[5]);

            if(reglas_des[2]){  nombre_recibe = reglas_des[2]+'*';  /*content2[x].FirstName;*/ }else{nombre_recibe ='*';} 
            if(reglas_des[3]){  segundo_nombre = reglas_des[3]+'*'; /*content2[x].MiddleName;*/}else{segundo_nombre ='*';}
            if(reglas_des[4]){ apellido = reglas_des[4]+'*';}else{apellido ='*';} /*content2[x].LastName;*/ 
            if(reglas_des[5]){ puesto = reglas_des[5]+'*';}else{puesto ='*';}//content2[x].Position;
            if(reglas_des[6]){ correo = reglas_des[6]+'*';}else{correo ='*';}//content2[x].E_MailL;
            if(reglas_des[7]){ telefono_1 = reglas_des[7]+'*';}else{telefono_1 ='*';}//content2[x].Tel1;
            if(reglas_des[8]){ telefono_2 = reglas_des[8]+'*';}else{telefono_2 ='*';}//content2[x].Tel2;
            if(reglas_des[9]){ calle = reglas_des[9]+'*';}else{calle ='*';}//content2[x].Street;
            if(reglas_des[10]){ no_exterior = reglas_des[10]+'*';}else{no_exterior ='*';}//content2[x].StreetNo;
            if(reglas_des[11]){ no_interior = reglas_des[11]+'*';}else{no_interior ='*';}//content2[x].Building;
            if(reglas_des[12]){ colonia = reglas_des[12]+'*';}else{colonia ='*';}//content2[x].Block;
            if(reglas_des[13]){ ciudad = reglas_des[13]+'*';}else{ciudad ='*';}//content2[x].City;
            if(reglas_des[14]){ cp = reglas_des[14]+'*';}else{cp ='*';}//content2[x].ZipCode;
            if(reglas_des[15]){ alcadia = reglas_des[15]+'*';}else{alcadia ='*';}//content2[x].County;
            if(reglas_des[16]){ estado = reglas_des[16]+'*';}else{estado ='*';}//content2[x].State;
            
            if(reglas_des[17]){
                var OC_copias = reglas_des[17]+'*';//content2[x].U_Copias_OC;
                if(OC_copias != 0){
                    var OC = 1;
                }else{
                    var OC = 0;
                }
            }else{
                var OC = 0;
            }
            if(reglas_des[18]){
                var factura_copias = reglas_des[18]+'*';//content2[x].U_Copias_FB;
                if(factura_copias != 0){
                    var factura = 1;
                }else{
                    var factura = 0;
                }
            }else{
                var factura = 0;
            }
            if(reglas_des[19]){
                var SUA_copias = reglas_des[19]+'*';//content2[x].U_Copias_SUA;
                if(SUA_copias != 0){
                    var SUA = 1;
                }else{
                    var SUA = 0;
                }
            }else{
                var SUA = 0;
            }
            if(reglas_des[20]){
                var TIA_copias = reglas_des[20]+'*';//content2[x].U_Copias_TIA;
                if(TIA_copias != 0){
                    var TIA = 1;
                }else{
                    var TIA = 0;
                }
            }else{
                var TIA = 0;
            }
            if(reglas_des[21]){
                var otro_doc_copias = reglas_des[21]+'*';//content2[x].U_Otros;
                if(otro_doc_copias != 0){
                    var otro_doc = 1;
                }else{
                    var otro_doc = 0;
                }
            }else{
                var otro_doc = 0;
            }
            var dias = '';

            if(reglas_des[22] == 'Y'){
                dias = dias+"L,";
            }
            if(reglas_des[23] == 'Y'){
                dias = dias+"Ma,";
            }
            if(reglas_des[24] == 'Y'){
                dias = dias+"Mi,";
            }
            if(reglas_des[25] == 'Y'){
                dias = dias+"J,";
            }
            if(reglas_des[26] == 'Y'){
                dias = dias+"V,";
            }
            if(reglas_des[27] == 'Y'){
                dias = dias+"S";
            }
            // var horas_I = reglas_des[28];//content2[x].U_HorariosLV;
            // var horas_F = reglas_des[28];//content2[x].U_HorariosLV;
            // var horasS_I = reglas_des[29];//content2[x].U_HorarioS;
            // var horasS_F = reglas_des[29];//content2[x].U_HorarioS;
            var horas_I = '';
            var horas_F = '';
            var horasS_I = '';
            var horasS_F = '';
            if(reglas_des[28]){
                var permiso = 1;//content2[x].U_PEntrega;
            }else{
                var permiso = 0;
            }

            if(reglas_des[29]){
                var medio1  = 1;//content2[x].U_PEntrega;
                var medio1_campo = reglas_des[29]+'*';//content2[x].U_MedioP;
            }else{
                var medio1 = 0;
                var medio1_campo = reglas_des[29]+'*';//content2[x].U_MedioP;
            }

            //var dias_solicitud = reglas_des[32];//content2[x].U_TEntrega;
            if(reglas_des[33]){
                var cita = 1;
            }else{
                var cita = 0;
            }

            if(reglas_des[31]){
                var medio2 = 1;
                var medio2_campo =  reglas_des[31]+'*';//content2[x].U_MCita;
            }else{
                var medio2 = 0;
            }
            if(reglas_des[34]){//content2[x].U_EA;
                var entrada_almacen = 1;
            }else{
                var entrada_almacen = 0;
            }
            if(reglas_des[35]){//content2[x].U_Folio;
                var folio_recepcion = 1;
            }else{
                var folio_recepcion = 0;
            }
            if(reglas_des[36]){//content2[x].U_CR;
                var contra_recibo = 1;
            }else{
                var contra_recibo = 0;
            }
            if(reglas_des[37]){//content2[x].U_Firma;
                var firma_sello = 1;
            }else {
                var firma_sello = 0;
            }
            // if(reglas_des[38]){//content2[x].U_Recibido;
            //     var recibido_factura = 1;
            // }else {
            //     var recibido_factura = 0;
            // }
                var recibido_factura = 0;
            if(reglas_des[38]){//content2[x].U_SelloCte;
                var sello_cliente = 1;
            }else {
                var sello_cliente = 0;
            }
            if(reglas_des[39]){//content2[x].U_OC;
                var oc3 = 1;
            }else {
                var oc3 = 0;
            }
            if(reglas_des[40]){//content2[x].U_D;
                var id3 = 1;
            }else{
                var id3 = 0;
            }
            if(reglas_des[41]){//content2[x].U_Otro;
                var otro3 = 1;
            }else{
                var otro3 = 0;
            }
            if(reglas_des[42]){//content2[x].U_Ninguno;
                var ninguno = 1;
            }else{
                var ninguno = 0;
            }
            if(reglas_des[43]){//content2[x].U_Cofia;
                var cofia = 1;
            }else {
                var cofia = 0;
            }
            if(reglas_des[44]){//content2[x].U_Calzado;
                var zapato_seguridad = 1;
            }else {
                var zapato_seguridad = 0;
            }
            var otro4 = 0;
            var otros_requisitos = '*';//content2[x].U_U_DesOtros

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            console.log(id_cedula,foto_llegada,nocliente,razon_social,nombre_recibe,segundo_nombre,apellido,puesto,correo,telefono_1,telefono_2, calle,no_exterior,no_interior,colonia,ciudad,cp,alcadia,estado,acceso_proveedor, OC, OC_copias, factura, factura_copias, SUA, SUA_copias, TIA, TIA_copias, otro_doc, otro_doc_copias, permiso, correo1, correo1_campo, medio1, medio1_campo, otro_med1, otro_med1_campo, dias_solicitud, cita, correo2, correo2_campo, medio2, medio2_campo, otro_med2, otro_med2_campo, dias_anticipacion, entrada_almacen, folio_recepcion, contra_recibo, firma_sello, recibido_factura, persona_autorizada, sello_cliente, oc3, id3, otro3, ninguno, cofia, zapato_seguridad, chaleco, otro4, otros_requisitos,dias, horas_I, horas_F, horasS_I, horasS_F)
                            productHandler.addBennettsL(id_cedula,foto_llegada,nocliente,razon_social,nombre_recibe,segundo_nombre,apellido,puesto,correo,telefono_1,telefono_2, calle,no_exterior,no_interior,colonia,ciudad,cp,alcadia,estado,acceso_proveedor, OC, OC_copias, factura, factura_copias, SUA, SUA_copias, TIA, TIA_copias, otro_doc, otro_doc_copias, permiso, correo1, correo1_campo, medio1, medio1_campo, otro_med1, otro_med1_campo, dias_solicitud, cita, correo2, correo2_campo, medio2, medio2_campo, otro_med2, otro_med2_campo, dias_anticipacion, entrada_almacen, folio_recepcion, contra_recibo, firma_sello, recibido_factura, persona_autorizada, sello_cliente, oc3, id3, otro3, ninguno, cofia, zapato_seguridad, chaleco, otro4, otros_requisitos,dias, horas_I, horas_F, horasS_I, horasS_F)
                            app.views.main.router.navigate({ name: "recorridoBennettsL2" });
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            let codigoPostal = localStorage.getItem("codigoPostal");
            let ciudad = localStorage.getItem("ciudad");
            let calle = localStorage.getItem("calle");
            let colonia = localStorage.getItem("colonia");
            let no_exterior = localStorage.getItem("no_exterior");
            let estado = localStorage.getItem("estado");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            productHandler.addBennettsL2(id_cedula,foto_llegada,nocliente,razon_social,codigoPostal,ciudad,calle,colonia,no_exterior,estado);
                            app.views.main.router.navigate({ name: "recorridoBennettsL2" });
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function regrsarBennettsL1(){
        app.views.main.router.back('/recorridoBennettsL1/', {force: true, ignoreCache: true, reload: true});
    }
    function regrsarBennettsL2(){
        app.views.main.router.back('/recorridoBennettsL2/', {force: true, ignoreCache: true, reload: true});
    }
    function guardaBennettsLLogis1(){
        var campos, valido;
        var res='';
        campos = document.querySelectorAll('#logis input.obligatorio');
        valido = true;

        [].slice.call(campos).forEach(function(campo) {
            if (campo.value.trim() === '') {
                valido = false;
                res = res + ", "+$(campo).attr("alt");
            }
        });

        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var nombre_recibe = $("#nombre_recibe").val();
            var segundo_nombre = $("#segundo_nombre").val();
            var apellido = $("#apellido").val();
            var puesto = $("#puesto").val();
            var correo = $("#correo").val();
            var telefono_1 = $("#telefono_1").val();
            var telefono_2 = $("#telefono_2").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET nombre_recibe = ?,segundo_nombre = ?,apellido = ?,puesto = ?,correo = ?,telefono_1 = ?,telefono_2 = ? WHERE id_cedula = ?",
                        [nombre_recibe,segundo_nombre,apellido,puesto,correo,telefono_1,telefono_2,id_cedula],
                        function(tx, results){
                            $("#nombre_recibe").css("background-color", "#FFFFFF");
                            $("#segundo_nombre").css("background-color", "#FFFFFF");
                            $("#apellido").css("background-color", "#FFFFFF");
                            $("#puesto").css("background-color", "#FFFFFF");
                            $("#correo").css("background-color", "#FFFFFF");
                            $("#telefono_1").css("background-color", "#FFFFFF");
                            $("#telefono_2").css("background-color", "#FFFFFF");
                            swal("","Guardado correctamente","success");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            const str = res;
            const newStr = str.slice(1)
            swal("","Te faltaron algunos campos por llenar: "+newStr,"warning");
        }
    }
    function guardaBennettsLLogis2(){
        let id_cedula = localStorage.getItem("IdCedula");
        var campos, valido;
        var res='';
        campos = document.querySelectorAll('#direccion_entrega input.obligatorio');
        valido = true;

        [].slice.call(campos).forEach(function(campo) {
            if (campo.value.trim() === '') {
                valido = false;
                res = res + ", "+$(campo).attr("alt");
            }
        });
        if (valido) {
            var calle = $("#calle").val();
            var no_exterior = $("#no_exterior").val();
            var no_interior = $("#no_interior").val();
            var colonia = $("#colonia").val();
            var ciudad = $("#ciudad").val();
            var cp = $("#cp").val();
            var alcadia = $("#alcadia").val();
            var estado = $("#estado").val();
            var acceso_proveedor = $("#acceso_proveedor").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET calle = ?,no_exterior = ?,no_interior = ?,colonia = ?,ciudad = ?,cp = ?,alcadia = ?,estado = ?,acceso_proveedor = ? WHERE id_cedula = ?",
                        [calle,no_exterior,no_interior,colonia,ciudad,cp,alcadia,estado,acceso_proveedor,id_cedula],
                        function(tx, results){
                            $("#calle").css("background-color", "#FFFFFF");
                            $("#no_exterior").css("background-color", "#FFFFFF");
                            $("#no_interior").css("background-color", "#FFFFFF");
                            $("#colonia").css("background-color", "#FFFFFF");
                            $("#ciudad").css("background-color", "#FFFFFF");
                            $("#cp").css("background-color", "#FFFFFF");
                            $("#alcadia").css("background-color", "#FFFFFF");
                            $("#estado").css("background-color", "#FFFFFF");
                            $("#acceso_proveedor").css("background-color", "#FFFFFF");
                            swal("","Guardado correctamente","success");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            const str = res;
            const newStr = str.slice(1)
            swal("","Te faltaron algunos campos por llenar: "+newStr,"warning");
        }
    }
    function guardaBennettsLLogis3(number){
        var id_cedula = localStorage.getItem("IdCedula");
        var campos, valido;
        var res='';
        valido = true;
        pasa = 0;
        for(i = 1;i <= number;i++){
            if($("#check-"+i).prop("checked") == true){
                pasa = pasa + ","+i;
            }
        }
        if(pasa == 0){
            swal("","Debes seleccionar al menos un documento","warning");
        }else{
            const str = pasa;
            const newStr = str.slice(2)
            var pasaDatas = newStr.split(",");
            pasaDatas.forEach(function(pasaData) {
                if ($("#copias-"+pasaData).val() == '') {
                    valido = false;
                    res = res + ", "+$("#copias-"+pasaData).attr("alt");
                }
            });
            if (valido) {
                var OC = 0;
                var OC_copias = '';
                var factura = 0;
                var factura_copias = '';
                var SUA = 0;
                var SUA_copias = '';
                var TIA = 0;
                var TIA_copias = '';
                var otro_doc = 0;
                var otro_doc_copias = '';
                if($("#check-1").prop("checked") == true){
                    OC = 1;
                    OC_copias = $("#copias-1").val();
                }
                if($("#check-2").prop("checked") == true){
                    factura = 1;
                    factura_copias = $("#copias-2").val();
                }
                if($("#check-3").prop("checked") == true){
                    SUA = 1;
                    SUA_copias = $("#copias-3").val();
                }
                if($("#check-4").prop("checked") == true){
                    TIA = 1;
                    TIA_copias = $("#copias-4").val();
                }
                if($("#check-5").prop("checked") == true){
                    otro_doc = 1;
                    otro_doc_copias = $("#copias-5").val();
                }
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE logistica_bennettsL SET OC = ?, OC_copias = ?,factura = ?,factura_copias = ?, SUA = ?, SUA_copias = ?, TIA = ?, TIA_copias = ?, otro_doc = ?, otro_doc_copias = ? WHERE id_cedula = ?",
                            [OC, OC_copias ,factura ,factura_copias, SUA, SUA_copias, TIA, TIA_copias, otro_doc, otro_doc_copias,id_cedula],
                            function(tx, results){
                                $("#copias-1").css("background-color", "#FFFFFF");
                                $("#copias-2").css("background-color", "#FFFFFF");
                                $("#copias-3").css("background-color", "#FFFFFF");
                                $("#copias-4").css("background-color", "#FFFFFF");
                                $("#copias-5").css("background-color", "#FFFFFF");
                                GuardarHor();
                            },
                            function(tx, error){
                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                const str1 = res;
                const newStr1 = str1.slice(1)
                swal("","Debes llenar el no de copias de: "+newStr1,"warning");
            }
        }
    }
    function muestracopiab(id){
        var ids = id.split("-");
        if($("#"+id).prop("checked") == true){
            $("#copias-"+ids[1]).css('display','inline-block');
            $(".copiass-"+ids[1]).css('display','inline-block');
            $("#copiasss-"+ids[1]).css('display','inline-block');
        }else{
            $("#copiasss-"+ids[1]).css('display','none');
            $(".copiass-"+ids[1]).css('display','none');
            $("#copias-"+ids[1]).css('display','none');
        }
    }
    function muestracopiac(id){
        var ids = id.split("-");
        if($("#"+id).prop("checked") == true){
            $("#indicas-"+ids[1]).css('display','inline-block');
            $(".indicass-"+ids[1]).css('display','inline-block');
            $("#indicasss-"+ids[1]).css('display','inline-block');
        }else{
            $("#indicasss-"+ids[1]).css('display','none');
            $(".indicass-"+ids[1]).css('display','none');
            $("#indicas-"+ids[1]).css('display','none');
        }
    }
    function muestracopiad(id){
        var ids = id.split("-");
        if($("#"+id).prop("checked") == true){
            $("#medios-"+ids[1]).css('display','inline-block');
            $(".medioss-"+ids[1]).css('display','inline-block');
            $("#mediosss-"+ids[1]).css('display','inline-block');
        }else{
            $("#mediosss-"+ids[1]).css('display','none');
            $(".medioss-"+ids[1]).css('display','none');
            $("#medios-"+ids[1]).css('display','none');
        }
    }
    function checkBennettsL(id,valor,parte){
        var currentId = id.split("-");
        if(parte==1){
            if(id.includes("1")){
                if($("#"+id).prop("checked") == true){
                    $("#"+currentId[0]+"-2").prop("checked", false);
                    $("#horarios").css('display','inline-block');
                }else{
                    $("#horarios").css('display','none');
                }
            } else if(id.includes("2")){
                if($("#"+id).prop("checked") == true){
                    $("#"+currentId[0]+"-1").prop("checked", false);
                    $("#horarios").css('display','none');
                }
            }
        }
        if(parte==2){
            if(id.includes("1")){
                if($("#"+id).prop("checked") == true){
                    $("#"+currentId[0]+"-2").prop("checked", false);
                    $("#gestion").css('display','inline-block');
                }else{
                    $("#gestion").css('display','none');
                }
            } else if(id.includes("2")){
                if($("#"+id).prop("checked") == true){
                    $("#"+currentId[0]+"-1").prop("checked", false);
                    $("#gestion").css('display','none');
                }
            }
        }
        if(parte == 3){
            if(id.includes("1")){
                if($("#"+id).prop("checked") == true){
                    $("#"+currentId[0]+"-2").prop("checked", false);
                    $("#devoluciones").css('display','block');
                    var devoluciones = 'Si';
                }else{
                    $("#devoluciones").css('display','none');
                    $("#otro_devolucion").css('display','none');
                    var devoluciones = 'No';
                }
            } else if(id.includes("2")){
                if($("#"+id).prop("checked") == true){
                    $("#"+currentId[0]+"-1").prop("checked", false);
                    $("#devoluciones").css('display','none');
                    $("#otro_devolucion").css('display','none');
                    var devoluciones = 'No';
                }
            }
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET devoluciones = ? WHERE id_cedula = ?",
                        [devoluciones, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            console.error("Error al guardar cierre: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardaBennettslhorarios(){
        var pasa = 0;
        var res= '';
        var valido = true;
        var pasa1 = 0;
        var res1= '';
        var valido1 = true;
        var validacion = false;
        var validacion1 = false;
        if($("#permiso-1").prop("checked") == true || $("#permiso-2").prop("checked") == true ){
            if($("#permiso-1").prop("checked") == true){
                for(i = 1;i <= 3;i++){
                    if($("#check2-"+i).prop("checked") == true){
                        pasa = pasa + ","+i;
                    }
                }
                if(pasa == 0){
                    swal("","Debes seleccionar al menos un medio para solicitar el permiso","warning");
                }else{
                    const str = pasa;
                    const newStr = str.slice(2)
                    var pasaDatas = newStr.split(",");
                    pasaDatas.forEach(function(pasaData) {
                        if ($("#medios-"+pasaData).val() == '') {
                            valido = false;
                            res = res + ", "+$("#medios-"+pasaData).attr("alt");
                        }
                    });
                    if (valido) {
                        if($("#dias_solicitud").val() == ''){
                            swal("","Debes llenar los días de anticipación","warning");
                        }else{
                            validacion = true;
                        }
                    } else {
                        const str1 = res;
                        const newStr1 = str1.slice(1)
                        swal("","Debes llenar el campo en: "+newStr1,"warning");
                    }
                }
            }else{
                validacion = true;
            }
        }else{
            swal("","Debes seleccionar una opción en la pregunta de gestión de permiso","warning");
        }
        if(validacion){
            if($("#cita-1").prop("checked") == true || $("#cita-2").prop("checked") == true ){
                if($("#cita-1").prop("checked") == true){
                    for(i = 1;i <= 3;i++){
                        if($("#check1-"+i).prop("checked") == true){
                            pasa1 = pasa1 + ","+i;
                        }
                    }
                    if(pasa1 == 0){
                        swal("","Debes seleccionar al menos un medio para solicitar el permiso","warning");
                    }else{
                        const str3 = pasa1;
                        const newStr3 = str3.slice(2)
                        var pasaDatas1 = newStr3.split(",");
                        pasaDatas1.forEach(function(pasaData1) {
                            if ($("#indicas-"+pasaData1).val() == '') {
                                valido1 = false;
                                res1 = res1 + ", "+$("#indicas-"+pasaData1).attr("alt");
                            }
                        });
                        if (valido1) {
                            if($("#dias_anticipacion").val() == ''){
                                swal("","Debes llenar los días de anticipación","warning");
                            }else{
                                validacion1 = true;
                            }
                        } else {
                            const str2 = res1;
                            const newStr2 = str2.slice(1)
                            swal("","Debes llenar el campo en: "+newStr2,"warning");
                        }
                    }
                }else{
                    validacion1 = true;
                }
            }else{
                swal("","Debes seleccionar una opción en la pregunta de gestión de cita","warning");
            }
        }
        if(validacion1){
            var id_cedula = localStorage.getItem("IdCedula");
            var permiso = 0;
            var cita = 0;
            var correo1 = 0;
            var correo1_campo = '';
            var medio1 = 0;
            var medio1_campo = '';
            var otro1 = 0;
            var otro1_campo = '';
            var correo2 = 0;
            var correo2_campo = '';
            var medio2 = 0;
            var medio2_campo = '';
            var otro2 = 0;
            var otro2_campo = '';
            var dias_solicitud = '';
            var dias_anticipacion = '';
            if($("#permiso-1").prop("checked") == true){
                permiso=1;
                if($("#check2-1").prop("checked") == true){
                    correo1 = 1;
                    correo1_campo = $("#medios-1").val();
                }
                if($("#check2-2").prop("checked") == true){
                    medio1 = 1;
                    medio1_campo = $("#medios-2").val();
                }
                if($("#check2-3").prop("checked") == true){
                    otro1 = 1;
                    otro1_campo = $("#medios-3").val();
                }
                dias_solicitud = $("#dias_solicitud").val();
            }else{
                permiso=0;
            }
            if($("#cita-1").prop("checked") == true){
                cita = 1;
                if($("#check1-1").prop("checked") == true){
                    correo2 = 1;
                    correo2_campo = $("#indicas-1").val();
                }
                if($("#check1-2").prop("checked") == true){
                    medio2 = 1;
                    medio2_campo = $("#indicas-2").val();
                }
                if($("#check1-3").prop("checked") == true){
                    otro2 = 1;
                    otro2_campo = $("#indicas-3").val();
                }
                dias_anticipacion = $("#dias_anticipacion").val();
            }else{
                cita = 0;
            }

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET permiso = ?, correo1 = ?, correo1_campo = ?, medio1 = ?, medio1_campo = ?, otro_med1 = ?, otro_med1_campo = ?, dias_solicitud = ?, cita = ?, correo2 = ?, correo2_campo = ?, medio2 = ?, medio2_campo = ?, otro_med2 = ?, otro_med2_campo = ?, dias_anticipacion = ? WHERE id_cedula = ?",
                        [permiso, correo1, correo1_campo, medio1, medio1_campo, otro1, otro1_campo, dias_solicitud, cita, correo2, correo2_campo, medio2, medio2_campo, otro2, otro2_campo, dias_anticipacion, id_cedula],
                        function(tx, results){
                            $("#medios-1").css("background-color", "#FFFFFF");
                            $("#medios-2").css("background-color", "#FFFFFF");
                            $("#medios-3").css("background-color", "#FFFFFF");
                            $("#indicas-1").css("background-color", "#FFFFFF");
                            $("#indicas-2").css("background-color", "#FFFFFF");
                            $("#indicas-3").css("background-color", "#FFFFFF");
                            $("#dias_solicitud").css("background-color", "#FFFFFF");
                            $("#dias_anticipacion").css("background-color", "#FFFFFF");
                            swal("","Guardado correctamente","success");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function muestraPersonaAutoriza(id){
        if($("#"+id).prop("checked") == true){
            $(".personas").css('display','inline-block');
            $("#persona").css('display','inline-block');
        }else{
            $(".personas").css('display','none');
            $("#persona").css('display','none');
        }
    }
    function guardaBennettslDocs(number){
        var campos, valido;
        var res='';
        var persona = $("#persona").val();
        var validacion = false;
        valido = true;
        pasa = 0;
        for(i = 1;i <= number;i++){
            if($("#check3-"+i).prop("checked") == true){
                pasa = pasa + ","+i;
            }
        }
        if(pasa == 0){
            swal("","Debes seleccionar al menos un documento","warning");
        }else{
            if($("#check3-5").prop("checked") == true){
                if(persona){
                    validacion = true;
                }else{
                    swal("","Debes indicar quien será la persona autorizada para firma","warning");
                }
            }else{
                validacion = true;
            }
        }
        if (validacion){
            var id_cedula = localStorage.getItem("IdCedula");
            const str = pasa;
            const newStr = str.slice(2)
            var pasaData = newStr.split(",");
            var entrada_almacen = 0;
            var folio_recepcion = 0;
            var contra_recibo = 0;
            var firma_sello = 0;
            var recibido_factura = 0;
            var sello_cliente = 0;
            var oc3 = 0;
            var id3 = 0;
            var otro3 = 0;

            var persona_autorizada = '';
            if($("#check3-1").prop("checked") == true){
                entrada_almacen = 1;
            }
            if($("#check3-2").prop("checked") == true){
                folio_recepcion = 1;
            }
            if($("#check3-3").prop("checked") == true){
                contra_recibo = 1;
            }
            if($("#check3-4").prop("checked") == true){
                firma_sello = 1;
            }
            if($("#check3-5").prop("checked") == true){
                recibido_factura = 1;
                persona_autorizada = $("#persona").val();
            }
            if($("#check3-6").prop("checked") == true){
                sello_cliente = 1;
            }
            if($("#check3-7").prop("checked") == true){
                oc3 = 1;
            }
            if($("#check3-8").prop("checked") == true){
                id3 = 1;
            }
            if($("#check3-9").prop("checked") == true){
                otro3 = 1;
            }
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET entrada_almacen = ?, folio_recepcion = ?, contra_recibo = ?, firma_sello = ?, recibido_factura = ?, persona_autorizada = ?, sello_cliente = ?, oc3 = ?, id3 = ?, otro3 = ? WHERE id_cedula = ?",
                        [entrada_almacen, folio_recepcion, contra_recibo, firma_sello, recibido_factura, persona_autorizada, sello_cliente, oc3, id3, otro3, id_cedula],
                        function(tx, results){
                            $("#persona").css("background-color", "#FFFFFF");
                            swal("","Guardado correctamente","success");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardaBennettslEquipo(number){
        var campos, valido;
        var res='';
        valido = true;
        pasa = 0;
        for(i = 1;i <= number;i++){
            if($("#check4-"+i).prop("checked") == true){
                pasa = pasa + ","+i;
            }
        }
        if(pasa == 0){
            swal("","Debes seleccionar al menos un documento","warning");
        }else{
            var id_cedula = localStorage.getItem("IdCedula");
            var ninguno = 0;
            var cofia = 0;
            var zapato_seguridad = 0;
            var chaleco = 0;
            var otro4 = 0;
            var otros_requisitos = $("#otros_requisitos").val();

            if($("#check4-1").prop("checked") == true){
                ninguno = 1;
            }
            if($("#check4-2").prop("checked") == true){
                cofia = 1;
            }
            if($("#check4-3").prop("checked") == true){
                zapato_seguridad = 1;
            }
            if($("#check4-4").prop("checked") == true){
                chaleco = 1;
            }
            if($("#check4-5").prop("checked") == true){
                otro4 = 1;
            }
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET ninguno = ?, cofia = ?, zapato_seguridad = ?, chaleco = ?, otro4 = ?, otros_requisitos = ? WHERE id_cedula = ?",
                        [ninguno, cofia, zapato_seguridad, chaleco, otro4, otros_requisitos, id_cedula],
                        function(tx, results){
                            $("#otros_requisitos").css("background-color", "#FFFFFF");
                            swal("","Guardado correctamente","success");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarEvidenciaBennettsL(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC").val();
        var comentario = $("#comentario").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if (foto && comentario){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencias_bennettsL(id_cedula, comentario, foto, fecha) VALUES (?,?,?,?)",
                        [id_cedula, comentario, foto, fecha_registro],
                        function(tx, results){
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            $("#comentario").css("background-color", "#FFFFFF");
                            $("#comentario").val('');
                            $("#imagenC").val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from evidencias_bennettsL where id_cedula = ? ORDER BY id_evidencia desc",
                                    [id_cedula],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaBennettsL("+
                                            item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                            item.comentario+ "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                            $("#message-nr").css("display", "none");
                                        },
                                        function(tx, error){
                                            console.log("Error al mostrat datos: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes llenar todos los campos" ,"warning");
        }
    }
    function eliminarFilaBennettsL(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencias_bennettsL WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function continuarCedBennettsL(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoBennettsL1'});
        }else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoBennettsL2'});
        }
    }
    function guardarCierreBennttsL(){
        if($("#check_vuelta_BL").prop("checked") == true){
            if($("#motivos_select").val() == 0 ){
                swal("","Favor de seleccionar un motivo","warning");
                return false;
            }
            if($("#motivos_select").val() == 4 && $("#motivos_input").val() == ''){
                swal("","Favor de describir el motivo","warning");
                return false;
            }
            var motivos1 = $("#motivos_select").val();
            var motivos2 = $("#motivos_input").val();

            var fecha = new Date();
            var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var comentarioCliente = "Vuelta en falso";
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET motivo = ?, motivo_desc = ?, fecha_cliente = ? WHERE id_cedula = ?",
                        [motivos1, motivos2, fecha_firma, id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET comentario_cliente = ? WHERE id_cedula = ?",
                                        [comentarioCliente,id_cedula],
                                        function(tx, results){
                                            swal("","Guardado correctamente","success");
                                            app.views.main.router.back('/yamevoyBennettsL/', {force: true, reload: true});
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al guardar cierre: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
                swal("","Todos los campos son obligatorios","warning");
                return false;
            }
            if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
                swal("","Por favor, ingresa el motivo de tu calificacion","warning");
                return false;
            }
            var id_cedula = localStorage.getItem("IdCedula");
            var nombrefirma = $("#NombreFirma").val();
            var firmaCliente = $("#signate").val();
            var calificacion = $("#eval").val();
            var comentarioCliente = $('#comentario_cliente').val();

            var fecha = new Date();
            var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                        [firmaCliente,fecha_firma,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                        [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                        function(tx, results){
                                            swal("","Guardado correctamente","success");
                                            app.views.main.router.back('/yamevoyBennettsL/', {force: true, reload: true});
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al guardar cierre: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function terminarBennettsL(){
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var ubicacion_salida = $("#geolocation").val();
        var estatus = 1;
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
              [fecha_salida, ubicacion_salida, estatus, id_cedula],
              function (tx, results) {
                window.location.href = "./menu.html";
              },
              function (tx, error) {
                swal("Error al guardar", error.message, "error");
              }
            );
          },
          function (error) {},
          function () {}
        )
    }
    function HorariosLV(){
        var tex = '';
      $('input[name=P1]:checked').each(function() {
            // console.log($(this).prop("id"));
            tex += $(this).prop("id")+',';
        });
        // console.log(tex)
        var fin = $('input[name=P2]:checked').prop("id");
        // console.log(fin)
        if(fin){
            $('#horasS').css("display","inline-block")
        }else{
            $('#horasS').css("display","none")
        }
        if(tex){
            $('#dias').text('Horarios para los dias '+tex)
            $('#horasLV').css("display","inline-block")
        }else{
            $('#horasLV').css("display","none")
        }

    }
    function guardarEvidenciaBennettsL2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC").val();
        var comentario = $("#comentario").val();
        var no_llamada = $("#no_llamada").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if (foto && comentario && no_llamada){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencias_bennettsL(id_cedula, comentario, foto, fecha,no_llamada) VALUES (?,?,?,?,?)",
                        [id_cedula, comentario, foto, fecha_registro,no_llamada],
                        function(tx, results){
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            $("#comentario").css("background-color", "#FFFFFF");
                            $("#comentario").val('');
                            $("#no_llamada").css("background-color", "#FFFFFF");
                            $("#no_llamada").val('');
                            $("#imagenC").val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from evidencias_bennettsL where id_cedula = ? ORDER BY id_evidencia desc",
                                    [id_cedula],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaBennettsL("+
                                            item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                            item.no_llamada + "</td><td style='text-align: center;'>" +
                                            item.comentario+ "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                            $("#message-nr").css("display", "none");
                                        },
                                        function(tx, error){
                                            console.log("Error al mostrat datos: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes llenar todos los campos" ,"warning");
        }
    }
    function GuardarHor(){
        var id_cedula = localStorage.getItem("IdCedula");
        var tex = '';
        var pregunta_horas = 0;
        var pregunta_horas1 = 0;
        $('input[name=P1]:checked').each(function() {
            // console.log($(this).prop("id"));
            tex += $(this).prop("id")+',';
        });
          //console.log(tex)
        var fin = $('input[name=P2]:checked').prop("id");
        //console.log(fin);
        if(tex){
          var h11=  $('#hora_inicio').val();
          var h21=  $('#hora_fin').val();
          if( h11 && h21){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE logistica_bennettsL SET dias = ?, horas_I = ?, horas_F = ? WHERE id_cedula = ?",
                        [tex,h11,h21,id_cedula],
                        function(tx, results){
                            swal("","Guardado correctamente","success");
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
          }else{
            app.dialog.alert('Llenar las horas de inicio y fin.', 'Aviso');
          }
        }else{
            pregunta_horas=1;
        }
        if(fin){
            var h1=  $('#hora_inicioS').val();
            var h2=  $('#hora_finS').val();
            if( h1 && h2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE logistica_bennettsL SET horasS_I = ?, horasS_F = ? where id_cedula = ?",
                            [h1,h2,id_cedula],
                            function(tx, results){
                                swal("","Guardado correctamente","success");
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                app.dialog.alert('Llenar las horas de inicio y fin del Sabado.', 'Aviso');
            }
        }else{
            pregunta_horas1=1;
        }
        if(pregunta_horas1 == 1 && pregunta_horas == 1){
            swal("", "Falta seleccionar horarios" ,"warning");
        }
    }
    function devolucionesBennettsL(val){
        if(val == 6){
            $("#otro_devolucion").css('display','block');
        }else{
            $("#otro_devolucion").css('display','none');
        }
        var motivo_devolucion = $("#motivo_devolucion").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE logistica_bennettsL SET motivo_devolucion = ? WHERE id_cedula = ?",
                    [motivo_devolucion, id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function devolucionesBennettsST(val){
        if(val == 13){
            $("#otro_devolucion").css('display','block');
        }else{
            $("#otro_devolucion").css('display','none');
        }
        var motivo_devolucion = $("#motivo_devolucion").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE logistica_bennettsL SET motivo_devolucion = ? WHERE id_cedula = ?",
                    [motivo_devolucion, id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function motivo_desc_bennettsL(){
        var devolucion_desc = $("#motivo_desc").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE logistica_bennettsL SET devolucion_desc = ? WHERE id_cedula = ?",
                    [devolucion_desc, id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function motivo_desc_bennettsST(){
        var devolucion_desc = $("#motivo_desc").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE logistica_bennettsL SET devolucion_desc = ? WHERE id_cedula = ?",
                    [devolucion_desc, id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function vueltaFalsoBennettsL(){
        if($("#check_vuelta_BL").prop("checked") == true){
            $("#motivos").css('display','block');
            $("#datos_cierre").css('display','none');
        }else{
            $("#motivos").css('display','none');
            $("#otro_motivos").css('display','none');
            $("#datos_cierre").css('display','block');
        }
    }
    function motivosvueltaFalsoBL(val){
        if(val == 4){
            $("#otro_motivos").css('display','block');
        }else{
            $("#otro_motivos").css('display','none');
        }
    }
    function ShowReglas1(cliente,cardname,FirstNameServTec, MiddleNameServTec, LastNameServTec, PositionServTec, Tel1ServTec, Tel2ServTec, E_MailLServTec, StreetServTec, StreetNoServTec, StreetNoInterServTec, BlockServTec, CityServTec, ZipCodeServTec, CountyServTec, StateServTec, U_Copias_OCServTec, U_Copias_FBServTec, U_Copias_SUAServTec, U_Copias_TIAServTec, U_OtrosServTec, U_Dias_1ServTec, U_Dias_2ServTec, U_Dias_3ServTec, U_Dias_4ServTec, U_Dias_5ServTec, U_Dias_6ServTec, U_PermisoServTec, U_MedioP_1ServTec, U_MedioP_2ServTec, U_MedioP_3, U_Permiso_TServTec, U_CitaServTec, U_EAServTec, U_FolioServTec, U_CRServTec, U_Firma_BServTec, U_SelloServTec, U_OCServTec, U_IDServTec, U_OtroServTec, U_NingunoServTec, U_CofiaServTec, U_CalzadoServTec){
        if(!FirstNameServTec){FirstNameServTec='N/A';}
        if(!MiddleNameServTec){MiddleNameServTec='N/A';}
        if(!LastNameServTec){LastNameServTec='N/A';}
        if(!PositionServTec){PositionServTec='N/A';}
        if(!Tel1ServTec){Tel1ServTec='N/A';}
        if(!Tel2ServTec){Tel2ServTec='N/A';}
        if(!E_MailLServTec){E_MailLServTec='N/A';}
        if(!StreetServTec){StreetServTec='N/A';}
        if(!StreetNoServTec){StreetNoServTec='N/A';}
        if(!StreetNoInterServTec){StreetNoInterServTec='N/A';}
        if(!BlockServTec){BlockServTec='N/A';}
        if(!CityServTec){CityServTec='N/A';}
        if(!ZipCodeServTec){ZipCodeServTec='N/A';}
        if(!CountyServTec){CountyServTec='N/A';}
        if(!StateServTec){StateServTec='N/A';}
        if(!U_Copias_OCServTec){U_Copias_OCServTec='N/A';}
        if(!U_Copias_FBServTec){U_Copias_FBServTec='N/A';}
        if(!U_Copias_SUAServTec){U_Copias_SUAServTec='N/A';}
        if(!U_Copias_TIAServTec){U_Copias_TIAServTec='N/A';}
        if(!U_OtrosServTec){U_OtrosServTec='N/A';}
        if(!U_Dias_1ServTec){U_Dias_1ServTec='N/A';}
        if(!U_Dias_2ServTec){U_Dias_2ServTec='N/A';}
        if(!U_Dias_3ServTec){U_Dias_3ServTec='N/A';}
        if(!U_Dias_4ServTec){U_Dias_4ServTec='N/A';}
        if(!U_Dias_5ServTec){U_Dias_5ServTec='N/A';}
        if(!U_Dias_6ServTec){U_Dias_6ServTec='N/A';}
        if(!U_PermisoServTec){U_PermisoServTec='N/A';}
        if(!U_MedioP_1ServTec){U_MedioP_1ServTec='N/A';}
        if(!U_MedioP_2ServTec){U_MedioP_2ServTec='N/A';}
        if(!U_MedioP_3){U_MedioP_3='N/A';}
        if(!U_Permiso_TServTec){U_Permiso_TServTec='N/A';}
        if(!U_CitaServTec){U_CitaServTec='N/A';}
        if(!U_EAServTec){U_EAServTec='N/A';}
        if(!U_FolioServTec){U_FolioServTec='N/A';}
        if(!U_CRServTec){U_CRServTec='N/A';}
        if(!U_Firma_BServTec){U_Firma_BServTec='N/A';}
        if(!U_SelloServTec){U_SelloServTec='N/A';}
        if(!U_OCServTec){U_OCServTec='N/A';}
        if(!U_IDServTec){U_IDServTec='N/A';}
        if(!U_OtroServTec){U_OtroServTec='N/A';}
        if(!U_NingunoServTec){U_NingunoServTec='N/A';}
        if(!U_CofiaServTec){U_CofiaServTec='N/A';}
        if(!U_CalzadoServTec){U_CalzadoServTec='N/A';}
        var manual = app.popup.create({
            content: `
                    <div class="popup popup-Manual" id="camera">
                        <br/>
                        <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                            <a id="closeP" class="link popup-close">Cerrar</a>
                        </div>
                        <div class="app">
                        <div class="page">
                            <div class="page-content" style="background-color: #f6f7f9; ">
                                <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                    <div style="text-align: left;">
                                        <div class="item-inner">
                                            <div class="block-title" style="text-align: center; font-size: 20px;"><h3 style="color:#063E7F;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">Reglas de Negocio</h3></div>
                                        </div>
                                    </div>
                                    <div style="text-align: left;">
                                        <div class="list">
                                    <ul>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No. Cliente</div>`+cliente+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Razón Social</div>`+cardname+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Nombre de quien recibe el pedido</div>`+FirstNameServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Segundo Nombre</div>`+MiddleNameServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Apellido</div>`+LastNameServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Puesto</div>`+PositionServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Correo</div>`+E_MailLServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Telefono y ext 1</div>`+Tel1ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Telefono y ext 2</div>`+Tel2ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Calle</div>`+StreetServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No Exterior</div>`+StreetNoServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No. Interior</div>`+StreetNoInterServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Colonia</div>`+BlockServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Ciudad</div>`+CityServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">C.P.</div>`+ZipCodeServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Alcaldía/Munipio</div>`+CountyServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Estado</div>`+StateServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No. Copias OC</div>`+U_Copias_OCServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No. Copias Factura</div>`+U_Copias_FBServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No. Copias SUA</div>`+U_Copias_SUAServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No. Copias TIA</div>`+U_Copias_TIAServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">No. Copias Otros</div>`+U_OtrosServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Recepción en Lunes</div>`+U_Dias_1ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Recepción en Martes</div>`+U_Dias_2ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Recepción en Miércoles</div>`+U_Dias_3ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Recepción en Jueves</div>`+U_Dias_4ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Recepción en Viernes</div>`+U_Dias_5ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Recepción en Sábado</div>`+U_Dias_6ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">¿Se requiere gestionar algún permiso para la entrega?</div>`+U_PermisoServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">¿Cual es medio para solicitarlo?</div>`+U_MedioP_1ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">¿Cuantos días de anticipación se debe solicitar?</div>`+U_MedioP_2ServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">¿Se requiere gestionar cita para la entrega?</div>`+U_CitaServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Nos Puede indicar el medio para solicitarlo</div>`+U_Permiso_TServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">¿Cuantos días de anticipación se debe solicitar?</div>`+U_MedioP_3+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Entrada de almacén</div>`+U_EAServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Folio de recepción de mercancía</div>`+U_FolioServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Contrarecibo</div>`+U_CRServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Firma y Sello en la Factura</div>`+U_SelloServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Nombre y firma de recibido en la factura</div>`+U_Firma_BServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">OC</div>`+U_OCServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">ID</div>`+U_IDServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Otro</div>`+U_OtroServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Ninguno equipo de protección</div>`+U_NingunoServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Cofía</div>`+U_CofiaServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="#" class="item-link item-content">
                                                <div class="item-media">
                                                    <i class="material-icons md-light" style="color: #505759;">dashboard</i>
                                                </div>
                                                <div class="item-inner no-chevron">
                                                    <div class="item-title">
                                                        <div class="item-header">Calzado de Seguridad</div>`+U_CalzadoServTec+`
                                                    </div>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                    </div>
                                    <fwm></fwm>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                `,
                on: {
                    open: function (popup) {
                        $('#closeP').click(function () {
                            manual.close();
                            $("#autocomplete-dropdown-ajax").val('');
                        });
                    },
                }
        });
            manual.open();
    }

function ShowReglas(cliente,cardname,FirstName,MiddleName, LastName, Position, E_MailL, Tel1, Tel2, Street, StreetNo, Building, Block, City, ZipCode, County, State, U_Copias_OC, U_Copias_FB, U_Copias_SUA, U_Copias_TIA, U_Otros, U_RecepL, U_RecepM, U_RecepMi, U_RecepJ, U_RecepV, U_RecepS, U_HorariosLV, U_HorarioS, U_PEntrega, U_MedioP, U_TEntrega, U_CEntrega, U_MCita, U_EA, U_Folio, U_CR, U_Firma, U_Recibido, U_SelloCte, U_OC, U_ID, U_Otro, U_Ninguno, U_Cofia, U_Calzado, U_U_Otros, U_U_DesOtros){
    if(!FirstName){FirstName='N/A';}
    if(!MiddleName){MiddleName='N/A';}
    if(!LastName){LastName='N/A';}
    if(!Position){Position='N/A';}
    if(!E_MailL){E_MailL='N/A';}
    if(!Tel1){Tel1='N/A';}
    if(!Tel2){Tel2='N/A';}
    if(!Street){Street='N/A';}
    if(!StreetNo){StreetNo='N/A';}
    if(!Building){Building='N/A';}
    if(!Block){Block='N/A';}
    if(!City){City='N/A';}
    if(!ZipCode){ZipCode='N/A';}
    if(!County){County='N/A';}
    if(!State){State='N/A';}
    if(!U_Copias_OC){U_Copias_OC='N/A';}
    if(!U_Copias_FB){U_Copias_FB='N/A';}
    if(!U_Copias_SUA){U_Copias_SUA='N/A';}
    if(!U_Copias_TIA){U_Copias_TIA='N/A';}
    if(!U_Otros){U_Otros='N/A';}
    if(!U_RecepL){U_RecepL='N/A';}
    if(!U_RecepM){U_RecepM='N/A';}
    if(!U_RecepMi){U_RecepMi='N/A';}
    if(!U_RecepJ){U_RecepJ='N/A';}
    if(!U_RecepV){U_RecepV='N/A';}
    if(!U_RecepS){U_RecepS='N/A';}
    if(!U_HorariosLV){U_HorariosLV='N/A';}
    if(!U_HorarioS){U_HorarioS='N/A';}
    if(!U_PEntrega){U_PEntrega='N/A';}
    if(!U_MedioP){U_MedioP='N/A';}
    if(!U_TEntrega){U_TEntrega='N/A';}
    if(!U_CEntrega){U_CEntrega='N/A';}
    if(!U_MCita){U_MCita='N/A';}
    if(!U_EA){U_EA='N/A';}
    if(!U_Folio){U_Folio='N/A';}
    if(!U_CR){U_CR='N/A';}
    if(!U_Firma){U_Firma='N/A';}
    if(!U_Recibido){U_Recibido='N/A';}
    if(!U_SelloCte){U_SelloCte='N/A';}
    if(!U_OC){U_OC='N/A';}
    if(!U_ID){U_ID='N/A';}
    if(!U_Otro){U_Otro='N/A';}
    if(!U_Ninguno){U_Ninguno='N/A';}
    if(!U_Cofia){U_Cofia='N/A';}
    if(!U_Calzado){U_Calzado='N/A';}
    if(!U_U_Otros){U_U_Otros='N/A';}
    if(!U_U_DesOtros){U_U_DesOtros='N/A';}    
    var manual = app.popup.create({
            content: `
                  <div class="popup popup-Manual" id="camera">
                        <br/>
                        <div class="headerPopupPhoto" style="width: 90%;display: flex;justify-content: end;padding-left: 20px;">
                            <a id="closeP" class="link popup-close">Cerrar</a>
                        </div>
                      <div class="app">
                        <div class="page">
                            <div class="page-content" style="background-color: #f6f7f9; ">
                                <div style="text-align: center; justify-content:center; margin-right:auto; margin-left:auto; width: 99%;">
                                    <div style="text-align: left;">
                                        <div class="item-inner">
                                            <div class="block-title" style="text-align: center; font-size: 20px;"><h3 style="color:#063E7F;font-size: 22px;font-family: 'ITC Avant Garde Gothic', sans-serif;">Reglas de Negocio</h3></div>
                                        </div>
                                    </div>
                                    <div style="text-align: left;">
                                        <div class="list">
                                        <ul>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No. Cliente</div>`+cliente+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Razón Social</div>`+cardname+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Nombre de quien recibe el pedido</div>`+FirstName+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Segundo Nombre</div>`+MiddleName+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Apellido</div>`+LastName+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Puesto</div>`+Position+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Correo</div>`+E_MailL+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Telefono y ext 1</div>`+Tel1+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Telefono y ext 2</div>`+Tel2+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Calle</div>`+Street+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No Exterior</div>`+StreetNo+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No. Interior</div>`+Building+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Colonia</div>`+Block+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Ciudad</div>`+City+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">C.P.</div>`+ZipCode+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Alcaldía/Munipio</div>`+County+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Estado</div>`+State+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No. Copias OC</div>`+U_Copias_OC+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No. Copias Factura</div>`+U_Copias_FB+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No. Copias SUA</div>`+U_Copias_SUA+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No. Copias TIA</div>`+U_Copias_TIA+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">No. Copias Otros</div>`+U_Otros+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Recepción en Lunes</div>`+U_RecepL+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Recepción en Martes</div>`+U_RecepM+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Recepción en Miércoles</div>`+U_RecepMi+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Recepción en Jueves</div>`+U_RecepJ+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Recepción en Viernes</div>`+U_RecepV+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Recepción en Sábado</div>`+U_RecepS+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Horarios de Lunes a Viernes</div>`+U_HorariosLV+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Horarios Sábado</div>`+U_HorarioS+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">¿Se requiere gestionar algún permiso para la entrega?</div>`+U_PEntrega+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">¿Cual es medio para solicitarlo?</div>`+U_MedioP+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">¿Cuantos días de anticipación se debe solicitar?</div>`+U_TEntrega+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">¿Se requiere gestionar cita para la entrega?</div>`+U_CEntrega+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Nos Puede indicar el medio para solicitarlo</div>`+U_MCita+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Entrada de almacén</div>`+U_EA+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Folio de recepción de mercancía</div>`+U_Folio+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Contrarecibo</div>`+U_CR+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Firma y Sello en la Factura</div>`+U_Firma+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Nombre y firma de recibido en la factura</div>`+U_Recibido+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Sello del cliente</div>`+U_SelloCte+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">OC</div>`+U_OC+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">ID</div>`+U_ID+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Otro</div>`+U_Otro+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Ninguno equipo de protección</div>`+U_Ninguno+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Cofía</div>`+U_Cofia+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Calzado de Seguridad</div>`+U_Calzado+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Otros</div>`+U_U_Otros+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#" class="item-link item-content">
                                                    <div class="item-media">
                                                        <i class="material-icons md-light" style="color: #063E7F;">lens</i>
                                                    </div>
                                                    <div class="item-inner no-chevron">
                                                        <div class="item-title">
                                                            <div class="item-header">Favor de indicar si existen otros requisitos a considerar en la entrega</div>`+U_U_DesOtros+`
                                                        </div>
                                                    </div>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <fwm></fwm>
                                </div>
                            </div>
                        </div>
                      </div>
                  </div>
                `,
                on: {
                    open: function (popup) {
                        $('#closeP').click(function () {
                            manual.close();
                            $("#autocomplete-dropdown-ajax").val('');
                        });
                    },
                }
        });
          manual.open();
    }
    //fin BennettsL
    //inicio Aliatonic
    function buscarClienteAliatonic(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#Idcliente-Field").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var puesto_contacto = $("#puesto_contacto").val();
        var telefono_contacto = $("#telefono_contacto").val();
        var correo = $("#correo_contacto").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#cliente-Field").val();
        if(localStorage.getItem('division') == 1){
            var tipo = "VisitaPacas";
            var tipoCedula = 'VisitaPacas';
            var estatus = 0;
            var id_visita = 1;
            if(nombre_cliente != ''){
                productHandler.addCedulaCompleta(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus,tipo);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "VisitaPacas"){
                                    console.log('aqui si entro ')
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            databaseHandler.db.transaction(
                                                function (tx) {
                                                tx.executeSql(
                                                    "insert into visita_Aliatonic(id_cedula) values(?)",
                                                    [id_cedula],
                                                    function (tx, results) {
                                                    console.log("Registro de datos producto creado exitosamente");
                                                    },
                                                    function (tx, error) {
                                                    console.error("Error registrar:" + error.message);
                                                    }
                                                );
                                                },
                                                function (error) {
                                                    console.log(error)
                                                },
                                        
                                                function () {}
                                            );
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    console.log('aqui tambien entro')
                                                    productHandler.addVisitaAliatonic(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,id_visita);
                                                    console.log('aqui tambien entroooo')
                                                    app.views.main.router.navigate({name: 'recorridoAliatonic1'});
                                                    app.preloader.hide();
                                                    console.log('aqui tambien paso')
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerido, por favor colocalo para poder iniciar." ,"warning");
                app.preloader.hide();
            }
        }else if(localStorage.getItem('division') == 2){
            var tipo = "VisitaCable";
            var tipoCedula = 'VisitaCable';
            var estatus = 0;
            var id_visita = 1;
            if(nombre_cliente != ''){
                productHandler.addCedulaCompleta(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus,tipo);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "VisitaCable"){
                                    console.log('aqui si entro ')
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            databaseHandler.db.transaction(
                                                function (tx) {
                                                tx.executeSql(
                                                    "insert into visita_Aliatonic(id_cedula) values(?)",
                                                    [id_cedula],
                                                    function (tx, results) {
                                                    console.log("Registro de datos producto creado exitosamente");
                                                    },
                                                    function (tx, error) {
                                                    console.error("Error registrar:" + error.message);
                                                    }
                                                );
                                                },
                                                function (error) {
                                                console.log('me ves3')
                                                    console.log(error)
                                                },
                                        
                                                function () {}
                                            );
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    console.log('aqui tambien entro')
                                                    productHandler.addVisitaAliatonic(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,id_visita);
                                                    console.log('aqui tambien entroooo')
                                                    app.views.main.router.navigate({name: 'recorridoAliatonic2'});
                                                    app.preloader.hide();
                                                    console.log('aqui tambien paso')
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerido, por favor colocalo para poder iniciar." ,"warning");
                app.preloader.hide();
            }
        }
        
        
    }
    function guardarValidAliatonic(){
        let id_cedula = localStorage.getItem("IdCedula");
        var tipo_inmueble = $("#tipo_inmueble").val();
        var ubicacion = $("#ubicacion").val();
        var caracteristicas_inmueble = $("#caracteristicas_inmueble").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        var page = 1;
        if (foto){
            if(caracteristicas_inmueble){}else{comentario='Sin Observaciones'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO validaAntesServ(id_cedula, observaciones, foto, fecha,tipo_tarima,no_tarimas,page) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula,caracteristicas_inmueble, foto, fecha_registro,tipo_inmueble, ubicacion,page],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql( 
                                        "Select * from validaAntesServ where id_cedula = ? AND page=? ORDER BY id_evidencia DESC",
                                            [id_cedula,page],
                                            function(tx, results){ 
                                                var item = results.rows.item(0);
                                                $("#tabla_evidenciasAliatonic").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaaliatonic("+item.id_evidencia +",1,`validaAntesServ`);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.observaciones
                                                + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#tipo_inmueble").val('');
                                                $("#tipo_inmueble").val();
                                                $("#caracteristicas_inmueble").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();  
                                            }
                                    );  
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );                
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotografía es requerida" ,"warning");
        }
    }
    function checkPointPacasAliatonic(){
        let id_cedula = localStorage.getItem("IdCedula");
        var No_Pacas = $("#No_Pacas").val();
        var observaciones = $("#observaciones").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        if (foto){
            if(observaciones){}else{comentario='Sin Observaciones'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO checkPointPacas(id_cedula, observaciones, foto, fecha,No_pacas) VALUES (?,?,?,?,?)",
                        [id_cedula,observaciones, foto, fecha_registro,No_Pacas],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql( 
                                        "Select * from checkPointPacas where id_cedula = ?  ORDER BY id_evidencia DESC",
                                            [id_cedula],
                                            function(tx, results){ 
                                                var item = results.rows.item(0);
                                                $("#tabla_checkpointPacas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1,`checkPointPacas`);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.observaciones
                                                + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#No_Pacas").val('');
                                                $("#observaciones").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();  
                                            }
                                    );  
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );                
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotografía es requerida" ,"warning");
        }
    }
    function checkOutPacasAliatonic(){
        let id_cedula = localStorage.getItem("IdCedula");
        var nombre_operador = $("#nombre_operador").val();
        var hora_salida = $("#hora_salida").val();
        var tipo_tarima = $("#tipo_tarima").val();
        var no_pacas = $("#no_pacas").val();
        var observaciones = $("#observaciones").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        if (foto){
            if(observaciones){}else{comentario='Sin Observaciones'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO checkoutPacas(id_cedula, observaciones, foto, fecha,nombre_operador,hora_salida,tipo_tarima,no_pacasrealizadas) VALUES (?,?,?,?,?,?,?,?)",
                        [id_cedula,observaciones, foto, fecha_registro,nombre_operador,hora_salida,tipo_tarima,no_pacas],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql( 
                                        "Select * from checkPointPacas where id_cedula = ?  ORDER BY id_evidencia DESC",
                                            [id_cedula],
                                            function(tx, results){ 
                                                var item = results.rows.item(0);
                                                $("#tabla_checkoutPacas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1,`checkoutPacas`);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.observaciones
                                                + "</td><td style='text-align: center;'>" + item.no_pacasrealizadas + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#No_Pacas").val('');
                                                $("#observaciones").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();  
                                            }
                                    );  
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );                
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotografía es requerida" ,"warning");
        }
    }
    function incidenPacasAliatonic(){
        let id_cedula = localStorage.getItem("IdCedula");
        var tipo_incidencia = $("#tipo_incidencia").val();
        var observaciones = $("#observaciones").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var foto = $("#imagenC").val();
        if (foto){
            if(observaciones){}else{comentario='Sin Observaciones'}
            databaseHandler.db.transaction(
                function(tx){//id_cedula text,comentario text,foto blob,fecha text
                    tx.executeSql("INSERT INTO incidenciasPacas(id_cedula, observaciones, foto, fecha,tipo_incidencia) VALUES (?,?,?,?,?)",
                        [id_cedula,observaciones, foto, fecha_registro,tipo_incidencia],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql( 
                                        "Select * from incidenciasPacas where id_cedula = ?  ORDER BY id_evidencia DESC",
                                            [id_cedula],
                                            function(tx, results){ 
                                                var item = results.rows.item(0);
                                                $("#tabla_incidenciasPacas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaProteus("+item.id_evidencia +",1,`incidenciasPacas`);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.observaciones
                                                + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#tipo_incidencia").val('0');
                                                $("#observaciones").css("background-color", "#FFFFFF");
                                                $("#smallImage").attr("src","img/blank.png");
                                                $("#photoIcon").attr("src","img/camera.svg");
                                                $("#imagenC").val('');
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                            function(tx, error){
                                                console.log("Error: " + error.message);
                                                app.preloader.hide();  
                                            }
                                    );  
                                },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                            );                
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error: " + error.message);
                },
                function(){}
            );
        }else{
            swal("", "La fotografía es requerida" ,"warning");
        }
    }
    function eliminarFilaaliatonic(index, opc,tabla){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM "+ tabla +" WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarReporteGeneralAliat(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","El campo de nombre y firma son obligatorios","warning");
            return false;
        }
        if($("#imagenC").val() == ""){
            swal("","Debes tomar la fotografía del sello para poder continuar","warning");
            return false;
        }
        var foto_sello = $("#imagenC").val();
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firma_cliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_gene_aliatonic SET cliente = ?, firma_cliente = ?, fecha_cliente = ? WHERE id_cedula = ?",
                    [nombrefirma,firma_cliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                                    [nombrefirma,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyAliatonic/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedAliatonic(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        
        if(tipo == 1){
            localStorage.setItem("Opcion", '1');
            app.views.main.router.navigate({ name: 'recorridoAliatonic1'});
        }else if(tipo == 2){
            localStorage.setItem("Opcion", '2');
            app.views.main.router.navigate({ name: 'recorridoAliatonic2'});
        }
    }
    function guardaEncuestaAliatonic(){
        var fecha = new Date();
        var fecha_encuesta = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var id_cedula = localStorage.getItem("IdCedula");
        var recomienda=0;
        var RCcarita = 0;
        var CCcarita = 0;
        var ACcarita = 0;
        var SCcarita = 0;
    
        for(i = 1;i <= 10; i++){
            if($("#rat"+i).prop("checked") == true){
                recomienda=i;
            }
        }
        for(i = 1;i <= 10; i++){
            if($("#RCcarita"+i).prop("checked") == true){
                RCcarita=i;
            }
        }
        for(i = 1;i <= 10; i++){
            if($("#CCcarita"+i).prop("checked") == true){
                CCcarita=i;
            }
        }
    
        for(i = 1;i <= 10; i++){
            if($("#ACcarita"+i).prop("checked") == true){
                ACcarita=i;
            }
        }
    
        for(i = 1;i <= 10; i++){
            if($("#SCcarita"+i).prop("checked") == true){
                SCcarita=i;
            }
        }
    
        if (recomienda==0 || RCcarita==0 || CCcarita==0 || ACcarita==0 || SCcarita==0){
            //console.log("no");
            app.dialog.alert('Debes colocar una calificación en todos', 'Aviso');
        }else{
            app.preloader.show('blue');
            //console.log(recomienda,RCcarita, CCcarita, ACcarita, SCcarita);
            productHandler.encuestaAliatonic(id_cedula, recomienda,RCcarita,CCcarita,ACcarita,SCcarita,fecha_encuesta);
            app.preloader.hide();
            app.dialog.alert('Encuesta guardada', 'Confirmación');
            $("#encuesta").css("display", "none");
            $("#realizada").css("display", "block");
            $("#btnEncuesta").css("display", "none");
            $("#btnQR").css("display", "none");
            app.sheet.close('#SheetEncuesta');
        }
    }
    function terminarReportAliatonic(){
        var id_cedula = localStorage.getItem("IdCedula");
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        
        var foto_salida = $('#imagenC').val();
        var firma_tec = $('#signate').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE visita_Aliatonic SET firma_tecnico = ?, foto_salida = ? WHERE id_cedula = ?",
                                    [firma_tec,foto_salida,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );    
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresar_Aliatonic(opcion){
        if(opcion == 1){
            app.views.main.router.back('/recorridoAliatonic1/', {force: true, ignoreCache: true, reload: true});    
        }else{
            app.views.main.router.back('/recorridoAliatonic2/', {force: true, ignoreCache: true, reload: true});
        }
    }
    //fin Aliatonic
    //inicio Zona04
    function continuarCedZona(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            localStorage.setItem("tipoServicio", "Prospeccion");
            app.views.main.router.back('/recorridoZona2/', {force: true, ignoreCache: true, reload: true});
        }else if(tipo == 2){
            localStorage.setItem("tipoServicio", "Clientes_zona");
            app.views.main.router.back('/recorridoZona1/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function startFromProgramZona1(idCte,id_cliente,client_name,category,celular,correo,fecha,nombre_completo,tipo_recurso,otro_recurso,otro,porqueotro,presupuesto,clave_easy,street,exterior,interior,colonia,alcaldia,ciudad,cp,titulo_propiedad,operacion,agente,inmueble,dia,hora,caracteristicas){
        var geolocation = $("#geolocation").val();
        localStorage.setItem("geolocation", geolocation);
        localStorage.setItem("IdCte", idCte);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("nombreCliente", client_name);
        localStorage.setItem("category", category);
        localStorage.setItem("celular", celular);
        localStorage.setItem("correo", correo);
        localStorage.setItem("fecha", fecha);
        localStorage.setItem("nombre_completo", nombre_completo);
        localStorage.setItem("tipo_recurso", tipo_recurso);
        localStorage.setItem("otro_recurso", otro_recurso);
        localStorage.setItem("otro", otro);
        localStorage.setItem("porqueotro", porqueotro);
        localStorage.setItem("presupuesto", presupuesto);
        localStorage.setItem("clave_easy", clave_easy);
        localStorage.setItem("street", street);
        localStorage.setItem("exterior", exterior);
        localStorage.setItem("interior", interior);
        localStorage.setItem("colonia", colonia);
        localStorage.setItem("alcaldia", alcaldia);
        localStorage.setItem("ciudad", ciudad);
        localStorage.setItem("cp", cp);
        localStorage.setItem("titulo_propiedad", titulo_propiedad);
        localStorage.setItem("operacion", operacion);
        localStorage.setItem("agente", agente);
        localStorage.setItem("inmueble", inmueble);
        localStorage.setItem("dia", dia);
        localStorage.setItem("hora", hora);
        localStorage.setItem("caracteristicas", caracteristicas);
        //app.views.main.router.navigate({name: 'yallegueZona2'});
        iniciarClienteZona04();
    }
    function startFromProgramZona(idCte,id_cliente,client_name,category,celular,correo,fecha,nombre_completo,direccion,inmueble,otro_inmueble,caracteristicas){
        localStorage.setItem("IdCte", idCte);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("nombreCliente", client_name);
        localStorage.setItem("category", category);
        localStorage.setItem("celular", celular);
        localStorage.setItem("correo", correo);
        localStorage.setItem("fecha", fecha);
        localStorage.setItem("nombre_completo", nombre_completo);
        localStorage.setItem("direccion", direccion);
        localStorage.setItem("inmueble", inmueble);
        localStorage.setItem("otro_inmueble", otro_inmueble);
        localStorage.setItem("caracteristicas", caracteristicas);
        var geolocation = $("#geolocation").val();
        localStorage.setItem("geolocation", geolocation);
        iniciarClienteZona04();
        //app.views.main.router.navigate({name: 'yallegueZona2'});
    }

    function iniciarClienteZona04(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = localStorage.getItem("geolocation");
        var id_visita = localStorage.getItem("IdCte");
        var id_cliente = localStorage.getItem("id_cliente");
        var tipo_cedula = localStorage.getItem("category");
        var celular = localStorage.getItem("celular");
        var correo = localStorage.getItem("correo");
        var nombre_completo = localStorage.getItem("nombre_completo");
        var nombreCliente = localStorage.getItem("nombreCliente");
        var otro_inmueble = localStorage.getItem("otro_inmueble");
        var horario_programado = fecha_llegada;
        var foto_llegada = "A esperar";
        var tipo = localStorage.getItem("tipo_recurso");
        var otro_tipo = localStorage.getItem("otro_recurso");
        var porque = localStorage.getItem("otro");
        var porqueotro = localStorage.getItem("porqueotro");
        var presupuesto =localStorage.getItem("presupuesto");
        var tipo_cedula = localStorage.getItem("category");
        var caracteristicas_generales = localStorage.getItem("caracteristicas");
        var direccion = localStorage.getItem("direccion");
        var inmueble = localStorage.getItem("inmueble");
        var clave_easy = localStorage.getItem("clave_easy");
        var street = localStorage.getItem("street");
        var exterior = localStorage.getItem("exterior");
        var interior = localStorage.getItem("interior");
        var colonia = localStorage.getItem("colonia");
        var alcaldia = localStorage.getItem("alcaldia");
        var ciudad = localStorage.getItem("ciudad");
        var cp = localStorage.getItem("cp");
        var titulo_propiedad = localStorage.getItem("titulo_propiedad");
        var operacion = localStorage.getItem("operacion");
        var agente = localStorage.getItem("agente");
        var dia = localStorage.getItem("dia");
        var hora = localStorage.getItem("hora");
        if(tipo_cedula == 'Clientes_zona'){
            foto_llegada = "Clientes";
        }

        if(tipo_cedula == 'Prospeccion'){
            var tipoCedula = 'Prospeccion'
        }else if(tipo_cedula == 'Clientes_zona'){
            var tipoCedula = 'Clientes_zona';
        }
        var estatus = 0;
        if(foto_llegada != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_completo,horario_programado,estatus,tipoCedula);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var id_cedula = item.Id;
                            localStorage.setItem("IdCedula", item.Id);
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                        [tipoCedula,id_cedula],
                                        function(tx, results){
                                            if(tipoCedula == "Prospeccion"){
                                                productHandler.addZonaProspeccion(id_cedula,id_visita,nombre_completo,celular,correo,direccion,inmueble,otro_inmueble,caracteristicas_generales,foto_llegada);
                                                localStorage.setItem("tipoServicio",tipoCedula);
                                                app.views.main.router.back('/recorridoZona2/', {force: true, ignoreCache: true, reload: true});
                                            } else if(tipoCedula == "Clientes_zona"){
                                                var op = 1;
                                                productHandler.addZona(id_cedula,op,id_visita,nombre_completo,celular,correo,presupuesto,tipo,porque,otro_tipo,porqueotro,clave_easy,street,exterior,interior,colonia,alcaldia,ciudad,cp,titulo_propiedad,operacion,agente,inmueble,nombre_usuario,dia,hora,caracteristicas_generales);
                                                localStorage.setItem("tipoServicio",tipoCedula);
                                                app.views.main.router.back('/recorridoZona1/', {force: true, ignoreCache: true, reload: true});
                                            }
                                        },
                                        function(tx, error){
                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function buscarClienteZona(){
        var IdCte = $("#IdCte").val();
        var title = $("#title").val();
        var nombre_completo = $("#nombre_completo").val();
        var celular = $("#celular").val();
        var correo = $("#correo").val();
        var direccion = $("#direccion").val();
        var inmueble = $("#inmueble").val();
        var otro_inmueble = $("#otro_inmueble").val();
        var tipo_recursos = $("#tipo_recursos").val();
        var otro_recurso = $("#otro_recurso").val();
        var presupuesto = $("#presupuesto").val();
        var porque = $("#porque").val();
        var porqueotro = $("#porqueotro").val();
        var caracteristicas = $("#caracteristicas").val();
        var inmobiliaria = $("#inmobiliaria").val();
        var asesor_externo = $("#asesor_externo").val();
        var celular1 = $("#celular1").val();
        var correo1 = $("#correo1").val();
        var asesor_asiste = $("#asesor_asiste").val();
        var celular2 = $("#celular2").val();
        var category = $("#category").val();
        var clave_easy = $("#clave_easy").val();
        var street = $("#street").val();
        var exterior = $("#exterior").val();
        var interior = $("#interior").val();
        var colonia = $("#colonia").val();
        var ciudad = $("#ciudad").val();
        var cp = $("#cp").val();
        var titulo_propiedad = $("#titulo_propiedad").val();
        var operacion = $("#operacion").val();
        var agente = $("#agente").val();
        var alcaldia = $("#alcaldia").val();
        var dia = $("#dia").val();
        var hora = $("#hora").val();

        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = "A esperar";
        var nombre_cliente = $("#cliente-Field").val();
        var estatus = 0;
        var id_cliente = 'na';
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);

                                localStorage.setItem("IdCte" ,IdCte);
                                localStorage.setItem("title" ,title);
                                localStorage.setItem("nombre_completo" ,nombre_completo);
                                localStorage.setItem("celular" ,celular);
                                localStorage.setItem("correo" ,correo);
                                localStorage.setItem("direccion" ,direccion);
                                localStorage.setItem("inmueble" ,inmueble);
                                localStorage.setItem("otro_inmueble" ,otro_inmueble);
                                localStorage.setItem("tipo_recursos" ,tipo_recursos);
                                localStorage.setItem("otro_recurso " ,otro_recurso );
                                localStorage.setItem("presupuesto" ,presupuesto);
                                localStorage.setItem("porque" ,porque);
                                localStorage.setItem("porqueotro" ,porqueotro);
                                localStorage.setItem("caracteristicas" ,caracteristicas);
                                localStorage.setItem("inmobiliaria" ,inmobiliaria);
                                localStorage.setItem("asesor_externo" ,asesor_externo);
                                localStorage.setItem("celular1" ,celular1);
                                localStorage.setItem("correo1" ,correo1);
                                localStorage.setItem("asesor_asiste" ,asesor_asiste);
                                localStorage.setItem("celular2" ,celular2);
                                localStorage.setItem("category" ,category);
                                localStorage.setItem("clave_easy",clave_easy);
                                localStorage.setItem("street",street);
                                localStorage.setItem("exterior",exterior);
                                localStorage.setItem("interior",interior);
                                localStorage.setItem("colonia",colonia);
                                localStorage.setItem("ciudad",ciudad);
                                localStorage.setItem("cp",cp);
                                localStorage.setItem("titulo_propiedad",titulo_propiedad);
                                localStorage.setItem("operacion",operacion);
                                localStorage.setItem("agente",agente);
                                localStorage.setItem("alcaldia",alcaldia);
                                localStorage.setItem("dia",dia);
                                localStorage.setItem("hora",hora);

                                app.views.main.router.navigate({name: 'menuZona04'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarRecorrido_zona(op){
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_cliente = localStorage.getItem("nombreCliente");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var foto_llegada = localStorage.getItem("foto_llegada");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

        var id_visita = localStorage.getItem("IdCte")
        var title = localStorage.getItem("title")
        var nombre_completo = localStorage.getItem("nombre_completo")
        var celular = localStorage.getItem("celular")
        var correo = localStorage.getItem("correo")
        var direccion = localStorage.getItem("direccion")
        var inmueble = localStorage.getItem("inmueble")
        var otro_inmueble = localStorage.getItem("otro_inmueble")
        var tipo = localStorage.getItem("tipo_recursos")
        var otro_tipo = localStorage.getItem("otro_recurso ")
        var presupuesto = localStorage.getItem("presupuesto")
        var porque = localStorage.getItem("porque")
        var porqueotro = localStorage.getItem("porqueotro")
        var caracteristicas_generales = localStorage.getItem("caracteristicas")
        var inmobiliaria = localStorage.getItem("inmobiliaria")
        var asesor_externo = localStorage.getItem("asesor_externo")
        var celular1 = localStorage.getItem("celular1")
        var correo1 = localStorage.getItem("correo1")
        var asesor_asiste = localStorage.getItem("asesor_asiste")
        var celular2 = localStorage.getItem("celular2")
        var clave_easy = localStorage.getItem("clave_easy");
        var street = localStorage.getItem("street");
        var exterior = localStorage.getItem("exterior");
        var interior = localStorage.getItem("interior");
        var colonia = localStorage.getItem("colonia");
        var ciudad = localStorage.getItem("ciudad");
        var cp = localStorage.getItem("cp");
        var titulo_propiedad = localStorage.getItem("titulo_propiedad");
        var operacion = localStorage.getItem("operacion");
        var agente = localStorage.getItem("agente");
        var alcaldia = localStorage.getItem("alcaldia");
        var dia = localStorage.getItem("dia");
        var hora = localStorage.getItem("hora");

        if(op == 1){
            var tipoCedula = 'Clientes_zona';
        }else if(op == 2){
            var tipoCedula = 'Prospeccion'
        }

        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula, id_cedula],
                    function (tx, results) {
                        if(tipoCedula == "Prospeccion"){
                            productHandler.addZonaProspeccion(id_cedula,id_visita,nombre_completo,celular,correo,direccion,inmueble,otro_inmueble,caracteristicas_generales,foto_llegada);
                            localStorage.setItem("tipoServicio",tipoCedula);
                            app.views.main.router.back('/recorridoZona2/', {force: true, ignoreCache: true, reload: true});
                        } else if(tipoCedula == "Clientes_zona"){
                            var op = 1;
                            productHandler.addZona(id_cedula,op,id_visita,nombre_completo,celular,correo,presupuesto,tipo,porque,otro_tipo,porqueotro,clave_easy,street,exterior,interior,colonia,alcaldia,ciudad,cp,titulo_propiedad,operacion,agente,inmueble,nombre_usuario,dia,hora,caracteristicas_generales);
                            localStorage.setItem("tipoServicio",tipoCedula);
                            app.views.main.router.back('/recorridoZona1/', {force: true, ignoreCache: true, reload: true});
                        }
                    },
                    function (tx, error) {
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function select_tipo(val,tipo){
        if(val == 'Otro'){
            $('#div_otros'+tipo).css("display", "block");
        }else{
            $('#div_otros'+tipo).css("display", "none");
        }
    }
    function guardarDG_zona(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            if($("#tipo").val() != 0){
                if($("#tipo").val() == 'Otro'){if ($("#otro-tipo").val()){}else{swal("","Debes especificar cuál es el otro tipo de recurso","warning"); return false;}}
            }else{
                swal("","Debes seleccionar una opción para los tipos de recursos","warning"); return false;
            }

            if($("#porque").val() != 0){
                if($("#porque").val() == 'Otro'){if ($("#porqueotro").val()){}else{swal("","Debes especificar cuál es el otro tipo de recurso","warning"); return false;}}
            }else{
                swal("","Debes seleccionar una opción del medio por el cual se enteraron","warning"); return false;
            }

            var id_cedula = localStorage.getItem("IdCedula");
            var cliente = $("#cliente").val();
            var celular = $("#celular").val();
            var correo = $("#correo").val();
            var tipo = $("#tipo option:selected").text();
            var otrotipo = $("#otro-tipo").val();
            var presupuesto = $("#presupuesto").val();
            var porque = $("#porque option:selected").text();
            var porqueotro = $("#porqueotro").val();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosG_zona SET nombre = ?, celular = ?, correo = ?, tipo = ?, tipo_otro = ?, presupuesto = ?, porque = ?, porqueotro = ? WHERE id_cedula = ?",
                        [cliente,celular,correo,tipo,otrotipo,presupuesto,porque,porqueotro,id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#cliente").css("background-color", "#FFFFFF");
                            $("#celular").css("background-color", "#FFFFFF");
                            $("#correo").css("background-color", "#FFFFFF");
                            $("#otro-tipo").css("background-color", "#FFFFFF");
                            $("#presupuesto").css("background-color", "#FFFFFF");
                            $("#porqueotro").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarPerfilZona(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            if($("#tipo_inmueble").val()==0){
                swal("","Debes indicar el tipo de inmueble","warning"); return false;
            }else{
                if($("#tipo_inmueble").val()=='Otro'){
                    if($("#otro_inmueble").val()){}else{swal("","Debes especificar el tipo de inmueble","warning"); return false;}
                }
            }
            if($("#tipo_operacion").val()==0){
                swal("","Debes indicar el tipo de operación","warning"); return false;
            }
            if($("#alcaldia").val()==0){
                swal("","Debes indicar la alcaldía","warning"); return false;
            }

            var calle = $("#calle").val();
            var no_exterior = $("#no_exterior").val();
            var no_interior = $("#no_interior").val();
            var colonia = $("#colonia").val();
            var ciudad = $("#ciudad").val();
            var cp = $("#cp").val();
            var tipo_inmueble = $("#tipo_inmueble").val();
            var otro_inmueble = $("#otro_inmueble").val();
            var tipo_operacion = $("#tipo_operacion").val();
            var alcaldia = $("#alcaldia").val();
            var ubicacion = $("#ubicacion").val();
            var caracteristicas_inmueble = $("#caracteristicas_inmueble").val();
            var id_cedula = localStorage.getItem("IdCedula");

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosG_zona SET calle = ?, no_exterior = ?, no_interior = ?, colonia = ?, ciudad = ?, cp = ?, tipo_inmueble = ?, otro_inmueble = ?, tipo_operacion = ?, alcaldia = ?, ubicacion = ?, caracteristicas_inmueble = ? WHERE id_cedula = ?",
                        [calle,no_exterior,no_interior,colonia,ciudad,cp,tipo_inmueble,otro_inmueble,tipo_operacion,alcaldia,ubicacion,caracteristicas_inmueble,id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#otro_inmueble").css("background-color", "#FFFFFF");
                            $("#ubicacion").css("background-color", "#FFFFFF");
                            $("#caracteristicas_inmueble").css("background-color", "#FFFFFF");
                            $("#calle").css("background-color", "#FFFFFF");
                            $("#no_exterior").css("background-color", "#FFFFFF");
                            $("#no_interior").css("background-color", "#FFFFFF");
                            $("#colonia").css("background-color", "#FFFFFF");
                            $("#ciudad").css("background-color", "#FFFFFF");
                            $("#cp").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );

        } else {
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarCitaZona(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var propiedad = $("#propiedad").val();
            var clave = $("#clave").val();
            var dia = $("#dia").val();
            var hora = $("#hora").val();
            var asesor_asigando = $("#asesor_asigando").val();
            var asesor_muestra = $("#asesor_muestra").val();
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosG_zona SET propiedad = ?, clave = ?, dia = ?, hora = ?,asesor_asigando = ?, asesor_muestra = ? WHERE id_cedula = ?",
                        [propiedad,clave,dia,hora,asesor_asigando,asesor_muestra,id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#propiedad").css("background-color", "#FFFFFF");
                            $("#clave").css("background-color", "#FFFFFF");
                            $("#dia").css("background-color", "#FFFFFF");
                            $("#hora").css("background-color", "#FFFFFF");
                            $("#asesor_asigando").css("background-color", "#FFFFFF");
                            $("#asesor_muestra").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );

        } else {
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarProspeccionZona(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            if($("#tipo_inmueble").val()==0){
                swal("","Debes indicar el tipo de inmueble","warning"); return false;
            }else{
                if($("#tipo_inmueble").val()=='Otro'){
                    if($("#otro_inmuble").val()){}else{swal("","Debes indicar describir tipo de inmueble","warning"); return false;}
                }
            }
            if($("#caracteristicas_generales").val()){}else{swal("","Debes llenar las características generales","warning"); return false;}
            var nombre_cliente = $("#nombre_cliente").val();
            var correo = $("#correo").val();
            var telefono = $("#telefono").val();
            var direccion = $("#direccion").val();
            var tipo_inmueble = $("#tipo_inmueble").val();
            var otro_inmuble = $("#otro_inmuble").val();
            var caracteristicas_generales = $("#caracteristicas_generales").val();
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE prospeccion_zona SET nombre_cliente = ?, correo = ?, telefono = ?, direccion = ?, tipo_inmueble = ?, otro_inmuble = ?, caracteristicas_generales = ? WHERE id_cedula = ?",
                        [nombre_cliente,correo,telefono,direccion,tipo_inmueble,otro_inmuble,caracteristicas_generales,id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#nombre_cliente").css("background-color", "#FFFFFF");
                            $("#correo").css("background-color", "#FFFFFF");
                            $("#telefono").css("background-color", "#FFFFFF");
                            $("#direccion").css("background-color", "#FFFFFF");
                            $("#tipo_inmueble").css("background-color", "#FFFFFF");
                            $("#otro_inmuble").css("background-color", "#FFFFFF");
                            $("#caracteristicas_generales").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function get_datos_completos(){
        var campos;
        var trae_los_campos_sin_llennar='';
        campos = document.querySelectorAll('#datos_form input.obligatorio');
        var valido = true;

        [].slice.call(campos).forEach(function(campo) {
            if (campo.value.trim() === '') {
                valido = false;
                trae_los_campos_sin_llennar = trae_los_campos_sin_llennar + ", "+$(campo).attr("name");
            }
        });
        if (valido) {
            return {
                valido: valido,
                reponse: "1"
            };
        } else {
            const str = trae_los_campos_sin_llennar;
            const quita_coma = str.slice(1)
            return {
                valido: valido,
                response: quita_coma
            };
        }
    }
    function regresar_zona04(opcion){
        if(opcion == 1){
            app.views.main.router.back('/recorridoZona1/', {force: true, ignoreCache: true, reload: true});
        }else{
            app.views.main.router.back('/recorridoZona2/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardaVentaZona(){
        var values = get_datos_completos2('datos_form1');
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var calle_v = $("#calle_v").val();
            var no_exterior_v = $("#no_exterior_v").val();
            var no_interior_v = $("#no_interior_v").val();
            var colonia_v = $("#colonia_v").val();
            var alcadia_v = $("#alcadia_v").val();
            var ciudad_v = $("#ciudad_v").val();
            var cp_v = $("#cp_v").val();
            var precio_venta_v = $("#precio_venta_v").val();
            var precio_letra_v = $("#precio_letra_v").val();
            var forma_pago_v = $("#forma_pago_v").val();
            var nombre_compra_v = $("#nombre_compra_v").val();
            var apartado_v = $("#apartado_v").val();
            var anticipo_contrato_v = $("#anticipo_contrato_v").val();
            var monto_restante_v = $("#monto_restante_v").val();
            var cuando_contrato_v = $("#cuando_contrato_v").val();
            var observaciones = $("#observaciones").val();
            var id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO venta_zona(id_cedula,calle_v ,no_exterior_v ,no_interior_v ,colonia_v ,alcadia_v ,ciudad_v ,cp_v ,precio_venta_v ,precio_letra_v ,forma_pago_v ,nombre_compra_v ,apartado_v ,anticipo_contrato_v ,monto_restante_v ,cuando_contrato_v ,observaciones, fecha_registro) VALUES (?, ? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? , ?)",
                        [id_cedula, calle_v, no_exterior_v, no_interior_v, colonia_v, alcadia_v, ciudad_v, cp_v, precio_venta_v, precio_letra_v, forma_pago_v, nombre_compra_v, apartado_v, anticipo_contrato_v, monto_restante_v, cuando_contrato_v, observaciones, fecha_registro],
                        function(tx, results){
                            app.dialog.alert('Carta guardada', 'Confirmación');
                            $("#encuesta1").css("display", "none");
                            $("#realizada1").css("display", "block");
                            $("#btn_encuesta_qr1").css("display", "none");
                            $("#btnEncuesta1").css("display", "none");
                            $("#div_firma").css("display", "block");
                            app.sheet.close('#SheetEncuesta1');
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }else{
            app.dialog.alert('Debes llenar estos campos para poder guardar: '+quita_coma, 'Aviso');
        }
    }
    function guardaEncuestaZona(){
        var values = get_datos_completos2('datos_form');
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var nombre_cliente_en = $("#nombre_cliente_en").val();
            var asesor_en = $("#asesor_en").val();
            var inmueble_en = $("#inmueble_en").val();
            var clave_EB_en = $("#clave_EB_en").val();
            var ubicacion = $("#ubicacion option:selected").text();
            var conservacion = $("#conservacion option:selected").text();
            var espacios = $("#espacios option:selected").text();
            var aspecto = $("#aspecto option:selected").text();
            var distrubucion = $("#distrubucion option:selected").text();
            var precio_comparado = $("#precio_comparado option:selected").text();
            var comentarios_inmueble = $("#comentarios_inmueble").val();
            var despues_visita = $("#despues_visita option:selected").text();
            var consideracion_servicios = $("#consideracion_servicios option:selected").text();
            var comentario_sugerencia = $("#comentario_sugerencia").val();
            var id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO encuestas_zona(id_cedula,nombre_cliente_en, asesor_en, inmueble_en, clave_EB_en, ubicacion, conservacion, espacios, aspecto, distrubucion, precio_comparado, comentarios_inmueble, despues_visita, consideracion_servicios, comentario_sugerencia,fecha_registro) VALUES (? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,? ,?, ?)",
                        [id_cedula, nombre_cliente_en, asesor_en, inmueble_en, clave_EB_en, ubicacion, conservacion, espacios, aspecto, distrubucion, precio_comparado, comentarios_inmueble, despues_visita, consideracion_servicios, comentario_sugerencia,fecha_registro],
                        function(tx, results){
                            app.dialog.alert('Encuesta guardada', 'Confirmación');
                            $("#encuesta").css("display", "none");
                            $("#realizada").css("display", "block");
                            $("#btn_encuesta_qr").css("display", "none");
                            $("#btnEncuesta").css("display", "none");
                            app.sheet.close('#SheetEncuesta2');
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }else{
            app.dialog.alert('Debes llenar estos campos para poder guardar: '+quita_coma, 'Aviso');
        }
    }
    function guardaRentaZona(){
        var values = get_datos_completos2('datos_form2');
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var calle_r = $("#calle_r").val();
            var no_exterior_r = $("#no_exterior_r").val();
            var no_interior_r = $("#no_interior_r").val();
            var colonia_r = $("#colonia_r").val();
            var alcadia_r = $("#alcadia_r").val();
            var ciudad_r = $("#ciudad_r").val();
            var cp_r = $("#cp_r").val();
            var precio_venta_r = $("#precio_venta_r").val();
            var precio_letra_r = $("#precio_letra_r").val();
            var meses_deposito_r = $("#meses_deposito_r").val();
            var cuota_mantenimiento_r = $("#cuota_mantenimiento_r").val();
            var forma_pago_r = $("#forma_pago_r").val();
            var pago_poliza_r = $("#pago_poliza_r").val();
            var fiador_gravamen_r = $("#fiador_gravamen_r").val();
            var fiador_r = $("#fiador_r").val();
            var ubicacion_inmueble_r = $("#ubicacion_inmueble_r").val();
            var arrendatario_moral_r = $("#arrendatario_moral_r").val();
            var nombre_r = $("#nombre_r").val();
            var nombre_firma_r = $("#nombre_firma_r").val();
            var fecha_inicio_contrato_r = $("#fecha_inicio_contrato_r").val();
            var vigencia_r = $("#vigencia_r").val();
            var giro_empresa_r = $("#giro_empresa_r").val();
            var anios_constituida_r = $("#anios_constituida_r").val();
            var pagina_web_r = $("#pagina_web_r").val();
            var ubicacion_actual_r = $("#ubicacion_actual_r").val();
            var motivo_cambio_r = $("#motivo_cambio_r").val();
            var personas_ocuparan_r = $("#personas_ocuparan_r").val();
            var observaciones_r = $("#observaciones_r").val();
            var id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO renta_zona(id_cedula, calle_r, no_exterior_r, no_interior_r, colonia_r, alcadia_r, ciudad_r, cp_r, precio_venta_r, precio_letra_r, meses_deposito_r, cuota_mantenimiento_r, forma_pago_r, pago_poliza_r, fiador_gravamen_r, fiador_r, ubicacion_inmueble_r, arrendatario_moral_r, nombre_r, nombre_firma_r, fecha_inicio_contrato_r, vigencia_r, giro_empresa_r, anios_constituida_r, pagina_web_r, ubicacion_actual_r, motivo_cambio_r, personas_ocuparan_r, observaciones_r ,fecha_registro) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ? ,?)",
                        [id_cedula, calle_r, no_exterior_r, no_interior_r, colonia_r, alcadia_r, ciudad_r, cp_r, precio_venta_r, precio_letra_r, meses_deposito_r, cuota_mantenimiento_r, forma_pago_r, pago_poliza_r, fiador_gravamen_r, fiador_r, ubicacion_inmueble_r, arrendatario_moral_r, nombre_r, nombre_firma_r, fecha_inicio_contrato_r, vigencia_r, giro_empresa_r, anios_constituida_r, pagina_web_r, ubicacion_actual_r, motivo_cambio_r, personas_ocuparan_r,observaciones_r,fecha_registro],
                        function(tx, results){
                            app.dialog.alert('Carta guardada', 'Confirmación');
                            $("#encuesta2").css("display", "none");
                            $("#realizada2").css("display", "block");
                            $("#btn_encuesta_qr2").css("display", "none");
                            $("#btnEncuesta2").css("display", "none");
                            $("#div_firma").css("display", "block");
                            app.sheet.close('#SheetEncuesta2');
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }else{
            app.dialog.alert('Debes llenar estos campos para poder guardar: '+quita_coma, 'Aviso');
        }
    }
    function get_datos_completos2(form){
        var campos;
        var trae_los_campos_sin_llennar='';
        campos = document.querySelectorAll('#'+form+' .obligatorio');
        var valido = true;

        [].slice.call(campos).forEach(function(campo) {
            if($(campo).get(0).tagName == 'SELECT'){
                if (campo.value.trim() == 0) {
                    valido = false;
                    trae_los_campos_sin_llennar = trae_los_campos_sin_llennar + ", "+$(campo).attr("name");
                }
            }else if($(campo).get(0).tagName == 'TEXTAREA'){
                if (campo.value.trim() === '') {
                    valido = false;
                    trae_los_campos_sin_llennar = trae_los_campos_sin_llennar + ", "+$(campo).attr("name");
                }
            }else{
                if (campo.value.trim() === '') {
                    valido = false;
                    trae_los_campos_sin_llennar = trae_los_campos_sin_llennar + ", "+$(campo).attr("name");
                }
            }
        });

        if (valido) {
            return {
                valido: valido,
                reponse: 1
            };
        } else {
            const str = trae_los_campos_sin_llennar;
            const quita_coma = str.slice(1)
            return {
                valido: valido,
                response: quita_coma
            };
        }
    }
    function guardarCierreZona042(){
        var id_cedula = localStorage.getItem("IdCedula");
        var pasa = true;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from venta_zona WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        let length = results.rows.length;
                        if (length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from renta_zona WHERE id_cedula = ?",
                                        [id_cedula],
                                        function(tx, results){
                                            let length = results.rows.length;
                                            if (length == 0){
                                                guardaCierreZona();
                                            }else{
                                                if($("#signate").val() == ""){
                                                    swal("","Debes agregar una firma que se ligara con tu carta de renta","warning");
                                                    pasa = false;
                                                }else{
                                                    guardaCierreZona();
                                                }
                                            }
                                        },
                                        function(tx, error){
                                            console.log("Error al mostar datos: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }else{
                            if($("#signate").val() == ""){
                                swal("","Debes agregar una firma que se ligara con tu carta de venta","warning");
                                pasa = false;
                            }else{
                                guardaCierreZona();
                            }
                        }
                    },
                    function(tx, error){
                        console.log("Error al mostar datos: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardaCierreZona(){
        var id_cedula = localStorage.getItem("IdCedula");
        var firmaCliente = $("#signate").val();
        var estatus = 0;
        var geolocalizacion_salida =$("#geolocation").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datosG_zona SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_firma,geolocalizacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyZona042/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarServicioZona042(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datosG_zona SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){ },
                    function(tx, error){ swal("Error al guardar",error.message,"error"); }
                );
            },
            function(error){}, function(){}
        );
        if(ubicacion_salida){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                        [fecha_salida,ubicacion_salida,estatus,id_cedula],
                        function(tx, results){
                            window.location.href = "./menu.html";
                        },
                        function(tx, error){ swal("Error al guardar",error.message,"error"); }
                    );
                },
                function(error){}, function(){}
            );
        }else{
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,estatus = ? WHERE id_cedula = ?",
                        [fecha_salida,estatus,id_cedula],
                        function(tx, results){
                            window.location.href = "./menu.html";
                        },
                        function(tx, error){ swal("Error al guardar",error.message,"error"); }
                    );
                },
                function(error){}, function(){}
            );
        }
        
    }
    function guardarCierreZona04(){
        var tipoServicio = localStorage.getItem("tipoServicio");
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var comentarioCliente = $('#comentario_cliente').val();
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();

        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE prospeccion_zona SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyZona04/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarServicioZona04(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE prospeccion_zona SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function copytoclipboard(fase){
        var text = $("#encuesta_link"+fase).val();
        cordova.plugins.clipboard.copy(text);
        app.dialog.alert('Link copiado correctamente', 'Confirmación');
    }
    //fin zona04
    //Inicio Restatools
    function buscarClienteRestatools(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var foto_llegada = $("#imagenC").val();
        var horario_programado = fecha_llegada;
        var nombre_cliente = $("#cliente-Field").val();
        var sucursal = $("#sucursal").val();
        var razon_social = $("#razon_social").val();
        var estaciones = $("#estaciones").val();
        var numero_estaciones = $("#numero_estaciones").val();
        var capacidad = $("#capacidad").val();
        var ubicacion = $("#ubicacion").val();
        var titulo_reporte = $("#titulo_reporte").val();
        var ubicacion_sucursal = $("#ubicacion_sucursal").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != '' && sucursal != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("horario_programado", horario_programado);
                                localStorage.setItem("sucursal", sucursal);
                                localStorage.setItem("social_reason", razon_social);
                                localStorage.setItem("estaciones", estaciones);
                                localStorage.setItem("no_estaciones", numero_estaciones);
                                localStorage.setItem("capacidad", capacidad);
                                localStorage.setItem("ubicacion", ubicacion);
                                localStorage.setItem("titulo_reporte", titulo_reporte);
                                localStorage.setItem("ubicacion_sucursal", ubicacion_sucursal);
                                app.views.main.router.navigate({name: 'menuRestatools'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Cliente no encontrado", "Favor de verificar el nombre del cliente" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarTrampaRestatools(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let fecha = localStorage.getItem("horario_programado");
        let sucursal = localStorage.getItem("sucursal");
        let razon_social = localStorage.getItem("social_reason");
        let estaciones = localStorage.getItem("estaciones");
        let numero_estaciones = localStorage.getItem("no_estaciones");
        let capacidad = localStorage.getItem("capacidad");
        let ubicacion = localStorage.getItem("ubicacion");
        let ubicacion_sucursal = localStorage.getItem("ubicacion_sucursal");
        let tipoCedula = "Trampa";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addTrampaRestatools(id_cedula,foto_llegada,nombre_cliente,fecha,sucursal,razon_social,estaciones,numero_estaciones,capacidad,ubicacion,ubicacion_sucursal);
                        localStorage.setItem("tipoServicio",tipoCedula);
                        app.views.main.router.navigate({name: 'recorridoRestatools1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMantenimientoRestatools(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let sucursal = localStorage.getItem("sucursal");
        let razon_social = localStorage.getItem("social_reason");
        let fecha = localStorage.getItem("horario_programado");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let ubicacion_sucursal = localStorage.getItem("ubicacion_sucursal");
        let tipoCedula = "Mantenimiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMmtoRestatools(id_cedula,nombre_cliente, sucursal, razon_social, fecha, foto_llegada,ubicacion_sucursal);
                        localStorage.setItem("tipoServicio",tipoCedula);
                        app.views.main.router.navigate({name: 'recorridoRestatools3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarExtraccionRestatools(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let sucursal = localStorage.getItem("sucursal");
        let razon_social = localStorage.getItem("social_reason");
        let fecha = localStorage.getItem("horario_programado");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let ubicacion = localStorage.getItem("ubicacion");
        let ubicacion_sucursal = localStorage.getItem("ubicacion_sucursal");
        let tipoCedula = "Extraccion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addExtraccionRestatools(id_cedula,nombre_cliente, sucursal, razon_social, fecha, foto_llegada,ubicacion_sucursal);
                        localStorage.setItem("tipoServicio",tipoCedula);
                        app.views.main.router.navigate({name: 'recorridoRestatools2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarDesasolveRestatools(){
        let id_cedula = localStorage.getItem("IdCedula");
        let titulo_reporte = localStorage.getItem("titulo_reporte");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let sucursal = localStorage.getItem("sucursal");
        let razon_social = localStorage.getItem("social_reason");
        let fecha = localStorage.getItem("horario_programado");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let ubicacion_sucursal = localStorage.getItem("ubicacion_sucursal");
        let tipoCedula = "Desasolve";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addDesasolveRestatools(id_cedula,titulo_reporte,nombre_cliente, sucursal, razon_social, fecha, foto_llegada,ubicacion_sucursal);
                        localStorage.setItem("tipoServicio",tipoCedula);
                        app.views.main.router.navigate({name: 'recorridoRestatools4'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function DatosTrampaRestatools(){
        var id_cedula = localStorage.getItem("IdCedula");
        var observaciones = $("#observaciones").val();
        if(observaciones){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_trampa_restatools SET observaciones = ? WHERE id_cedula = ?",
                        [observaciones,id_cedula],
                        function(tx, results){
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            $("#observaciones").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes llenar todos los campos" ,"warning");
        }
    }
    function guardarEvidenciaRestatools(recorrido, fase){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC").val();
        var comentario = $("#comentario").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(recorrido == 1){
            var area = $("#area").val();
            if (fase == 1){
                var area = $("#area").val();
            }else if (fase == 2){
                var area = $("#areas").val();
                if(area == 0){
                    swal("", "Debes seleccionar un área" ,"warning");
                    return false;
                }
            }
            if (foto && comentario && area){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO evidencias_restatools(id_cedula, comentario, area, foto, fase, recorrido, fecha) VALUES (?,?,?,?,?,?,?)",
                            [id_cedula, comentario, area, foto, fase, recorrido,fecha_registro],
                            function(tx, results){
                                swal("", "Se guardaron los datos correctamente" ,"success");
                                $("#comentario").css("background-color", "#FFFFFF");
                                $("#comentario").val('');
                                $("#area").css("background-color", "#FFFFFF");
                                $("#area").val('');
                                $("#imagenC").val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                if (fase == 2){
                                    $("#areas").val(0);
                                }
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from evidencias_restatools where id_cedula = ? AND fase = ? AND recorrido = ? ORDER BY id_evidencia desc",
                                        [id_cedula, fase, recorrido],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaRestatools("+
                                                item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                                item.comentario+ "</td><td style='text-align: center;'>" +
                                                item.area + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                            },
                                            function(tx, error){
                                                console.log("Error al mostrat datos: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes llenar todos los campos" ,"warning");
            }
        }else if(recorrido == 2){
            if (foto && comentario){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO evidencias_restatools(id_cedula, comentario, foto, fase, recorrido, fecha) VALUES (?,?,?,?,?,?)",
                            [id_cedula, comentario, foto, fase, recorrido,fecha_registro],
                            function(tx, results){
                                swal("", "Se guardaron los datos correctamente" ,"success");
                                $("#comentario").css("background-color", "#FFFFFF");
                                $("#comentario").val('');
                                $("#imagenC").val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from evidencias_restatools where id_cedula = ? AND fase = ? AND recorrido = ? ORDER BY id_evidencia desc",
                                        [id_cedula, fase, recorrido],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#tabla_evidencias").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaRestatools("+
                                                item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                                item.comentario+ "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                            },
                                            function(tx, error){
                                                console.log("Error al mostrat datos: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes colocar un comentario y tomar una fotografía" ,"warning");
            }
        }
    }
    function DatosExtraccionRestatools(){
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#area").val();
        if(area){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_extracciones_restatools SET area = ? WHERE id_cedula = ?",
                        [area,id_cedula],
                        function(tx, results){
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            $("#area").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes llenar todos los campos" ,"warning");
        }
    }
    function DatosMMtoRestatools(){
        var equipo = $("#equipo").val();
        var problematica = $("#problematica").val();
        var observaciones = $("#observaciones").val();
        if ($("#tipo1").prop("checked")){
            var tipo_servicio = 'Correctivo';
        }else if ($("#tipo0").prop("checked")){
            var tipo_servicio = 'Preventivo';
        }else {
            swal("", "Debes llenar todos los campos" ,"warning");
            return false;
        }
        if(equipo && problematica && observaciones){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_mmto_restatools SET equipo = ?, problematica = ?, observaciones = ?,tipo_servicio = ? WHERE id_cedula = ?",
                        [equipo, problematica,observaciones,tipo_servicio,id_cedula],
                        function(tx, results){
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            $("#equipo").css("background-color", "#FFFFFF");
                            $("#problematica").css("background-color", "#FFFFFF");
                            $("#observaciones").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes llenar todos los campos" ,"warning");
        }
    }
    function DatosDesasolveRestatools(){
        var no_lineas = $("#no_lineas").val();
        var problematica = $("#problematica").val();
        var observaciones = $("#observaciones").val();
        if ($("#tipo1").prop("checked")){
            var tipo_servicio = 'Correctivo';
        }else if ($("#tipo0").prop("checked")){
            var tipo_servicio = 'Preventivo';
        }else {
            swal("", "Debes llenar todos los campos" ,"warning");
            return false;
        }
        if(no_lineas && problematica && observaciones){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_desasolve_restatools SET numero_lineas = ?, problematica = ?, observaciones = ?,tipo_servicio = ? WHERE id_cedula = ?",
                        [no_lineas, problematica,observaciones,tipo_servicio,id_cedula],
                        function(tx, results){
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            $("#no_lineas").css("background-color", "#FFFFFF");
                            $("#problematica").css("background-color", "#FFFFFF");
                            $("#observaciones").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes llenar todos los campos" ,"warning");
        }
    }
    function guardarCierreRestatools(){
        var tipoServicio = localStorage.getItem("tipoServicio");
        if($("#cliente_cerrado").prop("checked")){
            var comentarioCliente = 'Cliente Cerrado';
        }else{
            if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
                swal("","Todos los campos son obligatorios","warning");
                return false;
            }
            if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
                swal("","Por favor, ingresa el motivo de tu calificacion","warning");
                return false;
            }
            var comentarioCliente = $('#comentario_cliente').val();
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();

        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(tipoServicio == 'Trampa'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_trampa_restatools SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                        [firmaCliente,fecha_firma,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                        [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                        function(tx, results){
                                            swal("","Guardado correctamente","success");
                                            app.views.main.router.back('/yamevoyRestatools/', {force: true, reload: true});
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipoServicio == 'Extraccion'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_extracciones_restatools SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                        [firmaCliente,fecha_firma,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                        [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                        function(tx, results){
                                            swal("","Guardado correctamente","success");
                                            app.views.main.router.back('/yamevoyRestatools/', {force: true, reload: true});
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipoServicio == 'Mantenimiento'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_mmto_restatools SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                        [firmaCliente,fecha_firma,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                        [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                        function(tx, results){
                                            swal("","Guardado correctamente","success");
                                            app.views.main.router.back('/yamevoyRestatools/', {force: true, reload: true});
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipoServicio == 'Desasolve'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_desasolve_restatools SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                        [firmaCliente,fecha_firma,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                        [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                        function(tx, results){
                                            swal("","Guardado correctamente","success");
                                            app.views.main.router.back('/yamevoyRestatools/', {force: true, reload: true});
                                        },
                                        function(tx, error){
                                            console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function terminarServicioRestatools(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var tipoServicio = localStorage.getItem("tipoServicio");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        if(tipoServicio == 'Trampa'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_trampa_restatools SET foto_salida  = ? WHERE id_cedula = ?",
                        [foto_salida,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                        [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                        function(tx, results){
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipoServicio == 'Extraccion'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_extracciones_restatools SET foto_salida  = ? WHERE id_cedula = ?",
                        [foto_salida,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                        [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                        function(tx, results){
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipoServicio == 'Mantenimiento'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_mmto_restatools SET foto_salida  = ? WHERE id_cedula = ?",
                        [foto_salida,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                        [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                        function(tx, results){
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipoServicio == 'Desasolve'){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datos_desasolve_restatools SET foto_salida  = ? WHERE id_cedula = ?",
                        [foto_salida,id_cedula],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                        [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                        function(tx, results){
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function eliminarFilaRestatools(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencias_restatools WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function continuarCedRestaTools(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            localStorage.setItem("tipoServicio",'Trampa');
            app.views.main.router.navigate({ name: 'recorridoRestatools1'});
        }else if(tipo == 2){
            localStorage.setItem("tipoServicio",'Extraccion');
            app.views.main.router.navigate({ name: 'recorridoRestatools2'});
        }else if(tipo == 3){
            localStorage.setItem("tipoServicio",'Mantenimiento');
            app.views.main.router.navigate({ name: 'recorridoRestatools3'});
        }else if(tipo == 4){
            localStorage.setItem("tipoServicio",'Desasolve');
            app.views.main.router.navigate({ name: 'recorridoRestatools4'});
        }
    }
    function regresarRecorridoRestatools(){
        var tipoServicio = localStorage.getItem("tipoServicio");
        if(tipoServicio == 'Trampa'){
            app.views.main.router.back('/recorridoRestatools1/', {force: true, ignoreCache: true, reload: true});
        }else if(tipoServicio == 'Extraccion'){
            app.views.main.router.back('/recorridoRestatools2/', {force: true, ignoreCache: true, reload: true});
        }else if(tipoServicio == 'Mantenimiento'){
            app.views.main.router.back('/recorridoRestatools3/', {force: true, ignoreCache: true, reload: true});
        }else if(tipoServicio == 'Desasolve'){
            app.views.main.router.back('/recorridoRestatools4/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function startFromProgramRestatools(id_visita,id_cliente,marca,sucursal,razon_social,estaciones,numero_estaciones,capacidad,ubicacion,category,ubicacion_sucursal){
        localStorage.setItem("id_visita", id_visita);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("marca", marca);
        localStorage.setItem("sucursal", sucursal);
        localStorage.setItem("razon_social", razon_social);
        localStorage.setItem("estaciones", estaciones);
        localStorage.setItem("numero_estaciones", numero_estaciones);
        localStorage.setItem("capacidad", capacidad);
        localStorage.setItem("ubicacion", ubicacion);
        localStorage.setItem("category", category);
        localStorage.setItem("ubicacion_sucursal", ubicacion_sucursal);
        app.views.main.router.navigate({name: 'yallegueRestatools2'});
    }
    function iniciarClienteRestatools(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_visita = localStorage.getItem("id_visita");
        var id_cliente = localStorage.getItem("id_cliente");
        var nombre_cliente = localStorage.getItem("marca");
        var sucursal = localStorage.getItem("sucursal");
        var razon_social = localStorage.getItem("razon_social");

        var estaciones = localStorage.getItem("estaciones");
        var numero_estaciones = localStorage.getItem("numero_estaciones");
        var capacidad = localStorage.getItem("capacidad");
        var ubicacion = localStorage.getItem("ubicacion");
        var ubicacion_sucursal = localStorage.getItem("ubicacion_sucursal");

        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var tipoCedula = localStorage.getItem("category");

        if(tipoCedula == "Trampa"){
            tipoCedula = "Trampa";
        } else if(tipoCedula == "Extraccion"){
            tipoCedula = "Extraccion";
        } else if(tipoCedula == "Mantenimiento"){
            tipoCedula = "Mantenimiento";
        } else if(tipoCedula == "Desasolve"){
            tipoCedula = "Desasolve";
        }
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus,tipoCedula);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                if(tipoCedula == "Trampa"){
                                                    productHandler.addTrampaRestatools(id_cedula,foto_llegada,nombre_cliente,fecha_llegada,sucursal,razon_social,estaciones,numero_estaciones,capacidad,ubicacion,ubicacion_sucursal);
                                                    localStorage.setItem("tipoServicio",tipoCedula);
                                                    app.views.main.router.back('/recorridoRestatools1/', {force: true, ignoreCache: true, reload: true});
                                                } else if(tipoCedula == "Extraccion"){
                                                    productHandler.addExtraccionRestatools(id_cedula,nombre_cliente, sucursal, razon_social, fecha_llegada, foto_llegada,ubicacion_sucursal);
                                                    localStorage.setItem("tipoServicio",tipoCedula);
                                                    app.views.main.router.back('/recorridoRestatools2/', {force: true, ignoreCache: true, reload: true});
                                                } else if(tipoCedula == "Mantenimiento"){
                                                    productHandler.addMmtoRestatools(id_cedula,nombre_cliente, sucursal, razon_social, fecha_llegada, foto_llegada,ubicacion_sucursal);
                                                    localStorage.setItem("tipoServicio",tipoCedula);
                                                    app.views.main.router.back('/recorridoRestatools3/', {force: true, ignoreCache: true, reload: true});
                                                } else if(tipoCedula == "Desasolve"){
                                                    var titulo_reporte = "Desde Portal";
                                                    productHandler.addDesasolveRestatools(id_cedula,titulo_reporte,nombre_cliente, sucursal, razon_social, fecha_llegada, foto_llegada,ubicacion_sucursal);
                                                    localStorage.setItem("tipoServicio",tipoCedula);
                                                    app.views.main.router.back('/recorridoRestatools4/', {force: true, ignoreCache: true, reload: true});
                                                }
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function clienteCerradoResta(){
        if($("#cliente_cerrado").prop("checked")){
            swal({
                title: "Aviso",
                text: "¿Estas seguro de marcar el cliente como cerrado?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    $("#cliente_cerrado").prop("checked",true)
                } else {
                    $("#cliente_cerrado").prop("checked",false)
                }
            });
        }else{
            console.log('no cerrado');
        }
    }
    //Fin Restatools
    //FIled Inicio
    function buscarClienteField(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#cliente-Field").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                app.views.main.router.navigate({name: 'menuField'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function iniciarClienteField(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();

        var nombre_cliente = localStorage.getItem("nombreCliente");
        var tipo = localStorage.getItem("tipoServicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        var estatus = 0;
        if(tipo == "Levantamiento"){
            var tipoCedula = "levantamiento";
        } else if(tipo == "Mantenimiento"){
            var tipoCedula = "mantenimiento";
        }
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "Levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addLevantamientoFieldC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoField1/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addMantenimientoFieldC(id_cedula,foto_llegada,nombre_cliente,orden_servicio);
                                                    app.views.main.router.back('/recorridoField2/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }

                                // app.views.main.router.navigate({name: 'menuField'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarLevantamientoField(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addLevantamientoField(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoField1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMantenimientoField(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "mantenimiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMantenimientoField(id_cedula,foto_llegada,nombre_cliente);
                        app.views.main.router.navigate({name: 'recorridoField2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosLevantamientoField(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosMantenimientoField(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || ($("#servicioC").prop("checked") == false && $("#servicioP").prop("checked") == false)){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        if($("#servicioC").prop("checked") == true){
            var servicio = "1";
        } else if($("#servicioP").prop("checked")){
            var servicio = "2";
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,servicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarMantenimientoField(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var descripcion = $('#descripcion').val();
        var foto = $('#imagenC').val()
        var equipo = $('#imagenC1').val()
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,foto_equipo = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,equipo,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,descripcion,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#descripcion").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_mantenimiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoField(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var motor = $("#tipoMotor").val();
        var boquilla = $("#tipoBoquilla").val();
        var combustible = $("#tipoCombustible").val();
        var mastil = $("#tipoMastil").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,tipo_motor = ?,tipo_boquilla = ?,tipo_combustible = ?,tipo_mastil = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,motor,boquilla,combustible,mastil,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        $("#tipoMotor").css("background-color", "#FFFFFF");
                        $("#tipoBoquilla").css("background-color", "#FFFFFF");
                        $("#tipoCombustible").css("background-color", "#FFFFFF");
                        $("#tipoMastil").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarLevantamientoField(){
        app.preloader.show('blue');
        if($("#comentariosEquipo").val() == "" || $('#lugarReparacion').val() == "0" || ($("#reparadoSi").prop("checked") == false && $("#reparadoNo").prop("checked") == false) || $('#observaciones').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentariosEquipo = $("#comentariosEquipo").val();
        var lugarReparacion = $('#lugarReparacion').val()
        if($("#reparadoSi").prop("checked") == true){
            var reparado = "1";
        } else if($("#reparadoNo").prop("checked")){
            var reparado = "2";
        }
        var observaciones = $('#observaciones').val();
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET comentario_equipo = ?,lugar_reparacion = ?,reparo_visita = ? WHERE id_cedula = ?",
                    [comentariosEquipo,lugarReparacion,reparado,id_cedula],
                    function(tx, results){
                        $("#comentariosEquipo").css("background-color", "#FFFFFF");
                        $("#lugarReparacion").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_levantamiento_Field(id_cedula,observacion,foto_observacion,fecha_regristro) VALUES (?,?,?,?)",
                                    [id_cedula,observaciones,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_levantamiento_Field",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_levantamiento_Field where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#observaciones").val("");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_observacion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCedField(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoField1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoField2'});
        }
    }
    function continuarCedMer(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoMerGroup'});
        }
    }
    function eliminarFilaField(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_levantamiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_Field WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarPiezaField(){
        app.preloader.show('blue');
        if($("#pieza").val() == "" || $('#imagenC1').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#pieza").val();
        var foto = $('#imagenC1').val();
        var fase = "pieza";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#pieza").val("");
                                                        $('#imagenC1').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#pieza").css("background-color", "#FFFFFF");
                                                        $("#tabla_pieza tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr1").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCambioField(){
        app.preloader.show('blue');
        if($("#cambio").val() == "" || $('#imagenC').val() == "" || ($("#piezaChk").prop("checked") == false && $("#cambioChk").prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#cambio").val();
        var foto = $('#imagenC').val();
        if($("#piezaChk").prop("checked") == true){
            var fase = "pieza";
        } else {
            var fase = "cambio";
        }
        // var fase = "cambio";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_Field(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_Field",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_Field where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#cambio").val("");
                                                        $('#imagenC').val("");
                                                        $("#cambioChk").prop("checked", false);
                                                        $("#piezaChk").prop("checked", false);
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#cambio").css("background-color", "#FFFFFF");
                                                        $("#tabla_cambio tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaField("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreLevantamientoField(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoField/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreMantenimientoField(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoymantenimientoField/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamientoField(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_Field SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarMantenimientooField(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_Field SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function singleCheck1(valor){
        if($("#reparadoNo").prop("checked") === true){
            $("#reparadoNo").prop("checked", false);
        }
    }
    function singleCheck2(valor){
        if($("#reparadoSi").prop("checked") === true){
            $("#reparadoSi").prop("checked", false);
        }
    }
    function datosCheck1(valor){
        if($("#servicioP").prop("checked") === true){
            $("#servicioP").prop("checked", false);
        }
    }
    function datosCheck2(valor){
        if($("#servicioC").prop("checked") === true){
            $("#servicioC").prop("checked", false);
        }
    }
    function ingressCheck1(valor){
        if($("#cambioChk").prop("checked") === true){
            $("#cambioChk").prop("checked", false);
        }
    }
    function ingressCheck2(valor){
        if($("#piezaChk").prop("checked") === true){
            $("#piezaChk").prop("checked", false);
        }
    }
    function startFromProgramField(nombre,tipo,orden,descripcion){
        localStorage.setItem("nombreCliente", nombre);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("ordenServicio", orden);
        localStorage.setItem("descripcion", descripcion);
        app.views.main.router.navigate({name: 'yallegueField2'});
    }
    function regresarRecorridoField1(){
        app.views.main.router.back('/recorridoField1/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoField2(){
        app.views.main.router.back('/recorridoField2/', {force: true, ignoreCache: true, reload: true});
    }
    function captureSingleField() {
        navigator.camera.getPicture(onSinglePhotoFieldSucceess, onSinglePhotoFieldFail, {
          quality: 100,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoFieldSucceess(imageData) {
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoFieldFail(message) {
        swal("Error al tomar foto:",message,"error");
    }
    //Field Fin
    //SMC Inicio
    function generarVentaSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let RFC = localStorage.getItem("RFC");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tiposervicio = localStorage.getItem("tiposervicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        let tipoCedula = "ventaSMC";
        var datosEquipo = localStorage.getItem("datosCliente");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){
            },
            function(){
            }
        );
        productHandler.addVentaSMC(id_cedula,foto_llegada,nombre_cliente,RFC,nombrecontacto,telefono,correo,tiposervicio,orden_servicio);
        var equipoData = datosEquipo.split("/+/");
        if(equipoData[0] == "0"){
            var marca = "";
        } else {
            var marca = equipoData[0];
        }
        if(equipoData[1] == "0"){
            var tipo_motor = "";
        } else {
            var tipo_motor = equipoData[1];
        }
        if(equipoData[2] == "0"){
            var marca_motor = "";
        } else {
            var marca_motor = equipoData[2];
        }
        if(equipoData[3] == "0"){
            var modelo = "";
        } else {
            var modelo = equipoData[3];
        }
        if(equipoData[4] == "0"){
            var serie = "";
        } else {
            var serie = equipoData[4];
        }
        if(equipoData[5] == "0"){
            var aditamentos = "";
        } else {
            var aditamentos = equipoData[5];
        }
        productHandler.addEquipoSMC(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
        //app.views.main.router.navigate({name: 'recorridoSMC3'});
        app.views.main.router.back('/recorridoSMC3/', {force: true, ignoreCache: true, reload: true});
    }
    function buscarClienteSMC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = $("#HorarioProgramado").val();
        var foto_llegada = $("#imagenC").val();
        var RFC = $("#RFC").val();
        var NombreContacto = $("#NombreContacto").val();
        var TelefonoContacto = $("#TelefonoContacto").val();
        var CorreoContacto = $("#CorreoContacto").val();
        var TipoServicio = $("#TipoServicio").val();
        var nombre_cliente = $("#cliente-smc").val();
        var order_service = $("#order_service").val();

        if($("#brand").val() == ""){
            var brand = "0";
        } else {
            var brand = $("#brand").val();
        }

        if($("#motor_type").val() == ""){
            var motor_type = "0";
        } else {
            var motor_type = $("#motor_type").val();
        }

        if($("#motor_brand").val() == ""){
            var motor_brand = "0";
        } else {
            var motor_brand = $("#motor_brand").val();
        }

        if($("#motor_model").val() == ""){
            var motor_model = "0";
        } else {
            var motor_model = $("#motor_model").val();
        }

        if($("#serie").val() == ""){
            var serie = "0";
        } else {
            var serie = $("#serie").val();
        }

        if($("#aditaments").val() == ""){
            var aditaments = "0";
        } else {
            var aditaments = $("#aditaments").val();
        }
        var datosCliente = brand +"/+/"+motor_type+"/+/"+motor_brand+"/+/"+motor_model+"/+/"+serie+"/+/"+aditaments;
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("RFC", RFC);
                                localStorage.setItem("nombrecontacto", NombreContacto);
                                localStorage.setItem("telefono", TelefonoContacto);
                                localStorage.setItem("correo", CorreoContacto);
                                localStorage.setItem("tiposervicio", TipoServicio);
                                localStorage.setItem("datosCliente", datosCliente);
                                localStorage.setItem("ordenServicio",order_service);//se agrego
                                app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function iniciarClienteSMC(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("IdCte");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = localStorage.getItem("nombreCliente");
        var tipo = localStorage.getItem("tipoServicio");
        var orden_servicio = localStorage.getItem("ordenServicio");
        var nombre = localStorage.getItem("contact_name");
        var datosCliente = localStorage.getItem("datosCliente");
        var rfc = localStorage.getItem("rfc");
        var telefono = localStorage.getItem("contact_phone");
        var correo = localStorage.getItem("contact_mail");
        var tipo = localStorage.getItem("tipoServicio");
        var marca = localStorage.getItem("brand");
        var tipo_motor = localStorage.getItem("motoy_type");
        var estatus = 0;
        var marca_motor = localStorage.getItem("motor_brand");
        var modelo = localStorage.getItem("brand");
        var serie = localStorage.getItem("serie");
        var aditamentos = localStorage.getItem("aditaments");
        var id_visita = localStorage.getItem("id");
        var motor_model = localStorage.getItem("motor_model");
        var no_contrato = localStorage.getItem("contract_number");
        var no_activo = localStorage.getItem("active_number");
        if(tipo == "Levantamiento"){
            var tipoCedula = "levantamiento";
        } else if(tipo == "Mantenimiento"){
            var tipoCedula = "mantenimiento";
        } else if(tipo == "Ventas"){
            var tipoCedula = "ventaSMC";
        } else if(tipo == "Servicios"){
            var tipoCedula = "servicioSMC";
        }
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                if(tipo == "Levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addLevantamientoSMCC(id_cedula,foto_llegada,nombre_cliente,orden_servicio,nombre,telefono,correo,marca,motor_model,serie,tipo_motor);
                                                    app.views.main.router.back('/recorridoSMC1/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addMantenimientoSMCC(id_cedula,foto_llegada,nombre_cliente,orden_servicio,nombre,telefono,correo,marca,motor_model,serie);
                                                    app.views.main.router.back('/recorridoSMC2/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Ventas"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addVentaSMC(id_cedula,foto_llegada,nombre_cliente,rfc,nombre,telefono,correo,tipo,orden_servicio,id_visita);
                                                    productHandler.addEquipoSMC(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                                                    app.views.main.router.back('/recorridoSMC3/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if(tipo == "Servicios"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                [tipoCedula,id_cedula],
                                                function(tx, results){
                                                    productHandler.addServicioSMC(id_cedula,foto_llegada,nombre_cliente,rfc,nombre,telefono,correo,tipo,orden_servicio,id_visita,no_activo,no_contrato);
                                                    productHandler.addEquipoSMC2(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
                                                    app.views.main.router.back('/recorridoSMC4/', {force: true, ignoreCache: true, reload: true});
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }

                                // app.views.main.router.navigate({name: 'menuSMC'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarLevantamientoSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        var order_service = localStorage.getItem("ordenServicio");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_visita = localStorage.getItem("id_visita");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
        productHandler.addLevantamientoSMC(id_cedula,foto_llegada,nombre_cliente,nombrecontacto,telefono,correo,order_service,id_visita);
        //app.views.main.router.navigate({name: 'recorridoSMC1'});
        app.views.main.router.back('/recorridoSMC1/', {force: true, ignoreCache: true, reload: true});
    }
    function generarMantenimientoSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        var order_service = localStorage.getItem("ordenServicio");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_visita = localStorage.getItem("id_visita");
        let tipoCedula = "mantenimiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
        productHandler.addMantenimientoSMC(id_cedula,foto_llegada,nombre_cliente,nombrecontacto,telefono,correo,order_service,id_visita);
        app.views.main.router.navigate({name: 'recorridoSMC2'});
    }

    function generarServicioSMC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let RFC = localStorage.getItem("RFC");
        let nombrecontacto = localStorage.getItem("nombrecontacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let tiposervicio = localStorage.getItem("tiposervicio");
        let tipoCedula = "servicioSMC";
        var datosEquipo = localStorage.getItem("datosCliente");
        var id_visita = localStorage.getItem("id_visita");
        var order_service = localStorage.getItem("ordenServicio");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){}
        );
        productHandler.addServicioSMC(id_cedula,foto_llegada,nombre_cliente,RFC,nombrecontacto,telefono,correo,tiposervicio,order_service,id_visita);
        var equipoData = datosEquipo.split("/+/");
        if(equipoData[0] == "0"){
            var marca = "";
        } else {
            var marca = equipoData[0];
        }
        if(equipoData[1] == "0"){
            var tipo_motor = "";
        } else {
            var tipo_motor = equipoData[1];
        }
        if(equipoData[2] == "0"){
            var marca_motor = "";
        } else {
            var marca_motor = equipoData[2];
        }
        if(equipoData[3] == "0"){
            var modelo = "";
        } else {
            var modelo = equipoData[3];
        }
        if(equipoData[4] == "0"){
            var serie = "";
        } else {
            var serie = equipoData[4];
        }
        if(equipoData[5] == "0"){
            var aditamentos = "";
        } else {
            var aditamentos = equipoData[5];
        }
        productHandler.addEquipoSMC2(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos);
        // app.views.main.router.navigate({name: 'recorridoSMC4'});
        app.views.main.router.back('/recorridoSMC4/', {force: true, ignoreCache: true, reload: true});
    }
    function guardarDatosLevantamientoSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosGMantenimientoSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || ($("#servicioC").prop("checked") == false && $("#servicioP").prop("checked") == false)){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var contacto = $("#nombreContacto").val();
        var telefono = $("#telefonoContacto").val();
        var correo = $("#correoContacto").val();
        if($("#servicioC").prop("checked") == true){
            var servicio = "1";
        } else if($("#servicioP").prop("checked")){
            var servicio = "2";
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET nombre_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_servicio = ? WHERE id_cedula = ?",
                    [cliente,contacto,telefono,correo,servicio,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosVentaSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#rfc").val() == "" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || $("#tipoVisita").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var rfc = $("#rfc").val();
        var nombreContacto = $("#nombreContacto").val();
        var telefonoContacto = $("#telefonoContacto").val();
        var correoContacto = $("#correoContacto").val();
        var tipoVisita = $("#tipoVisita").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET nombre_cliente = ?,rfc_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_visita = ? WHERE id_cedula = ?",
                    [cliente,rfc,nombreContacto,telefonoContacto,correoContacto,tipoVisita,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#rfc").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        $("#tipoVisita").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosServicioSMC(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#rfc").val() == "" || $("#nombreContacto").val() == "" || $("#telefonoContacto").val() == "" || $("#correoContacto").val() == "" || $("#tipoVisita").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var rfc = $("#rfc").val();
        var nombreContacto = $("#nombreContacto").val();
        var telefonoContacto = $("#telefonoContacto").val();
        var correoContacto = $("#correoContacto").val();
        var tipoVisita = $("#tipoVisita").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET nombre_cliente = ?,rfc_cliente = ?,nombre_contacto = ?,telefono_contacto = ?,correo_contacto = ?,tipo_visita = ? WHERE id_cedula = ?",
                    [cliente,rfc,nombreContacto,telefonoContacto,correoContacto,tipoVisita,id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#rfc").css("background-color", "#FFFFFF");
                        $("#nombreContacto").css("background-color", "#FFFFFF");
                        $("#telefonoContacto").css("background-color", "#FFFFFF");
                        $("#correoContacto").css("background-color", "#FFFFFF");
                        $("#tipoVisita").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarMantenimientoSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var descripcion = $('#descripcion').val();
        var foto = $('#imagenC').val()
        var odometro = $("#odometro").val();
        var equipo = $('#imagenC1').val()
        var fecha = new Date();
        var fase = "antes";
        if (foto && descripcion && orden && marca && modelo && serie && equipo && odometro){
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,foto_equipo = ?, odometro = ? WHERE id_cedula = ?",
                    [orden,marca,modelo,serie,equipo,odometro,id_cedula],
                    function(tx, results){
                        $("#ordenServicio").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        $("#modelo").css("background-color", "#FFFFFF");
                        $("#numeroSerie").css("background-color", "#FFFFFF");
                        $("#odometro").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                                    [id_cedula,fase,descripcion,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#descripcion").val("");
                                                                        $("#descripcion").css("background-color", "#FFFFFF");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_mantenimiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
        }else{
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
        }
    }
    function guardarVentasAntesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(foto == "" || comentarios == ""){
            swal("","La foto y/o el comentario son obligatorios","warning");
            app.preloader.hide();
        } else {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencia_venta_smc(id_cedula,fase,foto,comentario,fecha_regristro) VALUES (?,?,?,?,?)",
                        [id_cedula,fase,foto,comentarios,fecha_registro],
                        function(tx, results){
                            app.preloader.hide();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_venta_smc",
                                        [],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            var id_evidencia = item.Id;
                                            app.preloader.hide();
                                            //Consultar el producto
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select * from evidencia_venta_smc where id_evidencia = ?",
                                                    [id_evidencia],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            $("#smallImage").attr("src","img/blank.png");
                                                            $('#imagenC').val("");
                                                            $('#comentarios').val("");
                                                            $("#comentarios").css("background-color", "#FFFFFF");
                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px'/></td><td style='text-align: center;'>" + item.comentario + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al guardar cedula: " + error.message);
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            swal("","Registro guardado","success");
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar plaga",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarServicioAntesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "antes";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(foto == "" || comentarios == ""){
            swal("","La foto y/o el comentario son obligatorios","warning");
            app.preloader.hide();
        } else {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencia_servicio_smc(id_cedula,fase,foto,comentario,fecha_regristro) VALUES (?,?,?,?,?)",
                        [id_cedula,fase,foto,comentarios,fecha_registro],
                        function(tx, results){
                            app.preloader.hide();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_servicio_smc",
                                        [],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            var id_evidencia = item.Id;
                                            app.preloader.hide();
                                            //Consultar el producto
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select * from evidencia_servicio_smc where id_evidencia = ?",
                                                    [id_evidencia],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            $("#smallImage").attr("src","img/blank.png");
                                                            $('#imagenC').val("");
                                                            $('#comentarios').val("");
                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px'/></td><td style='text-align: center;'>" + item.comentario + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al guardar cedula: " + error.message);
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            swal("","Registro guardado","success");
                            $('#comentarios').css("background-color", "#FFFFFF")
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar plaga",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarVentasDespuesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "despues";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET comentario_despues = ? WHERE id_cedula = ?",
                    [comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                if(foto){
                                    tx.executeSql("INSERT INTO evidencia_venta_smc(id_cedula,fase,foto,fecha_regristro) VALUES (?,?,?,?)",
                                        [id_cedula,fase,foto,fecha_registro],
                                        function(tx, results){
                                            app.preloader.hide();
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_venta_smc",
                                                        [],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            var id_evidencia = item.Id;
                                                            app.preloader.hide();
                                                            //Consultar el producto
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("Select * from evidencia_venta_smc where id_evidencia = ?",
                                                                    [id_evidencia],
                                                                        function(tx, results){
                                                                            var item = results.rows.item(0);
                                                                            $("#smallImage").attr("src","img/blank.png");
                                                                            $('#imagenC').val("");
                                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                            $("#message-nr").css("display", "none");
                                                                            $('.preloader').remove();
                                                                            $('.infinite-scroll-preloader').remove();
                                                                            app.preloader.hide();
                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                            swal("","Registro guardado","success");
                                            app.preloader.hide();
                                        },
                                        function(tx, error){
                                            swal("Error al guardar plaga",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                } else {
                                    if(comentarios){
                                        swal("","Comentario general Actualizado","success");
                                        app.preloader.hide();
                                    } else {
                                        swal("","No hay datos para guardar, ingresa una foto o un comentario.","warning");
                                        app.preloader.hide();
                                    }

                                }
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarServicioDespuesSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var comentarios = $('#comentarios').val();
        var fecha = new Date();
        var fase = "despues";
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(foto == "" || comentarios == ""){
            swal("","La foto y/o el comentario son obligatorios","warning");
            app.preloader.hide();
        } else {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencia_servicio_smc(id_cedula,fase,foto,comentario,fecha_regristro) VALUES (?,?,?,?,?)",
                        [id_cedula,fase,foto,comentarios,fecha_registro],
                        function(tx, results){
                            app.preloader.hide();
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_servicio_smc",
                                        [],
                                        function(tx, results){
                                            var item = results.rows.item(0);
                                            var id_evidencia = item.Id;
                                            app.preloader.hide();
                                            //Consultar el producto
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("Select * from evidencia_servicio_smc where id_evidencia = ?",
                                                    [id_evidencia],
                                                        function(tx, results){
                                                            var item = results.rows.item(0);
                                                            $("#smallImage").attr("src","img/blank.png");
                                                            $('#imagenC').val("");
                                                            $('#comentarios').val("");
                                                            $("#comentarios").css("background-color", "#FFFFFF");
                                                            $("#photoIcon").attr("src","img/camera.svg");
                                                            $("#tabla_ventas tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px'/></td><td style='text-align: center;'>" + item.comentario + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                            app.preloader.hide();
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al guardar cedula: " + error.message);
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al mostrar Registro guardado",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            swal("","Registro guardado","success");
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar plaga",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarEquipoSMC(){
        app.preloader.show('blue');
        var id_cedula = localStorage.getItem("IdCedula");
        var orden = $("#ordenServicio").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var serie = $("#numeroSerie").val();
        var motor = $("#tipoMotor").val();
        var boquilla = $("#tipoBoquilla").val();
        var combustible = $("#tipoCombustible").val();
        var odometro = $('#odometro').val();
        var mastil = $("#tipoMastil").val();
        if (orden && marca && modelo && serie && motor && boquilla && combustible && mastil && odometro){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE levantamiento_smc SET orden_servicio = ?,marca = ?,modelo = ?,numero_serie = ?,tipo_motor = ?,tipo_boquilla = ?,tipo_combustible = ?,tipo_mastil = ?, odometro = ? WHERE id_cedula = ?",
                        [orden,marca,modelo,serie,motor,boquilla,combustible,mastil,odometro,id_cedula],
                        function(tx, results){
                            $("#ordenServicio").css("background-color", "#FFFFFF");
                            $("#marca").css("background-color", "#FFFFFF");
                            $("#modelo").css("background-color", "#FFFFFF");
                            $("#numeroSerie").css("background-color", "#FFFFFF");
                            $("#tipoMotor").css("background-color", "#FFFFFF");
                            $("#tipoBoquilla").css("background-color", "#FFFFFF");
                            $("#tipoCombustible").css("background-color", "#FFFFFF");
                            $("#tipoMastil").css("background-color", "#FFFFFF");
                            $("#odometro").css("background-color", "#FFFFFF");
                            swal("", "Se guardaron los datos correctamente" ,"success");
                            app.preloader.hide();
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Favor de llenar todos los campos.","warning");
            app.preloader.hide();
        }
    }
    function guardarLevantamientoSMC(){
        app.preloader.show('blue');
        if($("#comentariosEquipo").val() == "" || $('#lugarReparacion').val() == "0" || ($("#reparadoSi").prop("checked") == false && $("#reparadoNo").prop("checked") == false) || $('#observaciones').val() == "" || $('#imagenC').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentariosEquipo = $("#comentariosEquipo").val();
        var lugarReparacion = $('#lugarReparacion').val()
        if($("#reparadoSi").prop("checked") == true){
            var reparado = "1";
        } else if($("#reparadoNo").prop("checked")){
            var reparado = "2";
        }
        var observaciones = $('#observaciones').val();
        var foto = $('#imagenC').val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET comentario_equipo = ?,lugar_reparacion = ?,reparo_visita = ? WHERE id_cedula = ?",
                    [comentariosEquipo,lugarReparacion,reparado,id_cedula],
                    function(tx, results){
                        $("#comentariosEquipo").css("background-color", "#FFFFFF");
                        $("#lugarReparacion").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO evidencia_levantamiento_smc(id_cedula,observacion,foto_observacion,fecha_regristro) VALUES (?,?,?,?)",
                                    [id_cedula,observaciones,foto,fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_levantamiento_smc",
                                                    [],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        var id_evidencia = item.Id;
                                                        app.preloader.hide();
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from evidencia_levantamiento_smc where id_evidencia = ?",
                                                                [id_evidencia],
                                                                    function(tx, results){
                                                                        var item = results.rows.item(0);
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#observaciones").val("");
                                                                        $("#observaciones").css("background-color", "#FFFFFF");
                                                                        $('#imagenC').val("");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_observacion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                                        $("#message-nr").css("display", "none");
                                                                        $('.preloader').remove();
                                                                        $('.infinite-scroll-preloader').remove();
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        swal("","Registro guardado","success");
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        swal("Error al guardar plaga",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarProspeccionSMC(){
        app.preloader.show('blue');
        if($("#objetivo").val() == "" ||
            $("#necesidad").val() == "" ||
            $("#marca").val() == "" ||
            $("#numeroActivo").val() == ""||
            $("#marcall").val()== "" ||
            $("#llantas").val()== "" ||
            $("#medidas").val()== "" ||
            $("#porque").val()== "" ||
            $("#competencia").val()== "" ||
            $("#sugerencia").val()== "" ||
            $("#comentarios").val()== ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var objetivo = $("#objetivo").val();
        var necesidad = $("#necesidad").val();
        var marca = $("#marca").val();
        var numero = $("#numeroActivo").val();
        var pregunta1 = $('input:radio[name=pregunta1]:checked').val();
        var cuandoc = $("#demo-calendar-modal").val();
        var marcall = $("#marcall").val();
        var llantas = $("#llantas").val();
        var medidas = $("#medidas").val();
        var pregunta2 = $('input:radio[name=pregunta2]:checked').val();
        var porque = $("#porque").val();
        var pregunta3 = $('input:radio[name=pregunta3]:checked').val();
        var cuando = $("#demo-calendar-modal1").val();
        var pregunta4 = $('input:radio[name=pregunta4]:checked').val();
        var cuales = $("#cuales").val();
        var competencia = $("#competencia").val();
        var sugerencia = $("#sugerencia").val();
        var comentarios = $("#comentarios").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET objetivo_prospeccion = ?,necesidad_prospeccion = ?,marca_montacargas_prospeccion = ?,numero_montacargas_prospeccion = ?,status_montacarga_prospeccion = ?,venc_contrato = ?,marca_llantas_prospeccion = ?,tipo_llantas_prospeccion = ?,mediadas_prospeccion = ?,resolvio_prospeccion = ?,por_que_prospeccion = ?,vista_prospeccion = ?,cuando_prospeccion =?, presente_prospeccion = ?,cuales_prospeccion = ?,copetencia_prospeccion = ?,sugerencia_prospeccion = ?,comentarios_prospeccion = ? WHERE id_cedula = ?",
                    [objetivo,necesidad,marca,numero,pregunta1,cuandoc,marcall,llantas,medidas,pregunta2,porque,pregunta3,cuando,pregunta4,cuales,competencia,sugerencia,comentarios,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                $("#objetivo").css("background-color", "#FFFFFF");
                                $("#necesidad").css("background-color", "#FFFFFF");
                                $("#marca").css("background-color", "#FFFFFF");
                                $("#numeroActivo").css("background-color", "#FFFFFF");
                                $("#marcall").css("background-color", "#FFFFFF");
                                $("#llantas").css("background-color", "#FFFFFF");
                                $("#medidas").css("background-color", "#FFFFFF");
                                $("#porque").css("background-color", "#FFFFFF");
                                $("#competencia").css("background-color", "#FFFFFF");
                                $("#sugerencia").css("background-color", "#FFFFFF");
                                $("#comentarios").css("background-color", "#FFFFFF");
                                $("#demo-calendar-modal1").css("background-color", "#FFFFFF");
                                $("#cuales").css("background-color", "#FFFFFF");
                                $("#demo-calendar-modal").css("background-color", "#FFFFFF");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosMantenimientoSMC(){
        app.preloader.show('blue');
        if($("#observaciones").val() == "" || $('#estadoGeneral').val() == "0" || $('#numeroMontacargas').val() == "0" || ($("#tipo1").prop("checked") == false && $("#tipo0").prop("checked") == false) || $('#marca').val() == "" || $('#requiereMantenimiento').val() == "0"){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var observaciones = $("#observaciones").val();
        var estadoGeneral = $('#estadoGeneral').val();
        var numeroMontacargas = $('#numeroMontacargas').val();
        if($("#tipo1").prop("checked") == true){
            var tipo = "1";
        } else if($("#tipo0").prop("checked")){
            var tipo = "0";
        }
        var marca = $('#marca').val();
        var requiereMantenimiento = $('#requiereMantenimiento').val()
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET observaciones_prospeccion = ?,estado_monta = ?,numero_monta = ?,tipo_monta = ?,marca = ?,mantenimiento = ? WHERE id_cedula = ?",
                    [observaciones,estadoGeneral,numeroMontacargas,tipo,marca,requiereMantenimiento,id_cedula],
                    function(tx, results){
                        $("#observaciones").css("background-color", "#FFFFFF");
                        $("#estadoGeneral").css("background-color", "#FFFFFF");
                        $("#numeroMontacargas").css("background-color", "#FFFFFF");
                        $("#marca").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarValoresVentaSMC(){
        app.preloader.show('blue');
        if($("#numeroActivo").val() == "" || $('#numeroContrato').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var numeroActivo = $("#numeroActivo").val();
        var numeroContrato = $('#numeroContrato').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET no_activo = ?,no_contrato = ? WHERE id_cedula = ?",
                    [numeroActivo,numeroContrato,id_cedula],
                    function(tx, results){
                        $("#numeroActivo").css("background-color", "#FFFFFF");
                        $("#numeroContrato").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarValoresServicioSMC(){
        app.preloader.show('blue');
        if($("#numeroActivo").val() == "" || $('#numeroContrato').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var numeroActivo = $("#numeroActivo").val();
        var numeroContrato = $('#numeroContrato').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET no_activo = ?,no_contrato = ? WHERE id_cedula = ?",
                    [numeroActivo,numeroContrato,id_cedula],
                    function(tx, results){
                        $("#numeroActivo").css("background-color", "#FFFFFF");
                        $("#numeroContrato").css("background-color", "#FFFFFF");
                        databaseHandler.db.transaction(
                            function(tx){
                                swal("","Registro guardado","success");
                                app.preloader.hide();
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEquipoVentaSMC(){
        app.preloader.show('blue');
        if($("#marca").val() == "" || $('#tipoMotor').val() == "" || $('#marcaMotor').val() == "" || $('#modelo').val() == "" || $('#serie').val() == "" || $('#aditamentos').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var marca = $("#marca").val();
        var tipoMotor = $('#tipoMotor').val();
        var marcaMotor = $('#marcaMotor').val();
        var modelo = $('#modelo').val();
        var serie = $('#serie').val();
        var aditamentos = $('#aditamentos').val();

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO datos_equipo_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
                    [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_equipo) as Id from datos_equipo_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_equipo = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from datos_equipo_smc where id_equipo = ?",
                                                [id_equipo],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#marca").css("background-color", "#FFFFFF");
                                                        $("#tipoMotor").css("background-color", "#FFFFFF");
                                                        $("#marcaMotor").css("background-color", "#FFFFFF");
                                                        $("#modelo").css("background-color", "#FFFFFF");
                                                        $("#serie").css("background-color", "#FFFFFF");
                                                        $("#aditamentos").css("background-color", "#FFFFFF");

                                                        $("#marca").val("");
                                                        $("#tipoMotor").val("");
                                                        $("#marcaMotor").val("");
                                                        $("#modelo").val("");
                                                        $("#serie").val("");
                                                        $("#aditamentos").val("");
                                                        $("#tabla_equipos tbody").append("<tr id='fila"+ item.id_equipo +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_equipo +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + unescape(item.marca) + "</td><td style='text-align: center;'>" + unescape(item.tipo_motor) + "</td><td style='text-align: center;'>" + unescape(item.marca_motor) + "</td><td style='text-align: center;'>" + unescape(item.modelo) + "</td><td style='text-align: center;'>" + unescape(item.serie) + "</td><td style='text-align: center;'>" + unescape(item.aditamentos) + "</td></tr>");

                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
        // databaseHandler.db.transaction(
        //     function(tx1){
        //         tx1.executeSql(
        //             "Select id_cedula from datos_equipo_smc where id_cedula= ?",
        //             [id_cedula],
        //             function(tx, results){
        //                 var item = results.rows.item(0);
        //                 if(item){
        //                     databaseHandler.db.transaction(
        //                         function(tx){
        //                             tx.executeSql("UPDATE datos_equipo_smc SET marca = ?,tipo_motor = ?,marca_motor = ?,modelo = ?,serie = ?,aditamentos = ? WHERE id_cedula = ?",
        //                                 [marca,tipoMotor,marcaMotor,modelo,serie,aditamentos,id_cedula],
        //                                 function(tx, results){
        //                                     $("#marca").css("background-color", "#FFFFFF");
        //                                     $("#tipoMotor").css("background-color", "#FFFFFF");
        //                                     $("#marcaMotor").css("background-color", "#FFFFFF");
        //                                     $("#modelo").css("background-color", "#FFFFFF");
        //                                     $("#serie").css("background-color", "#FFFFFF");
        //                                     $("#aditamentos").css("background-color", "#FFFFFF");
        //                                     databaseHandler.db.transaction(
        //                                         function(tx){
        //                                             swal("","Registro actualizado","success");
        //                                             app.preloader.hide();
        //                                         },
        //                                         function(error){},
        //                                         function(){}
        //                                     );
        //                                 },
        //                                 function(tx, error){
        //                                     swal("Error al guardar",error.message,"error");
        //                                     app.preloader.hide();
        //                                 }
        //                             );
        //                         },
        //                         function(error){},
        //                         function(){}
        //                     );
        //                 } else {
        //                     databaseHandler.db.transaction(
        //                         function(tx){
        //                             tx.executeSql("INSERT INTO datos_equipo_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos) VALUES (?,?,?,?,?,?,?)",
        //                                 [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos],
        //                                 function(tx, results){
        //                                     $("#marca").css("background-color", "#FFFFFF");
        //                                     $("#tipoMotor").css("background-color", "#FFFFFF");
        //                                     $("#marcaMotor").css("background-color", "#FFFFFF");
        //                                     $("#modelo").css("background-color", "#FFFFFF");
        //                                     $("#serie").css("background-color", "#FFFFFF");
        //                                     $("#aditamentos").css("background-color", "#FFFFFF");
        //                                     databaseHandler.db.transaction(
        //                                         function(tx){
        //                                             swal("","Registro guardado","success");
        //                                             app.preloader.hide();
        //                                         },
        //                                         function(error){},
        //                                         function(){}
        //                                     );
        //                                 },
        //                                 function(tx, error){
        //                                     swal("Error al guardar",error.message,"error");
        //                                     app.preloader.hide();
        //                                 }
        //                             );
        //                         },
        //                         function(error){},
        //                         function(){}
        //                     );
        //                 }
        //             },
        //             function(tx, error){
        //                 console.log("Error al consultar: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    function guardarEquipoServicioSMC(){
        app.preloader.show('blue');
        if($("#marca").val() == "" || $('#tipoMotor').val() == "" || $('#marcaMotor').val() == "" || $('#modelo').val() == "" || $('#serie').val() == "" || $('#aditamentos').val() == "" || $('#odometro').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var marca = $("#marca").val();
        var tipoMotor = $('#tipoMotor').val();
        var marcaMotor = $('#marcaMotor').val();
        var modelo = $('#modelo').val();
        var serie = $('#serie').val();
        var aditamentos = $('#aditamentos').val();
        var odometro = $('#odometro').val();
        databaseHandler.db.transaction(
            function(tx1){
                tx1.executeSql(
                    "Select id_cedula from datos_servicio_smc where id_cedula= ?",
                    [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(item){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE datos_servicio_smc SET marca = ?,tipo_motor = ?,marca_motor = ?,modelo = ?,serie = ?,aditamentos = ?, odometro = ? WHERE id_cedula = ?",
                                        [marca,tipoMotor,marcaMotor,modelo,serie,aditamentos,odometro,id_cedula],
                                        function(tx, results){
                                            $("#marca").css("background-color", "#FFFFFF");
                                            $("#tipoMotor").css("background-color", "#FFFFFF");
                                            $("#marcaMotor").css("background-color", "#FFFFFF");
                                            $("#modelo").css("background-color", "#FFFFFF");
                                            $("#serie").css("background-color", "#FFFFFF");
                                            $("#aditamentos").css("background-color", "#FFFFFF");
                                            $("#odometro").css("background-color", "#FFFFFF");
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    swal("","Registro actualizado","success");
                                                    app.preloader.hide();
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO datos_servicio_smc(id_cedula,marca,tipo_motor,marca_motor,modelo,serie,aditamentos,odometro) VALUES (?,?,?,?,?,?,?,?)",
                                        [id_cedula,marca,tipoMotor,marcaMotor,modelo,serie,aditamentos, odometro],
                                        function(tx, results){
                                            $("#marca").css("background-color", "#FFFFFF");
                                            $("#tipoMotor").css("background-color", "#FFFFFF");
                                            $("#marcaMotor").css("background-color", "#FFFFFF");
                                            $("#modelo").css("background-color", "#FFFFFF");
                                            $("#serie").css("background-color", "#FFFFFF");
                                            $("#aditamentos").css("background-color", "#FFFFFF");
                                            $("#odometro").css("background-color", "#FFFFFF");
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    swal("","Registro guardado","success");
                                                    app.preloader.hide();
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al consultar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }function buscadorSMC(clave){
        var id_usuario = localStorage.getItem("id_usuario");
        var estatus = 0;
        if(clave==1){
            app.dialog.prompt("Ingresa la Orden de Servicio que deseas Continuar", 'FIELD',function (name) {
                databaseHandler.db.transaction(
                    function(tx5){
                        tx5.executeSql("SELECT * FROM levantamiento_smc WHERE orden_servicio = ?",
                            [name],
                            function(tx5, results){
                                var length = results.rows.length;
                                if(length==0){
                                    databaseHandler.db.transaction(
                                        function(tx4){
                                            tx4.executeSql("SELECT * FROM mantenimiento_smc WHERE orden_servicio = ?",
                                                [name],
                                                function(tx4, results){
                                                    var length = results.rows.length;
                                                    if(length==0){
                                                        databaseHandler.db.transaction(
                                                            function(tx3){
                                                                tx3.executeSql("SELECT * FROM ventaSMC WHERE orden_servicio = ?",
                                                                    [name],
                                                                    function(tx3, results){
                                                                        var length = results.rows.length;
                                                                        if(length==0){
                                                                            databaseHandler.db.transaction(
                                                                                function(tx2){
                                                                                    tx2.executeSql("SELECT * FROM servicioSMC WHERE orden_servicio = ?",
                                                                                        [name],
                                                                                        function(tx2, results){
                                                                                            var length = results.rows.length;
                                                                                            if(length==0){
                                                                                                swal("","No se encontraron resultados con esa Orden de Servicio.","warning");
                                                                                            }else{
                                                                                                var item = results.rows.item(0);
                                                                                                continuarCedSMC(item.id_cedula,4);
                                                                                            }
                                                                                        },
                                                                                        function(tx2, error){
                                                                                            console.error("Error al consultar bandeja de salida: " + error.message);
                                                                                        }
                                                                                    );
                                                                                },
                                                                            function(error){},
                                                                            function(){}
                                                                            );
                                                                        }else{
                                                                            var item = results.rows.item(0);
                                                                            continuarCedSMC(item.id_cedula,3);
                                                                        }
                                                                    },
                                                                    function(tx3, error){
                                                                        console.error("Error al consultar bandeja de salida: " + error.message);
                                                                    }
                                                                );
                                                            },
                                                        function(error){},
                                                        function(){}
                                                        );
                                                    }else{
                                                        var item = results.rows.item(0);
                                                        continuarCedSMC(item.id_cedula,2);
                                                    }
                                                },
                                                function(tx4, error){
                                                    console.error("Error al consultar bandeja de salida: " + error.message);
                                                }
                                            );
                                        },
                                    function(error){},
                                    function(){}
                                    );
                                }else{
                                    var item = results.rows.item(0);
                                    continuarCedSMC(item.id_cedula,1);
                                }
                            },
                            function(tx5, error){
                                console.error("Error al consultar bandeja de salida: " + error.message);
                            }
                        );
                    },
                function(error){},
                function(){}
                );
            });
        }else if (clave == 2){
            app.dialog.prompt("Ingresa la Orden de Servicio que deseas buscar", 'FIELD',function (name) {
                $.ajax({
                    type: "POST",
                    async : true,
                    url: "http://www.appbennetts.com/FWM2/app/consultaOrdenSMC.php",
                    dataType: 'html',
                    data: {'os':name, 'funcion':1},
                    success: function(respuesta){
                        if(respuesta == "0._.0._.0._.0"){
                            swal("","No se encontraron resultados con esa Orden de Servicio.","warning");
                        }else{
                            var respu1 = respuesta.split("._.");
                            var dat = respu1[0];
                            var dat1 = respu1[1];
                            var dat2 = respu1[2];
                            var dat3 = respu1[3];
                            if (dat > 0){
                                localStorage.setItem("IdBennetts", dat);
                                localStorage.setItem("TipoCedula", "levantamiento");
                                app.views.main.router.navigate({name: "visualizar",});
                            }else if (dat1 > 0){
                                localStorage.setItem("IdBennetts", dat1);
                                localStorage.setItem("TipoCedula", "mantenimiento");
                                app.views.main.router.navigate({name: "visualizar",});
                            }else if (dat2 > 0){
                                localStorage.setItem("IdBennetts", dat2);
                                localStorage.setItem("TipoCedula", "servicioSMC");
                                app.views.main.router.navigate({name: "visualizar",});
                            }else if (dat3 > 0){
                                localStorage.setItem("IdBennetts", dat3);
                                localStorage.setItem("TipoCedula", "ventaSMC");
                                app.views.main.router.navigate({name: "visualizar",});
                            }
                        }
                    },
                    error: function(){
                        console.log("Error en la comunicacion");
                    }
                });
            });
        }else if (clave == 3){
            var currentFecha1 = new Date();
            var monthR1 = currentFecha1.getMonth() + 1;
            var yearR1 = currentFecha1.getFullYear();
            var date = new Date();
            var primerDia = new Date(date.getFullYear(), date.getMonth(), 1);
            var ultimoDia = new Date(date.getFullYear(), date.getMonth() + 1, 0);
            var diauno = primerDia.getDate();
            var diaultimo = ultimoDia.getDate()

            app.dialog.prompt("Ingresa la Orden de Servicio que deseas buscar", 'FIELD',function (name) {
                $.ajax({
                    type: "POST",
                    async : true,
                    url: "http://www.appbennetts.com/FWM2/app/consultaOrdenSMC.php?IdUsuario="+id_usuario+"&id_empresa=3&day="+diauno+"&month="+monthR1+"&year="+yearR1+"&day2="+diaultimo+"&month2="+monthR1+"&year2="+yearR1+"",
                    dataType: 'html',
                    data: {'os':name, 'funcion':2},
                    success: function(respuesta){
                        if(respuesta == "0"){
                            swal("","No se encontraron resultados con esa Orden de Servicio.","warning");
                        }else{
                            var content = JSON.parse(respuesta);
                            clientSelected2(content[0].nombreCliente,content[0].fecha);
                        }
                    },
                    error: function(){
                        console.log("Error en la comunicacion");
                    }
                });
            });
        }
    }
    function continuarCedSMC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            databaseHandler.db.transaction(
                function(tx2){
                    tx2.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx2, results){
                            var length = results.rows.length;
                            if(length==0){
                                swal("","No se encontraron resultados con esa Orden de Servicio.","warning");
                            }else{
                                var item = results.rows.item(0);
                                var estado = item.estatus;
                                if(estado != 0){
                                    swal("","Esta Orden de Servicio ya fue enviada o esta en proceso de envío.","warning");
                                }else{
                                    app.views.main.router.navigate({ name: 'recorridoSMC1'});
                                }
                            }
                        },
                        function(tx2, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else if(tipo == 2){
            databaseHandler.db.transaction(
                function(tx2){
                    tx2.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx2, results){
                            var length = results.rows.length;
                            if(length==0){
                                swal("","No se encontraron resultados con esa Orden de Servicio.","warning");
                            }else{
                                var item = results.rows.item(0);
                                var estado = item.estatus;
                                if(estado != 0){
                                    swal("","Esta Orden de Servicio ya fue enviada o en proceso de envío.","warning");
                                }else{
                                    app.views.main.router.navigate({ name: 'recorridoSMC2'});
                                }
                            }
                        },
                        function(tx2, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else if(tipo == 3){
            databaseHandler.db.transaction(
                function(tx2){
                    tx2.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx2, results){
                            var length = results.rows.length;
                            if(length==0){
                                swal("","No se encontraron resultados con esa Orden de Servicio.","warning");
                            }else{
                                var item = results.rows.item(0);
                                var estado = item.estatus;
                                if(estado != 0){
                                    swal("","Esta Orden de Servicio ya fue enviada o en proceso de envío.","warning");
                                }else{
                                    app.views.main.router.navigate({ name: 'recorridoSMC3'});
                                }
                            }
                        },
                        function(tx2, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else if(tipo == 4){
            databaseHandler.db.transaction(
                function(tx2){
                    tx2.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx2, results){
                            var length = results.rows.length;
                            if(length==0){
                                swal("","No se encontraron resultados con esa Orden de Servicio.","warning");
                            }else{
                                var item = results.rows.item(0);
                                var estado = item.estatus;
                                if(estado != 0){
                                    swal("","Esta Orden de Servicio ya fue enviada o en proceso de envío.","warning");
                                }else{
                                    app.views.main.router.navigate({ name: 'recorridoSMC4'});
                                }
                            }
                        },
                        function(tx2, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        }
    }
    function eliminarFilaSMC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_levantamiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_mantenimiento_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_venta_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia_servicio_smc WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM datos_equipo_smc WHERE id_equipo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarPiezaSMC(){
        app.preloader.show('blue');
        if($("#pieza").val() == "" || $('#imagenC1').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#pieza").val();
        var foto = $('#imagenC1').val();
        var fase = "pieza";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage1").attr("src","img/blank.png");
                                                        $("#pieza").val("");
                                                        $('#imagenC1').val("");
                                                        $("#photoIcon1").attr("src","img/camera.svg");
                                                        $("#pieza").css("background-color", "#FFFFFF");
                                                        $("#tabla_pieza tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr1").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCambioSMC(){
        app.preloader.show('blue');
        if($("#cambio").val() == "" || $('#imagenC').val() == "" || ($("#piezaChk").prop("checked") == false && $("#cambioChk").prop("checked") == false)){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var pieza = $("#cambio").val();
        var foto = $('#imagenC').val();
        if($("#piezaChk").prop("checked") == true){
            var fase = "pieza";
        } else {
            var fase = "cambio";
        }
        // var fase = "cambio";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO evidencia_mantenimiento_smc(id_cedula,fase,descripcion,foto_decripcion,fecha_regristro) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,pieza,foto,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_evidencia) as Id from evidencia_mantenimiento_smc",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from evidencia_mantenimiento_smc where id_evidencia = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#cambio").val("");
                                                        $('#imagenC').val("");
                                                        $("#cambioChk").prop("checked", false);
                                                        $("#piezaChk").prop("checked", false);
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#cambio").css("background-color", "#FFFFFF");
                                                        $("#tabla_cambio tbody").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaSMC("+ item.id_evidencia +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_decripcion+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.descripcion) + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar la pieza guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Pieza guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreLevantamientoSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoSMC/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreMantenimientoSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoymantenimientoSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreServicioSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <=  '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyservicioSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreVentaSMC(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <=  '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyventaSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamientoSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_smc SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarMantenimientooSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE mantenimiento_smc SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarVentaSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarServicioSMC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function singleCheck1(valor){
        if($("#reparadoNo").prop("checked") === true){
            $("#reparadoNo").prop("checked", false);
        }
    }
    function singleCheck2(valor){
        if($("#reparadoSi").prop("checked") === true){
            $("#reparadoSi").prop("checked", false);
        }
    }
    function datosCheck1(valor){
        if($("#servicioP").prop("checked") === true){
            $("#servicioP").prop("checked", false);
        }
    }
    function datosCheck2(valor){
        if($("#servicioC").prop("checked") === true){
            $("#servicioC").prop("checked", false);
        }
    }
    function ingressCheck1(valor){
        if($("#cambioChk").prop("checked") === true){
            $("#cambioChk").prop("checked", false);
        }
    }
    function ingressCheck2(valor){
        if($("#piezaChk").prop("checked") === true){
            $("#piezaChk").prop("checked", false);
        }
    }
    function startFromProgram(nombre,tipo,orden,descripcion,id_cliente,client_rfc,contact_name,contact_phone,contact_mail,type_Service,brand,motoy_type,motor_brand,motor_model,serie,aditaments,id,contract_number,active_number){
        localStorage.setItem("nombreCliente", nombre);
        localStorage.setItem("tipoServicio", tipo);
        localStorage.setItem("ordenServicio", orden);
        localStorage.setItem("descripcion", descripcion);
        localStorage.setItem("IdCte", id_cliente);
        localStorage.setItem("rfc", client_rfc);
        localStorage.setItem("contact_name", contact_name);
        localStorage.setItem("contact_phone", contact_phone);
        localStorage.setItem("contact_mail", contact_mail);
        localStorage.setItem("type_Service", type_Service);
        localStorage.setItem("brand", brand);
        localStorage.setItem("motoy_type", motoy_type);
        localStorage.setItem("motor_brand", motor_brand);
        localStorage.setItem("motor_model", motor_model);
        localStorage.setItem("serie", serie);
        localStorage.setItem("aditaments", aditaments);
        localStorage.setItem("id", id);
        localStorage.setItem("contract_number", contract_number);
        localStorage.setItem("active_number", active_number);
        app.views.main.router.navigate({name: 'yallegueSMC2'});
    }
    function sonRentados(){
        if($('input:radio[name=pregunta1]:checked').val() == 0){
            $("#contrato").css("display","block")
        } else {
            $("#contrato").css("display","none")
        }
    }
    function siguienteVisita(){
        if($('input:radio[name=pregunta3]:checked').val()== 1){
            $("#siguienteVisita").css("display","block")
        } else {
            $("#siguienteVisita").css("display","none")
        }
    }
    function dejaPresente(){
        if($('input:radio[name=pregunta4]:checked').val()== 1){
            $("#presente").css("display","block")
        } else {
            $("#presente").css("display","none")
        }
    }
    function mayusculas(e) {
        e.value = e.value.toUpperCase();
    }
    function guardarConclusion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var conclusion = $('#conclusion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventaSMC SET conclusion_servicio = ? WHERE id_cedula = ?",
                    [conclusion,id_cedula],
                    function(tx, results){
                        swal("","Conclusion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarConclusion2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var conclusion = $('#conclusion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE servicioSMC SET conclusion_servicio = ? WHERE id_cedula = ?",
                    [conclusion,id_cedula],
                    function(tx, results){
                        swal("","Conclusion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //SMC Fin
    // AyB Inicio
    function buscarCliente(){
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $('#id_cliente').val();
        var nombre_cliente = $("#nombre_cliente").val();
        var hora_programada = $("#horario_programado").val();
        var foto_llegada = $("#imagenC").val();
        var sucursal = $("#sucursal").val();
        var direccion = $("#direccion").val();
        var personaRecibe = $("#persona_recibe").val();
        var documentoIngresar = $("#documento_ingresar").val();
        var codigoPostal = $("#codigo_postal").val();
        var alcance = $("#alcance").val();
        var estatus = 0;
        // var correo = $("#correo").val(); //----
        if(localStorage.getItem("IdCedula"))
        {
            app.preloader.hide();
            var cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [cedula],
                        function(tx5, results){
                            var item = results.rows.item(0);
                            if(nombre_cliente != item.nombre_cliente || foto_llegada != localStorage.getItem("foto_llegada")){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET id_usuario = ?,nombre_usuario = ?,fecha_entrada = ?,geolocalizacion_entrada = ?,id_cliente = ?,nombre_cliente = ?,horario_programado = ? WHERE id_cedula = ?",
                                            [id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,cedula],
                                            function(tx, results){
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else {
                                app.views.main.router.navigate({name: 'recorrido1'});
                            }

                        },
                        function(tx5, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
        } else {
            var NomDescCli = "Clientes";
            if(foto_llegada != ''){
                app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: id_usuario}, function (data) {
                    var content = JSON.parse(data);
                    var aux = 0;
                    for(var i=0; i < content.length; i++){
                        for (var i = 0; i < content.length; i++) {
                            if(content[i].IdCte == id_cliente){
                                aux = 1;
                                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,hora_programada,estatus);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                            [],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                localStorage.setItem("IdCedula", item.Id);
                                                localStorage.setItem("nombreCliente", nombre_cliente);
                                                localStorage.setItem("IdCte", id_cliente);
                                                localStorage.setItem("foto_llegada", foto_llegada);
                                                localStorage.setItem("sucursal", sucursal);
                                                localStorage.setItem("personaRecibe", personaRecibe);
                                                localStorage.setItem("direccion", direccion);
                                                localStorage.setItem("documentoIngresar", documentoIngresar);
                                                localStorage.setItem("codigoPostal", codigoPostal);
                                                localStorage.setItem("alcance", alcance);
                                                // localStorage.setItem("correo", correo);
                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        }
                    }
                    if(aux == 0){
                        app.preloader.hide();
                        swal("Cliente no encontrado", "No se tiene registro de ese cliente, Por favor sincroniza tus datos!" ,"error");
                    }
                });
            } else {
                swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
    }
    //Generar tipos de cedula
    function generarLevantamiento(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let direccion = localStorage.getItem("direccion");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let tipoCedula = "levantamiento";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addLevantamiento(id_cedula,foto_llegada,nombre_cliente,direccion);
                        app.views.main.router.navigate({name: 'recorrido3'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarFumigacion(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        let direccion = localStorage.getItem("direccion");
        let persona_recibe = localStorage.getItem("personaRecibe");
        let documento_ingresar = localStorage.getItem("documentoIngresar");
        let alcance_servicio = localStorage.getItem("alcance");
        let tipoCedula = "fumigacion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addFumigacion(id_cedula,foto_llegada,sucursal,direccion,persona_recibe,documento_ingresar,alcance_servicio);
                        app.views.main.router.navigate({name: 'recorrido'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarSanitizacion(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        let direccion = localStorage.getItem("direccion");
        let persona_recibe = localStorage.getItem("personaRecibe");
        let documento_ingresar = localStorage.getItem("documentoIngresar");
        let tipoCedula = "sanitizacion";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addSanitizacion(id_cedula,foto_llegada,sucursal,direccion,persona_recibe,documento_ingresar);
                        app.views.main.router.navigate({name: 'recorrido2'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Fin Generar tipos de cedula
    function guardarDatosLevantamiento(){
        app.preloader.show('blue');
        if($("#colonia").val() =="" || $("#revision").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var colonia = $("#colonia").val();
        var revision = $("#revision").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET colonia = ?,revision = ? WHERE id_cedula = ?",
                    [colonia,revision,id_cedula],
                    function(tx, results){
                        $("#colonia").css("background-color", "#FFFFFF");
                        $("#revision").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarLevantamiento(){
        app.preloader.show('blue');
        if($("#area").val() == "" || $('#imagenC').val() == "" || $('#plaga').val() == "" || $('#observaciones').val() == ""){
            swal("","Todos los campos son requeridos","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#area").val();
        var foto_plaga = $('#imagenC').val();
        var plaga = $('#plaga').val();
        var observaciones = $('#observaciones').val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO levantamiento_evidencia(id_cedula,area,foto_plaga,descripcion_plaga,observacion,fecha_regristro) VALUES (?,?,?,?,?,?)",
                    [id_cedula,area,foto_plaga,plaga,observaciones,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_levantamiento_foto) as Id from levantamiento_evidencia",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from levantamiento_evidencia where id_levantamiento_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#area").val("");
                                                        $("#plaga").val("");
                                                        $("#observaciones").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#area").css("background-color", "#FFFFFF");
                                                        $("#plaga").css("background-color", "#FFFFFF");
                                                        $("#observaciones").css("background-color", "#FFFFFF");
                                                        $("#tabla_levantamiento tbody").append("<tr id='fila"+ item.id_levantamiento_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_levantamiento_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_plaga+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.area + "</td><td style='text-align: center;'>" + unescape(item.descripcion_plaga) + "</td><td style='text-align: center;'>"+ item.observacion + "</td><td style='text-align: center;'>" + item.fecha_regristro + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveGradoLevantamiento(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "BAJA: SERVICIO BÁSICO,ASPERSIÓN,POLVO,PRESENCIA EN 1 ÁREA";
            $("#descripcion_infeccion").val(message);
        } else if(valor == 2){
            var message = "MEDIA: SERVICIO REGULAR,ASPERSIÓN,GEL,POLVO,PRESENCIA EN 2 ÁREAS";
            $("#descripcion_infeccion").val(message);
        } else if(valor == 3){
            var message = "ALTA: SERVICIO PREMIUM ,MICRO INYECCIÓN ,ASPERSIÓN,GEL,POLVO,PRESENCIA EN TODAS LAS ÁREAS";
            $("#descripcion_infeccion").val(message);
        } else {
            var message = "";
            $("#descripcion_infeccion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET grado_infeccion = ?,descripcion = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un grado de infestacíon valido","warning");
                        } else {
                            swal("", "Se guardo el grado de infestación","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarLevantamiento(){
        let infestacion = $("#descripcion_infeccion").val();
        if(infestacion == ""){
            swal({
                title: "Aviso",
                text: "Aun no agregas el grado de infestación, ¿Estas seguro que deseas regresar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
                } else {}
            });
        } else {
            app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardarCierreLevantamiento(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var comentarios = $("#comentarios").val();
        var nombreComentario = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET comentarios_tecnico = ?,firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [comentarios,firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        app.views.main.router.back('/yamevoylevantamiento/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                    [nombreComentario,id_cedula],
                    function(tx, results){
                        app.views.main.router.back('/yamevoylevantamiento/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreFumigacion(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET firma_evalua = ?,fecha_firma = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyfumigacion/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarCierreSanitizacion(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET firma_evalua = ?,fecha_firma = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoylevantamientoSMC/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarLevantamiento(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE levantamiento_servicio SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarFumigacion(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSanitizacion(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function continuarCed(id_cliente, id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("IdCte",id_cliente);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorrido3'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorrido'});
        } else if(tipo == 3) {
            app.views.main.router.navigate({ name: 'recorrido2'});
        }
    }
    function EliminarReg(id_cedula,tipo_cedula,op){
        if(op == 2){
            swal({
                title: "Aviso",
                text: "Se presento un error, valide su proceso e intente de nuevo",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then((willGoBack) => {
                if (willGoBack){
                    var empresa = localStorage.getItem("nombre_empresa");
                    console.log(empresa,id_cedula,tipo_cedula);
                    if(empresa == "VIC"){
                         if (tipo_cedula == "VentasVIC" || tipo_cedula == "VentasVIC_SinV" || tipo_cedula == "VentasVIC_ConV" || tipo_cedula == "VentasVIC_Acompa") {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("DELETE FROM ventas_bennetts WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {                                       
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("DELETE FROM minuta WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function (tx, results) {                                                      
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("DELETE FROM apoyo_venta_vic  WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function (tx, results) {
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                            tx.executeSql("DELETE FROM datos_contacto  WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                function (tx, results) {                                                                             
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM proyectos_vic WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                    function (tx, results) {   
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                                                                                                [id_cedula],
                                                                                                                    function (tx, results) {   
                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                        // swal("Proyecto Eliminado","Se elimino satisfactoriamente el proyecto","success");
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al guardar VENTAS: " + error.message);
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                          
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar VENTAS: " + error.message);
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar VENTAS: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        },
                                        function(tx, error){
                                            console.log("Error al guardar VENTAS: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        }
                    }
                }
            });
        }else{
        swal({
            title: "Aviso",
            text: "Estas apunto de eliminar todos los datos de la cedula, ¿Estas seguro continuar con la acción?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
        .then((willGoBack) => {
            if (willGoBack){
                var empresa = localStorage.getItem("nombre_empresa");               
                console.log(empresa,id_cedula,tipo_cedula);
                if(empresa == "VIC"){
                    if (tipo_cedula == "ApoyoVIC") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM apoyo_bennetts WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM fotos_apoyo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                   
                                                    $("#conc" + id_cedula).remove();
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar Apoyo VIC",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar Apoyo VIC ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                    } else if (tipo_cedula == "VentasVIC" || tipo_cedula == "VentasVIC_SinV" || tipo_cedula == "VentasVIC_ConV" || tipo_cedula == "VentasVIC_Acompa") {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM ventas_bennetts WHERE id_cedula = ?",
                                    [id_cedula],
                                    function (tx, results) {                                       
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM minuta WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function (tx, results) {                                                      
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM apoyo_venta_vic  WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function (tx, results) {
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                        tx.executeSql("DELETE FROM datos_contacto  WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function (tx, results) {                                                                             
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx){
                                                                                            tx.executeSql("DELETE FROM proyectos_vic WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                                function (tx, results) {   
                                                                                                    databaseHandler.db.transaction(
                                                                                                        function(tx){
                                                                                                            tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                                function (tx, results) {   
                                                                                                                    $("#conc" + id_cedula).remove();
                                                                                                                    swal("Proyecto Eliminado","Se elimino satisfactoriamente el proyecto","success");
                                                                                                                },
                                                                                                                function(tx, error){
                                                                                                                    console.log("Error al guardar cedula: " + error.message);
                                                                                                                }
                                                                                                            );
                                                                                                        },
                                                                                                        function(error){},
                                                                                                        function(){}
                                                                                                    );
                                                                                                },
                                                                                                function(tx, error){
                                                                                                    console.log("Error al guardar cedula: " + error.message);
                                                                                                }
                                                                                            );
                                                                                        },
                                                                                        function(error){},
                                                                                        function(){}
                                                                                    );
                                                                                },
                                                                                function(tx, error){
                                                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                      
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar VENTAS: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    } else if (tipo_cedula == "VIC") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM datosVIC WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM equiposVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                   
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                          tx.executeSql(
                                                            "DELETE FROM imagenVIC WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                               
                                                                databaseHandler.db.transaction(
                                                                    function (tx) {
                                                                      tx.executeSql(
                                                                        "DELETE FROM entrenaVIC WHERE id_cedula = ?",
                                                                        [id_cedula],
                                                                        function (tx, results) {
                                                                           
                                                                            databaseHandler.db.transaction(
                                                                                function (tx) {
                                                                                  tx.executeSql(
                                                                                    "DELETE FROM almacenVIC WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function (tx, results) {
                                                                                       
                                                                                        databaseHandler.db.transaction(
                                                                                            function (tx) {
                                                                                              tx.executeSql(
                                                                                                "DELETE FROM pedidosVIC WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function (tx, results) {
                                                                                                    $("#conc" + id_cedula).remove();
                                                                                                },
                                                                                                function (tx, error) {
                                                                                                  swal(
                                                                                                    "Error al eliminar pedidosVIC de Ventas VIC",
                                                                                                    error.message,
                                                                                                    "error"
                                                                                                  );
                                                                                                }
                                                                                              );
                                                                                            },
                                                                                            function (error) { },
                                                                                            function () { }
                                                                                          );
                                                                                    },
                                                                                    function (tx, error) {
                                                                                      swal(
                                                                                        "Error al eliminar almacenVIC de Ventas VIC",
                                                                                        error.message,
                                                                                        "error"
                                                                                      );
                                                                                    }
                                                                                  );
                                                                                },
                                                                                function (error) { },
                                                                                function () { }
                                                                              );
                                                                        },
                                                                        function (tx, error) {
                                                                          swal(
                                                                            "Error al eliminar entrenaVIC de Ventas VIC",
                                                                            error.message,
                                                                            "error"
                                                                          );
                                                                        }
                                                                      );
                                                                    },
                                                                    function (error) { },
                                                                    function () { }
                                                                  );
                                                            },
                                                            function (tx, error) {
                                                              swal(
                                                                "Error al eliminar imagenVIC de Ventas VIC",
                                                                error.message,
                                                                "error"
                                                              );
                                                            }
                                                          );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                      );
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar equiposVIC de Ventas VIC",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar datos VIC ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                    }
                } else if(empresa == "CarnesIdeal"){
                    if (tipo_cedula == "Venta") {
                        databaseHandler.db.transaction(
                            function (tx) { tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                    function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) { tx.executeSql("DELETE FROM datos_ventas WHERE id_cedula = ?",
                                                [id_cedula],
                                                    function (tx, results) {
                                                        databaseHandler.db.transaction(
                                                            function (tx) { tx.executeSql("DELETE FROM visitas_ci WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                    function (tx, results) {
                                                                        databaseHandler.db.transaction(
                                                                            function (tx) { tx.executeSql("DELETE FROM prodcutos_ci WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                    function (tx, results) {
                                                                                        databaseHandler.db.transaction(
                                                                                            function (tx) { tx.executeSql("DELETE FROM minuta_ci WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                    function (tx, results) {
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function (tx) { tx.executeSql("DELETE FROM visita_seguimiento WHERE id_cedula = ?",
                                                                                                                [id_cedula],
                                                                                                                    function (tx, results) {
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function (tx) { tx.executeSql("DELETE FROM cierre_seguimiento_ci WHERE id_cedula = ?",
                                                                                                                                [id_cedula],
                                                                                                                                    function (tx, results) {
                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                            function (tx) { tx.executeSql("DELETE FROM fotos_ci WHERE id_cedula = ?",
                                                                                                                                                [id_cedula],
                                                                                                                                                    function (tx, results) {
                                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                                    },
                                                                                                                                                    function (tx, error) {
                                                                                                                                                        swal("Error al eliminar fotos_ci", error.message, "error");
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function (error) { }, function () { }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function (tx, error) {
                                                                                                                                        swal("Error al eliminar cierre_seguimiento_ci", error.message, "error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function (error) { }, function () { }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function (tx, error) {
                                                                                                                        swal("Error al eliminar visita_seguimiento", error.message, "error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function (error) { }, function () { }
                                                                                                        );
                                                                                                    },
                                                                                                    function (tx, error) {
                                                                                                        swal("Error al eliminar minuta_ci", error.message, "error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function (error) { }, function () { }
                                                                                        );
                                                                                    },
                                                                                    function (tx, error) {
                                                                                        swal("Error al eliminar prodcutos_ci", error.message, "error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function (error) { }, function () { }
                                                                        );
                                                                    },
                                                                    function (tx, error) {
                                                                        swal("Error al eliminar visitas_ci", error.message, "error");
                                                                    }
                                                                );
                                                            },
                                                            function (error) { }, function () { }
                                                        );
                                                    },
                                                    function (tx, error) {
                                                        swal("Error al eliminar datos_ventas", error.message, "error");
                                                    }
                                                );
                                            },
                                            function (error) { }, function () { }
                                        );
                                    },
                                    function (tx, error) {
                                        swal("Error al eliminar cedulas_general", error.message, "error");
                                    }
                                );
                            },
                            function (error) { }, function () { }
                        );
                    }else if (tipo_cedula == "Entrega") {
                        databaseHandler.db.transaction(
                            function (tx) { tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                    function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) { tx.executeSql("DELETE FROM datos_generales WHERE id_cedula = ?",
                                                [id_cedula],
                                                    function (tx, results) {
                                                        databaseHandler.db.transaction(
                                                            function (tx) { tx.executeSql("DELETE FROM fotos_ci WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                    function (tx, results) {
                                                                        databaseHandler.db.transaction(
                                                                            function (tx) { tx.executeSql("DELETE FROM fotos_entrega_ci WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                    function (tx, results) {
                                                                                        $("#conc" + id_cedula).remove();
                                                                                    },
                                                                                    function (tx, error) {
                                                                                        swal("Error al eliminar fotos_entrega_ci", error.message, "error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function (error) { }, function () { }
                                                                        );
                                                                    },
                                                                    function (tx, error) {
                                                                        swal("Error al eliminar fotos_ci", error.message, "error");
                                                                    }
                                                                );
                                                            },
                                                            function (error) { }, function () { }
                                                        );
                                                    },
                                                    function (tx, error) {
                                                        swal("Error al eliminar datos_generales", error.message, "error");
                                                    }
                                                );
                                            },
                                            function (error) { }, function () { }
                                        );
                                    },
                                    function (tx, error) {
                                        swal("Error al eliminar cedulas_general", error.message, "error");
                                    }
                                );
                            },
                            function (error) { }, function () { }
                        );
                    }else if (tipo_cedula == "Ruta") {
                        databaseHandler.db.transaction(
                            function (tx) { tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                    function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) { tx.executeSql("DELETE FROM datos_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                    function (tx, results) {
                                                        databaseHandler.db.transaction(
                                                            function (tx) { tx.executeSql("DELETE FROM evidencias_carga WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                    function (tx, results) {
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function (tx, error) {
                                                                        swal("Error al eliminar evidencias_carga", error.message, "error");
                                                                    }
                                                                );
                                                            },
                                                            function (error) { }, function () { }
                                                        );
                                                    },
                                                    function (tx, error) {
                                                        swal("Error al eliminar datos_ci", error.message, "error");
                                                    }
                                                );
                                            },
                                            function (error) { }, function () { }
                                        );
                                    },
                                    function (tx, error) {
                                        swal("Error al eliminar cedulas_general", error.message, "error");
                                    }
                                );
                            },
                            function (error) { }, function () { }
                        );
                    }
                } else if(empresa == "sales_suro"){
                    console.log('Entro a sales suro')
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("DELETE FROM ventas_bennetts_SS WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {                                       
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM minuta_SS WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {                                                      
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM apoyo_venta_vic_SS  WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("DELETE FROM  datos_contacto_SS  WHERE id_cedula = ?",
                                                                        [id_cedula],
                                                                        function (tx, results) {                                                                             
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("DELETE FROM proyectos_vic_SS WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function (tx, results) {   
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function (tx, results) {   
                                                                                                    $("#conc" + id_cedula).remove();
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                                                        app.preloader.hide();
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );

                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al guardar cedula: " + error.message);
                                                                                            app.preloader.hide();
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){},
                                                                                function(){}
                                                                            );
                                                                              
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al guardar VENTAS: " + error.message);
                                                                                app.preloader.hide();
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                                  
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                                    app.preloader.hide();
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error al guardar VENTAS: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else if(empresa == "Zona04"){
                    if(tipo_cedula == "Clientes_zona"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datosG_zona WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM encuestas_zona WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM venta_zona WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM renta_zona WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else  if(tipo_cedula == "Prospeccion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM prospeccion_zona WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        $("#conc" + id_cedula).remove();
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Bennetts2"){
                    if(tipo_cedula == "Cobranza"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM evidenciaCobranza WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM cobranza WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                        swal("Eliminada correctamente","","success");
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },function(error){},function(){}
                                                        );
                                                    },
                                                    function(tx, error){console.log("Error al eliminar datos_generales BennetssL: " +error.message);}
                                                );
                                            },function(error){},function(){}
                                        );
                                    },
                                    function(tx, error){console.log("Error al eliminar datos_generales BennetssL: " +error.message);}
                                );
                            },function(error){},function(){}
                        );
                    }
                } else if(empresa == "MrFixer"){
                    if(tipo_cedula == "Bitacora"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_generales_MrFixer WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM insumos WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM bitacora WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM material_registrado WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "BennettsL"){
                    if(tipo_cedula == "servicio_tecnico" || tipo_cedula == "logistica"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM logistica_bennettsL WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencias_bennettsL WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },function(error){},function(){}
                                                        );
                                                    },
                                                    function(tx, error){console.log("Error al eliminar datos_generales BennetssL: " +error.message);}
                                                );
                                            },function(error){},function(){}
                                        );
                                    },
                                    function(tx, error){console.log("Error al eliminar datos_generales BennetssL: " +error.message);}
                                );
                            },function(error){},function(){}
                        );
                    }
                } else if(empresa == "Restatools"){
                    if(tipo_cedula == "Trampa"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_trampa_restatools WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencias_restatools WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else if(tipo_cedula == "Extraccion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_extracciones_restatools WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencias_restatools WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else if(tipo_cedula == "Mantenimiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_mmto_restatools WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencias_restatools WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else if(tipo_cedula == "Desasolve"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_desasolve_restatools WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencias_restatools WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Proteus"){
                    if(tipo_cedula == "Reposicion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM reposicion_proteus WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM evidencias_proteus WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM fotos_proteus WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else if(tipo_cedula == "Preventivo"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM reposicion_proteus WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM evidencias_proteus WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM fotos_proteus WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("DELETE FROM check_limpieza WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                            function(tx){
                                                                                                                                                tx.executeSql("DELETE FROM check_revision WHERE id_cedula = ?",
                                                                                                                                                    [id_cedula],
                                                                                                                                                    function(tx, results){
                                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                                    },
                                                                                                                                                    function(tx, error){
                                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(error){},
                                                                                                                                            function(){}
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else if(tipo_cedula == "Correctivo"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM mmto_correctivo WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM evidencias_proteus WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM fotos_proteus WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else if(tipo_cedula == "Instalacion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_generales_proteus WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM datos_equipos_proteus WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Dilimpio"){
                    if(tipo_cedula == "visitaDilimpio"){
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM visitaDilimpio WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM equiposDL WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                     
                                                      databaseHandler.db.transaction(
                                                          function (tx) {
                                                            tx.executeSql(
                                                              "DELETE FROM imagenDL WHERE id_cedula = ?",
                                                              [id_cedula],
                                                              function (tx, results) {
                                                                 
                                                                  databaseHandler.db.transaction(
                                                                      function (tx) {
                                                                        tx.executeSql(
                                                                          "DELETE FROM entrenaDL WHERE id_cedula = ?",
                                                                          [id_cedula],
                                                                          function (tx, results) {
                                                                             
                                                                              databaseHandler.db.transaction(
                                                                                  function (tx) {
                                                                                    tx.executeSql(
                                                                                      "DELETE FROM almacenDL WHERE id_cedula = ?",
                                                                                      [id_cedula],
                                                                                      function (tx, results) {
                                                                                         
                                                                                          databaseHandler.db.transaction(
                                                                                              function (tx) {
                                                                                                tx.executeSql(
                                                                                                  "DELETE FROM pedidosDL WHERE id_cedula = ?",
                                                                                                  [id_cedula],
                                                                                                  function (tx, results) {
                                                                                                     
                                                                                                      $("#conc" + id_cedula).remove();
                                                                                                  },
                                                                                                  function (tx, error) {
                                                                                                    swal(
                                                                                                      "Error al eliminar pedidosVIC de Ventas DL",
                                                                                                      error.message,
                                                                                                      "error"
                                                                                                    );
                                                                                                  }
                                                                                                );
                                                                                              },
                                                                                              function (error) { },
                                                                                              function () { }
                                                                                            );
                                                                                      },
                                                                                      function (tx, error) {
                                                                                        swal(
                                                                                          "Error al eliminar almacenDL de Ventas DL",
                                                                                          error.message,
                                                                                          "error"
                                                                                        );
                                                                                      }
                                                                                    );
                                                                                  },
                                                                                  function (error) { },
                                                                                  function () { }
                                                                                );
                                                                          },
                                                                          function (tx, error) {
                                                                            swal(
                                                                              "Error al eliminar entrenaDL de Ventas DL",
                                                                              error.message,
                                                                              "error"
                                                                            );
                                                                          }
                                                                        );
                                                                      },
                                                                      function (error) { },
                                                                      function () { }
                                                                    );
                                                              },
                                                              function (tx, error) {
                                                                swal(
                                                                  "Error al eliminar imagenDL de Ventas DL",
                                                                  error.message,
                                                                  "error"
                                                                );
                                                              }
                                                            );
                                                          },
                                                          function (error) { },
                                                          function () { }
                                                        );
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar equiposDL de Ventas DL",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar datos DL ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                    }else if(tipo_cedula == "Entregas"){
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM DatosentregasDL WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM entregasDL WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                      $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar entregasDL",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar DatosentregasDL ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                    }else if(tipo_cedula == "Cobranza"){
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM DatoscobranzasDL WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM cobranzasDL WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                      $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar cobranzasDL",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar DatoscobranzasDL ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                    }else if(tipo_cedula == "Control"){
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM DatosentregasDL WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM equipo_comision WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                          tx.executeSql(
                                                            "DELETE FROM evidencias_equipo_comision WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                                $("#conc" + id_cedula).remove();
                                                            },
                                                            function (tx, error) {
                                                              swal(
                                                                "Error al eliminar evidencias_equipo_comision",
                                                                error.message,
                                                                "error"
                                                              );
                                                            }
                                                          );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                      );
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar equipo_comision",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar DatosentregasDL ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                    }
                } else if(empresa == "SMC"){
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_smc WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "mantenimiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM mantenimiento_smc WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "ventaSMC"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM ventaSMC WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_venta_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM datos_equipo_smc WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        $("#conc" + id_cedula).remove();
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "servicioSMC"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM servicioSMC WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_servicio_smc WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM datos_servicio_smc WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        $("#conc" + id_cedula).remove();
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Field"){
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_Field WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "mantenimiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM mantenimiento_Field WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar mantenimiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "DIPREC"){
                    if(tipo_cedula == "reporteTecnico"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM servicio_tecnico WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM datos_equipo WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM evidencia_equipo WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM datos_equipo_antes WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM evidencia_refacciones WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("DELETE FROM check_list WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                            function(tx){
                                                                                                                                                tx.executeSql("DELETE FROM check_list2 WHERE id_cedula = ?",
                                                                                                                                                    [id_cedula],
                                                                                                                                                    function(tx, results){
                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                            function(tx){
                                                                                                                                                                tx.executeSql("DELETE FROM datos_equipo_despues WHERE id_cedula = ?",
                                                                                                                                                                    [id_cedula],
                                                                                                                                                                    function(tx, results){
                                                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                                                    },
                                                                                                                                                                    function(tx, error){
                                                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                                                    }
                                                                                                                                                                );
                                                                                                                                                            },
                                                                                                                                                            function(error){},
                                                                                                                                                            function(){}
                                                                                                                                                        );
                                                                                                                                                    },
                                                                                                                                                    function(tx, error){
                                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(error){},
                                                                                                                                            function(){}
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    } else {
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM minuta_coordinador WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM zonas_coordinador WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("DELETE FROM equipos_coordinador WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("DELETE FROM datos_coordinador WHERE id_cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function(tx, results){
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function(tx){
                                                                                                                tx.executeSql("DELETE FROM observaciones WHERE id_cedula = ?",
                                                                                                                    [id_cedula],
                                                                                                                    function(tx, results){
                                                                                                                        databaseHandler.db.transaction(
                                                                                                                            function(tx){
                                                                                                                                tx.executeSql("DELETE FROM notas WHERE id_cedula = ?",
                                                                                                                                    [id_cedula],
                                                                                                                                    function(tx, results){
                                                                                                                                        $("#conc" + id_cedula).remove();
                                                                                                                                    },
                                                                                                                                    function(tx, error){
                                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(error){},
                                                                                                                            function(){}
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(tx, error){
                                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                                    }
                                                                                                                );
                                                                                                            },
                                                                                                            function(error){},
                                                                                                            function(){}
                                                                                                        );
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else if(empresa == "Bennetts"){
                    if(tipo_cedula == "baja"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    $("#conc" + id_cedula).remove();
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                    if(tipo_cedula == "conteo"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM inventario WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM conteo WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    $("#conc" + id_cedula).remove();
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }
                } else if(empresa == "ServInd"){
                    if(tipo_cedula == "reporteGeneral"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM reporteGeneral WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM evidenciasReporte WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM equiposReporte WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    $("#conc" + id_cedula).remove();
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    } else if(tipo_cedula == "checklistServ"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM checklist WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM selectcheck WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    $("#conc" + id_cedula).remove();
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    } else if(tipo_cedula == "AuditoriaTecnico" || tipo_cedula == "AuditoriaSupervisorTecnico" || tipo_cedula == "AuditoriaLider"){
                        databaseHandler.db.transaction(
                          function(tx){
                              tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                  [id_cedula],
                                  function(tx, results){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM SV_Fotos WHERE SV_ID_Cedula = ?",
                                                [id_cedula],
                                                function(tx, results){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("DELETE FROM Aud_Tec WHERE AT_ID_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM Aud_General WHERE AG_ID_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    $("#conc" + id_cedula).remove();
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    swal("Error al eliminar baja de producto ",error.message,"error");
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                  },
                                  function(tx, error){
                                      swal("Error al eliminar cedulas_general",error.message,"error");
                                  }
                              );
                          },
                          function(error){},
                          function(){}
                      );
                    }else if (tipo_cedula == "Correctivo") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                    databaseHandler.db.transaction(
                                        function (tx) {
                                        tx.executeSql(
                                            "DELETE FROM visita_servInd WHERE id_cedula = ?",
                                            [id_cedula],
                                            function (tx, results) {
                                                databaseHandler.db.transaction(
                                                    function (tx) {
                                                    tx.executeSql(
                                                        "DELETE FROM checklist_servind WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function (tx, results) {
                                                            databaseHandler.db.transaction(
                                                                function (tx) {
                                                                tx.executeSql(
                                                                    "DELETE FROM fotos_check WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function (tx, results) {
                                                                        databaseHandler.db.transaction(
                                                                            function (tx) {
                                                                            tx.executeSql(
                                                                                "DELETE FROM papeleta WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                function (tx, results) {
                                                                                    databaseHandler.db.transaction(
                                                                                        function (tx) {
                                                                                        tx.executeSql(
                                                                                            "DELETE FROM refacciones WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function (tx, results) {
                                                                                                $("#conc" + id_cedula).remove();
                                                                                            },
                                                                                            function (tx, error) {
                                                                                            swal(
                                                                                                "Error al refacciones Serv",
                                                                                                error.message,
                                                                                                "error"
                                                                                            );
                                                                                            }
                                                                                        );
                                                                                        },
                                                                                        function (error) { },
                                                                                        function () { }
                                                                                    );
                                                                                },
                                                                                function (tx, error) {
                                                                                swal(
                                                                                    "Error al eliminar papeleta serv",
                                                                                    error.message,
                                                                                    "error"
                                                                                );
                                                                                }
                                                                            );
                                                                            },
                                                                            function (error) { },
                                                                            function () { }
                                                                        );
                                                                    },
                                                                    function (tx, error) {
                                                                    swal(
                                                                        "Error al eliminar fotos_check serv",
                                                                        error.message,
                                                                        "error"
                                                                    );
                                                                    }
                                                                );
                                                                },
                                                                function (error) { },
                                                                function () { }
                                                            );
                                                        },
                                                        function (tx, error) {
                                                        swal(
                                                            "Error al eliminar checklist serv",
                                                            error.message,
                                                            "error"
                                                        );
                                                        }
                                                    );
                                                    },
                                                    function (error) { },
                                                    function () { }
                                                );
                                            },
                                            function (tx, error) {
                                            swal(
                                                "Error al eliminar visita serv",
                                                error.message,
                                                "error"
                                            );
                                            }
                                        );
                                        },
                                        function (error) { },
                                        function () { }
                                    );
                                },
                                function (tx, error) {
                                swal(
                                    "Error al eliminar cedulasG",
                                    error.message,
                                    "error"
                                );
                                }
                            );
                            },
                            function (error) { },
                            function () { }
                        );
                    }
                } else if(empresa == "SURO"){
                    if (tipo_cedula == "sanitizacionSURO") {
                        databaseHandler.db.transaction(
                          function (tx) {
                            tx.executeSql(
                              "DELETE FROM cedulas_general WHERE id_cedula = ?",
                              [id_cedula],
                              function (tx, results) {
                                databaseHandler.db.transaction(
                                  function (tx) {
                                    tx.executeSql(
                                      "DELETE FROM sanitizacion_Suro WHERE id_cedula = ?",
                                      [id_cedula],
                                      function (tx, results) {
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "DELETE FROM evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) {
                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                          tx.executeSql(
                                                            "DELETE FROM grupos WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                              $("#conc" + id_cedula).remove();
                                                            },
                                                            function (tx, error) {
                                                              swal(
                                                                "Error al eliminar sanitizacion ",
                                                                error.message,
                                                                "error"
                                                              );
                                                            }
                                                          );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                      );
                                                },
                                                function (tx, error) {
                                                  swal(
                                                    "Error al eliminar sanitizacion ",
                                                    error.message,
                                                    "error"
                                                  );
                                                }
                                              );
                                            },
                                            function (error) { },
                                            function () { }
                                          );
                                      },
                                      function (tx, error) {
                                        swal(
                                          "Error al eliminar sanitizacion ",
                                          error.message,
                                          "error"
                                        );
                                      }
                                    );
                                  },
                                  function (error) { },
                                  function () { }
                                );
                              },
                              function (tx, error) {
                                swal(
                                  "Error al eliminar cedulas_general",
                                  error.message,
                                  "error"
                                );
                              }
                            );
                          },
                          function (error) { },
                          function () { }
                        );
                      }else if (tipo_cedula == "recorridoSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Recorrido_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar Recorrido_SURO ",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar Recorrido_SURO ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "visitaSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Visita_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar Visita_SURO ",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar Visita_SURO ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "encuestaSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Encuesta_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar encuestaSURO  ",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar encuestaSURO  ",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "visitaBSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM VisitaB_SURO WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar visitaBSURO",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar visitaBSURO",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }else if (tipo_cedula == "seguimientoSURO") {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "DELETE FROM cedulas_general WHERE id_cedula = ?",
                                [id_cedula],
                                function (tx, results) {
                                  databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM Seguimiento WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                          databaseHandler.db.transaction(
                                              function (tx) {
                                                tx.executeSql(
                                                  "DELETE FROM Fotos_SURO WHERE id_cedula = ?",
                                                  [id_cedula],
                                                  function (tx, results) {
                                                    $("#conc" + id_cedula).remove();
                                                  },
                                                  function (tx, error) {
                                                    swal(
                                                      "Error al eliminar seguimientoSURO",
                                                      error.message,
                                                      "error"
                                                    );
                                                  }
                                                );
                                              },
                                              function (error) { },
                                              function () { }
                                            );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar seguimientoSURO",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                                },
                                function (tx, error) {
                                  swal(
                                    "Error al eliminar cedulas_general",
                                    error.message,
                                    "error"
                                  );
                                }
                              );
                            },
                            function (error) { },
                            function () { }
                          );
                      }
                } else if(empresa == "PlatoLimpio"){
                    databaseHandler.db.transaction(
                        function (tx) {
                          tx.executeSql(
                            "DELETE FROM cedulas_general WHERE id_cedula = ?",
                            [id_cedula],
                            function (tx, results) {
                                databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "DELETE FROM DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            databaseHandler.db.transaction(
                                                function (tx) {
                                                  tx.executeSql(
                                                    "DELETE FROM Ciclo_Charola WHERE CC_ID_Cedula = ?",
                                                    [id_cedula],
                                                    function (tx, results) {
                                                        databaseHandler.db.transaction(
                                                            function (tx) {
                                                              tx.executeSql(
                                                                "DELETE FROM Factor_Humano WHERE FH_ID_Cedula = ?",
                                                                [id_cedula],
                                                                function (tx, results) {
                                                                    databaseHandler.db.transaction(
                                                                        function (tx) {
                                                                          tx.executeSql(
                                                                            "DELETE FROM Info_Equipo WHERE IE_ID_Cedula = ?",
                                                                            [id_cedula],
                                                                            function (tx, results) {
                                                                                databaseHandler.db.transaction(
                                                                                    function (tx) {
                                                                                      tx.executeSql(
                                                                                        "DELETE FROM Capa_Equipo_A WHERE CE_ID_Cedula = ?",
                                                                                        [id_cedula],
                                                                                        function (tx, results) {
                                                                                            databaseHandler.db.transaction(
                                                                                                function (tx) {
                                                                                                  tx.executeSql(
                                                                                                    "DELETE FROM Capa_Equipo_B WHERE CE_ID_Cedula = ?",
                                                                                                    [id_cedula],
                                                                                                    function (tx, results) {
                                                                                                        databaseHandler.db.transaction(
                                                                                                            function (tx) {
                                                                                                              tx.executeSql(
                                                                                                                "DELETE FROM Tipo_Sistema WHERE TS_ID_Cedula = ?",
                                                                                                                [id_cedula],
                                                                                                                function (tx, results) {
                                                                                                                    databaseHandler.db.transaction(
                                                                                                                        function (tx) {
                                                                                                                          tx.executeSql(
                                                                                                                            "DELETE FROM Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function (tx, results) {
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function (tx) {
                                                                                                                                      tx.executeSql(
                                                                                                                                        "DELETE FROM Insumos_A WHERE ID_Cedula = ?",
                                                                                                                                        [id_cedula],
                                                                                                                                        function (tx, results) {
                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                function (tx) {
                                                                                                                                                  tx.executeSql(
                                                                                                                                                    "DELETE FROM Insumos_B WHERE ID_Cedula = ?",
                                                                                                                                                    [id_cedula],
                                                                                                                                                    function (tx, results) {
                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                            function (tx) {
                                                                                                                                                              tx.executeSql(
                                                                                                                                                                "DELETE FROM Insumos_C WHERE ID_Cedula = ?",
                                                                                                                                                                [id_cedula],
                                                                                                                                                                function (tx, results) {
                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                        function (tx) {
                                                                                                                                                                          tx.executeSql(
                                                                                                                                                                            "DELETE FROM Stress WHERE ID_Cedula = ?",
                                                                                                                                                                            [id_cedula],
                                                                                                                                                                            function (tx, results) {
                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                    function (tx) {
                                                                                                                                                                                      tx.executeSql(
                                                                                                                                                                                        "DELETE FROM Resultado WHERE ID_Cedula = ?",
                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                        function (tx, results) {
                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                function (tx) {
                                                                                                                                                                                                  tx.executeSql(
                                                                                                                                                                                                    "DELETE FROM PL_Fotos WHERE F_ID_Cedula = ?",
                                                                                                                                                                                                    [id_cedula],
                                                                                                                                                                                                    function (tx, results) {
                                                                                                                                                                                                    $("#conc" + id_cedula).remove();
                                                                                                                                                                                                       
                                                                                                                                                                                                    },
                                                                                                                                                                                                    function (tx, error) {
                                                                                                                                                                                                      swal(
                                                                                                                                                                                                        "Error al eliminar PL_Fotos",
                                                                                                                                                                                                        error.message,
                                                                                                                                                                                                        "error"
                                                                                                                                                                                                      );
                                                                                                                                                                                                    }
                                                                                                                                                                                                  );
                                                                                                                                                                                                },
                                                                                                                                                                                                function (error) { },
                                                                                                                                                                                                function () { }
                                                                                                                                                                                              );
                                                                                                                                                                                        },
                                                                                                                                                                                        function (tx, error) {
                                                                                                                                                                                          swal(
                                                                                                                                                                                            "Error al eliminar Resultado",
                                                                                                                                                                                            error.message,
                                                                                                                                                                                            "error"
                                                                                                                                                                                          );
                                                                                                                                                                                        }
                                                                                                                                                                                      );
                                                                                                                                                                                    },
                                                                                                                                                                                    function (error) { },
                                                                                                                                                                                    function () { }
                                                                                                                                                                                  );
                                                                                                                                                                            },
                                                                                                                                                                            function (tx, error) {
                                                                                                                                                                              swal(
                                                                                                                                                                                "Error al eliminar Stress",
                                                                                                                                                                                error.message,
                                                                                                                                                                                "error"
                                                                                                                                                                              );
                                                                                                                                                                            }
                                                                                                                                                                          );
                                                                                                                                                                        },
                                                                                                                                                                        function (error) { },
                                                                                                                                                                        function () { }
                                                                                                                                                                      );
                                                                                                                                                                },
                                                                                                                                                                function (tx, error) {
                                                                                                                                                                  swal(
                                                                                                                                                                    "Error al eliminar Insumos_C",
                                                                                                                                                                    error.message,
                                                                                                                                                                    "error"
                                                                                                                                                                  );
                                                                                                                                                                }
                                                                                                                                                              );
                                                                                                                                                            },
                                                                                                                                                            function (error) { },
                                                                                                                                                            function () { }
                                                                                                                                                          );
                                                                                                                                                    },
                                                                                                                                                    function (tx, error) {
                                                                                                                                                      swal(
                                                                                                                                                        "Error al eliminar Insumos_B",
                                                                                                                                                        error.message,
                                                                                                                                                        "error"
                                                                                                                                                      );
                                                                                                                                                    }
                                                                                                                                                  );
                                                                                                                                                },
                                                                                                                                                function (error) { },
                                                                                                                                                function () { }
                                                                                                                                              );
                                                                                                                                        },
                                                                                                                                        function (tx, error) {
                                                                                                                                          swal(
                                                                                                                                            "Error al eliminar Insumos_A",
                                                                                                                                            error.message,
                                                                                                                                            "error"
                                                                                                                                          );
                                                                                                                                        }
                                                                                                                                      );
                                                                                                                                    },
                                                                                                                                    function (error) { },
                                                                                                                                    function () { }
                                                                                                                                  );
                                                                                                                            },
                                                                                                                            function (tx, error) {
                                                                                                                              swal(
                                                                                                                                "Error al eliminar Prueba_Calidad_Agua",
                                                                                                                                error.message,
                                                                                                                                "error"
                                                                                                                              );
                                                                                                                            }
                                                                                                                          );
                                                                                                                        },
                                                                                                                        function (error) { },
                                                                                                                        function () { }
                                                                                                                      );
                                                                                                                },
                                                                                                                function (tx, error) {
                                                                                                                  swal(
                                                                                                                    "Error al eliminar Tipo_Sistema",
                                                                                                                    error.message,
                                                                                                                    "error"
                                                                                                                  );
                                                                                                                }
                                                                                                              );
                                                                                                            },
                                                                                                            function (error) { },
                                                                                                            function () { }
                                                                                                          );
                                                                                                    },
                                                                                                    function (tx, error) {
                                                                                                      swal(
                                                                                                        "Error al eliminar Capa_Equipo_B",
                                                                                                        error.message,
                                                                                                        "error"
                                                                                                      );
                                                                                                    }
                                                                                                  );
                                                                                                },
                                                                                                function (error) { },
                                                                                                function () { }
                                                                                              );
                                                                                        },
                                                                                        function (tx, error) {
                                                                                          swal(
                                                                                            "Error al eliminar Capa_Equipo_A",
                                                                                            error.message,
                                                                                            "error"
                                                                                          );
                                                                                        }
                                                                                      );
                                                                                    },
                                                                                    function (error) { },
                                                                                    function () { }
                                                                                  );
                                                                            },
                                                                            function (tx, error) {
                                                                              swal(
                                                                                "Error al eliminar Info_Equipo",
                                                                                error.message,
                                                                                "error"
                                                                              );
                                                                            }
                                                                          );
                                                                        },
                                                                        function (error) { },
                                                                        function () { }
                                                                      );
                                                                },
                                                                function (tx, error) {
                                                                  swal(
                                                                    "Error al eliminar Factor_Humano",
                                                                    error.message,
                                                                    "error"
                                                                  );
                                                                }
                                                              );
                                                            },
                                                            function (error) { },
                                                            function () { }
                                                          );
                                                    },
                                                    function (tx, error) {
                                                      swal(
                                                        "Error al eliminar Ciclo_Charola",
                                                        error.message,
                                                        "error"
                                                      );
                                                    }
                                                  );
                                                },
                                                function (error) { },
                                                function () { }
                                              );
                                        },
                                        function (tx, error) {
                                          swal(
                                            "Error al eliminar DG_PlatoL",
                                            error.message,
                                            "error"
                                          );
                                        }
                                      );
                                    },
                                    function (error) { },
                                    function () { }
                                  );
                            },
                            function (tx, error) {
                              swal(
                                "Error al eliminar cedulas_general",
                                error.message,
                                "error"
                              );
                            }
                          );
                        },
                        function (error) { },
                        function () { }
                    );
                } else if(empresa = 'Aliatonic'){
                    if(tipo_cedula == "VisitaPacas"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM datos_gene_aliatonic WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        $("#conc" + id_cedula).remove();
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                } else {
                    if(tipo_cedula == "levantamiento"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM levantamiento_servicio WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM levantamiento_evidencia WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar levantamiento servicio",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "fumigacion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM fumigacion WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM fotos_fumigacion WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                    if(tipo_cedula == "sanitizacion"){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("DELETE FROM sanitizacion WHERE id_cedula = ?",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM fotos_sanitizacion WHERE id_cedula = ?",
                                                                    [id_cedula],
                                                                    function(tx, results){
                                                                        $("#conc" + id_cedula).remove();
                                                                    },
                                                                    function(tx, error){
                                                                        swal("Error al eliminar sanitizacion",error.message,"error");
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        swal("Error al eliminar fumigacion",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al eliminar cedulas_general",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                }
            } else {

            }
        });
    }
    }

    function EliminarRegistrosAntiguos(){
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_ingreso = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        fecha_eliminar = editar_fecha(fecha_ingreso, "-11", "d","-");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM cedulas_general WHERE fecha_entrada > ? AND id_usuario = ? AND (estatus = 1 OR estatus = 2)",
                    [fecha_eliminar,id_usuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        for(var i = 0; i< length; i++){
                            var item2 = results.rows.item(i);
                            var id_eliminar = item2.IdCedula;
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql("DELETE FROM cedulas_general WHERE id_cedula = ?",
                                        [id_eliminar],
                                        function(tx4, results){
                                        },
                                        function(tx4, error){
                                            console.error("Error al eliminar cedula_general: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                            var empresa = localStorage.getItem("nombre_empresa");
                            if(empresa == "SMC"){
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar levantamiento SMC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar evidencia levantamiento SMC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM mantenimiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar mantenimiento SMC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia mantenimiento SMC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Bennetts2"){
                                if(tipo_cedula == "Cobranza"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM cobranza WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidenciaCobranza WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "CarnesIdeal"){
                                if(tipo == "Venta"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_ventas WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar datos_ventas: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM visitas_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar visitas_ci: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM prodcutos_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar prodcutos_ci: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM minuta_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar minuta_ci: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM visita_seguimiento WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar visita_seguimiento: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM cierre_seguimiento_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar cierre_seguimiento_ci: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar fotos_ci: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "Entrega"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_generales WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar datos_generales: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar fotos_ci: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_entrega_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar fotos_entrega_ci: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "Ruta"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_ci WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar datos_ci: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencias_carga WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al Eliminar evidencias_carga: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "MrFixer"){
                                if(tipo_cedula == "Bitacora"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_generales_MrFixer WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos generales rmfixer: " +error.message);}
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM insumos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar insumos rmfixer: " +error.message);}
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM bitacora WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar bitacora rmfixer: " +error.message);}
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM material_registrado WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar material reg rmfixer: " +error.message);}
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                            } else if(empresa == "BennettsL"){
                                if(tipo == "servicio_tecnico" || tipo == "logistica"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencias_bennettsL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidecias BennetssL: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM logistica_bennettsL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos_generales BennetssL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Dilimpio"){
                                if (tipo == "Entregas") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM DatosentregasDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar DatosentregasDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM entregasDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar entregasDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }else if (tipo == "Cobranza") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM DatoscobranzasDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar DatoscobranzasDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM cobranzasDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar cobranzasDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                } else if (tipo == "visitaDilimpio") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM visitaDilimpio WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar visitaDilimpio: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM equiposDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar equiposDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM imagenDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar imagenDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM entrenaDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar entrenaDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM almacenDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar almacenDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM pedidosDL WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar pedidosDL: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Field"){
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar levantamiento Field: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia levantamiento Field: " +error.message);}
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                }
                                if(tipo == "mantenimiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM mantenimiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Erro al eliminar mantenimiento Field: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar evidencia mantenimiento Field: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "Bennetts"){
                                if(tipo == "baja"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar productos Bennetts: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_productos WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion Bennetts: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "DIPREC"){
                                if(tipo == "reporteTecnico"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM servicio_tecnico WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar servicio tecnico DIPREC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_equipo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar al eliminar evidencia equipo: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo_antes WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo antes DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia_refacciones WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminarevidencia refacciones diprec: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM check_list WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error eliminar al check list DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM check_list2 WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar check list 2 DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_equipo_despues WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos equipo despues DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "minutaCoordinador"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM minuta_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar minuta coordonador DIPREC: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM zonas_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar zonas coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM equipos_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar equipos coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datos_coordinador WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datos coordinador DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM observaciones WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar observaciones DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM notas WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar notas DIPREC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            }  else if(empresa == "SURO"){
                                if(tipo == "sanitizacionSURO"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM sanitizacion_Suro WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar sanitizacion SURO: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion SURO: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "VIC"){
                                if (tipo == "ApoyoVIC") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM apoyo_bennetts WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar apoyo_bennetts VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_apoyo WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos_apoyo VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                } else if (tipo_cedula == "VentasVIC" || tipo_cedula == "VentasVIC_SinV" || tipo_cedula == "VentasVIC_ConV" || tipo_cedula == "VentasVIC_Acompa") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM ventas_bennetts WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) { },
                                                function(tx, error){
                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM minuta WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) { },
                                                function(tx, error){
                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM apoyo_venta_vic  WHERE id_cedula = ?",
                                                [id_cedula],
                                                function (tx, results) { },
                                                function(tx, error){
                                                    console.log("Error al guardar VENTAS: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                        tx.executeSql("DELETE FROM datos_contacto WHERE id_cedula = ?",
                                            [id_cedula],
                                            function (tx, results) {},
                                            function(tx, error){
                                                console.log("Error al guardar VENTAS: " + error.message);
                                            }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM proyectos_vic WHERE id_cedula = ?",
                                            [id_cedula],
                                                function (tx, results) { },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                } else if (tipo == "VIC") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM datosVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar datosVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM equiposVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar equiposVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM imagenVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar imagenVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM entrenaVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar entrenaVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM almacenVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar almacenVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM pedidosVIC WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar pedidosVIC VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM VIC_Fotos WHERE ID_Cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Fotos VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM VIC_Respuesta WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Respuesta VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else if(empresa == "ServInd"){
                               if (tipo_cedula == "Correctivo") {
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM visita_servInd WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Respuesta VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM refacciones WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Respuesta VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM papeleta WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Respuesta VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM checklist_servind WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar VIC_Respuesta VIC: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            } else {
                                if(tipo == "sanitizacion"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM sanitizacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar sanitizacion AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_sanitizacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos sanitizacion AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "levantamiento"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_servicio WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar levantamiento AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM levantamiento_evidencia WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos levantamiento AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                                if(tipo == "fumigacion"){
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fumigacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fumigacion AYB: " + error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("DELETE FROM fotos_fumigacion WHERE id_cedula = ?",
                                                [id_cedula],
                                                function(tx, results){},
                                                function(tx, error){console.log("Error al eliminar fotos fumigacion AYB: " +error.message);}
                                            );
                                        },function(error){},function(){}
                                    );
                                }
                            }
                        }

                    },
                    function(tx5, error){
                        console.log("Error al depurar registros: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionAntes(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_antes = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionAntesSani(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_antes = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDurante(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_durante = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDuranteSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_durante = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDespues(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET descripcion_despues = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDescripcionDespuesSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var descripcion = $('#descripcion').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET descripcion_despues = ? WHERE id_cedula = ?",
                    [descripcion,id_cedula],
                    function(tx, results){
                        swal("","Descripcion guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function capturePhotoSS1() {
        navigator.camera.getPicture(onSSinglePhotoSucceess1, onSSinglePhotoFail1, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function captureSingleSMC() {
        navigator.camera.getPicture(onSinglePhotoSMCSucceess, onSinglePhotoSMCFail, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSMCSucceess(imageData) {
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoSMCFail(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 1
    function onSSinglePhotoSucceess1(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_quimico = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto quimico fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail1(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhotoSS2() {
        navigator.camera.getPicture(onSSinglePhotoSucceess2, onSSinglePhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSSinglePhotoSucceess2(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_equipo = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto equipo fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function capturePhotoSS3() {
        navigator.camera.getPicture(onSSinglePhotoSucceess3, onSSinglePhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSSinglePhotoSucceess3(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET foto_reporte = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto del reporte fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onSSinglePhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    //Fumigacion single photo
    function capturePhotoS1() {
        navigator.camera.getPicture(onSinglePhotoSucceess1, onSinglePhotoFail1, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    // Imagen sola 1
    function onSinglePhotoSucceess1(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage1');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC1").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_quimico = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto quimico fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon1").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail1(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 2
    function capturePhotoS2() {
        navigator.camera.getPicture(onSinglePhotoSucceess2, onSinglePhotoFail2, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSucceess2(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage2');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC2").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_equipo = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto equipo fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon2").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail2(message) {
        swal("Error al tomar foto:",message,"error");
    }
    // Imagen sola 3
    function capturePhotoS3() {
        navigator.camera.getPicture(onSinglePhotoSucceess3, onSinglePhotoFail3, {
          quality: 50,
          destinationType: destinationType.DATA_URL,
          targetWidth: 500,
          targetHeight: 500,
          correctOrientation: true
        });
    }
    function onSinglePhotoSucceess3(imageData) {
        var id_cedula = localStorage.getItem("IdCedula");
        var smallImage = document.getElementById('smallImage3');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC3").val(nameima);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET foto_reporte = ? WHERE id_cedula = ?",
                    [nameima,id_cedula],
                    function(tx, results){
                        swal("","Foto del reporte fue guardada correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
        $("#photoIcon3").attr("src","img/reload.svg");
    }
    function onSinglePhotoFail3(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function guardarAntesFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $("#imagenC1").val() == "" || $("#imagenC2").val() == "" || $("descripcion").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "antes";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla_fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarAntesSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#imagenC1').val() == "" || $('#descripcion').val() == "" || ($("#DespejadoSi").prop("checked") == false && $("#DespejadoNo").prop("checked") == false)){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "antes";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla_sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar area guardada",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Area guardada","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar area",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDuranteFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == "") {
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "durante";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-durante-fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDuranteSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "durante";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-durante-sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDespuesSanitizacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#imagenC3').val() == "" || $('#descripcion').val() =="" || $('#productoUtilizado').val() ==""){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "despues";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_sanitizacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_sanitizacion_foto) as Id from fotos_sanitizacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_sanitizacion where id_sanitizacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-despues-sanitizacion tbody").append("<tr id='fila"+ item.id_sanitizacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_sanitizacion_foto +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDespuesFumigacion(){
        app.preloader.show('blue');
        if($("#nombreArea").val() == "" || $('#imagenC').val() == "" || $('#descripcion').val() == "" || $('#productoUtilizado').val() == "" || $('#imagenC3').val() == "" || $('#tipoAplicacion').val() == "0" || $('#gradoInfestacion').val() == "0" || ($("#MantenimientoSi").prop("checked") == false && $("#MantenimientoNo").prop("checked") == false)){
            swal("","Todos los campos son obligatorios","warning");
            app.preloader.hide();
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var area = $("#nombreArea").val();
        var foto_area = $('#imagenC').val();
        var fase = "despues";
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_fumigacion(id_cedula,fase,foto_area,nombre_area,fecha_foto) VALUES (?,?,?,?,?)",
                    [id_cedula,fase,foto_area,area,fecha_registro],
                    function(tx, results){
                        app.preloader.hide();
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select MAX(id_fumigacion_foto) as Id from fotos_fumigacion",
                                    [],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        var id_evidencia = item.Id;
                                        app.preloader.hide();
                                        //Consultar el producto
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_fumigacion where id_fumigacion_foto = ?",
                                                [id_evidencia],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#nombreArea").val("");
                                                        $('#imagenC').val("");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#nombreArea").css("background-color", "#FFFFFF");
                                                        $("#tabla-despues-fumigacion tbody").append("<tr id='fila"+ item.id_fumigacion_foto +"'><td><a href='#' onclick='eliminarFila("+ item.id_fumigacion_foto +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto_area+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.nombre_area + "</td><td style='text-align: center;'>" + item.fecha_foto + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al mostrar Registro guardado",error.message,"error");
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                        swal("","Registro guardado","success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarProductoFumigacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var productoUtilizado = $('#productoUtilizado').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET producto_utilizado = ? WHERE id_cedula = ?",
                    [productoUtilizado,id_cedula],
                    function(tx, results){
                        swal("","El producto utilizado fue guardado correctamente","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveTipoAplicacion(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "Aspersión";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 2){
            var message = "Microinyección";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 3){
            var message = "Nebulización";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 4){
            var message = "Espolvoreo";
            $("#tipo_aplicacion").val(message);
        } else if(valor == 5){
            var message = "Gel";
            $("#tipo_aplicacion").val(message);
        } else {
            var message = "";
            $("#tipo_aplicacion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET tipo_aplicacion = ?,descripcion_tipo = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un tipo de aplicación valido","warning");
                        } else {
                            swal("", "Se guardo el tipo de aplicación","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function saveGradoInfestacion(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if(valor == 1){
            var message = "Sin Actividad";
            $("#grado_infestacion").val(message);
        } else if(valor == 2){
            var message = "Baja";
            $("#grado_infestacion").val(message);
        } else if(valor == 3){
            var message = "Media";
            $("#grado_infestacion").val(message);
        } else if(valor == 4){
            var message = "Alta";
            $("#grado_infestacion").val(message);
        } else {
            var message = "";
            $("#grado_infestacion").val("");
        }
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET grado_infestacion = ?,descripcion_infestacion = ? WHERE id_cedula = ?",
                    [valor,message,id_cedula],
                    function(tx, results){
                        if(valor == 0){
                            swal("","Debes seleccionar un grado de infestación valido","warning");
                        } else {
                            swal("", "Se guardo el el grado de infestación","success");
                        }
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function mantenimientoSi(valor){
        if($("#MantenimientoNo").prop("checked") === true){
            $("#MantenimientoNo").prop("checked", false);
        }
        if(!$(valor).prop('checked')){
            $('#detalle_container').css("display","none");
        }else{
            $('#detalle_container').css("display","block");
        }
    }
    function guardarDetalleMantenimiento(){
        var id_cedula = localStorage.getItem("IdCedula");
        var mantenimiento = 1;
        var detalle = $('#detalle').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET mantenimiento = ?,detalle_mantenimiento = ? WHERE id_cedula = ?",
                    [mantenimiento,detalle,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo el mantenimiento","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function mantenimientoNo(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#MantenimientoSi").prop("checked") === true){
            $("#MantenimientoSi").prop("checked", false);
            $('#detalle_container').css("display","none");
        }
        if(!$(valor).prop('checked')){

        }else{
            var mantenimiento = 0;
            var detalle = "";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE fumigacion SET mantenimiento = ?,detalle_mantenimiento = ? WHERE id_cedula = ?",
                        [mantenimiento,detalle,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el mantenimiento","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function despejadoSi(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#DespejadoNo").prop("checked") === true){
            $("#DespejadoNo").prop("checked", false);
        }
        if(!$(valor).prop('checked')){

        }else{
            var despejado = 1;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE sanitizacion SET areas_despejadas = ? WHERE id_cedula = ?",
                        [despejado,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el estado area y limpieza","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function despejadoNo(valor){
        var id_cedula = localStorage.getItem("IdCedula");
        if($("#DespejadoSi").prop("checked") === true){
            $("#DespejadoSi").prop("checked", false);
        }
        if(!$(valor).prop('checked')){

        }else{
            var despejado = 0;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE sanitizacion SET areas_despejadas = ? WHERE id_cedula = ?",
                        [despejado,id_cedula],
                        function(tx, results){
                            swal("", "Se guardo el estado area y limpieza","success");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarRecomendacionesFumigacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var recomendaciones = $('#recomendaciones').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE fumigacion SET recomendaciones = ? WHERE id_cedula = ?",
                    [recomendaciones,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo la recomendacion","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarRecomendacionesSanitizacion(){
        var id_cedula = localStorage.getItem("IdCedula");
        var recomendaciones = $('#recomendaciones').val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion SET recomendaciones = ? WHERE id_cedula = ?",
                    [recomendaciones,id_cedula],
                    function(tx, results){
                        swal("", "Se guardo la recomendacion","success");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function llevarTodo(id_cedula,tipo_cedula){
        //Aqio va el ajax (tipo de cedula,id_usuario y id_empresa)
        var datos = new Array();
        var id_usuario = localStorage.getItem("id_usuario");
        var id_empresa = localStorage.getItem("id_empresa");
        var versionapp = '7.3.19';
        datos[0] = {'id_usuario':id_usuario,'id_empresa':id_empresa,'tipo_cedula':tipo_cedula,'versionapp':versionapp};
        $.ajax({
            type: "POST",
            async : true,
            url: "http://www.appbennetts.com/FWM2/app/guardarEnvioCedula.php",
            dataType: 'html',
            data: {'datos': JSON.stringify(datos)},
            success: function(respuesta){
            },
            error: function(){
                console.log("Error en la comunicacion con el servidor");
            }
        });
        swal("Enviando!", "Puedes serguir usando la aplicación!", "success");
        var empresa = localStorage.getItem("nombre_empresa");
        if(empresa == "SMC"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var datosVenta = new Array();
            var evidenciaVenta = new Array();
            var datosEquipoVenta = new Array();

            var datosServicio = new Array();
            var evidenciaServicio = new Array();
            var datosEquipoServicio = new Array();

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_smc WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_visita':item2.id_visita,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'tipo_motor':item2.tipo_motor,'tipo_boquilla':item2.tipo_boquilla,'tipo_combustible':item2.tipo_combustible,'tipo_mastil':item2.tipo_mastil,'comentario_equipo':item2.comentario_equipo,'lugar_reparacion':item2.lugar_reparacion,'reparo_visita':item2.reparo_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'odometro':item2.odometro,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_levantamiento_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observacion,'foto_observacion': item3.foto_observacion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamientoSMC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM mantenimiento_smc WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMantenimiento[mantenimiento] = {'Valor':mantenimiento,'id_visita':item2.id_visita,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_servicio':item2.tipo_servicio,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'foto_equipo':item2.foto_equipo,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'odometro':item2.odometro,'fecha_envio':fecha_envio};
                                                    mantenimiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_mantenimiento_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaMantenimiento[evidenciamant] = {'Valor':evidenciamant,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto_decripcion': item3.foto_decripcion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidenciamant++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMantenimientoSMC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosMantenimiento': JSON.stringify(datosMantenimiento),'evidenciaMantenimiento': JSON.stringify(evidenciaMantenimiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "ventaSMC"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM ventaSMC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosVenta[i] = {'id_cedula':item2.id_cedula,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'id_visita':item2.id_visita,'nombre_cliente':item2.nombre_cliente,'rfc_cliente':item2.rfc_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_visita':item2.tipo_visita,'comentario_antes':item2.comentario_antes,'comentario_despues':item2.comentario_despues,'objetivo_prospeccion': item2.objetivo_prospeccion, 'necesidad_prospeccion': item2.necesidad_prospeccion, 'marca_montacargas_prospeccion': item2.marca_montacargas_prospeccion,'numero_montacargas_prospeccion': item2.numero_montacargas_prospeccion,'status_montacarga_prospeccion': item2.status_montacarga_prospeccion,'venc_contrato':item2.venc_contrato, 'marca_llantas_prospeccion': item2.marca_llantas_prospeccion,'tipo_llantas_prospeccion': item2.tipo_llantas_prospeccion,'mediadas_prospeccion': item2.mediadas_prospeccion,'resolvio_prospeccion': item2.resolvio_prospeccion,'por_que_prospeccion':item2.por_que_prospeccion,'vista_prospeccion': item2.vista_prospeccion, 'cuando_prospeccion': item2.cuando_prospeccion,'presente_prospeccion': item2.presente_prospeccion, 'cuales_prospeccion': item2.cuales_prospeccion,'copetencia_prospeccion': item2.copetencia_prospeccion,'sugerencia_prospeccion': item2.sugerencia_prospeccion,'comentarios_prospeccion': item2.comentarios_prospeccion,'no_activo':item2.no_activo,'no_contrato':item2.no_contrato,'conclusion_servicio':item2.conclusion_servicio,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_venta_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaVenta[i] = {'id_cedula': item3.id_cedula,'fase': item3.fase,'comentario': item3.comentario,'foto': item3.foto,'comentario': item3.comentario,'fecha_regristro': item3.fecha_regristro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_equipo_smc WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    datosEquipoVenta[i] = {'id_cedula': item4.id_cedula,'marca': item4.marca,'tipo_motor': item4.tipo_motor,'marca_motor': item4.marca_motor,'modelo': item4.modelo,'serie': item4.serie,'aditamentos': item4.aditamentos};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarVentaSMC.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosVenta': JSON.stringify(datosVenta),'evidenciaVenta': JSON.stringify(evidenciaVenta),'datosEquipoVenta': JSON.stringify(datosEquipoVenta)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "servicioSMC"){
                                console.log(tipo)
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM servicioSMC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosServicio[i] = {'id_cedula':item2.id_cedula,'orden_servicio':item2.orden_servicio,'foto_entrada':item2.foto_entrada,'id_visita':item2.id_visita,'nombre_cliente':item2.nombre_cliente,'rfc_cliente':item2.rfc_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_visita':item2.tipo_visita,'comentario_antes':item2.comentario_antes,'comentario_despues':item2.comentario_despues,'observaciones_prospeccion':item2.observaciones_prospeccion,'estado_monta':item2.estado_monta,'numero_monta':item2.numero_monta,'tipo_monta':item2.tipo_monta,'marca':item2.marca,'mantenimiento':item2.mantenimiento,'no_activo':item2.no_activo,'no_contrato':item2.no_contrato,'conclusion_servicio':item2.conclusion_servicio,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_servicio_smc WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaServicio[i] = {'id_cedula': item3.id_cedula,'fase': item3.fase,'comentario': item3.comentario,'foto': item3.foto,'fecha_regristro': item3.fecha_regristro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_servicio_smc WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    datosEquipoServicio[i] = {'id_cedula': item4.id_cedula,'marca': item4.marca,'tipo_motor': item4.tipo_motor,'marca_motor': item4.marca_motor,'modelo': item4.modelo,'serie': item4.serie,'aditamentos': item4.aditamentos,'odometro':item4.odometro};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarServicioSMC.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosServicio': JSON.stringify(datosServicio),'evidenciaServicio': JSON.stringify(evidenciaServicio),'datosEquipoServicio': JSON.stringify(datosEquipoServicio)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "sales_suro"){
            var estatus_proyecto=0;
            var datosCedulaGeneral = new Array();
            var apoyoBennetts = new Array();
            var fotosApoyo = new Array();
            var ventasBennetts = new Array();
            var minuta = new Array();
            var proyectosVic = new Array();
            //VIC new
            var datosVIC = new Array();
            var equiposVIC = new Array();
            var equiposCVIC = new Array();
            var imagenVIC = new Array();
            var entrenaVIC = new Array();
            var almacenVIC = new Array();
            var pedidosVIC = new Array();

            var apoyo = new Array();
            var datosClientes = new Array();

            var rol = localStorage.getItem("rol");
            var roles = rol.split("-");
            var empresa1=roles[1];

            var usuario;

            var div = localStorage.getItem("division");

            var respuesta = new Array();
            var fotos = new Array();
            //VIC new
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                usuario=item.id_usuario;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,
                                'tipo_cedula':item.tipo_cedula,
                                'id_usuario':item.id_usuario,
                                'nombre_usuario':item.nombre_usuario,
                                'fecha_entrada':item.fecha_entrada,
                                'geolocalizacion_entrada': item.geolocalizacion_entrada,
                                'id_cliente': item.id_cliente,
                                'nombre_cliente': item.nombre_cliente,
                                'horario_programado': item.horario_programado,
                                'calificacion': item.calificacion,
                                'fecha_salida':item.fecha_salida,
                                'geolocalizacion_salida':item.geolocalizacion_salida,
                                'nombre_evalua':item.nombre_evalua,
                                'comentario_cliente':item.comentario_cliente,
                                'fecha_envio':fecha_envio};
                            }
                        if (tipo == "VentasVIC" || tipo == "VentasVIC_SinV" || tipo == "VentasVIC_ConV" ){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * FROM ventas_bennetts_SS WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            var length = results.rows.length;
                                            var fecha = new Date();
                                            var fecha_envio = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
                                            for (var i = 0; i < length; i++) {
                                                var item2 = results.rows.item(i);
                                                ventasBennetts[i] = {
                                                    'Valor': i, 'id_ventas': item2.id_ventas,
                                                    'id_cedula': item2.id_cedula,
                                                    'foto_inicio': item2.foto_inicio,
                                                    'nombre_cliente': item2.nombre_cliente,
                                                    'puesto_cliente': item2.puesto_cliente,
                                                    'telefono': item2.telefono,
                                                    'correo': item2.correo,
                                                    'firma_cliente': item2.firma_cliente,
                                                    'foto_salida': item2.foto_salida,
                                                    'id_proyecto': item2.id_proyecto,
                                                    'tipo_visita': item2.tipo_visita,
                                                    'foto_visita': item2.foto_visita,
                                                    'nivel': item2.nivel,
                                                    'pendiente_vendedor': item2.pendiente_vendedor,
                                                    'actividadSelect': item2.actividadSelect
                                                };
                                            }
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("SELECT * from minuta_SS WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function (tx, results) {
                                                            var length = results.rows.length;
                                                            for (var i = 0; i < length; i++) {
                                                                var item3 = results.rows.item(i);
                                                                minuta[i] = {
                                                                    'Valor': i,
                                                                    'id_minuta': item3.id_minuta,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'tema': item3.tema,
                                                                    'compromiso': item3.compromiso,
                                                                    'fecha': item3.fecha,
                                                                    'foto': item3.foto,
                                                                    'fecha_foto': item3.fecha_foto,
                                                                    'h_inicio': item3.h_inicio,
                                                                    'h_fin':item3.h_fin
                                                                };
                                                            }
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("SELECT * from datos_contacto_SS  WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                function (tx, results) {
                                                                                    var length = results.rows.length;
                                                                                    for (var i = 0; i < length; i++) {
                                                                                        var item6 = results.rows.item(i);
                                                                                        datosClientes[i] = {
                                                                                            'Valor': i,
                                                                                            'id_proyecto': item6.id_proyecto,
                                                                                            'nombre_cliente': item6.nombre_cliente,
                                                                                            'puesto_cliente': item6.puesto_cliente,
                                                                                            'telefono': item6.telefono,
                                                                                            'correo': item6.correo
                                                                                        };
                                                                                    }
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx){
                                                                                            tx.executeSql("SELECT * from proyectos_vic_SS where id_proyecto = ?",
                                                                                            [item.id_cliente],
                                                                                            function (tx, results) {
                                                                                                var length = results.rows.length;
                                                                                                for (var i = 0; i < length; i++) {
                                                                                                    var item4 = results.rows.item(i);
                                                                                                    proyectosVic[i] = {
                                                                                                        'Valor': i,
                                                                                                        'id_proyecto': item4.id_proyecto,
                                                                                                        'id_usuario': item4.id_usuario,
                                                                                                        'nombre_proyecto': item4.nombre_proyecto,
                                                                                                        'potencial': item4.potencial,
                                                                                                        'segmento': item4.segmento,
                                                                                                        'fecha_creacion': item4.fecha_creacion,
                                                                                                        'division': item4.division,
                                                                                                        'estrategia': item4.estrategia,
                                                                                                        'estatus': item4.estatus,
                                                                                                        'metodo': item4.metodo,
                                                                                                        'grupo': item4.grupo,
                                                                                                        'enviado': item4.enviado,
                                                                                                        'nivel' :item4.nivel
                                                                                                    };
                                                                                                }
                                                                                                console.log('datosC', datosClientes);
                                                                                                console.log('datog', datosCedulaGeneral);
                                                                                                console.log('ventas', ventasBennetts);
                                                                                                console.log('minuta', minuta);
                                                                                                console.log('proyectosVic', proyectosVic);
                                                                                                $.ajax({
                                                                                                    type: "POST",
                                                                                                    async: true,
                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarDatosVentasSales_suro_D.php",
                                                                                                    dataType: 'html',
                                                                                                    data: {
                                                                                                        'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                        'ventasBennetts': JSON.stringify(ventasBennetts),
                                                                                                        'minuta': JSON.stringify(minuta),
                                                                                                        'proyectosVic': JSON.stringify(proyectosVic),
                                                                                                        'datosClientes': JSON.stringify(datosClientes)
                                                                                                    },
                                                                                                    success: function (respuesta) {
                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                        console.log(respuesta);
                                                                                                        var dat1 = respu1[0];
                                                                                                        var dat2 = respu1[1];
                                                                                                        if (dat1 == "CEDULA") {
                                                                                                            if (dat2 > 0) {
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function (tx7) {
                                                                                                                        tx7.executeSql(
                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function (tx7, results) {
                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                $.ajax({
                                                                                                                                    type: "POST",
                                                                                                                                    async : true,
                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/ARCHIVOSJSONS/Sales_suro-Gestion.php",
                                                                                                                                    dataType: 'html',
                                                                                                                                    data: {'datos': JSON.stringify(datos)},
                                                                                                                                    success: function(respuesta){
                                                                                                                                        window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function(oEntry) {
                                                                                                                                            var jsonHijos = new download();
                                                                                                                                            jsonHijos.Initialize({
                                                                                                                                              fileSystem : cordova.file.dataDirectory,
                                                                                                                                              folder: "jsons",
                                                                                                                                              remove: false,
                                                                                                                                              timeout: 0,
                                                                                                                                              success: DownloaderSuccess,
                                                                                                                                              error: DownloaderError,
                                                                                                                                              headers: [
                                                                                                                                                {
                                                                                                                                                  key : "Cache-Control",
                                                                                                                                                  Value: "no-store"
                                                                                                                                                }
                                                                                                                                              ]
                                                                                                                                            });
                                                                                                                                            jsonHijos.Get("http://appbennetts.com/FWM2/app/ARCHIVOSJSONS/Gestion-SE-VIC.json");
                                                                                                                                            function DownloaderSuccess() {}
                                                                                                                                            function DownloaderError(err) {
                                                                                                                                              console.log(err);
                                                                                                                                            }
                                                                                                                                        });
                                                                                                                                    },
                                                                                                                                    error: function(){
                                                                                                                                        console.log("Error en la comunicacion con el servidor");
                                                                                                                                    }
                                                                                                                                });
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function (tx8) {
                                                                                                                                        tx8.executeSql(
                                                                                                                                            "UPDATE proyectos_vic SET enviado = 1 WHERE id_usuario = ?",
                                                                                                                                            [id_usuarioP],
                                                                                                                                            function (tx8, results) {

                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    }
                                                                                                                                );
                                                                                                                                RecargarJSON_SALES_Suro();
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                );
                                                                                                            }
                                                                                                        } else {
                                                                                                            AlmacenarError(respuesta);
                                                                                                        }

                                                                                                    },
                                                                                                    error: function () {
                                                                                                        console.log(respuesta);
                                                                                                        console.log("Error en la comunicacion");
                                                                                                    }
                                                                                                });
                                                                                                },
                                                                                                function(tx, error){
                                                                                                    console.log("Error al guardar cedula: " + error.message);
                                                                                                    app.preloader.hide();
                                                                                                }
                                                                                            );
                                                                                        },
                                                                                        function(error){},
                                                                                        function(){}
                                                                                    );

                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al guardar VENTAS: " + error.message);
                                                                                        app.preloader.hide();
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );


                                                        },
                                                        function(tx, error){
                                                            console.log("Error al guardar VENTAS: " + error.message);
                                                            app.preloader.hide();
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            console.log("Error al guardar VENTAS: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        } else if(tipo == "VentasVIC_Acompa"){
                                console.log('Entro ACOMPA')
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * from apoyo_venta_vic_SS  WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            var length = results.rows.length;
                                            for (var i = 0; i < length; i++) {
                                                var item5 = results.rows.item(i);
                                                apoyo[i] = {
                                                    'Valor': i,
                                                    'proyecto': item5.proyecto,
                                                    'companero': item5.companero,
                                                    'comentario': item5.comentario,
                                                    'fecha': item5.fecha
                                                };
                                            }
                                            $.ajax({
                                                type: "POST",
                                                async: true,
                                                url: "http://www.appbennetts.com/FWM2/app/guardarDatosVentasSales_suro_D.php",
                                                dataType: 'html',
                                                data: {
                                                    'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                    'apoyo': JSON.stringify(apoyo)
                                                },
                                                success: function (respuesta) {
                                                    var respu1 = respuesta.split("._.");
                                                    console.log(respuesta);
                                                    var dat1 = respu1[0];
                                                    var dat2 = respu1[1];
                                                    if (dat1 == "CEDULA") {
                                                        if (dat2 > 0) {
                                                            databaseHandler.db.transaction(
                                                                function (tx7) {
                                                                    tx7.executeSql(
                                                                        "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                        [id_cedula],
                                                                        function (tx7, results) {
                                                                            localStorage.setItem("sendFlag", 0);
                                                                            swal("Enviado!", "Ya se envio tu visita!", "success");

                                                                        }
                                                                    );
                                                                }
                                                            );
                                                        }
                                                    } else {
                                                        AlmacenarError(respuesta);
                                                    }

                                                },
                                                error: function () {
                                                    console.log(respuesta);
                                                    console.log("Error en la comunicacion");
                                                }
                                            });
                                        },///in
                                        function(tx, error){
                                            console.log("Error al guardar VENTAS: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );//termina
                        }
                    },
                    function(tx, error){
                        console.log("Error al consultar datos generales: " + error.message);
                    }
                );
            },
            function(error){
                console.log("Error: " + error.message);
            },
            function(){}
        );

        } else if(empresa == "Rocadi"){
            var datosCedulaGeneral = new Array();
            var datosGenerales = new Array();
            var fotos_rocadi = new Array();
            var checklist = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "Checklist"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM fotos_rocadi WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    fotos_rocadi[i] = {'Valor':i,'foto':item2.foto,'observaciones':item2.observaciones,'page':item2.page,'fecha_registro':item2.fecha_registro};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from checks_rocadi WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    checklist[i] = {'Valor':i,'apartado': item3.apartado,'value':item3.value,'page':item3.page,'fecha_registro':item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_generales_rocadi WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item3 = results.rows.item(i);
                                                                                    datosGenerales[i] = {'Valor':i,'foto_entrada': item3.foto_entrada,
                                                                                    'firma_cliente':item3.firma_cliente,'fecha_cliente':item3.fecha_cliente,'foto_salida':item3.foto_salida,'nombre_sitio':item3.nombre_sitio,'fecha':item3.fecha};
                                                                                }
                                                                                console.log(fotos_rocadi);
                                                                                console.log(checklist);
                                                                                console.log(datosGenerales);
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarRocadiChecklist.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                    'fotos_rocadi': JSON.stringify(fotos_rocadi),
                                                                                    'checklist': JSON.stringify(checklist),
                                                                                    'datosGenerales': JSON.stringify(datosGenerales)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "BennettsL"){
            var datosCedulaGeneral = new Array();
            var datosGenerales = new Array();
            var evidencias = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "logistica" || tipo == "servicio_tecnico"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM evidencias_bennettsL WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    evidencias[i] = {'Valor':i,'comentario':item2.comentario,'foto':item2.foto,'fecha':item2.fecha,'page':item2.page,'no_llamada':item2.no_llamada};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from logistica_bennettsL WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosGenerales[i] = {'Valor':i,'foto_entrada': item3.foto_entrada,'firma_cliente':item3.firma_cliente,'fecha_cliente':item3.fecha_cliente,'nocliente':item3.nocliente,'razon_social':item3.razon_social,'nombre_recibe':item3.nombre_recibe,'segundo_nombre':item3.segundo_nombre,'apellido':item3.apellido,'puesto':item3.puesto,'correo':item3.correo,'telefono_1':item3.telefono_1,'telefono_2':item3.telefono_2,'calle':item3.calle,'no_exterior':item3.no_exterior,'no_interior':item3.no_interior,
                                                                    'colonia':item3.colonia,'ciudad':item3.ciudad,'cp':item3.cp,'alcadia':item3.alcadia,'estado':item3.estado,'acceso_proveedor':item3.acceso_proveedor,'OC':item3.OC,'OC_copias':item3.OC_copias,'factura':item3.factura,'factura_copias':item3.factura_copias,'SUA':item3.SUA,'SUA_copias':item3.SUA_copias,'TIA':item3.TIA,'TIA_copias':item3.TIA_copias,'otro_doc':item3.otro_doc,'otro_doc_copias':item3.otro_doc_copias,
                                                                    'permiso':item3.permiso,'correo1':item3.correo1,'correo1_campo':item3.correo1_campo,'medio1':item3.medio1,'medio1_campo':item3.medio1_campo,'otro_med1':item3.otro_med1,'otro_med1_campo':item3.otro_med1_campo,'dias_solicitud':item3.dias_solicitud,'cita':item3.cita,'correo2':item3.correo2,'correo2_campo':item3.correo2_campo,'medio2':item3.medio2,'medio2_campo':item3.medio2_campo,'otro_med2':item3.otro_med2,'otro_med2_campo':item3.otro_med2_campo,'dias_anticipacion':item3.dias_anticipacion,'entrada_almacen':item3.entrada_almacen,'folio_recepcion':item3.folio_recepcion,'contra_recibo':item3.contra_recibo,'firma_sello':item3.firma_sello,
                                                                    'recibido_factura':item3.recibido_factura,'persona_autorizada':item3.persona_autorizada,'sello_cliente':item3.sello_cliente,'oc3':item3.oc3,'id3':item3.id3,'otro3':item3.otro3,'ninguno':item3.ninguno,'cofia':item3.cofia,'zapato_seguridad':item3.zapato_seguridad,'chaleco':item3.chaleco,'otro4':item3.otro4,'otros_requisitos':item3.otros_requisitos,'dias':item3.dias,'horas_I':item3.horas_I,'horas_F':item3.horas_F,'horasS_I':item3.horasS_I,'horasS_F':item3.horasS_F,
                                                                    'motivo':item3.motivo,'motivo_desc':item3.motivo_desc,'devoluciones':item3.devoluciones,'motivo_devolucion':item3.motivo_devolucion,'devolucion_desc':item3.devolucion_desc};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarBennetts3Logis.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                    'evidencias': JSON.stringify(evidencias),
                                                                    'datosGenerales': JSON.stringify(datosGenerales)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Zona04"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;
            var datosG = new Array();
            var datosProspeccion = new Array();
            var encuesta = new Array();
            var renta = new Array();
            var venta = new Array()
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Prospeccion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM prospeccion_zona WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosProspeccion[i] = {'Valor':i,
                                                        'nombre_cliente':item2.nombre_cliente,
                                                        'correo':item2.correo,
                                                        'telefono':item2.telefono,
                                                        'direccion':item2.direccion,
                                                        'tipo_inmueble':item2.tipo_inmueble,
                                                        'otro_inmuble':item2.otro_inmuble,
                                                        'caracteristicas_generales':item2.caracteristicas_generales,
                                                        'firma_cliente':item2.firma_cliente,
                                                        'fecha_cliente':item2.fecha_cliente,
                                                        'foto_salida':item2.foto_salida,
                                                        'foto_entrada':item2.foto_entrada
                                                    };
                                                }
                                                $.ajax({
                                                    type: "POST",
                                                    async : true,
                                                    url: "http://www.appbennetts.com/FWM2/app/guararZonaProspeccion.php",
                                                    dataType: 'html',
                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                             'datosProspeccion': JSON.stringify(datosProspeccion)
                                                            },
                                                    success: function(respuesta){
                                                        var respu1 = respuesta.split("._.");
                                                        var dat1 = respu1[0];
                                                        var dat2 = respu1[1];
                                                        if(dat1 == "CEDULA"){
                                                            if(dat2 > 0){
                                                                databaseHandler.db.transaction(
                                                                    function(tx7){
                                                                        tx7.executeSql(
                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx7, results){
                                                                                localStorage.setItem("sendFlag", 0);
                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                            }
                                                                        );
                                                                    }
                                                                );
                                                            }
                                                        }else{
                                                            AlmacenarError(respuesta);
                                                        }
                                                    },
                                                    error: function(){
                                                        console.log("Error en la comunicacion");
                                                    }
                                                });
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "Clientes_zona"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datosG_zona WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosG[i] = {'Valor':i,
                                                        'id_visita':item2.id_visita,
                                                        'nombre':item2.nombre,
                                                        'celular':item2.celular,
                                                        'correo':item2.correo,
                                                        'tipo':item2.tipo,
                                                        'tipo_otro':item2.tipo_otro,
                                                        'presupuesto':item2.presupuesto,
                                                        'porque':item2.porque,
                                                        'porqueotro':item2.porqueotro,
                                                        'tipo_inmueble':item2.tipo_inmueble,
                                                        'otro_inmueble':item2.otro_inmueble,
                                                        'tipo_operacion':item2.tipo_operacion,
                                                        'alcaldia':item2.alcaldia,
                                                        'ubicacion':item2.ubicacion,
                                                        'caracteristicas_inmueble':item2.caracteristicas_inmueble,
                                                        'propiedad':item2.propiedad,
                                                        'clave':item2.clave,
                                                        'dia':item2.dia,
                                                        'hora':item2.hora,
                                                        'asesor_asigando':item2.asesor_asigando,
                                                        'asesor_muestra':item2.asesor_muestra,
                                                        'calle':item2.calle,
                                                        'no_exterior':item2.no_exterior,
                                                        'no_interior':item2.no_interior,
                                                        'colonia':item2.colonia,
                                                        'ciudad':item2.ciudad,
                                                        'cp':item2.cp,
                                                        'firma_cliente':item2.firma_cliente,
                                                        'foto_salida':item2.foto_salida,
                                                        'fecha_cliente':item2.fecha_cliente
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * FROM encuestas_zona WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    encuesta[i] = {'Valor':i,
                                                                        'id_visita':item2.id_visita,
                                                                        'fecha_registro':item3.fecha_registro,
                                                                        'nombre_cliente_en':item3.nombre_cliente_en,
                                                                        'asesor_en':item3.asesor_en,
                                                                        'inmueble_en':item3.inmueble_en,
                                                                        'clave_EB_en':item3.clave_EB_en,
                                                                        'ubicacion':item3.ubicacion,
                                                                        'conservacion':item3.conservacion,
                                                                        'espacios':item3.espacios,
                                                                        'aspecto':item3.aspecto,
                                                                        'distrubucion':item3.distrubucion,
                                                                        'precio_comparado':item3.precio_comparado,
                                                                        'comentarios_inmueble':item3.comentarios_inmueble,
                                                                        'despues_visita':item3.despues_visita,
                                                                        'consideracion_servicios':item3.consideracion_servicios,
                                                                        'comentario_sugerencia':item3.comentario_sugerencia
                                                                    };
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * FROM venta_zona WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    venta[i] = {'Valor':i,
                                                                                        'id_visita':item2.id_visita,
                                                                                        'fecha_registro':item4.fecha_registro,
                                                                                        'calle_v':item4.calle_v,
                                                                                        'no_exterior_v':item4.no_exterior_v,
                                                                                        'no_interior_v':item4.no_interior_v,
                                                                                        'colonia_v':item4.colonia_v,
                                                                                        'alcadia_v':item4.alcadia_v,
                                                                                        'ciudad_v':item4.ciudad_v,
                                                                                        'cp_v':item4.cp_v,
                                                                                        'precio_venta_v':item4.precio_venta_v,
                                                                                        'precio_letra_v':item4.precio_letra_v,
                                                                                        'forma_pago_v':item4.forma_pago_v,
                                                                                        'nombre_compra_v':item4.nombre_compra_v,
                                                                                        'apartado_v':item4.apartado_v,
                                                                                        'anticipo_contrato_v':item4.anticipo_contrato_v,
                                                                                        'monto_restante_v':item4.monto_restante_v,
                                                                                        'cuando_contrato_v':item4.cuando_contrato_v,
                                                                                        'observaciones':item4.observaciones
                                                                                    };
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * FROM renta_zona WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    renta[i] = {'Valor':i,
                                                                                                        'id_visita':item2.id_visita,
                                                                                                        'fecha_registro':item5.fecha_registro,
                                                                                                        'calle_r':item5.calle_r,
                                                                                                        'no_exterior_r':item5.no_exterior_r,
                                                                                                        'no_interior_r':item5.no_interior_r,
                                                                                                        'colonia_r':item5.colonia_r,
                                                                                                        'alcadia_r':item5.alcadia_r,
                                                                                                        'ciudad_r':item5.ciudad_r,
                                                                                                        'cp_r':item5.cp_r,
                                                                                                        'precio_venta_r':item5.precio_venta_r,
                                                                                                        'precio_letra_r':item5.precio_letra_r,
                                                                                                        'meses_deposito_r':item5.meses_deposito_r,
                                                                                                        'cuota_mantenimiento_r':item5.cuota_mantenimiento_r,
                                                                                                        'forma_pago_r':item5.forma_pago_r,
                                                                                                        'pago_poliza_r':item5.pago_poliza_r,
                                                                                                        'fiador_gravamen_r':item5.fiador_gravamen_r,
                                                                                                        'fiador_r':item5.fiador_r,
                                                                                                        'ubicacion_inmueble_r':item5.ubicacion_inmueble_r,
                                                                                                        'arrendatario_moral_r':item5.arrendatario_moral_r,
                                                                                                        'nombre_r':item5.nombre_r,
                                                                                                        'nombre_firma_r':item5.nombre_firma_r,
                                                                                                        'fecha_inicio_contrato_r':item5.fecha_inicio_contrato_r,
                                                                                                        'vigencia_r':item5.vigencia_r,
                                                                                                        'giro_empresa_r':item5.giro_empresa_r,
                                                                                                        'anios_constituida_r':item5.anios_constituida_r,
                                                                                                        'pagina_web_r':item5.pagina_web_r,
                                                                                                        'ubicacion_actual_r':item5.ubicacion_actual_r,
                                                                                                        'motivo_cambio_r':item5.motivo_cambio_r,
                                                                                                        'personas_ocuparan_r':item5.personas_ocuparan_r,
                                                                                                        'observaciones_r':item5.observaciones_r
                                                                                                    };
                                                                                                }
                                                                                                $.ajax({
                                                                                                    type: "POST",
                                                                                                    async : true,
                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guararZonaClientes.php",
                                                                                                    dataType: 'html',
                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                            'datosG': JSON.stringify(datosG),
                                                                                                            'encuesta': JSON.stringify(encuesta),
                                                                                                            'venta': JSON.stringify(venta),
                                                                                                            'renta': JSON.stringify(renta)
                                                                                                        },
                                                                                                    success: function(respuesta){
                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                        var dat1 = respu1[0];
                                                                                                        var dat2 = respu1[1];
                                                                                                        if(dat1 == "CEDULA"){
                                                                                                            if(dat2 > 0){
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx7){
                                                                                                                        tx7.executeSql(
                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx7, results){
                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                );
                                                                                                            }
                                                                                                        }else{
                                                                                                            AlmacenarError(respuesta);
                                                                                                        }
                                                                                                    },
                                                                                                    error: function(){
                                                                                                        console.log("Error en la comunicacion");
                                                                                                    }
                                                                                                });
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar cedulas generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Restatools"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosTrampaRestatools = new Array();
            var datosEvidenciasRestatools = new Array();
            var datosExtraccionRestatools = new Array();
            var datosMmtoRestatools = new Array();
            var datosDesasolveRestatools = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Trampa"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_trampa_restatools WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosTrampaRestatools[i] = {'Valor':i,
                                                        'capacidad':item2.capacidad,
                                                        'estaciones':item2.estaciones,
                                                        'fecha':item2.fecha,
                                                        'fecha_cliente':item2.fecha_cliente,
                                                        'firma_cliente':item2.firma_cliente,
                                                        'foto_entrada':item2.foto_entrada,
                                                        'foto_salida':item2.foto_salida,
                                                        'nombre_cliente':item2.nombre_cliente,
                                                        'numero_estaciones':item2.numero_estaciones,
                                                        'observaciones':item2.observaciones,
                                                        'razon_social':item2.razon_social,
                                                        'sucursal':item2.sucursal,
                                                        'ubicacion':item2.ubicacion,
                                                        'direccion':item2.direccion
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencias_restatools WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosEvidenciasRestatools[i] = {'Valor':i,
                                                                        'area':item3.area,
                                                                        'comentario':item3.comentario,
                                                                        'fase':item3.fase,
                                                                        'fecha':item3.fecha,
                                                                        'foto':item3.foto,
                                                                        'recorrido':item3.recorrido
                                                                    };
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarRestatoolsTrampa.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                             'datosTrampaRestatools': JSON.stringify(datosTrampaRestatools),
                                                                             'datosEvidenciasRestatools': JSON.stringify(datosEvidenciasRestatools)
                                                                            },
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }else{
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "Extraccion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_extracciones_restatools WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosExtraccionRestatools[i] = {'Valor':i,
                                                        'area':item2.area,
                                                        'fecha':item2.fecha,
                                                        'fecha_cliente':item2.fecha_cliente,
                                                        'firma_cliente':item2.firma_cliente,
                                                        'foto_entrada':item2.foto_entrada,
                                                        'foto_salida':item2.foto_salida,
                                                        'nombre_cliente':item2.nombre_cliente,
                                                        'razon_social':item2.razon_social,
                                                        'sucursal':item2.sucursal,
                                                        'direccion':item2.direccion
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencias_restatools WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosEvidenciasRestatools[i] = {'Valor':i,
                                                                        'area':item3.area,
                                                                        'comentario':item3.comentario,
                                                                        'fase':item3.fase,
                                                                        'fecha':item3.fecha,
                                                                        'foto':item3.foto,
                                                                        'recorrido':item3.recorrido
                                                                    };
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarRestatoolsExtraccion.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                             'datosExtraccionRestatools': JSON.stringify(datosExtraccionRestatools),
                                                                             'datosEvidenciasRestatools': JSON.stringify(datosEvidenciasRestatools)
                                                                            },
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }else{
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            else if(tipo == "Mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_mmto_restatools WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMmtoRestatools[i] = {'Valor':i,
                                                        'equipo':item2.equipo,
                                                        'fecha':item2.fecha,
                                                        'fecha_cliente':item2.fecha_cliente,
                                                        'firma_cliente':item2.firma_cliente,
                                                        'foto_entrada':item2.foto_entrada,
                                                        'foto_salida':item2.foto_salida,
                                                        'nombre_cliente':item2.nombre_cliente,
                                                        'observaciones':item2.observaciones,
                                                        'problematica':item2.problematica,
                                                        'razon_social':item2.razon_social,
                                                        'sucursal':item2.sucursal,
                                                        'tipo_servicio':item2.tipo_servicio,
                                                        'direccion':item2.direccion
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencias_restatools WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosEvidenciasRestatools[i] = {'Valor':i,
                                                                        'area':item3.area,
                                                                        'comentario':item3.comentario,
                                                                        'fase':item3.fase,
                                                                        'fecha':item3.fecha,
                                                                        'foto':item3.foto,
                                                                        'recorrido':item3.recorrido
                                                                    };
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarRestatoolsMmto.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                             'datosMmtoRestatools': JSON.stringify(datosMmtoRestatools),
                                                                             'datosEvidenciasRestatools': JSON.stringify(datosEvidenciasRestatools)
                                                                            },
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }else{
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "Desasolve"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_desasolve_restatools WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosDesasolveRestatools[i] = {'Valor':i,
                                                        'fecha':item2.fecha,
                                                        'fecha_cliente':item2.fecha_cliente,
                                                        'firma_cliente':item2.firma_cliente,
                                                        'foto_entrada':item2.foto_entrada,
                                                        'foto_salida':item2.foto_salida,
                                                        'nombre_cliente':item2.nombre_cliente,
                                                        'numero_lineas':item2.numero_lineas,
                                                        'observaciones':item2.observaciones,
                                                        'problematica':item2.problematica,
                                                        'razon_social':item2.razon_social,
                                                        'sucursal':item2.sucursal,
                                                        'tipo_servicio':item2.tipo_servicio,
                                                        'titulo_reporte':item2.titulo_reporte,
                                                        'direccion':item2.direccion
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencias_restatools WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosEvidenciasRestatools[i] = {'Valor':i,
                                                                        'area':item3.area,
                                                                        'comentario':item3.comentario,
                                                                        'fase':item3.fase,
                                                                        'fecha':item3.fecha,
                                                                        'foto':item3.foto,
                                                                        'recorrido':item3.recorrido
                                                                    };
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarRestatoolsDesasolve.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                             'datosDesasolveRestatools': JSON.stringify(datosDesasolveRestatools),
                                                                             'datosEvidenciasRestatools': JSON.stringify(datosEvidenciasRestatools)
                                                                            },
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        }else{
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar cedulas generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Devlyn"){
            var datosCedulaGeneral = new Array();
            var datosDevlyn = new Array();
            var evidenciaDevlyn = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                console.log(tipo)
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "Devlyn"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datosDevlyn WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosDevlyn[i] = {'Valor':i,'id_visita':item2.id_visita,'foto_entrada':item2.foto_entrada,'proveedor':item2.proveedor,'sucursal':item2.sucursal,'rfc':item2.rfc,'fecha':item2.fecha,'nombre_cliente':item2.nombre_cliente,'foto_llegada':item2.foto_llegada,'foto_salida':item2.foto_salida,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'fecha_llegada':item2.fecha_llegada,'id_proveedor':item2.id_proveedor};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidenciaDevlyn WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaDevlyn[i] = {'Valor':i,'tema': item3.tema,'observacion': item3.observacion,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                console.log('Cedula',datosCedulaGeneral)
                                                                console.log('evidenciaDevlyn',evidenciaDevlyn)
                                                                console.log('datosDevlyn',datosDevlyn)
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarDevlyn.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosDevlyn': JSON.stringify(datosDevlyn),'evidenciaDevlyn': JSON.stringify(evidenciaDevlyn)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Dilimpio"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;
            var datosDL = new Array();
            var equiposDL = new Array();
            var equiposCDL = new Array();
            var imagenDL = new Array();
            var entrenaDL = new Array();
            var almacenDL = new Array();
            var pedidosDL = new Array();
            var pedidosDL2 = new Array();
            var datosentregasDL = new Array();
            var entregasDL = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                usuario=item.id_usuario;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,
                                'tipo_cedula':item.tipo_cedula,
                                'id_usuario':item.id_usuario,
                                'nombre_usuario':item.nombre_usuario,
                                'fecha_entrada':item.fecha_entrada,
                                'geolocalizacion_entrada': item.geolocalizacion_entrada,
                                'id_cliente': item.id_cliente,
                                'nombre_cliente': item.nombre_cliente,
                                'horario_programado': item.horario_programado,
                                'calificacion': item.calificacion,
                                'fecha_salida':item.fecha_salida,
                                'geolocalizacion_salida':item.geolocalizacion_salida,
                                'nombre_evalua':item.nombre_evalua,
                                'comentario_cliente':item.comentario_cliente,
                                'fecha_envio':fecha_envio};
                            }
                            if(tipo == "Entregas"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM DatosentregasDL WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosentregasDL[i] = {'Valor':i,
                                                    'id_entrega':item2.id_datos,
                                                    'id_cedula':item2.id_cedula,
                                                    'id_cliente':item2.id_cliente,
                                                    'nombre_cliente':item2.nombre_cliente,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'correo':item2.correo,
                                                    'telefono':item2.telefono,
                                                    'estatus_cliente':item2.estatus_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'foto_inicio':item2.foto_inicio,
                                                    'observaciones_generales':item2.observaciones_generales };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from entregasDL WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    entregasDL[i] = {'Valor':i,
                                                                    'id_entrega': item3.id_entrega ,
                                                                    'foto_entrega': item3.foto_entrega ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'comentarios': item3.comentarios,
                                                                    'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from pedidosDL WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item7 = results.rows.item(i);
                                                                                    pedidosDL2[i] = {'Valor':i,
                                                                                    'id_producto': item7.id_producto ,
                                                                                    'id_cedula': item7.id_cedula,
                                                                                    'producto' : item7.producto,
                                                                                    'codigo' : item7.codigo,
                                                                                    'descripcion' : item7.descripcion,
                                                                                    'inventario_dia': item7.inventario_dia,
                                                                                    'cantidad_solicitada': item7.cantidad_solicitada,
                                                                                    'comentarios': item7.comentarios};
                                                                                }
                                                                                /*console.log(datosCedulaGeneral);
                                                                                console.log(datosentregasDL);
                                                                                console.log(entregasDL);
                                                                                console.log(pedidosDL2);*/
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarEntregasDL.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                    'datosentregasDL': JSON.stringify(datosentregasDL),
                                                                                    'pedidosDL2': JSON.stringify(pedidosDL2),
                                                                                    'entregasDL': JSON.stringify(entregasDL)
                                                                                    },
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log(respuesta);
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },//
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );//
                                                            },//
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );//
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "Cobranza"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM DatoscobranzasDL WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosentregasDL[i] = {'Valor':i,'id_entrega':item2.id_datos,'id_cedula':item2.id_cedula,'id_cliente':item2.id_cliente,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'correo':item2.correo,'telefono':item2.telefono,'estatus_cliente':item2.estatus_cliente,'firma_cliente':item2.firma_cliente,'foto_salida':item2.foto_salida,'foto_inicio':item2.foto_inicio,'observaciones_generales':item2.observaciones_generales,'cobro':item2.cobro, 'porque_cobro':item2.porque_cobro};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from cobranzasDL WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    entregasDL[i] = {'Valor':i,'id_entrega': item3.id_entrega,'foto_entrega': item3.foto_entrega ,'id_cedula': item3.id_cedula,'comentarios': item3.comentarios,'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from pedidosDL WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item7 = results.rows.item(i);
                                                                                    pedidosDL2[i] = {'Valor':i,'id_producto': item7.id_producto ,'id_cedula': item7.id_cedula,'producto' : item7.producto,'codigo' : item7.codigo,'descripcion' : item7.descripcion,'inventario_dia': item7.inventario_dia,'cantidad_solicitada': item7.cantidad_solicitada,'comentarios': item7.comentarios};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCobranzaDL.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosentregasDL': JSON.stringify(datosentregasDL),'pedidosDL2': JSON.stringify(pedidosDL2),'entregasDL': JSON.stringify(entregasDL)
                                                                                    },
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log(respuesta);
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "visitaDilimpio"){
                                var enviadoB=0;
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM visitaDilimpio WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){//
                                                    var item2 = results.rows.item(i);
                                                    datosDL[i] = {'Valor':i,'id_datos':item2.id_datos,
                                                    'id_cedula':item2.id_cedula,
                                                    'foto_inicio':item2.foto_inicio,
                                                    'id_cliente':item2.id_cliente,
                                                    'nombre_cliente':item2.nombre_cliente,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'correo':item2.correo,
                                                    'telefono':item2.telefono,
                                                    'estatus_cliente':item2.estatus_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'observaciones_generales':item2.observaciones_generales,
                                                    'estado_cuenta':item2.estado_cuenta,
                                                    'permite_almacen':item2.permite_almacen,
                                                    'persona_cuenta':item2.persona_cuenta,
                                                    'correo_cuenta':item2.correo_cuenta
                                                 };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from equiposDL WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    equiposDL[i] = {'Valor':i,
                                                                    'id_equipos': item3.id_equipos ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'estado' : item3.estado,
                                                                    'descripcion' : item3.descripcion,
                                                                    'equipo' : item3.equipo,
                                                                    'cantidad': item3.cantidad,
                                                                    'motivo': item3.motivo,
                                                                    'comentarios': item3.comentarios,
                                                                    'ubicacion': item3.ubicacion,
                                                                    'foto': item3.foto,
                                                                    'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from imagenDL WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    imagenDL[i] = {'Valor':i,
                                                                                    'id_imagen': item4.id_imagen ,
                                                                                    'id_cedula': item4.id_cedula,
                                                                                    'tipo' : item4.tipo,
                                                                                    'estado' : item4.estado,
                                                                                    'cantidad' : item4.cantidad,
                                                                                    'ubicacion': item4.ubicacion,
                                                                                    'comentarios': item4.comentarios,
                                                                                    'foto': item4.foto,
                                                                                    'fecha': item4.fecha};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from entrenaDL WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    entrenaDL[i] = {'Valor':i,
                                                                                                    'id_entrena': item5.id_entrena ,
                                                                                                    'id_cedula': item5.id_cedula,
                                                                                                    'tipo' : item5.tipo,
                                                                                                    'persona_capacita' : item5.persona_capacita,
                                                                                                    'puesto_capacita' : item5.puesto_capacita,
                                                                                                    'tema_capacita': item5.tema_capacita,
                                                                                                    'comentarios': item5.comentarios,
                                                                                                    'foto': item5.foto,
                                                                                                    'fecha': item5.fecha};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from almacenDL WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    almacenDL[i] = {'Valor':i,
                                                                                                                    'id_almacen': item6.id_almacen ,
                                                                                                                    'id_cedula': item6.id_cedula,
                                                                                                                    'observaciones' : item6.observaciones,
                                                                                                                    'foto' : item6.foto,
                                                                                                                    'fecha' : item6.fecha};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from pedidosDL WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    pedidosDL[i] = {'Valor':i,
                                                                                                                                    'id_producto': item7.id_producto ,
                                                                                                                                    'id_cedula': item7.id_cedula,
                                                                                                                                    'producto' : item7.producto,
                                                                                                                                    'codigo' : item7.codigo,
                                                                                                                                    'descripcion' : item7.descripcion,
                                                                                                                                    'inventario_dia': item7.inventario_dia,
                                                                                                                                    'cantidad_solicitada': item7.cantidad_solicitada,
                                                                                                                                    'comentarios': item7.comentarios};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from equiposCargadosDL WHERE enviado = ?",
                                                                                                                                            [enviadoB],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item10 = results.rows.item(i);
                                                                                                                                                    equiposCDL[i] = {'Valor':i,
                                                                                                                                                    'id_equipo': item10.id_equipo ,
                                                                                                                                                    'id_cliente': item10.id_cliente,
                                                                                                                                                    'codigo' : item10.codigo,
                                                                                                                                                    'descripcion' : item10.descripcion,
                                                                                                                                                    'id_usuario' : item10.id_usuario,
                                                                                                                                                    'estatus': item10.enviado,
                                                                                                                                                    };
                                                                                                                                                }
                                                                                                                                                    /*console.log(datosCedulaGeneral);
                                                                                                                                                    console.log(datosDL);
                                                                                                                                                    console.log(equiposDL);
                                                                                                                                                    console.log(equiposCDL);
                                                                                                                                                    console.log(imagenDL);
                                                                                                                                                    console.log(entrenaDL);
                                                                                                                                                    console.log(almacenDL);
                                                                                                                                                    console.log(pedidosDL);*/
                                                                                                                                                    $.ajax({
                                                                                                                                                        type: "POST",
                                                                                                                                                        async : true,
                                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarVisitaDL.php",
                                                                                                                                                        dataType: 'html',
                                                                                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                        'datosDL': JSON.stringify(datosDL),
                                                                                                                                                        'equiposDL': JSON.stringify(equiposDL),
                                                                                                                                                        'equiposCDL': JSON.stringify(equiposCDL),
                                                                                                                                                        'imagenDL': JSON.stringify(imagenDL),
                                                                                                                                                        'entrenaDL': JSON.stringify(entrenaDL),
                                                                                                                                                        'almacenDL': JSON.stringify(almacenDL),
                                                                                                                                                        'pedidosDL': JSON.stringify(pedidosDL)
                                                                                                                                                        },
                                                                                                                                                        success: function(respuesta){
                                                                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                                                                            var dat1 = respu1[0];
                                                                                                                                                            var dat2 = respu1[1];
                                                                                                                                                            var enviadoA=0;
                                                                                                                                                            if(dat1 == "CEDULA"){
                                                                                                                                                                if(dat2 > 0){
                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                        function(tx7){
                                                                                                                                                                            tx7.executeSql(
                                                                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                function(tx7, results){
                                                                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                        function(tx8){
                                                                                                                                                                                            tx8.executeSql(
                                                                                                                                                                                                "UPDATE equiposCargadosDL SET enviado = 1 WHERE enviado = ?",
                                                                                                                                                                                                 [enviadoA],
                                                                                                                                                                                                function(tx8, results){
                                                                                                                                                                                                }
                                                                                                                                                                                            );
                                                                                                                                                                                        }
                                                                                                                                                                                    );
                                                                                                                                                                                }
                                                                                                                                                                            );
                                                                                                                                                                        }
                                                                                                                                                                    );
                                                                                                                                                                }
                                                                                                                                                            } else {
                                                                                                                                                                AlmacenarError(respuesta);
                                                                                                                                                            }
                                                                                                                                                        },
                                                                                                                                                        error: function(){
                                                                                                                                                            console.log(respuesta);
                                                                                                                                                            console.log("Error en la comunicacion");
                                                                                                                                                        }
                                                                                                                                                    });
                                                                                                                                                },
                                                                                                                                                function(tx, error){
                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        },
                                                                                                                                        function(error){},
                                                                                                                                        function(){}
                                                                                                                                    );

                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar pedidos: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){
                                                                                                                        console.log("Error: " +error.message);
                                                                                                                    },
                                                                                                                    function(){}
                                                                                                                );

                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar almacen: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );

                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar entrenamiento: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );

                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar imagen: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){
                                                                        console.log("Error: " + error.message);
                                                                    },
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar equipos: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){
                                                        console.log("Error: " + error.message);
                                                    },
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                                );
                            } else {
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM DatoscobranzasDL WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosentregasDL[i] = {'Valor':i,'id_entrega':item2.id_datos,'id_cedula':item2.id_cedula,'id_cliente':item2.id_cliente,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'correo':item2.correo,'telefono':item2.telefono,'estatus_cliente':item2.estatus_cliente,'firma_cliente':item2.firma_cliente,'foto_salida':item2.foto_salida,'foto_inicio':item2.foto_inicio,'observaciones_generales':item2.observaciones_generales,'cobro':item2.cobro, 'porque_cobro':item2.porque_cobro};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from cobranzasDL WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    entregasDL[i] = {'Valor':i,'id_entrega': item3.id_entrega,'foto_entrega': item3.foto_entrega ,'id_cedula': item3.id_cedula,'comentarios': item3.comentarios,'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from pedidosDL WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item7 = results.rows.item(i);
                                                                                    pedidosDL2[i] = {'Valor':i,'id_producto': item7.id_producto ,'id_cedula': item7.id_cedula,'producto' : item7.producto,'codigo' : item7.codigo,'descripcion' : item7.descripcion,'inventario_dia': item7.inventario_dia,'cantidad_solicitada': item7.cantidad_solicitada,'comentarios': item7.comentarios};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCobranzaDL_dev.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosentregasDL': JSON.stringify(datosentregasDL),'pedidosDL2': JSON.stringify(pedidosDL2),'entregasDL': JSON.stringify(entregasDL)
                                                                                    },
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log(respuesta);
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){
                    console.log("Error: " + error.message);
                },
                function(){}
            );
        } else if(empresa == "VIC"){
            var estatus_proyecto=0;
            var datosCedulaGeneral = new Array();
            var apoyoBennetts = new Array();
            var fotosApoyo = new Array();
            var ventasBennetts = new Array();
            var minuta = new Array();
            var proyectosVic = new Array();
            //VIC new
            var datosVIC = new Array();
            var equiposVIC = new Array();
            var equiposCVIC = new Array();
            var imagenVIC = new Array();
            var entrenaVIC = new Array();
            var almacenVIC = new Array();
            var pedidosVIC = new Array();

            var apoyo = new Array();
            var datosClientes = new Array();

            var rol = localStorage.getItem("rol");
            var roles = rol.split("-");
            var empresa1=roles[1];

            var usuario;

            var div = localStorage.getItem("division");

            var respuesta = new Array();
            var fotos = new Array();
            //VIC new
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                usuario=item.id_usuario;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,
                                'tipo_cedula':item.tipo_cedula,
                                'id_usuario':item.id_usuario,
                                'nombre_usuario':item.nombre_usuario,
                                'fecha_entrada':item.fecha_entrada,
                                'geolocalizacion_entrada': item.geolocalizacion_entrada,
                                'id_cliente': item.id_cliente,
                                'nombre_cliente': item.nombre_cliente,
                                'horario_programado': item.horario_programado,
                                'calificacion': item.calificacion,
                                'fecha_salida':item.fecha_salida,
                                'geolocalizacion_salida':item.geolocalizacion_salida,
                                'nombre_evalua':item.nombre_evalua,
                                'comentario_cliente':item.comentario_cliente,
                                'fecha_envio':fecha_envio};
                            }
                            if(tipo == "ApoyoVIC"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM apoyo_bennetts WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    apoyoBennetts[i] = {'Valor':i,'id_apoyo':item2.id_apoyo,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_comercial':item2.nombre_comercial,'nombre_contacto':item2.nombre_contacto,'telefono':item2.telefono,'correo':item2.correo,'estatus_cliente':item2.estatus_cliente,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente ,'foto_salida':item2.foto_salida };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_apoyo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    fotosApoyo[i] = {'Valor':i,
                                                                    'id_foto_apoyo': item3.id_foto_apoyo ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'foto': item3.foto,
                                                                    'tipo_apoyo': item3.tipo_apoyo,
                                                                    'comentario': item3.comentario,
                                                                    'fechaYHora': item3.fechaYHora};
                                                                }
                                                                //console.log(datosCedulaGeneral);
                                                                //console.log(apoyoBennetts);
                                                                //console.log(fotosApoyo);
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarDatosVIC.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                    'apoyoBennetts': JSON.stringify(apoyoBennetts),
                                                                    'fotosApoyo': JSON.stringify(fotosApoyo)
                                                                    },
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log(respuesta);
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if (tipo == "VentasVIC" || tipo == "VentasVIC_SinV" || tipo == "VentasVIC_ConV" ){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM ventas_bennetts WHERE id_cedula = ?",
                                            [id_cedula],
                                            function (tx, results) {
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
                                                for (var i = 0; i < length; i++) {
                                                    var item2 = results.rows.item(i);
                                                    ventasBennetts[i] = {
                                                        'Valor': i, 'id_ventas': item2.id_ventas,
                                                        'id_cedula': item2.id_cedula,
                                                        'foto_inicio': item2.foto_inicio,
                                                        'nombre_cliente': item2.nombre_cliente,
                                                        'puesto_cliente': item2.puesto_cliente,
                                                        'telefono': item2.telefono,
                                                        'correo': item2.correo,
                                                        'firma_cliente': item2.firma_cliente,
                                                        'foto_salida': item2.foto_salida,
                                                        'id_proyecto': item2.id_proyecto,
                                                        'tipo_visita': item2.tipo_visita,
                                                        'foto_visita': item2.foto_visita,
                                                        'nivel': item2.nivel,
                                                        'pendiente_vendedor': item2.pendiente_vendedor,
                                                        'actividadSelect': item2.actividadSelect
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from minuta WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function (tx, results) {
                                                                var length = results.rows.length;
                                                                for (var i = 0; i < length; i++) {
                                                                    var item3 = results.rows.item(i);
                                                                    minuta[i] = {
                                                                        'Valor': i,
                                                                        'id_minuta': item3.id_minuta,
                                                                        'id_cedula': item3.id_cedula,
                                                                        'tema': item3.tema,
                                                                        'compromiso': item3.compromiso,
                                                                        'fecha': item3.fecha,
                                                                        'foto': item3.foto,
                                                                        'fecha_foto': item3.fecha_foto,
                                                                        'h_inicio': item3.h_inicio,
                                                                        'h_fin':item3.h_fin
                                                                    };
                                                                }
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("SELECT * from datos_contacto  WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function (tx, results) {
                                                                                        var length = results.rows.length;
                                                                                        for (var i = 0; i < length; i++) {
                                                                                            var item6 = results.rows.item(i);
                                                                                            datosClientes[i] = {
                                                                                                'Valor': i,
                                                                                                'id_proyecto': item6.id_proyecto,
                                                                                                'nombre_cliente': item6.nombre_cliente,
                                                                                                'puesto_cliente': item6.puesto_cliente,
                                                                                                'telefono': item6.telefono,
                                                                                                'correo': item6.correo
                                                                                            };
                                                                                        }
                                                                                        databaseHandler.db.transaction(
                                                                                            function(tx){
                                                                                                tx.executeSql("SELECT * from proyectos_vic where id_proyecto = ?",
                                                                                                [item.id_cliente],
                                                                                                function (tx, results) {
                                                                                                    var length = results.rows.length;
                                                                                                    for (var i = 0; i < length; i++) {
                                                                                                        var item4 = results.rows.item(i);
                                                                                                        proyectosVic[i] = {
                                                                                                            'Valor': i,
                                                                                                            'id_proyecto': item4.id_proyecto,
                                                                                                            'id_usuario': item4.id_usuario,
                                                                                                            'nombre_proyecto': item4.nombre_proyecto,
                                                                                                            'potencial': item4.potencial,
                                                                                                            'segmento': item4.segmento,
                                                                                                            'fecha_creacion': item4.fecha_creacion,
                                                                                                            'division': item4.division,
                                                                                                            'estrategia': item4.estrategia,
                                                                                                            'estatus': item4.estatus,
                                                                                                            'metodo': item4.metodo,
                                                                                                            'grupo': item4.grupo,
                                                                                                            'enviado': item4.enviado,
                                                                                                            'nivel' :item4.nivel
                                                                                                        };
                                                                                                    }
                                                                                                    console.log('datosC', datosClientes);
                                                                                                    console.log('datog', datosCedulaGeneral);
                                                                                                    console.log('ventas', ventasBennetts);
                                                                                                    console.log('minuta', minuta);
                                                                                                    console.log('proyectosVic', proyectosVic);
                                                                                                    $.ajax({
                                                                                                        type: "POST",
                                                                                                        async: true,
                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarDatosVentasSALES_VIC.php",
                                                                                                        dataType: 'html',
                                                                                                        data: {
                                                                                                            'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                            'ventasBennetts': JSON.stringify(ventasBennetts),
                                                                                                            'minuta': JSON.stringify(minuta),
                                                                                                            'proyectosVic': JSON.stringify(proyectosVic),
                                                                                                            'datosClientes': JSON.stringify(datosClientes)
                                                                                                        },
                                                                                                        success: function (respuesta) {
                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                            console.log(respuesta);
                                                                                                            var dat1 = respu1[0];
                                                                                                            var dat2 = respu1[1];
                                                                                                            if (dat1 == "CEDULA") {
                                                                                                                if (dat2 > 0) {
                                                                                                                    databaseHandler.db.transaction(
                                                                                                                        function (tx7) {
                                                                                                                            tx7.executeSql(
                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                [id_cedula],
                                                                                                                                function (tx7, results) {
                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                    $.ajax({
                                                                                                                                        type: "POST",
                                                                                                                                        async : true,
                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/ARCHIVOSJSONS/VIC-Gestion.php",
                                                                                                                                        dataType: 'html',
                                                                                                                                        data: {'datos': JSON.stringify(datos)},
                                                                                                                                        success: function(respuesta){
                                                                                                                                            window.resolveLocalFileSystemURL(cordova.file.dataDirectory, function(oEntry) {
                                                                                                                                                var jsonHijos = new download();
                                                                                                                                                jsonHijos.Initialize({
                                                                                                                                                  fileSystem : cordova.file.dataDirectory,
                                                                                                                                                  folder: "jsons",
                                                                                                                                                  remove: false,
                                                                                                                                                  timeout: 0,
                                                                                                                                                  success: DownloaderSuccess,
                                                                                                                                                  error: DownloaderError,
                                                                                                                                                  headers: [
                                                                                                                                                    {
                                                                                                                                                      key : "Cache-Control",
                                                                                                                                                      Value: "no-store"
                                                                                                                                                    }
                                                                                                                                                  ]
                                                                                                                                                });
                                                                                                                                                jsonHijos.Get("http://appbennetts.com/FWM2/app/ARCHIVOSJSONS/Gestion-SE-VIC.json");
                                                                                                                                                function DownloaderSuccess() {}
                                                                                                                                                function DownloaderError(err) {
                                                                                                                                                  console.log(err);
                                                                                                                                                }
                                                                                                                                            });
                                                                                                                                        },
                                                                                                                                        error: function(){
                                                                                                                                            console.log("Error en la comunicacion con el servidor");
                                                                                                                                        }
                                                                                                                                    });
                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                        function (tx8) {
                                                                                                                                            tx8.executeSql(
                                                                                                                                                "UPDATE proyectos_vic SET enviado = 1 WHERE id_usuario = ?",
                                                                                                                                                [id_usuarioP],
                                                                                                                                                function (tx8, results) {

                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        }
                                                                                                                                    );
                                                                                                                                    RecargarJSON_SALES();
                                                                                                                                }
                                                                                                                            );
                                                                                                                        }
                                                                                                                    );
                                                                                                                }
                                                                                                            } else {
                                                                                                                AlmacenarError(respuesta);
                                                                                                            }

                                                                                                        },
                                                                                                        error: function () {
                                                                                                            console.log(respuesta);
                                                                                                            console.log("Error en la comunicacion");
                                                                                                        }
                                                                                                    });
                                                                                                    },
                                                                                                    function(tx, error){
                                                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                                                        app.preloader.hide();
                                                                                                    }
                                                                                                );
                                                                                            },
                                                                                            function(error){},
                                                                                            function(){}
                                                                                        );

                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al guardar VENTAS: " + error.message);
                                                                                            app.preloader.hide();
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){},
                                                                                function(){}
                                                                            );


                                                            },
                                                            function(tx, error){
                                                                console.log("Error al guardar VENTAS: " + error.message);
                                                                app.preloader.hide();
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar VENTAS: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "VentasVIC_Acompa"){
                                console.log('Entro ACOMPA')
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * from apoyo_venta_vic  WHERE id_cedula = ?",
                                        [id_cedula],
                                        function (tx, results) {
                                            var length = results.rows.length;
                                            for (var i = 0; i < length; i++) {
                                                var item5 = results.rows.item(i);
                                                apoyo[i] = {
                                                    'Valor': i,
                                                    'proyecto': item5.proyecto,
                                                    'companero': item5.companero,
                                                    'comentario': item5.comentario,
                                                    'fecha': item5.fecha
                                                };
                                            }
                                            $.ajax({
                                                type: "POST",
                                                async: true,
                                                url: "http://www.appbennetts.com/FWM2/app/guardarDatosVentasVIC.php",
                                                dataType: 'html',
                                                data: {
                                                    'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                    'apoyo': JSON.stringify(apoyo)
                                                },
                                                success: function (respuesta) {
                                                    var respu1 = respuesta.split("._.");
                                                    console.log(respuesta);
                                                    var dat1 = respu1[0];
                                                    var dat2 = respu1[1];
                                                    if (dat1 == "CEDULA") {
                                                        if (dat2 > 0) {
                                                            databaseHandler.db.transaction(
                                                                function (tx7) {
                                                                    tx7.executeSql(
                                                                        "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                        [id_cedula],
                                                                        function (tx7, results) {
                                                                            localStorage.setItem("sendFlag", 0);
                                                                            swal("Enviado!", "Ya se envio tu visita!", "success");

                                                                        }
                                                                    );
                                                                }
                                                            );
                                                        }
                                                    } else {
                                                        AlmacenarError(respuesta);
                                                    }

                                                },
                                                error: function () {
                                                    console.log(respuesta);
                                                    console.log("Error en la comunicacion");
                                                }
                                            });
                                        },///in
                                        function(tx, error){
                                            console.log("Error al guardar VENTAS: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );//termina
                            } else if(tipo == "VIC"){
                                console.log(tipo)
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datosVIC WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){//
                                                    var item2 = results.rows.item(i);
                                                    datosVIC[i] = {'Valor':i,'id_datos':item2.id_datos,
                                                    'id_cedula':item2.id_cedula,
                                                    'foto_inicio':item2.foto_inicio,
                                                    'id_cliente':item2.id_cliente,
                                                    'nombre_cliente':item2.nombre_cliente,
                                                    'nombre_comercial':item2.nombre_comercial,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'telefono':item2.telefono,
                                                    'correo':item2.correo,
                                                    'estatus_cliente':item2.estatus_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'observaciones_generales':item2.observaciones_generales,
                                                    'estado_cuenta':item2.estado_cuenta,
                                                    'tipo_visita':item2.tipo_visita,
                                                    'permite_almacen':item2.permite_almacen,
                                                    'persona_cuenta':item2.persona_cuenta,
                                                    'correo_cuenta':item2.correo_cuenta,
                                                    'pregunta_equipo':item2.pregunta_equipo,
                                                    'pregunta_img':item2.pregunta_img,
                                                    'pregunta_entrena':item2.pregunta_entrena,
                                                    'pregunta_pedido':item2.pregunta_pedido
                                                 };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from equiposVIC WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    equiposVIC[i] = {'Valor':i,
                                                                    'id_equipos': item3.id_equipos ,
                                                                    'id_cedula': item3.id_cedula,
                                                                    'estado' : item3.estado,
                                                                    'descripcion' : item3.descripcion,
                                                                    'equipo' : item3.equipo,
                                                                    'cantidad': item3.cantidad,
                                                                    'motivo': item3.motivo,
                                                                    'comentarios': item3.comentarios,
                                                                    'ubicacion': item3.ubicacion,
                                                                    'foto': item3.foto,
                                                                    'fecha': item3.fecha};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from imagenVIC WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    imagenVIC[i] = {'Valor':i,
                                                                                    'id_imagen': item4.id_imagen ,
                                                                                    'id_cedula': item4.id_cedula,
                                                                                    'tipo' : item4.tipo,
                                                                                    'estado' : item4.estado,
                                                                                    'cantidad' : item4.cantidad,
                                                                                    'ubicacion': item4.ubicacion,
                                                                                    'comentarios': item4.comentarios,
                                                                                    'foto': item4.foto,
                                                                                    'fecha': item4.fecha};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from entrenaVIC WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    entrenaVIC[i] = {'Valor':i,
                                                                                                    'id_entrena': item5.id_entrena ,
                                                                                                    'id_cedula': item5.id_cedula,
                                                                                                    'tipo' : item5.tipo,
                                                                                                    'persona_capacita' : item5.persona_capacita,
                                                                                                    'puesto_capacita' : item5.puesto_capacita,
                                                                                                    'tema_capacita': item5.tema_capacita,
                                                                                                    'comentarios': item5.comentarios,
                                                                                                    'foto': item5.foto,
                                                                                                    'fecha': item5.fecha};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from almacenVIC WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    almacenVIC[i] = {'Valor':i,
                                                                                                                    'id_almacen': item6.id_almacen ,
                                                                                                                    'id_cedula': item6.id_cedula,
                                                                                                                    'observaciones' : item6.observaciones,
                                                                                                                    'foto' : item6.foto,
                                                                                                                    'fecha' : item6.fecha};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from pedidosVIC WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    pedidosVIC[i] = {'Valor':i,
                                                                                                                                    'id_producto': item7.id_producto ,
                                                                                                                                    'id_cedula': item7.id_cedula,
                                                                                                                                    'producto' : item7.producto,
                                                                                                                                    'codigo' : item7.codigo,
                                                                                                                                    'descripcion' : item7.descripcion,
                                                                                                                                    'inventario_dia': item7.inventario_dia,
                                                                                                                                    'cantidad_solicitada': item7.cantidad_solicitada,
                                                                                                                                    'comentarios': item7.comentarios};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * FROM VIC_Respuesta WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                    respuesta[i] = {'Valor':i,'id_pregunta': item8.id_pregunta , 'respuesta': item8.respuesta,'recomendacion': item8.recomendacion,'fecha': item8.fecha,'id_usuario': usuario,'div':div};
                                                                                                                                                }
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx){
                                                                                                                                                        tx.executeSql("SELECT * from VIC_Fotos WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx, results){
                                                                                                                                                                var length = results.rows.length;
                                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                                    var item9 = results.rows.item(i);
                                                                                                                                                                    fotos[i] = {'Valor':i,'pregunta': item9.pregunta,'FechaHora' : item9.FechaHora,'Foto' : item9.Foto};
                                                                                                                                                                }
                                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                                            function(tx){
                                                                                                                                                                                tx.executeSql("SELECT * from equiposCargados WHERE enviado = ?",
                                                                                                                                                                                    [estatus_proyecto],
                                                                                                                                                                                    function(tx, results){
                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                var item10 = results.rows.item(i);
                                                                                                                                                                                                equiposCVIC[i] = {'Valor':i,
                                                                                                                                                                                                'id_equipo': item10.id_equipo ,
                                                                                                                                                                                                'id_cliente': item10.id_cliente,
                                                                                                                                                                                                'codigo' : item10.codigo,
                                                                                                                                                                                                'descripcion' : item10.descripcion,
                                                                                                                                                                                                'id_usuario' : item10.id_usuario,
                                                                                                                                                                                                'estatus': item10.enviado,
                                                                                                                                                                                                'rol': empresa1};
                                                                                                                                                                                            }
                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                type: "POST",
                                                                                                                                                                                                async : true,
                                                                                                                                                                                                url: "http://www.appbennetts.com/FWM2/app/guardarVICVIC.php",
                                                                                                                                                                                                dataType: 'html',
                                                                                                                                                                                                data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                'datosVIC': JSON.stringify(datosVIC),
                                                                                                                                                                                                'equiposVIC': JSON.stringify(equiposVIC),
                                                                                                                                                                                                'equiposCVIC': JSON.stringify(equiposCVIC),
                                                                                                                                                                                                'imagenVIC': JSON.stringify(imagenVIC),
                                                                                                                                                                                                'entrenaVIC': JSON.stringify(entrenaVIC),
                                                                                                                                                                                                'almacenVIC': JSON.stringify(almacenVIC),
                                                                                                                                                                                                'pedidosVIC': JSON.stringify(pedidosVIC),
                                                                                                                                                                                                'respuesta': JSON.stringify(respuesta),
                                                                                                                                                                                                'evidenciaFotografica': JSON.stringify(fotos)
                                                                                                                                                                                                },
                                                                                                                                                                                                success: function(respuesta){
                                                                                                                                                                                                    var respu1 = respuesta.split("._.");
                                                                                                                                                                                                    var dat1 = respu1[0];
                                                                                                                                                                                                    var dat2 = respu1[1];
                                                                                                                                                                                                    var enviadoA=0;
                                                                                                                                                                                                    if(dat1 == "CEDULA"){
                                                                                                                                                                                                        if(dat2 > 0){
                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                function(tx7){
                                                                                                                                                                                                                    tx7.executeSql(
                                                                                                                                                                                                                        "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                        function(tx7, results){
                                                                                                                                                                                                                            localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                            swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                function(tx8){
                                                                                                                                                                                                                                    tx8.executeSql(
                                                                                                                                                                                                                                        "UPDATE equiposCargados SET enviado = 1 WHERE enviado = ?",
                                                                                                                                                                                                                                         [enviadoA],
                                                                                                                                                                                                                                        function(tx8, results){
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                            );
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    );
                                                                                                                                                                                                                }
                                                                                                                                                                                                            );
                                                                                                                                                                                                        }
                                                                                                                                                                                                    } else {
                                                                                                                                                                                                        AlmacenarError(respuesta);
                                                                                                                                                                                                    }
                                                                                                                                                                                                },
                                                                                                                                                                                                error: function(xhr, status, error) {
                                                                                                                                                                                                    var err = eval("(" + xhr.responseText + ")");
                                                                                                                                                                                                    AlmacenarError("Error en el envio desde la app:" + err.Message);
                                                                                                                                                                                                }
                                                                                                                                                                                            });


                                                                                                                                                                                        },
                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                        }
                                                                                                                                                                                    );
                                                                                                                                                                                },
                                                                                                                                                                                function(error){},
                                                                                                                                                                                function(){}
                                                                                                                                                                            );
                                                                                                                                                                        },
                                                                                                                                                                        function(tx, error){
                                                                                                                                                                            console.log("Error al consultar sanitizacion: " + error.message);
                                                                                                                                                                        }
                                                                                                                                                                    );
                                                                                                                                                                },
                                                                                                                                                                function(error){},
                                                                                                                                                                function(){}
                                                                                                                                                            );
                                                                                                                                                        },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar equiposCargados: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){
                                                                                                                                        console.log("Error: " +error.message);
                                                                                                                                    },
                                                                                                                                    function(){}
                                                                                                                                );

                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar pedidos: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){
                                                                                                                        console.log("Error: " +error.message);
                                                                                                                    },
                                                                                                                    function(){}
                                                                                                                );

                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar almacen: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );

                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar entrenamiento: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );

                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar imagen: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){
                                                                        console.log("Error: " + error.message);
                                                                    },
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar equipos: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){
                                                        console.log("Error: " + error.message);
                                                    },
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){
                                        console.log("Error: " + error.message);
                                    },
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){
                    console.log("Error: " + error.message);
                },
                function(){}
            );
        } else if(empresa == "Field"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'tipo_motor':item2.tipo_motor,'tipo_boquilla':item2.tipo_boquilla,'tipo_combustible':item2.tipo_combustible,'tipo_mastil':item2.tipo_mastil,'comentario_equipo':item2.comentario_equipo,'lugar_reparacion':item2.lugar_reparacion,'reparo_visita':item2.reparo_visita,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_levantamiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observacion,'foto_observacion': item3.foto_observacion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion con el servidor");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "mantenimiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM mantenimiento_Field WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosMantenimiento[mantenimiento] = {'Valor':mantenimiento,'id_levantamiento':item2.id_levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'nombre_contacto':item2.nombre_contacto,'telefono_contacto':item2.telefono_contacto,'correo_contacto':item2.correo_contacto,'tipo_servicio':item2.tipo_servicio,'orden_servicio':item2.orden_servicio,'marca':item2.marca,'modelo':item2.modelo,'numero_serie':item2.numero_serie,'foto_equipo':item2.foto_equipo,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    mantenimiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia_mantenimiento_Field WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaMantenimiento[evidenciamant] = {'Valor':evidenciamant,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'fase': item3.fase,'descripcion': item3.descripcion,'foto_decripcion': item3.foto_decripcion,'fecha_regristro': item3.fecha_regristro};
                                                                    evidenciamant++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMantenimientoField.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosMantenimiento': JSON.stringify(datosMantenimiento),'evidenciaMantenimiento': JSON.stringify(evidenciaMantenimiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "CarnesIdeal"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosEntrega = new Array();
            var evidenciaEntrega = new Array();
            var fotos_ci = new Array();
            var fotos_entrega_ci = new Array();

            var datos_ventas = new Array();
            var visitas_ci = new Array();
            var prodcutos_ci = new Array();
            var minuta_ci = new Array();
            var visita_seguimiento = new Array();
            var cierre_seguimiento_ci = new Array();

            var datosMantenimiento = new Array();
            var evidenciaMantenimiento = new Array();
            var evidencias_carga = new Array();
            var datos_ci = new Array();
            var mantenimiento = 0;
            var evidenciamant = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Venta"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * from datos_ventas WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item1 = results.rows.item(i);
                                                    datos_ventas[i] = {'Valor':i,
                                                    'nombre':item1.nombre,
                                                    'telefono':item1.telefono,
                                                    'correo':item1.correo,
                                                    'medio_conocido':item1.medio_conocido,
                                                    'potencia_kg':item1.potencia_kg,
                                                    'negocio':item1.negocio,
                                                    'ubicacion':item1.ubicacion,
                                                    'medio_contacto':item1.medio_contacto,
                                                    'otro_medio':item1.otro_medio,
                                                    'foto_entrada':item1.foto_entrada,
                                                    'id_cliente':item1.id_cliente,
                                                    'firma_cliente':item1.firma_cliente,
                                                    'fecha_cliente':item1.fecha_cliente,
                                                    'foto_salida':item1.foto_salida,
                                                    'porque_cierre':item1.porque_cierre};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from visitas_ci WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item2 = results.rows.item(i);
                                                                    visitas_ci[i] = {'Valor':i,
                                                                    'tipo_visita':item2.tipo_visita,
                                                                    'potencia':item2.potencia,
                                                                    'potencia_correcta':item2.potencia_correcta,
                                                                    'ubicacion':item2.ubicacion,
                                                                    'ubicacion_correcta':item2.ubicacion_correcta,
                                                                    'proveedor_actual':item2.proveedor_actual,
                                                                    'problematica':item2.problematica};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from prodcutos_ci WHERE id_cedula = ? AND enviado is null",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item3 = results.rows.item(i);
                                                                                    prodcutos_ci[i] = {'Valor':i,
                                                                                    'producto':item3.producto,
                                                                                    'precio':item3.precio,
                                                                                    'kilos':item3.kilos,
                                                                                    'observaciones':item3.observaciones,
                                                                                    'foto_producto':item3.foto_producto,
                                                                                    'fecha_registro':item3.fecha_registro};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from minuta_ci WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item4 = results.rows.item(i);
                                                                                                    minuta_ci[i] = {'Valor':i,
                                                                                                    'acciones':item4.acciones,
                                                                                                    'fecha_minuta':item4.fecha_minuta};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from visita_seguimiento WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item5 = results.rows.item(i);
                                                                                                                    visita_seguimiento[i] = {'Valor':i,
                                                                                                                    'objetivo':item5.objetivo,
                                                                                                                    'cotizacion':item5.cotizacion,
                                                                                                                    'muestras_check':item5.muestras_check,
                                                                                                                    'observaciones_muestras':item5.observaciones_muestras,
                                                                                                                    'credito_check':item5.credito_check,
                                                                                                                    'resultado_visita':item5.resultado_visita};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from cierre_seguimiento_ci WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                                    cierre_seguimiento_ci[i] = {'Valor':i,
                                                                                                                                    'credito':item6.credito,
                                                                                                                                    'documentos':item6.documentos,
                                                                                                                                    'foto_doc':item6.foto_doc,
                                                                                                                                    'factura':item6.factura,
                                                                                                                                    'pedido':item6.pedido,
                                                                                                                                    'producto':item6.producto,
                                                                                                                                    'kg':item6.kg,
                                                                                                                                    'pagos':item6.pagos,
                                                                                                                                    'otro_pago':item6.otro_pago,
                                                                                                                                    'dia':item6.dia,
                                                                                                                                    'hora':item6.hora,
                                                                                                                                    'direccion':item6.direccion,
                                                                                                                                    'observaciones':item6.observaciones
                                                                                                                                };
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx1){
                                                                                                                                        tx1.executeSql(
                                                                                                                                            "Select * from fotos_ci where id_cedula= ? AND enviado is null",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                                    fotos_ci[i] = {'Valor':i,
                                                                                                                                                    'foto':item7.foto,
                                                                                                                                                    'comentarios':item7.comentarios,
                                                                                                                                                    'fecha_evidencia':item7.fecha_evidencia,
                                                                                                                                                    'fase':item7.fase,
                                                                                                                                                    'apartado':item7.apartado};
                                                                                                                                                }
                                                                                                                                                
                                                                                                                                                $.ajax({
                                                                                                                                                    type: "POST",
                                                                                                                                                    async : true,
                                                                                                                                                    url: "https://www.fwm.com.mx/app/guardarCIVenta.php",
                                                                                                                                                    dataType: 'html',
                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                        'datos_ventas': JSON.stringify(datos_ventas),
                                                                                                                                                        'visitas_ci': JSON.stringify(visitas_ci),
                                                                                                                                                        'prodcutos_ci': JSON.stringify(prodcutos_ci),
                                                                                                                                                        'minuta_ci': JSON.stringify(minuta_ci),
                                                                                                                                                        'visita_seguimiento': JSON.stringify(visita_seguimiento),
                                                                                                                                                        'cierre_seguimiento_ci': JSON.stringify(cierre_seguimiento_ci),
                                                                                                                                                        'fotos_ci': JSON.stringify(fotos_ci)
                                                                                                                                                    },
                                                                                                                                                    success: function(respuesta){
                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                        var dat3 = respu1[2];
                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                            if(dat2 > 0){
                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                    function(tx7){
                                                                                                                                                                        tx7.executeSql(
                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                            [id_cedula],
                                                                                                                                                                            function(tx7, results){
                                                                                                                                                                                UpdateDataCI(dat3);
                                                                                                                                                                            }
                                                                                                                                                                        );
                                                                                                                                                                    }
                                                                                                                                                                );
                                                                                                                                                            }
                                                                                                                                                        } else {
                                                                                                                                                            AlmacenarError(respuesta);
                                                                                                                                                        }
                                                                                                                                                    },
                                                                                                                                                    error: function(){
                                                                                                                                                        console.log("Error en la comunicacion con el servidor");
                                                                                                                                                    }
                                                                                                                                                });
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){},
                                                                                                                                    function(){}
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){console.log(error)},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){console.log(error)},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){console.log(error)},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){console.log(error)},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){console.log(error)},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                            }
                                        );
                                    },
                                    function(error){console.log(error)},
                                    function(){}
                                );
                            }
                            if(tipo == "Entrega"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * from datos_generales WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosEntrega[i] = {'Valor':i,
                                                        'foto_entrada':item2.foto_entrada,
                                                        'nombre_cliente':item2.nombre_cliente,
                                                        'orden': item2.orden,'comanda': item2.comanda,
                                                        'nombre_contacto': item2.nombre_contacto,'temp_entregado': item2.temp_entregado,
                                                        'peso_cliente': item2.peso_cliente,'anomalia': item2.anomalia,'comunes_anomalias': item2.comunes_anomalias,
                                                        'descripcion_anomalia': item2.descripcion_anomalia,
                                                        'id_cliente': item2.id_cliente,'firma_cliente': item2.firma_cliente,'fecha_cliente': item2.fecha_cliente,
                                                        'foto_salida': item2.foto_salida,'foto_temp_producto': item2.foto_temp_producto,'foto_temp_caja': item2.foto_temp_caja
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_ci WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    fotos_ci[i] = {'Valor':i,'foto': item3.foto,'comentarios': item3.comentarios,'fecha_evidencia': item3.fecha_evidencia,'fase': item3.fase,'apartado': item3.apartado};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from fotos_entrega_ci WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    fotos_entrega_ci[i] = {'Valor':i,'foto': item4.foto,'comentarios': item4.comentarios,'fecha_evidencia': item4.fecha_evidencia,'temp_entregado': item4.temp_entregado, 'peso_cliente': item4.peso_cliente, 'anomalia': item4.anomalia, 'foto_temp_producto': item4.foto_temp_producto, 'foto_peso': item4.foto_peso, 'comunes_anomalias': item4.comunes_anomalias, 'descripcion_anomalia': item4.descripcion_anomalia};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "https://www.fwm.com.mx/app/guardarEntregaCI.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosEntrega': JSON.stringify(datosEntrega),'fotos_ci': JSON.stringify(fotos_ci),'fotos_entrega_ci': JSON.stringify(fotos_entrega_ci)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion con el servidor");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){console.log(error)},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "Ruta"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_ci WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datos_ci[i] = {'Valor':i,
                                                        'foto_entrada':item2.foto_entrada,
                                                        'id_cliente':item2.id_cliente,
                                                        'nombre_cliente':item2.nombre_cliente,
                                                        'nombre_usuario':item2.nombre_usuario,
                                                        'firma_cliente':item2.firma_cliente,
                                                        'fecha_cliente':item2.fecha_cliente,
                                                        'foto_salida':item2.foto_salida,
                                                        'pesocon_taras':item2.pesocon_taras,
                                                        'pesosin_taras':item2.pesosin_taras,
                                                        'total_coincide':item2.total_coincide,
                                                        'comentarios':item2.comentarios,
                                                        'temperatura_caja':item2.temperatura_caja,
                                                        'confirmacion_medidas':item2.confirmacion_medidas,
                                                        'foto_temp_caja':item2.foto_temp_caja,
                                                        'foto_caja_cargada':item2.foto_caja_cargada,
                                                        'nombre_completo' :item2.nombre_completo,
                                                        'id_cedula':item2.id_cedula
                                                    };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencias_carga WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidencias_carga[i] = {'Valor':i,
                                                                    'cliente':item3.cliente,
                                                                    'no_pedido':item3.no_pedido,
                                                                    'descripcion':item3.descripcion,
                                                                    'peso_ruta':item3.peso_ruta,
                                                                    'peso_actual':item3.peso_actual, 
                                                                    'foto':item3.foto,
                                                                    'id_cedula':item2.id_cedula
                                                                };
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCIRuta.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                    'datos_ci': JSON.stringify(datos_ci),
                                                                    'evidencias_carga': JSON.stringify(evidencias_carga)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta)
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Bennetts"){
            var datosCedulaGeneral = new Array();
            var productos = new Array();
            var datosProductos = new Array();
            var inventario = new Array();
            var conteo = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "baja"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM productos WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    productos[i] = {'Valor':i,'codigo_producto':item2.codigo_producto,'descripcion_producto':item2.descripcion_producto,'cantidad_producto':item2.cantidad_producto,'aplica':item2.aplica,'motivo':item2.motivo,'evidencia_foto_antes':item2.evidencia_foto_antes,'evidencia_foto_despues':item2.evidencia_foto_despues,'fecha':item2.fecha};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_productos WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosProductos[i] = {'Valor':i,'puesto': item3.puesto,'firma_cliente': item3.firma_cliente,'correo': item3.correo};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarBajaBennetts.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'productos': JSON.stringify(productos),'datosProductos': JSON.stringify(datosProductos)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "conteo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM inventario WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    inventario[i] = {'Valor':i,'id_inventario':item2.id_inventario,'id_cedula':item2.id_cedula,'id_conteo_general':item2.id_conteo_general,'numero_conteo':item2.numero_conteo,'empresa':item2.empresa,'pareja_almacen':item2.pareja_almacen,'almacen':item2.almacen,'fecha':item2.fecha};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from conteo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    conteo[i] = {'Valor':i,'id_conteo_general': item3.id_conteo_general,'numero_conteo': item3.numero_conteo,'codigo_proveedor': item3.codigo_proveedor,'codigo_sap': item3.codigo_sap,'ubicacion': item3.ubicacion,'descripcion': item3.descripcion,'inventario': item3.inventario,'familia': item3.familia,'costo_unitario': item3.costo_unitario,'usuario': item3.usuario,'estatus_diferencia': item3.estatus_diferencia,'fisico': item3.fisico,'enviado': item3.enviado,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarConteoBennetts.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'inventario': JSON.stringify(inventario),'conteo': JSON.stringify(conteo)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "DIPREC"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var servicioTecnico = new Array();
            var datosEquipo = new Array();
            var evidenciaEquipo = new Array();
            var datosEquipoAntes = new Array();
            var evidenciaRefacciones = new Array();
            var checkList = new Array();
            var checkList2 = new Array();
            var datosEquipoDespues = new Array();
            var reporteTecnico = 0;

            var minutaCoordinador = new Array();
            var zonasCoordinador = new Array();
            var equiposCoordinador = new Array();
            var datosCoordinador = new Array();
            var observaciones = new Array();
            var notas = new Array();
            var minutCoordinador = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "reporteTecnico"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM servicio_tecnico WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    servicioTecnico[i] = {'Valor':reporteTecnico,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'atencion':item2.atencion,'documento_ingresar':item2.documento_ingresar,'direccion':item2.direccion,'telefono':item2.telefono,'email':item2.email,'tipo_servicio':item2.tipo_servicio,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto,'fecha_envio':fecha_envio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipo WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datosEquipo[i] = {'Valor':reporteTecnico,'equipo': item3.equipo,'marca': item3.marca,'modelo': item3.modelo,'no_serie': item3.no_serie,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencia_equipo WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    evidenciaEquipo[i] = {'Valor':i,'fase': item4.fase,'foto': item4.foto,'equipo': item4.equipo,'fecha_regristro': item4.fecha_regristro};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from datos_equipo_antes WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    datosEquipoAntes[i] = {'Valor':reporteTecnico,'equipo': item5.equipo,'voltaje': item5.voltaje,'estado_voltaje': item5.estado_voltaje,'evidencia_voltaje': item5.evidencia_voltaje,'corriente': item5.corriente,'estado_corriente': item5.estado_corriente,'evidencia_corriente': item5.evidencia_corriente,'fases': item5.fases,'estado_fase': item5.estado_fase,'evidencia_fase': item5.evidencia_fase,'tipo_gas': item5.tipo_gas,'estado_gas': item5.estado_gas,'evidencia_gas': item5.evidencia_gas,'presion_gas': item5.presion_gas,'estado_presion_gas': item5.estado_presion_gas,'evidencia_presion_gas': item5.evidencia_presion_gas,'presion_vapor': item5.presion_vapor,'estado_presion_vapor': item5.estado_presion_vapor,'evidencia_presion_vapor': item5.evidencia_presion_vapor,'temperatura': item5.temperatura,'estado_temperatura': item5.estado_temperatura,'evidencia_estado_temperatura': item5.evidencia_estado_temperatura,'falla_reportada': item5.falla_reportada};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from evidencia_refacciones WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    evidenciaRefacciones[i] = {'Valor':reporteTecnico,'fase': item6.fase,'clave': item6.clave,'cantidad': item6.cantidad,'descripcion': item6.descripcion,'foto': item6.foto,'fecha_regristro': item6.fecha_regristro};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from check_list WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    checkList[i] = {'Valor':reporteTecnico,'equipo': item7.equipo,'gabinete_exterior': item7.gabinete_exterior,'gabinete_interior': item7.gabinete_interior,'quemadores': item7.quemadores,'paneles': item7.paneles,'parillas': item7.parillas,'vulvas_espreas': item7.vulvas_espreas,'paneles_control': item7.paneles_control,'condensador': item7.condensador,'evaporador': item7.evaporador,'motores': item7.motores,'compresor': item7.compresor,'flautas': item7.flautas,'sistema_hidraulico': item7.sistema_hidraulico,'sistema_lavado': item7.sistema_lavado,'empaques': item7.empaques,'dereccion_fugas': item7.dereccion_fugas,'ajuste_electrico': item7.ajuste_electrico,'libricacion': item7.libricacion,'revision_operacion': item7.revision_operacion,'filtro_aire': item7.filtro_aire};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from check_list2 WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                    checkList2[i] = {'Valor':reporteTecnico,'equipo': item8.equipo,'vulvas': item8.vulvas,'termostato': item8.termostato,'control_presion': item8.control_presion,'sensor_flama': item8.sensor_flama,'quemadores': item8.quemadores,'turbinas': item8.turbinas,'resistencias': item8.resistencias,'sondas': item8.sondas,'tarjeta_electronica': item8.tarjeta_electronica,'compresor': item8.compresor,'motor_difusores': item8.motor_difusores,'aspas': item8.aspas,'contractores': item8.contractores,'fuga_tuberia': item8.fuga_tuberia,'aislante_tuberia': item8.aislante_tuberia,'condfensador': item8.condfensador,'iluminacion': item8.iluminacion,'empaques': item8.empaques,'fuga': item8.fuga};
                                                                                                                                                }
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx){
                                                                                                                                                        tx.executeSql("SELECT * from datos_equipo_despues WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx, results){
                                                                                                                                                                var length = results.rows.length;
                                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                                    var item9 = results.rows.item(i);
                                                                                                                                                                    datosEquipoDespues[i] = {'Valor':reporteTecnico,'equipo': item9.equipo,'voltaje': item9.voltaje,'estado_voltaje': item9.estado_voltaje,'evidencia_voltaje': item9.evidencia_voltaje,'corriente': item9.corriente,'estado_corriente': item9.estado_corriente,'evidencia_corriente': item9.evidencia_corriente,'fases': item9.fases,'estado_fase': item9.estado_fase,'evidencia_fase': item9.evidencia_fase,'tipo_gas': item9.tipo_gas,'estado_gas': item9.estado_gas,'evidencia_gas': item9.evidencia_gas,'presion_gas': item9.presion_gas,'estado_presion_gas': item9.estado_presion_gas,'evidencia_presion_gas': item9.evidencia_presion_gas,'presion_vapor': item9.presion_vapor,'estado_presion_vapor': item9.estado_presion_vapor,'evidencia_presion_vapor': item9.evidencia_presion_vapor,'temperatura': item9.temperatura,'estado_temperatura': item9.estado_temperatura,'evidencia_estado_temperatura': item9.evidencia_estado_temperatura,'falla_reportada': item9.falla_reportada};
                                                                                                                                                                }
                                                                                                                                                                $.ajax({
                                                                                                                                                                    type: "POST",
                                                                                                                                                                    async : true,
                                                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteDIPREC.php",
                                                                                                                                                                    dataType: 'html',
                                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'servicioTecnico': JSON.stringify(servicioTecnico),'datosEquipo': JSON.stringify(datosEquipo),'evidenciaEquipo': JSON.stringify(evidenciaEquipo),'datosEquipoAntes': JSON.stringify(datosEquipoAntes),'evidenciaRefacciones': JSON.stringify(evidenciaRefacciones),'checkList': JSON.stringify(checkList),'checkList2': JSON.stringify(checkList2),'datosEquipoDespues': JSON.stringify(datosEquipoDespues)},
                                                                                                                                                                    success: function(respuesta){
                                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                                            if(dat2 > 0){
                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                    function(tx7){
                                                                                                                                                                                        tx7.executeSql(
                                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                            [id_cedula],
                                                                                                                                                                                            function(tx7, results){
                                                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                            }
                                                                                                                                                                                        );
                                                                                                                                                                                    }
                                                                                                                                                                                );
                                                                                                                                                                            }
                                                                                                                                                                        } else {
                                                                                                                                                                            AlmacenarError(respuesta);
                                                                                                                                                                        }
                                                                                                                                                                    },
                                                                                                                                                                    error: function(){
                                                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                                                    }
                                                                                                                                                                });
                                                                                                                                                            },
                                                                                                                                                            function(tx, error){
                                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                            }
                                                                                                                                                        );
                                                                                                                                                    },
                                                                                                                                                    function(error){},
                                                                                                                                                    function(){}
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){},
                                                                                                                                    function(){}
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "minutaCoordinador"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM minuta_coordinador WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    minutaCoordinador[i] = {'Valor':i,'foto_entrada':item2.foto_entrada,'empresa':item2.empresa,'coordinador_obra':item2.coordinador_obra,'nombre_cliente':item2.nombre_cliente,'proyecto':item2.proyecto,'coordonador':item2.coordonador,'direccion':item2.direccion,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from zonas_coordinador WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    zonasCoordinador[i] = {'Valor':i,'nombre': item3.nombre,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from equipos_coordinador WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    equiposCoordinador[i] = {'Valor':i,'zona': item4.zona,'equipo': item4.equipo,'foto': item4.foto,'fecha_registro': item4.fecha_registro};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from datos_coordinador WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    datosCoordinador[i] = {'Valor':reporteTecnico,'zona': item5.zona,'equipo': item5.equipo,'voltaje': item5.voltaje,'estado_voltaje': item5.estado_voltaje,'evidencia_voltaje': item5.evidencia_voltaje,'corriente': item5.corriente,'estado_corriente': item5.estado_corriente,'evidencia_corriente': item5.evidencia_corriente,'fases': item5.fases,'estado_fase': item5.estado_fase,'evidencia_fase': item5.evidencia_fase,'tipo_gas': item5.tipo_gas,'estado_gas': item5.estado_gas,'evidencia_gas': item5.evidencia_gas,'presion_gas': item5.presion_gas,'estado_presion_gas': item5.estado_presion_gas,'evidencia_presion_gas': item5.evidencia_presion_gas,'presion_vapor': item5.presion_vapor,'estado_presion_vapor': item5.estado_presion_vapor,'evidencia_presion_vapor': item5.evidencia_presion_vapor,'temperatura': item5.temperatura,'estado_temperatura': item5.estado_temperatura,'evidencia_estado_temperatura': item5.evidencia_estado_temperatura,'falla_reportada': item5.falla_reportada};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from observaciones WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    observaciones[i] = {'Valor':reporteTecnico,'acuerdo': item6.acuerdo,'foto': item6.foto,'fecha_registro': item6.fecha_registro};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from notas WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                    notas[i] = {'Valor':reporteTecnico,'nota': item7.nota,'foto': item7.foto,'fecha_registro': item7.fecha_registro};
                                                                                                                                }
                                                                                                                                $.ajax({
                                                                                                                                    type: "POST",
                                                                                                                                    async : true,
                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarMinutaDIPREC.php",
                                                                                                                                    dataType: 'html',
                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'minutaCoordinador': JSON.stringify(minutaCoordinador),'zonasCoordinador': JSON.stringify(zonasCoordinador),'equiposCoordinador': JSON.stringify(equiposCoordinador),'datosCoordinador': JSON.stringify(datosCoordinador),'observaciones': JSON.stringify(observaciones),'notas': JSON.stringify(notas)},
                                                                                                                                    success: function(respuesta){
                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                            if(dat2 > 0){
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx7){
                                                                                                                                                        tx7.executeSql(
                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx7, results){
                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                            }
                                                                                                                                                        );
                                                                                                                                                    }
                                                                                                                                                );
                                                                                                                                            }
                                                                                                                                        } else {
                                                                                                                                            AlmacenarError(respuesta);
                                                                                                                                        }
                                                                                                                                    },
                                                                                                                                    error: function(){
                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                    }
                                                                                                                                });
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "checklist_levantamiento" || tipo == "checklist_liberacion" ){
                                
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * from checklist_diprec WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item4 = results.rows.item(i);
                                                    equiposCoordinador[i] = {'Valor':i,
                                                    'fase': item4.fase,
                                                    'pregunta': item4.pregunta,
                                                    'id': item4.id,
                                                    'valor': item4.valor,
                                                    'tipo': item4.tipo};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencias_diprec WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    zonasCoordinador[i] = {'Valor':i,
                                                                        'comentario': item3.comentario,
                                                                        'area': item3.area,
                                                                        'recorrido': item3.recorrido,
                                                                        'fecha': item3.fecha,
                                                                        'foto': item3.foto
                                                                    };
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * FROM datos_generales_diprec WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item2 = results.rows.item(i);
                                                                                    datosCoordinador[i] = {'Valor':i,
                                                                                        'proyecto':item2.proyecto,
                                                                                        'pedido': item2.pedido,
                                                                                        'fecha':item2.fecha,
                                                                                        'referencia':item2.referencia,
                                                                                        'proyectos':item2.proyectos,
                                                                                        'vendedor':item2.vendedor,
                                                                                        'mombre':item2.mombre,
                                                                                        'razon_social':item2.razon_social,
                                                                                        'direccion':item2.direccion,
                                                                                        'telefono':item2.telefono,
                                                                                        'rfc':item2.rfc,
                                                                                        'atencion':item2.atencion,
                                                                                        'puesto':item2.puesto,
                                                                                        'foto_entrada':item2.foto_entrada,
                                                                                        'fecha_cliente':item2.fecha_cliente,
                                                                                        'foto_salida':item2.foto_salida
                                                                                    };
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarDIPREClevanta.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                        'datos_generales_diprec': JSON.stringify(datosCoordinador),
                                                                                        'evidencias_diprec': JSON.stringify(zonasCoordinador),
                                                                                        'checklist_diprec': JSON.stringify(equiposCoordinador)
                                                                                    },
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            //AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );

        } else if(empresa == "SURO"){
            var datosCedulaGeneral = new Array();
            var sanitizacion = new Array();
            var evidenciaSanitizacion = new Array();
            var evidenciaRecorrido = new Array();
            var Fotos_SURO = new Array();
            var visita = new Array();
            var encuesta = new Array();
            var visitaB = new Array();
            var seguimiento =new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "sanitizacionSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM sanitizacion_Suro WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    sanitizacion[i] = {'Valor':i,'nombre_cliente':item2.nombre_cliente,'foto_entrada':item2.foto_entrada,'sucursal':item2.sucursal,'direccion':item2.direccion,'correo':item2.correo,'nombre_usuario':item2.nombre_usuario,'foto_epp':item2.foto_epp,'foto_maquina':item2.foto_maquina,'foto_aspersor':item2.foto_aspersor,'foto_quimico':item2.foto_quimico,'foto_accesos':item2.foto_accesos,'foto_delimita_area':item2.foto_delimita_area,'fecha_foto_epp':item2.fecha_foto_epp,'fecha_foto_maquina':item2.fecha_foto_maquina,'fecha_foto_aspersor':item2.fecha_foto_aspersor,'fecha_foto_quimico':item2.fecha_foto_quimico,'fecha_foto_acceso':item2.fecha_foto_acceso,'fecha_foto_area':item2.fecha_foto_area,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'puesto':item2.puesto};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidencia WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaSanitizacion[i] = {'Valor':i,'nombre_grupo': item3.nombre_grupo,'foto_evidencia': item3.foto_evidencia,'fases': item3.fases,'fecha_foto': item3.fecha_foto};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarSanitizacionSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'sanitizacion': JSON.stringify(sanitizacion),'datosProductos': JSON.stringify(evidenciaSanitizacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(xhr, status, error) {
                                                                        var err = eval("(" + xhr.responseText + ")");
                                                                        AlmacenarError("Error en el envio desde la app:" + err.Message);
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "recorridoSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Recorrido_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    evidenciaRecorrido[i] = {'Valor':i,'comentarios_bodega':item2.Comentarios_bodega,'comentarios_maq':item2.Comentarios_maq,'nombre_remitente':item2.Nombre_remitente,'nombre_sitio':item2.Nombre_sitio,'pregunta_bodega':item2.Pregunta_bodega,'pregunta_maq1':item2.Pregunta_maq1,'pregunta_maq2':item2.Pregunta_maq2,'fecha_envio':item2.fecha_envio,'ubicacion':item2.ubicacion,'nombre_cliente': item2.nombre_cliente,'puesto':item2.puesto,'puesto_re':item2.puesto_re};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarrecorridoSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'recorrido': JSON.stringify(evidenciaRecorrido),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }else if(tipo == "visitaSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Visita_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    visita[i] = {'Valor':i,'nombre_cliente':item2.nombre_cliente,'nombre_remitente':item2.Nombre_remitente,'fecha_envio':item2.fecha_envio,'ubcacion':item2.ubicacion,'nombre_sitio':item2.Nombre_sitio,'motivo_visita':item2.motivo_vista,'cali_limpieza':item2.cali_limpieza,'cali_ejecutivo':item2.cali_ejecutivo,'cali_gerente':item2.cali_gerente,'comentarios':item2.Comentarios,'compromiso':item2.compromiso};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                              $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarvisitaSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'visita': JSON.stringify(visita),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                            if(dat1 == "CEDULA"){
                                                                                if(dat2 > 0){
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx7){
                                                                                            tx7.executeSql(
                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function(tx7, results){
                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                }
                                                                                            );
                                                                                        }
                                                                                    );
                                                                                }
                                                                            } else {
                                                                                AlmacenarError(respuesta);
                                                                            }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }if(tipo == "encuestaSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Encuesta_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    encuesta[i] = {'Valor':i,'nombre_remitente':item2.Nombre_remitente,'fecha_envio':item2.fecha_envio,'ubicacion':item2.ubicacion,'pregunta1':item2.pregunta1,'pregunta2':item2.pregunta2,'pregunta3':item2.pregunta3,'pregunta4':item2.pregunta4,'pregunta5':item2.pregunta5,'pregunta6':item2.pregunta6,'pregunta7':item2.pregunta7,'nombre_cliente':item2.nombre_cliente,'comentario1':item2.comentarios1,'comentario2':item2.comentarios2,'comentario3':item2.comentarios3,'comentario4':item2.comentarios4,'comentario5':item2.comentarios5,'comentario6':item2.comentarios6,'comentario7':item2.comentarios7,'nombre_sitio':item2.nombre_sitio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarencuestaSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'encuesta': JSON.stringify(encuesta),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "visitaBSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM VisitaB_SURO WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    visitaB[i] = {'Valor':i,'responsable':item2.responsable,'pendientes':item2.pendientes,'fecha':item2.fecha,'almacen1':item2.almacen1,'almacen2':item2.almacen2,'almacen3':item2.almacen3,'almacen4':item2.almacen4,'frecuencia1':item2.frecuencia1,'frecuencia2':item2.frecuencia2,'frecuencia3':item2.frecuencia3,'frecuencia4':item2.frecuencia4,'gestion1':item2.gestion1,'gestion2':item2.gestion2,'gestion3':item2.gestion3,'gestion4':item2.gestion4,'gestion5':item2.gestion5,'gestion6':item2.gestion6,'gestion7':item2.gestion7,'gestion8':item2.gestion8,'gestion9':item2.gestion9,'recorrido1':item2.recorrido1,'recorrido2':item2.recorrido2,'recorrido3':item2.recorrido3,'sitio':item2.sitio,'numero_ti':item2.numero_ti,'nombre_cliente':item2.nombre_cliente};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarvisitaBSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'visitaB': JSON.stringify(visitaB),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if (tipo == "seguimientoSURO"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM Seguimiento WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);

                                                    seguimiento[i] = {'Valor':i,'comentarios':item2.comentarios,'fecha':item2.fecha,'motivo':item2.motivo,'nombre_cliente':item2.nombre_cliente,'observacion':item2.observacion,'sitio':item2.sitio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from Fotos_SURO WHERE id_cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item3 = results.rows.item(i);
                                                                Fotos_SURO[i] = {'Valor':i,'titulo': item3.titulo,'foto': item3.foto,'fecha': item3.fecha,'recorrido': item3.recorrido, 'procesos' : item3.proceso};
                                                            }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarseguimientoSURO.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'seguimiento': JSON.stringify(seguimiento),'fotos': JSON.stringify(Fotos_SURO)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );

                            }

                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "MerGroup"){
            var datosCedulaGeneral = new Array();
            var reporteFotografico = new Array();
            var evidenciaFotografica = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "reporteFotografico"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM reporteFotografico WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    reporteFotografico[i] = {'Valor':i,'id_visita':item2.id_visita,'foto_entrada':item2.foto_entrada,'orden_compra':item2.orden_compra,'nombre_cliente':item2.nombre_cliente,'sitio':item2.sitio,'contratista':item2.contratista,'tipo_proyecto':item2.tipo_proyecto,'region':item2.region,'torre':item2.torre,'proceso':item2.proceso,'foto_salida':item2.foto_salida,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidenciaFotografica WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaFotografica[i] = {'Valor':i,'titulo': item3.titulo,'observacion': item3.observacion,'foto': item3.foto,'fecha_registro': item3.fecha_registro};
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarReporteFotograficoMerGroup.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'reporteFotografico': JSON.stringify(reporteFotografico),'evidenciaFotografica': JSON.stringify(evidenciaFotografica)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "PlatoLimpio"){
            var datosCedulaGeneral = new Array();
            var DatosGenerales = new Array();
            var Ciclo_Charola = new Array();
            var Factor_Humano = new Array();
            var Info_Equipo = new Array ();
            var Capa_Equipo_A = new Array();
            var Capa_Equipo_B = new Array();
            var Tipo_Sistema = new Array();
            var Prueba_Calidad_Agua = new Array();
            var Insumos_A = new Array();
            var Insumos_B = new Array();
            var Insumos_C = new Array();
            var Stress = new Array();
            var Resultados = new Array();
            var Fotos = new Array();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * from DG_PlatoL WHERE DG_ID_Cedula = ?",
                                        [id_cedula],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            for(var i = 0; i< length; i++){
                                                var item1 = results.rows.item(i);
                                                DatosGenerales[i] = {'Valor':i,'empresa': item1.DG_Empresa,'titulo': item1.titulo,'empleados': item1.DG_CEmpleados,'fecha': item1.DG_FechaA, 'Hora': item1.DG_HoraA, 'contacto': item1.DG_Contacto, 'puesto': item1.DG_Puesto, 'correo': item1.DG_Correo, 'telefono': item1.DG_Movil, 'bitacora' : item1.DG_CA_Bitacora, 'prl_observaciones' : item1.DG_PRL_Observaciones, 'fhc_observaciones' : item1.DG_FHC_Observaciones, 'manuales': item1.DG_FHC_Manuales , 'notas' : item1.DG_CE_Notas ,'lavaloza' : item1.DG_CE_Lavaloza , 'nombre_r': item1.Nombre_R , 'comentarios_cierre': item1.Comentarios_Cierre};
                                            }
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("SELECT * from Ciclo_Charola WHERE CC_ID_Cedula = ?",
                                                        [id_cedula],
                                                        function(tx, results){
                                                            var length = results.rows.length;
                                                            for(var i = 0; i< length; i++){
                                                                var item2 = results.rows.item(i);
                                                                console.log("item2",item2)
                                                                Ciclo_Charola[i] = {'Valor':i,'tipo': item2.CC_tipo ,'etapa': item2.CC_Etapa,'escala': item2.CC_Escala,'oportunidad': item2.CC_Oportunidad, 'comentario' : item2.CC_Comentario , 'responsable': item2.CC_Responsable };
                                                            }
                                                            databaseHandler.db.transaction(
                                                                function(tx){
                                                                    tx.executeSql("SELECT * from Factor_Humano WHERE FH_ID_Cedula = ?",
                                                                        [id_cedula],
                                                                        function(tx, results){
                                                                            var length = results.rows.length;
                                                                            for(var i = 0; i< length; i++){
                                                                                var item3 = results.rows.item(i);
                                                                                console.log("item3",item3)
                                                                                Factor_Humano[i] = {'Valor':i,'puesto': item3.FH_Puesto,'capacitacion': item3.FH_Capacitacion,'certificacion': item3.FH_Certificacion,'observacion': item3.FH_Observacion, 'manuales' : item3.FH_Manuales};
                                                                            }
                                                                            databaseHandler.db.transaction(
                                                                                function(tx){
                                                                                    tx.executeSql("SELECT * from Info_Equipo WHERE IE_ID_Cedula = ?",
                                                                                        [id_cedula],
                                                                                        function(tx, results){
                                                                                            var length = results.rows.length;
                                                                                            for(var i = 0; i< length; i++){
                                                                                                var item4 = results.rows.item(i);
                                                                                                Info_Equipo[i] = {'Valor':i,'modelo': item4.IE_Modelo,'numero_serie': item4.IE_NS ,'ubicacion': item4.IE_Ubicacion,'fecha': item4.IE_Fecha, 'uso' : item4.IE_Uso, 'consumo' : item4.IE_Consumo, 'agua' : item4.IE_Agua , 'suministro' : item4.IE_Suministro };
                                                                                            }
                                                                                            databaseHandler.db.transaction(
                                                                                                function(tx){
                                                                                                    tx.executeSql("SELECT * from Capa_Equipo_A WHERE CE_ID_Cedula = ?",
                                                                                                        [id_cedula],
                                                                                                        function(tx, results){
                                                                                                            var length = results.rows.length;
                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                var item5 = results.rows.item(i);
                                                                                                                Capa_Equipo_A[i] = {'Valor':i,'turno': item5.CE_Turno,'horario': item5.CE_Horario,'cantidad': item5.CE_Cantidad};
                                                                                                            }
                                                                                                            databaseHandler.db.transaction(
                                                                                                                function(tx){
                                                                                                                    tx.executeSql("SELECT * from Capa_Equipo_B WHERE CE_ID_Cedula = ?",
                                                                                                                        [id_cedula],
                                                                                                                        function(tx, results){
                                                                                                                            var length = results.rows.length;
                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                var item6 = results.rows.item(i);
                                                                                                                                Capa_Equipo_B[i] = {'Valor':i,'utencilio': item6.CE_Utencilio,'cantidad': item6.CE_Cantidad,'tipo': item6.CE_Tipo,'material': item6.CE_Material};
                                                                                                                            }
                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                function(tx){
                                                                                                                                    tx.executeSql("SELECT * from Tipo_Sistema WHERE TS_ID_Cedula = ?",
                                                                                                                                        [id_cedula],
                                                                                                                                        function(tx, results){
                                                                                                                                            var length = results.rows.length;
                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                var item7 = results.rows.item(i);
                                                                                                                                                Tipo_Sistema[i] = {'Valor':i,'equipo': item7.TS_Equipo,'boiler': item7.TS_Boiler,'booster': item7.TS_Booster,'maquina': item7.TS_Maquina, 'observacion' : item7.TS_Observacion};
                                                                                                                                            }
                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                function(tx){
                                                                                                                                                    tx.executeSql("SELECT * from Prueba_Calidad_Agua WHERE PCA_ID_Cedula = ?",
                                                                                                                                                        [id_cedula],
                                                                                                                                                        function(tx, results){
                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                var item8 = results.rows.item(i);
                                                                                                                                                                Prueba_Calidad_Agua[i] = {'Valor':i,'tipo': item8.PCA_Tipo,'dureza': item8.PCA_Dureza,'partes': item8.PCA_Partes ,'sistema': item8.PCA_Sitema};
                                                                                                                                                            }
                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                function(tx){
                                                                                                                                                                    tx.executeSql("SELECT * from Insumos_A WHERE ID_Cedula = ?",
                                                                                                                                                                        [id_cedula],
                                                                                                                                                                        function(tx, results){
                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                var item9 = results.rows.item(i);
                                                                                                                                                                                Insumos_A[i] = {'Valor':i,'equipo': item9.Equipo,'marca': item9.Marca,'modelo': item9.Modelo,'dosificador': item9.Dosificador};
                                                                                                                                                                            }
                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                function(tx){
                                                                                                                                                                                    tx.executeSql("SELECT * from Insumos_B WHERE ID_Cedula = ?",
                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                var item10 = results.rows.item(i);
                                                                                                                                                                                                Insumos_B[i] = {'Valor':i,'dosificador': item10.Dosificador,'marca': item10.Marca,'modelo': item10.Modelo};
                                                                                                                                                                                            }
                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                    tx.executeSql("SELECT * from Insumos_C WHERE ID_Cedula = ?",
                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                var item11 = results.rows.item(i);
                                                                                                                                                                                                                Insumos_C[i] = {'Valor':i,'horas': item11.Horas,'cantidad': item11.Cantidad};
                                                                                                                                                                                                            }
                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                                    tx.executeSql("SELECT * from Stress WHERE ID_Cedula = ?",
                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                var item12 = results.rows.item(i);
                                                                                                                                                                                                                                Stress[i] = {'Valor':i,'tomas': item12.Tomas,'equipo': item12.Equipo, 'hora' : item12.Hora, 'temp_entrada' : item12.TempeE,'pre_entrada' : item12.PreE, 'temp_salida' : item12.TempeS, 'pre_salida' : item12.PreS, 'bitacora' : item12.Bitacora };
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                                                    tx.executeSql("SELECT * from Resultado WHERE ID_Cedula = ?",
                                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                                var item13 = results.rows.item(i);
                                                                                                                                                                                                                                                Resultados[i] = {'Valor':i,'tipo': item13.Tipo,'suciedad': item13.Suciedad, 'detergente' : item13.Detergente };
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                                                                    tx.executeSql("Select * from PL_Fotos WHERE F_ID_Cedula = ?",
                                                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                                                var item14 = results.rows.item(i);
                                                                                                                                                                                                                                                                Fotos[i] = {'Valor':i,'recorrido': item14.F_Recorrido,'proceso': item14.F_Proceso, 'titulo' : item14.F_titulo, 'fecha' : item14.F_FechaHora , 'foto': item14.F_Foto };
                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                            $.ajax({
                                                                                                                                                                                                                                                                type: "POST",
                                                                                                                                                                                                                                                                async : true,
                                                                                                                                                                                                                                                                url: "http://www.appbennetts.com/FWM2/app/guardarPLCC.php",
                                                                                                                                                                                                                                                                dataType: 'html',
                                                                                                                                                                                                                                                                data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'DatosGenerales': JSON.stringify(DatosGenerales),'Ciclo_Charola': JSON.stringify(Ciclo_Charola),'Factor_Humano': JSON.stringify(Factor_Humano),'Info_Equipo': JSON.stringify(Info_Equipo),'Capa_Equipo_A': JSON.stringify(Capa_Equipo_A),'Capa_Equipo_B': JSON.stringify(Capa_Equipo_B),'Tipo_Sistema': JSON.stringify(Tipo_Sistema ),'Prueba_Calidad_Agua': JSON.stringify(Prueba_Calidad_Agua ),'Insumos_A': JSON.stringify(Insumos_A),'Insumos_B': JSON.stringify(Insumos_B),'Insumos_C': JSON.stringify(Insumos_C),'Stress': JSON.stringify(Stress),'Resultados': JSON.stringify(Resultados),'Fotos': JSON.stringify(Fotos)},
                                                                                                                                                                                                                                                                success: function(respuesta){
                                                                                                                                                                                                                                                                    var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                                                                    var dat1 = respu1[0];
                                                                                                                                                                                                                                                                    var dat2 = respu1[1];
                                                                                                                                                                                                                                                                    if(dat1 == "CEDULA"){
                                                                                                                                                                                                                                                                        if(dat2 > 0){
                                                                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                                                                function(tx7){
                                                                                                                                                                                                                                                                                    tx7.executeSql(
                                                                                                                                                                                                                                                                                        "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                                                                                        function(tx7, results){
                                                                                                                                                                                                                                                                                            localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                                                            swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                            );
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                        AlmacenarError(respuesta);
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                                error: function(){
                                                                                                                                                                                                                                                                    console.log("Error en la comunicacion");
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                                                                            console.log("Error al consultar fotos PL_Fotos: " +error.message);
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                function(error){
                                                                                                                                                                                                                                                    console.log("Error al consultar fotos PL_Fotos: " +error.message);
                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                function(){}
                                                                                                                                                                                                                                            );
                                                                                                                                                                                                                                        },
                                                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                                                            console.log("Error al consultar  Resultado: " +error.message);
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                function(error){
                                                                                                                                                                                                                                    console.log("Error al consultar  Resultado: " +error.message);
                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                function(){}
                                                                                                                                                                                                                            );
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                                            console.log("Error al consultar  Stress: " +error.message);
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    );
                                                                                                                                                                                                                },
                                                                                                                                                                                                                function(error){ console.log("Error al consultar  Stress: " +error.message);},
                                                                                                                                                                                                                function(){}
                                                                                                                                                                                                            );
                                                                                                                                                                                                        },
                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                                        }
                                                                                                                                                                                                    );
                                                                                                                                                                                                },
                                                                                                                                                                                                function(error){
                                                                                                                                                                                                    console.log("Error al consultarInsumos_C : " +error.message);
                                                                                                                                                                                                },
                                                                                                                                                                                                function(){}
                                                                                                                                                                                            );
                                                                                                                                                                                        },
                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                            console.log("Error al consultar Insumos_B: " +error.message);
                                                                                                                                                                                        }
                                                                                                                                                                                    );
                                                                                                                                                                                },
                                                                                                                                                                                function(error){
                                                                                                                                                                                    console.log("Error al consultar Insumos_B: " +error.message);
                                                                                                                                                                                },
                                                                                                                                                                                function(){}
                                                                                                                                                                            );
                                                                                                                                                                        },
                                                                                                                                                                        function(tx, error){
                                                                                                                                                                            console.log("Error al consultar Insumos_A: " +error.message);
                                                                                                                                                                        }
                                                                                                                                                                    );
                                                                                                                                                                },
                                                                                                                                                                function(error){
                                                                                                                                                                    console.log("Error al consultar Insumos_A: " +error.message);
                                                                                                                                                                },
                                                                                                                                                                function(){}
                                                                                                                                                            );
                                                                                                                                                        },
                                                                                                                                                        function(tx, error){
                                                                                                                                                            console.log("Error al consultar Prueba_Calidad_Agua: " +error.message);
                                                                                                                                                        }
                                                                                                                                                    );
                                                                                                                                                },
                                                                                                                                                function(error){
                                                                                                                                                    console.log("Error al consultar Prueba_Calidad_Agua: " +error.message);
                                                                                                                                                },
                                                                                                                                                function(){}
                                                                                                                                            );
                                                                                                                                        },
                                                                                                                                        function(tx, error){
                                                                                                                                            console.log("Error al consultar Tipo_Sistema: " +error.message);
                                                                                                                                        }
                                                                                                                                    );
                                                                                                                                },
                                                                                                                                function(error){
                                                                                                                                    console.log("Error al consultar Tipo_Sistema: " +error.message);
                                                                                                                                },
                                                                                                                                function(){}
                                                                                                                            );
                                                                                                                        },
                                                                                                                        function(tx, error){
                                                                                                                            console.log("Error al consultar Capa_Equipo_B: " +error.message);
                                                                                                                        }
                                                                                                                    );
                                                                                                                },
                                                                                                                function(error){
                                                                                                                    console.log("Error al consultar Capa_Equipo_B: " +error.message);
                                                                                                                },
                                                                                                                function(){}
                                                                                                            );

                                                                                                        },
                                                                                                        function(tx, error){
                                                                                                            console.log("Error al consultar Capa_Equipo_A: " +error.message);
                                                                                                        }
                                                                                                    );
                                                                                                },
                                                                                                function(error){
                                                                                                    console.log("Error al consultar Capa_Equipo_A: " +error.message);
                                                                                                },
                                                                                                function(){}
                                                                                            );
                                                                                        },
                                                                                        function(tx, error){
                                                                                            console.log("Error al consultar Info_Equipo: " +error.message);
                                                                                        }
                                                                                    );
                                                                                },
                                                                                function(error){
                                                                                    console.log("Error al consultar Info_Equipo: " +error.message);
                                                                                },
                                                                                function(){}
                                                                            );

                                                                        },
                                                                        function(tx, error){
                                                                            console.log("Error al consultar Info_Equipo: " +error.message);
                                                                        }
                                                                    );
                                                                },
                                                                function(error){},
                                                                function(){}
                                                            );
                                                        },
                                                        function(tx, error){
                                                            console.log("Error al consultar  Factor_Humano : " +error.message);
                                                        }
                                                    );
                                                },
                                                function(error){
                                                    console.log("Error al consultar  Factor_Humano : " +error.message);
                                                },
                                                function(){}
                                            );
                                        },
                                        function(tx, error){
                                            console.log("Error al consultar Ciclo_Charola : " +error.message);
                                        }
                                    );
                                },
                                function(error){
                                    console.log("Error al consultar Ciclo_Charola : " +error.message);
                                },
                                function(){}
                            );

                        },
                        function(tx, error){
                            console.log("Error al consultar datosCedulaGeneral : " +error.message);
                        }
                    );
                },
                function(error){
                    console.log("Error al consultar datosCedulaGeneral : " +error.message);
                },
                function(){}
            );
        } else if(empresa == "ServInd"){
            var datosCedulaGeneral = new Array();
            var datos_ge = new Array();
            var visita_serv = new Array();
            var encuesta = new Array();
            var checklist = new Array();
            var fotos_check = new Array();
            var papeleta = new Array();
            var refacciones = new Array();
            var fotos_diagnostico = new Array();
            var diagnostico = new Array();
            var diagnostico_servInd = new Array();
            var checklist_servind = new Array();
            var visita_servInd = new Array();
            var datos_eq = new Array();
            var datos_generales_serv = new Array();
            var fotos_posteriores = new Array();
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[i] = {'Valor':i,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                            }
                            if(tipo == "Correctivo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select type_equipo from visita_servInd WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                if(item.type_equipo == 'Frio' || item.type_equipo == 'Caliente'){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * FROM datos_generales_serv WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    var fecha = new Date();
                                                                    var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                    for(var i = 0; i< length; i++){
                                                                        var item2 = results.rows.item(i);
                                                                        datos_ge[i] = {'Valor':i,
                                                                        'id_datos':item2.id_datos,
                                                                        };
                                                                    }
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        var length = results.rows.length;
                                                                                        for(var i = 0; i< length; i++){
                                                                                            var item3 = results.rows.item(i);
                                                                                            visita_serv[i] = {'Valor':i,
                                                                                            'id_visita':item3.id_visita,
                                                                                            'H_espera': item3.H_espera,
                                                                                            'H_totales': item3.H_totales,
                                                                                            'H_trabajo':item3.H_trabajo,
                                                                                            'H_viaje':item3.H_viaje,
                                                                                            'amp':item3.amp,
                                                                                            'comentarios_entrega':item3.comentarios_entrega,
                                                                                            'como_encontro':item3.como_encontro,
                                                                                            'como_entrego':item3.como_entrego,
                                                                                            'falla_reportada':item3.falla_reportada,
                                                                                            'papeleta':item3.papeleta,
                                                                                            'refacciones':item3.refacciones,
                                                                                            'tierra_fisica':item3.tierra_fisica,
                                                                                            'trabajo_realizado':item3.trabajo_realizado,
                                                                                            'voltaje':item3.voltaje,
                                                                                            'firma_tecnico':item3.firma_tecnico,
                                                                                            'foto_salida':item3.foto_salida,
                                                                                            'firma_cliente':item3.firma_cliente,
                                                                                            'foto_sello':item3.foto_sello,
                                                                                            'fecha_cliente':item3.fecha_cliente,
                                                                                            'wc':item3.wc,
                                                                                            'viaticos':item3.viaticos,
                                                                                            'estatus_ced':item3.estatus_ced,
                                                                                            'ciudad':item3.ciudad,
                                                                                            'cliente':item3.cliente,
                                                                                            'correo':item3.correo,
                                                                                            'direccion':item3.direccion,
                                                                                            'equipo':item3.equipo,
                                                                                            'fecha':item3.fecha,
                                                                                            'foto_llegada':item3.foto_llegada,
                                                                                            'id_cliente':item3.id_cliente,
                                                                                            'marca':item3.marca,
                                                                                            'ml':item3.ml,
                                                                                            'modelo':item3.modelo,
                                                                                            'no_orden':item3.no_orden,
                                                                                            'nombre_comercial':item3.nombre_comercial,
                                                                                            'serie':item3.serie,'observaciones_papeleta':item3.observaciones_papeleta,
                                                                                            'sucursal_cliente':item3.sucursal_cliente,'otras_condiciones2':item3.otras_condiciones2,
                                                                                            'telefono':item3.telefono,'otras_condiciones':item3.otras_condiciones,
                                                                                            'tipo_servicio':item3.tipo_servicio,'type_equipo':item3.type_equipo};
                                                                                            //los nuevos fueron desde ciudad
                                                                                        }
                                                                                            databaseHandler.db.transaction(
                                                                                                function(tx){
                                                                                                    tx.executeSql("SELECT * from encuesta_serv WHERE id_cedula = ?",
                                                                                                        [id_cedula],
                                                                                                        function(tx, results){
                                                                                                            var length = results.rows.length;
                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                var item4 = results.rows.item(i);
                                                                                                                encuesta[i] = {'Valor':i,
                                                                                                                'atencion':item4.atencion,
                                                                                                                'capacidad': item4.capacidad,
                                                                                                                'fecha_encuesta': item4.fecha_encuesta,
                                                                                                                'id_encuesta':item4.id_encuesta,
                                                                                                                'rapidez':item4.rapidez,
                                                                                                                'recomienda':item4.recomienda,
                                                                                                                'satisfaccion':item4.satisfaccion};
                                                                                                            }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from checklist_servind WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item5 = results.rows.item(i);
                                                                                                                                    checklist[i] = {'Valor':i,
                                                                                                                                    'fase':item5.fase,
                                                                                                                                    'id_cedula':item5.id_cedula,
                                                                                                                                    'id_pregunta': item5.id_pregunta,
                                                                                                                                    'id_equipo': item5.id_equipo,
                                                                                                                                    'no_pregunta':item5.no_pregunta,
                                                                                                                                    'pregunta':item5.pregunta,
                                                                                                                                    'tipo':item5.tipo,
                                                                                                                                    'valor_p':item5.valor};
                                                                                                                                }
                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                        function(tx){
                                                                                                                                            tx.executeSql("SELECT * from fotos_check WHERE id_cedula = ?",
                                                                                                                                                [id_cedula],
                                                                                                                                                function(tx, results){
                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                        var item6 = results.rows.item(i);
                                                                                                                                                        fotos_check[i] = {'Valor':i,
                                                                                                                                                        'fase':item6.fase,
                                                                                                                                                        'fecha_foto': item6.fecha_foto,
                                                                                                                                                        'foto': item6.foto,
                                                                                                                                                        'id_foto':item6.id_foto,
                                                                                                                                                        'id_equipo':item6.id_equipo,
                                                                                                                                                        'no_pregunta':item6.no_pregunta,
                                                                                                                                                        'observaciones':item6.observaciones,
                                                                                                                                                        'pregunta':item6.pregunta};
                                                                                                                                                    }
                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                            function(tx){
                                                                                                                                                                tx.executeSql("SELECT * from papeleta WHERE id_cedula = ?",
                                                                                                                                                                    [id_cedula],
                                                                                                                                                                    function(tx, results){
                                                                                                                                                                        var length = results.rows.length;
                                                                                                                                                                        for(var i = 0; i< length; i++){
                                                                                                                                                                            var item7 = results.rows.item(i);
                                                                                                                                                                            papeleta[i] = {'Valor':i,
                                                                                                                                                                            'cantidad':item7.cantidad,
                                                                                                                                                                            'descripcion': item7.descripcion,
                                                                                                                                                                            'fecha_registro': item7.fecha_registro,
                                                                                                                                                                            'foto_papeleta':item7.foto_papeleta,
                                                                                                                                                                            'id_papeleta':item7.id_papeleta,
                                                                                                                                                                            'numero_parte':item7.numero_parte,
                                                                                                                                                                            'prioridad':item7.prioridad,
                                                                                                                                                                            'motivo_pr':item7.motivo_pr};
                                                                                                                                                                        }
                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                function(tx){
                                                                                                                                                                                    tx.executeSql("SELECT * from refacciones WHERE id_cedula = ?",
                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                var item8 = results.rows.item(i);
                                                                                                                                                                                                refacciones[i] = {'Valor':i,
                                                                                                                                                                                                'descripcion':item8.descripcion,
                                                                                                                                                                                                'fecha_registro': item8.fecha_registro,
                                                                                                                                                                                                'foto_refa': item8.foto_refa,
                                                                                                                                                                                                'id_refaccion':item8.id_refaccion,
                                                                                                                                                                                                'numero_parte':item8.numero_parte,
                                                                                                                                                                                                'parte':item8.parte};
                                                                                                                                                                                            }
                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                    tx.executeSql("SELECT * from fotos_diagnostico WHERE id_cedula = ?",
                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                var item9 = results.rows.item(i);
                                                                                                                                                                                                                fotos_diagnostico[i] = {'Valor':i,
                                                                                                                                                                                                                'fecha':item9.fecha,
                                                                                                                                                                                                                'foto': item9.foto,
                                                                                                                                                                                                                'id_foto':item9.id_foto,
                                                                                                                                                                                                                'tipo':item9.tipo};
                                                                                                                                                                                                            }
                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                                    tx.executeSql("SELECT * from fotos_posteriores WHERE id_cedula = ?",
                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                var item11 = results.rows.item(i);
                                                                                                                                                                                                                                fotos_posteriores[i] = {'Valor':i,
                                                                                                                                                                                                                                    'foto':item11.foto,
                                                                                                                                                                                                                                    'fecha_registro': item11.fecha_registro
                                                                                                                                                                                                                                };
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                            if(item3.estatus_ced==3){
                                                                                                                                                                                                                                //console.log("es ced 3");//que es igual a pendiente
                                                                                                                                                                                                                                $.ajax({
                                                                                                                                                                                                                                    type: "POST",
                                                                                                                                                                                                                                    async : true,
                                                                                                                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCheckServ.php",
                                                                                                                                                                                                                                    dataType: 'html',
                                                                                                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                                                    'refacciones': JSON.stringify(refacciones),
                                                                                                                                                                                                                                    'fotos_check': JSON.stringify(fotos_check),
                                                                                                                                                                                                                                    'checklist': JSON.stringify(checklist),
                                                                                                                                                                                                                                    'encuesta': JSON.stringify(encuesta),
                                                                                                                                                                                                                                    'visita_serv': JSON.stringify(visita_serv),
                                                                                                                                                                                                                                    'datos_ge': JSON.stringify(datos_ge),
                                                                                                                                                                                                                                    'fotos_posteriores': JSON.stringify(fotos_posteriores),
                                                                                                                                                                                                                                    'fotos_diagnostico': JSON.stringify(fotos_diagnostico)
                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                    success: function(respuesta){
                                                                                                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                                                                                                            if(dat2 > 0){
                                                                                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                                                                                    function(tx7){
                                                                                                                                                                                                                                                        tx7.executeSql(
                                                                                                                                                                                                                                                            "UPDATE visita_servInd SET id_servidor ='"+dat2+"' WHERE id_cedula = ?",
                                                                                                                                                                                                                                                            [id_cedula],
                                                                                                                                                                                                                                                            function(tx7, results){
                                                                                                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                                                                                                    function(tx8){
                                                                                                                                                                                                                                                                        tx8.executeSql(
                                                                                                                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                                            [id_cedula],
                                                                                                                                                                                                                                                                            function(tx8, results){
                                                                                                                                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                );
                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                );
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                    error: function(){
                                                                                                                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                });
                                                                                                                                                                                                                            }else if (item3.estatus_ced==4){
                                                                                                                                                                                                                                 //console.log("ced no 3");//que es normal
                                                                                                                                                                                                                                 $.ajax({
                                                                                                                                                                                                                                    type: "POST",
                                                                                                                                                                                                                                    async : true,
                                                                                                                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCheckServ_Repro.php",
                                                                                                                                                                                                                                    dataType: 'html',
                                                                                                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                                                    'visita_serv': JSON.stringify(visita_serv)
                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                    success: function(respuesta){
                                                                                                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                                                                                                            if(dat2 > 0){//  papeleta  id_cedula  id_papeleta
                                                                                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                                                                                    function(tx8){
                                                                                                                                                                                                                                                        tx8.executeSql(
                                                                                                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                            [id_cedula],
                                                                                                                                                                                                                                                            function(tx8, results){
                                                                                                                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                );
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                    error: function(){
                                                                                                                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                });
                                                                                                                                                                                                                            }else{
                                                                                                                                                                                                                                //console.log("ced no 3");//que es normal
                                                                                                                                                                                                                                $.ajax({
                                                                                                                                                                                                                                    type: "POST",
                                                                                                                                                                                                                                    async : true,
                                                                                                                                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCheckServ.php",
                                                                                                                                                                                                                                    dataType: 'html',
                                                                                                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                                                    'refacciones': JSON.stringify(refacciones),
                                                                                                                                                                                                                                    'papeleta': JSON.stringify(papeleta),
                                                                                                                                                                                                                                    'fotos_check': JSON.stringify(fotos_check),
                                                                                                                                                                                                                                    'checklist': JSON.stringify(checklist),
                                                                                                                                                                                                                                    'encuesta': JSON.stringify(encuesta),
                                                                                                                                                                                                                                    'visita_serv': JSON.stringify(visita_serv),
                                                                                                                                                                                                                                    'datos_ge': JSON.stringify(datos_ge),
                                                                                                                                                                                                                                    'fotos_posteriores': JSON.stringify(fotos_posteriores),
                                                                                                                                                                                                                                    'fotos_diagnostico': JSON.stringify(fotos_diagnostico)
                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                    success: function(respuesta){
                                                                                                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                                                                                                            if(dat2 > 0){//  papeleta  id_cedula  id_papeleta
                                                                                                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                                                                                                    function(tx8){
                                                                                                                                                                                                                                                        tx8.executeSql(
                                                                                                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                            [id_cedula],
                                                                                                                                                                                                                                                            function(tx8, results){
                                                                                                                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                );
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                    error: function(){
                                                                                                                                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                });
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    );
                                                                                                                                                                                                                },
                                                                                                                                                                                                                function(error){},
                                                                                                                                                                                                                function(){}
                                                                                                                                                                                                            );
                                                                                                                                                                                                        },
                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                                        }
                                                                                                                                                                                                    );
                                                                                                                                                                                                },
                                                                                                                                                                                                function(error){},
                                                                                                                                                                                                function(){}
                                                                                                                                                                                            );
                                                                                                                                                                                        },
                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                        }
                                                                                                                                                                                    );
                                                                                                                                                                                },
                                                                                                                                                                                function(error){},
                                                                                                                                                                                function(){}
                                                                                                                                                                            );
                                                                                                                                                                    },
                                                                                                                                                                    function(tx, error){
                                                                                                                                                                        console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                    }
                                                                                                                                                                );
                                                                                                                                                            },
                                                                                                                                                            function(error){},
                                                                                                                                                            function(){}
                                                                                                                                                        );
                                                                                                                                                },
                                                                                                                                                function(tx, error){
                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        },
                                                                                                                                        function(error){},
                                                                                                                                        function(){}
                                                                                                                                    );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            
                                                                                                        },
                                                                                                        function(tx, error){
                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                        }
                                                                                                    );
                                                                                                },
                                                                                                function(error){},
                                                                                                function(){}
                                                                                            );
                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar sanitizacion: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                }else if(item.type_equipo == 'Rational'){
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * FROM diagnostico_servInd WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    var fecha = new Date();
                                                                    var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                    for(var i = 0; i< length; i++){
                                                                        var item2 = results.rows.item(i);
                                                                        diagnostico_servInd[i] = {'Valor':i,
                                                                        'foto_diagnostico': item2.foto_diagnostico,'falla_en': item2.falla_en, 'diagnostico': item2.diagnostico, 'sw': item2.sw,'usbInfo': item2.usbInfo,'usbHa': item2.usbHa};
                                                                    }
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                                                                                [id_cedula],
                                                                                function(tx, results){
                                                                                    var length = results.rows.length;
                                                                                    for(var i = 0; i< length; i++){
                                                                                        var item3 = results.rows.item(i);
                                                                                        visita_servInd[i] = {'Valor':i,'no_orden': item3.no_orden, 
                                                                                        'fecha': item3.fecha, 
                                                                                        'foto_llegada': item3.foto_llegada, 
                                                                                        'tipo_servicio': item3.tipo_servicio, 
                                                                                        'id_cliente':item3.id_cliente, 
                                                                                        'cliente': item3.cliente, 
                                                                                        'nombre_comercial': item3.nombre_comercial,
                                                                                        'sucursal_cliente': item3.sucursal_cliente,
                                                                                        'direccion': item3.direccion,
                                                                                        'ciudad': item3.ciudad, 
                                                                                        'telefono': item3.telefono,
                                                                                        'correo':item3.correo, 
                                                                                        'equipo':item3.equipo, 
                                                                                        'marca': item3.marca,
                                                                                        'modelo': item3.modelo,
                                                                                        'serie': item3.serie, 
                                                                                        'ml': item3.ml,
                                                                                        'voltaje': item3.voltaje, 
                                                                                        'amp': item3.amp, 
                                                                                        'wc': item3.wc,
                                                                                        'tierra_fisica':item3.tierra_fisica, 
                                                                                        'falla_reportada': item3.falla_reportada,
                                                                                        'como_encontro': item3.como_encontro,
                                                                                        'comentarios_entrega': item3.comentarios_entrega, 
                                                                                        'diagnotico_corecto': item3.diagnotico_corecto,
                                                                                        'trabajo_realizado': item3.trabajo_realizado,
                                                                                        'como_entrego': item3.como_entrego, 
                                                                                        'papeleta':item3.papeleta, 
                                                                                        'refacciones': item3.refacciones, 
                                                                                        'viaticos': item3.viaticos, 
                                                                                        'H_viaje': item3.H_viaje, 
                                                                                        'H_espera': item3.H_espera, 
                                                                                        'H_trabajo': item3.H_trabajo , 
                                                                                        'H_totales': item3.H_totales, 
                                                                                        'estatus_ced':item3.estatus_ced,'observaciones_papeleta':item3.observaciones_papeleta,
                                                                                        'firma_cliente': item3.firma_cliente, 'otras_condiciones2':item3.otras_condiciones2,
                                                                                        'foto_sello': item3.foto_sello , 'otras_condiciones':item3.otras_condiciones,
                                                                                        'foto_salida':  item3.foto_salida, 'gas_30': item3.gas_30,
                                                                                        'gas_20': item3.gas_20, 'observacion_rational': item3.observacion_rational,
                                                                                        'filtro': item3.filtro,'transformadores_rational':item3.transformadores_rational,
                                                                                        'extracion': item3.extracion,'fusibles_rational':item3.fusibles_rational,
                                                                                        'fecha_cliente':item3.fecha_cliente, 'firma_tecnico':item3.firma_tecnico};
                                                                                    }
                                                                                    databaseHandler.db.transaction(
                                                                                        function(tx){
                                                                                            tx.executeSql("SELECT * from fotos_diagnostico WHERE id_cedula = ?",
                                                                                                [id_cedula],
                                                                                                function(tx, results){
                                                                                                    var length = results.rows.length;
                                                                                                    for(var i = 0; i< length; i++){
                                                                                                        var item9 = results.rows.item(i);
                                                                                                        fotos_diagnostico[i] = {'Valor':i,
                                                                                                        'foto':item9.foto,
                                                                                                         'fecha': item9.fecha ,
                                                                                                         'tipo': item9.tipo};
                                                                                                    }
                                                                                                    databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from checklist_servind WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item4 = results.rows.item(i);
                                                                                                                    checklist_servind[i] = {'Valor':i,'fase': item4.fase,'pregunta': item4.pregunta,'tipo': item4.tipo,'valor': item4.valor,'no_pregunta': item4.no_pregunta};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from fotos_check WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item5= results.rows.item(i);
                                                                                                                                    fotos_check[i] = {'Valor':i,'foto': item5.foto, 'pregunta': item5.pregunta , 'fase': item5.fase, 'observaciones': item5.observaciones, 'fecha_foto': item5.fecha_foto,'no_pregunta':item5.no_pregunta};
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from papeleta WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                                                    papeleta[i] = {'Valor':i,
                                                                                                                                                    'cantidad':item7.cantidad,
                                                                                                                                                    'descripcion': item7.descripcion,
                                                                                                                                                    'fecha_registro': item7.fecha_registro,
                                                                                                                                                    'foto_papeleta':item7.foto_papeleta,
                                                                                                                                                    'id_papeleta':item7.id_papeleta,
                                                                                                                                                    'numero_parte':item7.numero_parte,
                                                                                                                                                    'motivo_pr':item7.motivo_pr,
                                                                                                                                                    'prioridad':item7.prioridad};
                                                                                                                                                }
                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                    function(tx){
                                                                                                                                                        tx.executeSql("SELECT * from refacciones WHERE id_cedula = ?",
                                                                                                                                                            [id_cedula],
                                                                                                                                                            function(tx, results){
                                                                                                                                                                var length = results.rows.length;
                                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                                    refacciones[i] = {'Valor':i,
                                                                                                                                                                    'descripcion':item8.descripcion,
                                                                                                                                                                    'fecha_registro': item8.fecha_registro,
                                                                                                                                                                    'foto_refa': item8.foto_refa,
                                                                                                                                                                    'id_refaccion':item8.id_refaccion,
                                                                                                                                                                    'numero_parte':item8.numero_parte,
                                                                                                                                                                    'parte':item8.parte};
                                                                                                                                                                }
                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                        function(tx){
                                                                                                                                                                            tx.executeSql("SELECT * from encuesta_serv WHERE id_cedula = ?",
                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                function(tx, results){
                                                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                                                        var item6 = results.rows.item(i);
                                                                                                                                                                                        encuesta[i] = {'Valor':i,
                                                                                                                                                                                        'atencion':item6.atencion,
                                                                                                                                                                                        'capacidad': item6.capacidad,
                                                                                                                                                                                        'fecha_encuesta': item6.fecha_encuesta,
                                                                                                                                                                                        'id_encuesta':item6.id_encuesta,
                                                                                                                                                                                        'rapidez':item6.rapidez,
                                                                                                                                                                                        'recomienda':item6.recomienda,
                                                                                                                                                                                        'satisfaccion':item6.satisfaccion};
                                                                                                                                                                                    }
                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                        function(tx){
                                                                                                                                                                                            tx.executeSql("SELECT * from fotos_posteriores WHERE id_cedula = ?",
                                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                                function(tx, results){
                                                                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                                                                        var item11 = results.rows.item(i);
                                                                                                                                                                                                        fotos_posteriores[i] = {'Valor':i,
                                                                                                                                                                                                            'foto':item11.foto,
                                                                                                                                                                                                            'fecha_registro': item11.fecha_registro
                                                                                                                                                                                                        };
                                                                                                                                                                                                    }
                                                                                                                                                                                                    if(item3.estatus_ced==3){
                                                                                                                                                                                                        $.ajax({
                                                                                                                                                                                                            type: "POST",
                                                                                                                                                                                                            async : true,
                                                                                                                                                                                                            url: "http://www.appbennetts.com/FWM2/app/guardarRationalServInd.php",
                                                                                                                                                                                                            dataType: 'html',
                                                                                                                                                                                                            data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                            'fotos_check': JSON.stringify(fotos_check),
                                                                                                                                                                                                            'checklist_servind': JSON.stringify(checklist_servind),
                                                                                                                                                                                                            'visita_servInd': JSON.stringify(visita_servInd),
                                                                                                                                                                                                            'diagnostico_servInd': JSON.stringify(diagnostico_servInd),
                                                                                                                                                                                                            'refacciones': JSON.stringify(refacciones),
                                                                                                                                                                                                            'encuesta': JSON.stringify(encuesta),
                                                                                                                                                                                                            'fotos_posteriores': JSON.stringify(fotos_posteriores),
                                                                                                                                                                                                            'fotos_diagnostico': JSON.stringify(fotos_diagnostico)},
                                                                                                                                                                                                            success: function(respuesta){
                                                                                                                                                                                                                var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                var dat1 = respu1[0];
                                                                                                                                                                                                                var dat2 = respu1[1];
                                                                                                                                                                                                                if(dat1 == "CEDULA"){
                                                                                                                                                                                                                    if(dat2 > 0){
                                                                                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                                                                                            function(tx7){
                                                                                                                                                                                                                                tx7.executeSql(
                                                                                                                                                                                                                                    "UPDATE visita_servInd SET id_servidor ='"+dat2+"' WHERE id_cedula = ?",
                                                                                                                                                                                                                                    [id_cedula],
                                                                                                                                                                                                                                    function(tx7, results){
                                                                                                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                                                                                                            function(tx8){
                                                                                                                                                                                                                                                tx8.executeSql(
                                                                                                                                                                                                                                                    "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                    [id_cedula],
                                                                                                                                                                                                                                                    function(tx8, results){
                                                                                                                                                                                                                                                        localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                        swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                );
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                        );
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                );
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        );
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                }
                                                                                                                                                                                                            },
                                                                                                                                                                                                            error: function(){
                                                                                                                                                                                                                console.log("Error en la comunicacion");
                                                                                                                                                                                                            }
                                                                                                                                                                                                        });
                                                                                                                                                                                                    } else if(item3.estatus_ced==4){
                                                                                                                                                                                                        $.ajax({
                                                                                                                                                                                                            type: "POST",
                                                                                                                                                                                                            async : true,
                                                                                                                                                                                                            url: "http://www.appbennetts.com/FWM2/app/guardarRationalServInd_Repro.php",
                                                                                                                                                                                                            dataType: 'html',
                                                                                                                                                                                                            data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                                'visita_servInd': JSON.stringify(visita_servInd),
                                                                                                                                                                                                            },
                                                                                                                                                                                                            success: function(respuesta){
                                                                                                                                                                                                                var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                var dat1 = respu1[0];
                                                                                                                                                                                                                var dat2 = respu1[1];
                                                                                                                                                                                                                if(dat1 == "CEDULA"){
                                                                                                                                                                                                                    if(dat2 > 0){
                                                                                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                                                                                            function(tx7){
                                                                                                                                                                                                                                tx7.executeSql(
                                                                                                                                                                                                                                    "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                    [id_cedula],
                                                                                                                                                                                                                                    function(tx7, results){
                                                                                                                                                                                                                                        localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                        swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                );
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        );
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                }else{
                                                                                                                                                                                                                    AlmacenarError(respuesta);
                                                                                                                                                                                                                }
                                                                                                                                                                                                            },
                                                                                                                                                                                                            error: function(){
                                                                                                                                                                                                                console.log("Error en la comunicacion");
                                                                                                                                                                                                            }
                                                                                                                                                                                                        });
                                                                                                                                                                                                    } else{
                                                                                                                                                                                                        $.ajax({
                                                                                                                                                                                                            type: "POST",
                                                                                                                                                                                                            async : true,
                                                                                                                                                                                                            url: "http://www.appbennetts.com/FWM2/app/guardarRationalServInd.php",
                                                                                                                                                                                                            dataType: 'html',
                                                                                                                                                                                                            data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                            'fotos_check': JSON.stringify(fotos_check),
                                                                                                                                                                                                            'checklist_servind': JSON.stringify(checklist_servind),
                                                                                                                                                                                                            'visita_servInd': JSON.stringify(visita_servInd),
                                                                                                                                                                                                            'diagnostico_servInd': JSON.stringify(diagnostico_servInd),
                                                                                                                                                                                                            'refacciones': JSON.stringify(refacciones),
                                                                                                                                                                                                            'papeleta': JSON.stringify(papeleta),
                                                                                                                                                                                                            'fotos_posteriores': JSON.stringify(fotos_posteriores),
                                                                                                                                                                                                            'encuesta': JSON.stringify(encuesta),
                                                                                                                                                                                                            'fotos_diagnostico': JSON.stringify(fotos_diagnostico)},
                                                                                                                                                                                                            success: function(respuesta){
                                                                                                                                                                                                                var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                var dat1 = respu1[0];
                                                                                                                                                                                                                var dat2 = respu1[1];
                                                                                                                                                                                                                if(dat1 == "CEDULA"){
                                                                                                                                                                                                                    if(dat2 > 0){
                                                                                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                                                                                            function(tx7){
                                                                                                                                                                                                                                tx7.executeSql(
                                                                                                                                                                                                                                    "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                    [id_cedula],
                                                                                                                                                                                                                                    function(tx7, results){
                                                                                                                                                                                                                                        localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                        swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                );
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        );
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                }else{
                                                                                                                                                                                                                    AlmacenarError(respuesta);
                                                                                                                                                                                                                }
                                                                                                                                                                                                            },
                                                                                                                                                                                                            error: function(){
                                                                                                                                                                                                                console.log("Error en la comunicacion");
                                                                                                                                                                                                            }
                                                                                                                                                                                                        });
                                                                                                                                                                                                    }
                                                                                                                                                                                                },
                                                                                                                                                                                                function(tx, error){
                                                                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                                }
                                                                                                                                                                                            );
                                                                                                                                                                                        },
                                                                                                                                                                                        function(error){},
                                                                                                                                                                                        function(){}
                                                                                                                                                                                    );
                                                                                                                                                                                },
                                                                                                                                                                                function(tx, error){
                                                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                }
                                                                                                                                                                            );
                                                                                                                                                                        },
                                                                                                                                                                        function(error){},
                                                                                                                                                                        function(){}
                                                                                                                                                                    );
                                                                                                                                                            },
                                                                                                                                                            function(tx, error){
                                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                            }
                                                                                                                                                        );
                                                                                                                                                    },
                                                                                                                                                    function(error){},
                                                                                                                                                    function(){}
                                                                                                                                                );
                                                                                                                                            },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){},
                                                                                                                                    function(){}
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                                },
                                                                                                function(tx, error){
                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                }
                                                                                            );
                                                                                        },
                                                                                        function(error){},
                                                                                        function(){}
                                                                                    );
                                                                                },
                                                                                function(tx, error){
                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar sanitizacion: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                }
                                            },
                                            function(tx, error){}
                                        );  
                                    }, function(error){},function(){}
                                );
                            }else if(tipo == "PMP_Caliente" || tipo == "PMP_Frio"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_serv WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datos_ge[i] = {'Valor':i,
                                                    'id_datos':item2.id_datos,
                                                    'ciudad':item2.ciudad,
                                                    'cliente':item2.cliente,
                                                    'correo':item2.correo,
                                                    'direccion':item2.direccion,
                                                    'equipo':item2.equipo,
                                                    'fecha':item2.fecha,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'firma_tecnico':item2.firma_tecnico,
                                                    'foto_llegada':item2.foto_llegada,
                                                    'foto_salida':item2.foto_salida,
                                                    'foto_sello':item2.foto_sello,
                                                    'id_cliente':item2.id_cliente,
                                                    'marca':item2.marca,
                                                    'ml':item2.ml,
                                                    'modelo':item2.modelo,
                                                    'no_orden':item2.no_orden,
                                                    'nombre_comercial':item2.nombre_comercial,
                                                    'serie':item2.serie,
                                                    'sucursal_cliente':item2.sucursal_cliente,
                                                    'telefono':item2.telefono,
                                                    'tipo_servicio':item2.tipo_servicio};
                                                }
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                                                                [id_cedula],
                                                                function(tx, results){
                                                                    var length = results.rows.length;
                                                                    for(var i = 0; i< length; i++){
                                                                        var item3 = results.rows.item(i);
                                                                        visita_serv[i] = {'Valor':i,
                                                                        'id_visita':item3.id_visita,
                                                                        'H_espera': item3.H_espera,
                                                                        'H_totales': item3.H_totales,
                                                                        'H_trabajo':item3.H_trabajo,
                                                                        'H_viaje':item3.H_viaje,
                                                                        'comentarios_entrega':item3.comentarios_entrega,
                                                                        'como_entrego':item3.como_entrego,
                                                                        'papeleta':item3.papeleta,
                                                                        'refacciones':item3.refacciones,
                                                                        'trabajo_realizado':item3.trabajo_realizado,
                                                                        'viaticos':item3.viaticos,'estatus_ced':item3.estatus_ced};
                                                                    }
                                                                        databaseHandler.db.transaction(
                                                                            function(tx){
                                                                                tx.executeSql("SELECT * from encuesta_serv WHERE id_cedula = ?",
                                                                                    [id_cedula],
                                                                                    function(tx, results){
                                                                                        var length = results.rows.length;
                                                                                        for(var i = 0; i< length; i++){
                                                                                            var item4 = results.rows.item(i);
                                                                                            encuesta[i] = {'Valor':i,
                                                                                            'atencion':item4.atencion,
                                                                                            'capacidad': item4.capacidad,
                                                                                            'fecha_encuesta': item4.fecha_encuesta,
                                                                                            'id_encuesta':item4.id_encuesta,
                                                                                            'rapidez':item4.rapidez,
                                                                                            'recomienda':item4.recomienda,
                                                                                            'satisfaccion':item4.satisfaccion};
                                                                                        }
                                                                                            databaseHandler.db.transaction(
                                                                                                function(tx){
                                                                                                    tx.executeSql("SELECT * from checklist_servind WHERE id_cedula = ?",
                                                                                                        [id_cedula],
                                                                                                        function(tx, results){
                                                                                                            var length = results.rows.length;
                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                var item5 = results.rows.item(i);
                                                                                                                checklist[i] = {'Valor':i,
                                                                                                                'fase':item5.fase,
                                                                                                                'id_cedula':item5.id_cedula,
                                                                                                                'id_pregunta': item5.id_pregunta,
                                                                                                                'id_equipo': item5.id_equipo,
                                                                                                                'no_pregunta':item5.no_pregunta,
                                                                                                                'pregunta':item5.pregunta,
                                                                                                                'tipo':item5.tipo,
                                                                                                                'valor_p':item5.valor};
                                                                                                            }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from fotos_check WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                                    fotos_check[i] = {'Valor':i,
                                                                                                                                    'fase':item6.fase,
                                                                                                                                    'fecha_foto': item6.fecha_foto,
                                                                                                                                    'foto': item6.foto,
                                                                                                                                    'id_foto':item6.id_foto,
                                                                                                                                    'id_equipo':item6.id_equipo,
                                                                                                                                    'no_pregunta':item6.no_pregunta,
                                                                                                                                    'observaciones':item6.observaciones,
                                                                                                                                    'pregunta':item6.pregunta};
                                                                                                                                }
                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                        function(tx){
                                                                                                                                            tx.executeSql("SELECT * from papeleta WHERE id_cedula = ?",
                                                                                                                                                [id_cedula],
                                                                                                                                                function(tx, results){
                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                        var item7 = results.rows.item(i);
                                                                                                                                                        papeleta[i] = {'Valor':i,
                                                                                                                                                        'cantidad':item7.cantidad,
                                                                                                                                                        'descripcion': item7.descripcion,
                                                                                                                                                        'fecha_registro': item7.fecha_registro,
                                                                                                                                                        'foto_papeleta':item7.foto_papeleta,
                                                                                                                                                        'id_papeleta':item7.id_papeleta,
                                                                                                                                                        'numero_parte':item7.numero_parte,
                                                                                                                                                        'prioridad':item7.prioridad,
                                                                                                                                                        'motivo_pr':item7.motivo_pr};
                                                                                                                                                    }
                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                            function(tx){
                                                                                                                                                                tx.executeSql("SELECT * from refacciones WHERE id_cedula = ?",
                                                                                                                                                                    [id_cedula],
                                                                                                                                                                    function(tx, results){
                                                                                                                                                                        var length = results.rows.length;
                                                                                                                                                                        for(var i = 0; i< length; i++){
                                                                                                                                                                            var item8 = results.rows.item(i);
                                                                                                                                                                            refacciones[i] = {'Valor':i,
                                                                                                                                                                            'descripcion':item8.descripcion,
                                                                                                                                                                            'fecha_registro': item8.fecha_registro,
                                                                                                                                                                            'foto_refa': item8.foto_refa,
                                                                                                                                                                            'id_refaccion':item8.id_refaccion,
                                                                                                                                                                            'numero_parte':item8.numero_parte,
                                                                                                                                                                            'parte':item8.parte};
                                                                                                                                                                        }
                                                                                                                                                                        databaseHandler.db.transaction(
                                                                                                                                                                            function(tx){
                                                                                                                                                                                tx.executeSql("SELECT * from fotos_diagnostico WHERE id_cedula = ?",
                                                                                                                                                                                    [id_cedula],
                                                                                                                                                                                    function(tx, results){
                                                                                                                                                                                        var length = results.rows.length;
                                                                                                                                                                                        for(var i = 0; i< length; i++){
                                                                                                                                                                                            var item9 = results.rows.item(i);
                                                                                                                                                                                            fotos_diagnostico[i] = {'Valor':i,
                                                                                                                                                                                            'fecha':item9.fecha,
                                                                                                                                                                                            'foto': item9.foto,
                                                                                                                                                                                            'id_foto':item9.id_foto,
                                                                                                                                                                                            'tipo':item9.tipo};
                                                                                                                                                                                        }
                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                function(tx){
                                                                                                                                                                                                    tx.executeSql("SELECT * from diagnostico_servIndHBE WHERE id_cedula = ?",
                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                        function(tx, results){
                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                var item10 = results.rows.item(i);
                                                                                                                                                                                                                diagnostico[i] = {'Valor':i,
                                                                                                                                                                                                                'comentario':item10.comentario,
                                                                                                                                                                                                                'pregunta': item10.pregunta,
                                                                                                                                                                                                                'id_cedula':item10.id_cedula};
                                                                                                                                                                                                            }
                                                                                                                                                                                                                console.log(datosCedulaGeneral);
                                                                                                                                                                                                                console.log(refacciones);
                                                                                                                                                                                                                console.log(papeleta);
                                                                                                                                                                                                                console.log(fotos_check);
                                                                                                                                                                                                                console.log(checklist);
                                                                                                                                                                                                                console.log(encuesta);
                                                                                                                                                                                                                console.log(visita_serv);
                                                                                                                                                                                                                console.log(datos_ge);
                                                                                                                                                                                                                console.log(fotos_diagnostico);
                                                                                                                                                                                                                console.log(diagnostico);
                                                                                                                                                                                                                if(item3.estatus_ced==3){
                                                                                                                                                                                                                    console.log('es ced 3');
                                                                                                                                                                                                                    $.ajax({
                                                                                                                                                                                                                        type: "POST",
                                                                                                                                                                                                                        async : true,
                                                                                                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarCheckServ1.php",
                                                                                                                                                                                                                        dataType: 'html',
                                                                                                                                                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                                        'refacciones': JSON.stringify(refacciones),
                                                                                                                                                                                                                        'fotos_check': JSON.stringify(fotos_check),
                                                                                                                                                                                                                        'checklist': JSON.stringify(checklist),
                                                                                                                                                                                                                        'encuesta': JSON.stringify(encuesta),
                                                                                                                                                                                                                        'visita_serv': JSON.stringify(visita_serv),
                                                                                                                                                                                                                        'datos_ge': JSON.stringify(datos_ge),
                                                                                                                                                                                                                        'fotos_diagnostico': JSON.stringify(fotos_diagnostico),
                                                                                                                                                                                                                        'diagnostico': JSON.stringify(diagnostico)
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        success: function(respuesta){
                                                                                                                                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                            var dat1 = respu1[0];
                                                                                                                                                                                                                            var dat2 = respu1[1];
                                                                                                                                                                                                                            if(dat1 == "CEDULA"){
                                                                                                                                                                                                                                if(dat2 > 0){
                                                                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                                                                        function(tx7){
                                                                                                                                                                                                                                            tx7.executeSql(
                                                                                                                                                                                                                                                "UPDATE visita_servInd SET id_servidor ='"+dat2+"' WHERE id_cedula = ?",
                                                                                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                                                                                function(tx7, results){
                                                                                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                                                                                        function(tx8){
                                                                                                                                                                                                                                                            tx8.executeSql(
                                                                                                                                                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                                                                                                function(tx8, results){
                                                                                                                                                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                            );
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                            );
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        error: function(){
                                                                                                                                                                                                                            console.log("Error en la comunicacion");
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    });
                                                                                                                                                                                                                }else{
                                                                                                                                                                                                                    console.log('no es ced 3');
                                                                                                                                                                                                                    $.ajax({
                                                                                                                                                                                                                        type: "POST",
                                                                                                                                                                                                                        async : true,
                                                                                                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarCheckServ1.php",
                                                                                                                                                                                                                        dataType: 'html',
                                                                                                                                                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                                                                                        'refacciones': JSON.stringify(refacciones),
                                                                                                                                                                                                                        'papeleta': JSON.stringify(papeleta),
                                                                                                                                                                                                                        'fotos_check': JSON.stringify(fotos_check),
                                                                                                                                                                                                                        'checklist': JSON.stringify(checklist),
                                                                                                                                                                                                                        'encuesta': JSON.stringify(encuesta),
                                                                                                                                                                                                                        'visita_serv': JSON.stringify(visita_serv),
                                                                                                                                                                                                                        'datos_ge': JSON.stringify(datos_ge),
                                                                                                                                                                                                                        'fotos_diagnostico': JSON.stringify(fotos_diagnostico),
                                                                                                                                                                                                                        'diagnostico': JSON.stringify(diagnostico)
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        success: function(respuesta){
                                                                                                                                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                                                                                                                                            var dat1 = respu1[0];
                                                                                                                                                                                                                            var dat2 = respu1[1];
                                                                                                                                                                                                                            if(dat1 == "CEDULA"){
                                                                                                                                                                                                                                if(dat2 > 0){
                                                                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                                                                        function(tx7){
                                                                                                                                                                                                                                            tx7.executeSql(
                                                                                                                                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                                                                                function(tx7, results){
                                                                                                                                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                            );
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                            }
                                                                                                                                                                                                                        },
                                                                                                                                                                                                                        error: function(){
                                                                                                                                                                                                                            console.log("Error en la comunicacion");
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    });   
                                                                                                                                                                                                                }
                                                                                                                                                                                                        },
                                                                                                                                                                                                        function(tx, error){
                                                                                                                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                                        }
                                                                                                                                                                                                    );
                                                                                                                                                                                                },
                                                                                                                                                                                                function(error){},
                                                                                                                                                                                                function(){}
                                                                                                                                                                                            );
                                                                                                                                                                                        
                                                                                                                                                                                        },
                                                                                                                                                                                    function(tx, error){
                                                                                                                                                                                        console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                    }
                                                                                                                                                                                );
                                                                                                                                                                            },
                                                                                                                                                                            function(error){},
                                                                                                                                                                            function(){}
                                                                                                                                                                        );
                                                                                                                                                                    },
                                                                                                                                                                    function(tx, error){
                                                                                                                                                                        console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                    }
                                                                                                                                                                );
                                                                                                                                                            },
                                                                                                                                                            function(error){},
                                                                                                                                                            function(){}
                                                                                                                                                        );
                                                                                                                                                },
                                                                                                                                                function(tx, error){
                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        },
                                                                                                                                        function(error){},
                                                                                                                                        function(){}
                                                                                                                                    );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                        },
                                                                                                        function(tx, error){
                                                                                                            console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                        }
                                                                                                    );
                                                                                                },
                                                                                                function(error){},
                                                                                                function(){}
                                                                                            );
                                                                                        
                                                                                    },
                                                                                    function(tx, error){
                                                                                        console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                    }
                                                                                );
                                                                            },
                                                                            function(error){},
                                                                            function(){}
                                                                        );
                                                                },
                                                                function(tx, error){
                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "HEB"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM diagnostico_servIndHBE WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    console.log(item2)
                                                    diagnostico_servInd[i] = {'Valor':i,'comentario':item2.comentario,'pregunta':item2.pregunta};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    visita_servInd[i] = {'Valor':i,'no_orden': item3.no_orden, 'fecha': item3.fecha, 'foto_llegada': item3.foto_llegada, 'tipo_servicio': item3.tipo_servicio, 'id_cliente':item3.id_cliente, 'cliente': item3.cliente, 'nombre_comercial': item3.nombre_comercial,'sucursal_cliente': item3.sucursal_cliente,'direccion': item3.direccion,'ciudad': item3.ciudad, 'telefono': item3.telefono,'correo':item3.correo, 'equipo':item3.equio, 'marca': item3.marca,'modelo': item3.modelo,'serie': item3.serie, 'ml': item3.ml,'voltaje': item3.voltaje, 'amp': item3.amp, 'wc': item3.wc , 'tierra_fisica':item3.tierra_fisica, 'falla_reportada': item3.falla_reportada,'como_encontro': item3.como_encontro,'foto_diagnostico': item3.como_encontro,'comentarios_entrega': item3.comentarios_entrega, 'diagnotico_corecto': item3.diagnotico_corecto,'trabajo_realizado': item3.trabajo_realizado,'como_entrego': item3.como_entrego, 'papeleta':item3.papeleta, 'refacciones': item3.refacciones, 'viaticos': item3.viaticos, 'H_viaje': item3.H_viaje, 'H_espera': item3.H_espera, 'H_trabajo': item3.H_trabajo , 'H_totales': item3.H_totales, 'firma_cliente': item3.firma_cliente, 'foto_sello': item3.foto_sello , 'foto_salida':  item3.foto_salida, 'firma_tecnico':item3.firma_tecnico};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_eq WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item7 = results.rows.item(i);
                                                                                    datos_eq[i] = {'Valor':i,'id_datos': item7.id_datos,'marca': item7.marca,'modelo': item7.modelo,'serie':item7.serie,'numero_id': item7.numero_id,'volts':item7.volts , 'amp': item7.amp,'tierra':item7.tierra,'breaker': item7.breaker,'fase': item7.fase,'estatus': item7.estatus,'observaciones': item7.observaciones,'nombre': item7.nombre,'papeleta': item7.papeleta,'refacciones': item7.refacciones , 'viaticos': item7.viaticos,'ml': item7.ml,'id_equipo_app':item7.id_equipo};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from checklist_servind WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item4 = results.rows.item(i);
                                                                                                    checklist_servind[i] = {'Valor':i,'fase': item4.fase,'pregunta': item4.pregunta,'tipo': item4.tipo,'valor': item4.valor,'no_pregunta': item4.no_pregunta,'id_equipo':item4.id_equipo};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from fotos_check WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item5= results.rows.item(i);
                                                                                                                    fotos_check[i] = {'Valor':i,'foto': item5.foto, 'pregunta': item5.pregunta , 'fase': item5.fase, 'observaciones': item5.observaciones, 'fecha_foto': item5.fecha_foto,'no_pregunta':item5.no_pregunta,'id_equipo':item5.id_equipo};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from papeleta WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item17 = results.rows.item(i);
                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                        function(tx){
                                                                                                                                            tx.executeSql("SELECT * from datos_eq WHERE id_datos = ?",
                                                                                                                                                [item17.id_equipo],
                                                                                                                                                function(tx, results){
                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                        var item11 = results.rows.item(i);
                                                                                                                                                        console.log(item17.id_equipo, item11.papeleta);
                                                                                                                                                        if (item11.papeleta == 3){}else{
                                                                                                                                                            papeleta[i] = {'Valor':i,
                                                                                                                                                            'cantidad':item17.cantidad,
                                                                                                                                                            'descripcion': item17.descripcion,
                                                                                                                                                            'fecha_registro': item17.fecha_registro,
                                                                                                                                                            'foto_papeleta':item17.foto_papeleta,
                                                                                                                                                            'id_papeleta':item17.id_papeleta,
                                                                                                                                                            'numero_parte':item17.numero_parte,'motivo_pr':item17.motivo_pr,
                                                                                                                                                            'prioridad':item17.prioridad,'id_equipo':item17.id_equipo};
                                                                                                                                                        }
                                                                                                                                                    }
                                                                                                                                                },
                                                                                                                                                function(tx, error){
                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        },
                                                                                                                                        function(error){},
                                                                                                                                        function(){}
                                                                                                                                    );   
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from refacciones WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                    refacciones[i] = {'Valor':i,
                                                                                                                                                    'descripcion':item8.descripcion,
                                                                                                                                                    'fecha_registro': item8.fecha_registro,
                                                                                                                                                    'foto_refa': item8.foto_refa,
                                                                                                                                                    'id_refaccion':item8.id_refaccion,
                                                                                                                                                    'numero_parte':item8.numero_parte,
                                                                                                                                                    'parte':item8.parte,'id_equipo':item8.id_equipo};
                                                                                                                                                }
                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                        function(tx){
                                                                                                                                                            tx.executeSql("SELECT * from encuesta_serv WHERE id_cedula = ?",
                                                                                                                                                                [id_cedula],
                                                                                                                                                                function(tx, results){
                                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                                        var item4 = results.rows.item(i);
                                                                                                                                                                        encuesta[i] = {'Valor':i,
                                                                                                                                                                        'atencion':item4.atencion,
                                                                                                                                                                        'capacidad': item4.capacidad,
                                                                                                                                                                        'fecha_encuesta': item4.fecha_encuesta,
                                                                                                                                                                        'id_encuesta':item4.id_encuesta,
                                                                                                                                                                        'rapidez':item4.rapidez,
                                                                                                                                                                        'recomienda':item4.recomienda,
                                                                                                                                                                        'satisfaccion':item4.satisfaccion};
                                                                                                                                                                    }
                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                        function(tx){
                                                                                                                                                                            tx.executeSql("SELECT * from fotos_diagnostico WHERE id_cedula = ?",
                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                function(tx, results){
                                                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                                                        var item9 = results.rows.item(i);
                                                                                                                                                                                        fotos_diagnostico[i] = {'Valor':i,
                                                                                                                                                                                        'foto':item9.foto,
                                                                                                                                                                                        'fecha': item9.fecha ,
                                                                                                                                                                                        'tipo': item9.tipo};
                                                                                                                                                                                    }
                                                                                                                                                                                    
                                                                                                                                                                                    console.log('datosCedulaGeneral',datosCedulaGeneral);
                                                                                                                                                                                    console.log('fotos_check',fotos_check);
                                                                                                                                                                                    console.log('checklist_servind',checklist_servind);
                                                                                                                                                                                    console.log('diagnostico_servInd',diagnostico_servInd);
                                                                                                                                                                                    console.log('visita_servInd',visita_servInd);
                                                                                                                                                                                    console.log('refra',refacciones);
                                                                                                                                                                                    console.log('pap',papeleta);
                                                                                                                                                                                    console.log('encuesta',encuesta); 
                                                                                                                                                                                    console.log('fotos_diagnostico',fotos_diagnostico);
                                                                                                                                                                                    console.log('datos_eq',datos_eq);                                                                                                                                                        
                                                                                    
                                                                                                                                                                                    $.ajax({
                                                                                                                                                                                        type: "POST",
                                                                                                                                                                                        async : true,
                                                                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarHEBServInd.php",
                                                                                                                                                                                        dataType: 'html',
                                                                                                                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'fotos_check': JSON.stringify(fotos_check),'checklist_servind': JSON.stringify(checklist_servind),'visita_servInd': JSON.stringify(visita_servInd),'diagnostico_servInd': JSON.stringify(diagnostico_servInd),'refacciones': JSON.stringify(refacciones),'papeleta': JSON.stringify(papeleta),'encuesta': JSON.stringify(encuesta),'fotos_diagnostico':JSON.stringify(fotos_diagnostico),'datos_eq':JSON.stringify(datos_eq)},
                                                                                                                                                                                        success: function(respuesta){
                                                                                                                                                                                            console.log('RESPUESTA',respuesta);
                                                                                                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                                                                                                            var dat1 = respu1[0];
                                                                                                                                                                                            var dat2 = respu1[1];
                                                                                                                                                                                            var dat3 = respu1[2];
                                                                                                                                                                                            if(dat1 == "CEDULA"){
                                                                                                                                                                                                if(dat2 > 0){
                                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                                        function(tx7){
                                                                                                                                                                                                            tx7.executeSql(
                                                                                                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                                                function(tx7, results){
                                                                                                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                                }
                                                                                                                                                                                                            );
                                                                                                                                                                                                        }
                                                                                                                                                                                                    );
                                                                                                                                                                                                    if(dat3){
                                                                                                                                                                                                        var datos3 = JSON.parse(dat3);
                                                                                                                                                                                                        var tamanio= datos3.length;
                                                                                                                                                                                                        for(i=0;i<tamanio;i++){
                                                                                                                                                                                                             var id_servidor=datos3[i].id_datos_eq;
                                                                                                                                                                                                             var id_equipo=datos3[i].id_equipo_app;
                                                                                                                                                                                                             console.log(id_servidor, id_equipo);
                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                function(tx8){
                                                                                                                                                                                                                    tx8.executeSql(
                                                                                                                                                                                                                        "UPDATE datos_eq SET id_servidor = ?, id_servidor2 = ? WHERE id_datos = ?",
                                                                                                                                                                                                                        [dat2,id_servidor,id_equipo],
                                                                                                                                                                                                                        function(tx8, results){
                                                                                                                                                                                                                            databaseHandler.db.transaction(
                                                                                                                                                                                                                                function(tx8){
                                                                                                                                                                                                                                    tx8.executeSql(
                                                                                                                                                                                                                                        "SELECT * FROM datos_eq WHERE id_cedula = ?",
                                                                                                                                                                                                                                        [id_cedula],
                                                                                                                                                                                                                                        function(tx8, results){
                                                                                                                                                                                                                                            var length = results.rows.length;
                                                                                                                                                                                                                                            console.log(length)
                                                                                                                                                                                                                                            for(var i = 0; i< length; i++){
                                                                                                                                                                                                                                                var item = results.rows.item(i);
                                                                                                                                                                                                                                                console.log(item);
                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                    );
                                                                                                                                                                                                                                }
                                                                                                                                                                                                                            );
                                                                                                                                                                                                                        }
                                                                                                                                                                                                                    );
                                                                                                                                                                                                                }
                                                                                                                                                                                                            );
                                                                                                                                                                                                        }
                                                                                                                                                                                                    }
                                                                                                                                                                                                }
                                                                                                                                                                                            }else{
                                                                                                                                                                                                AlmacenarError(respuesta);
                                                                                                                                                                                            }
                                                                                                                                                                                        },
                                                                                                                                                                                        error: function(){
                                                                                                                                                                                            console.log("Error en la comunicacion");
                                                                                                                                                                                        }
                                                                                                                                                                                    });
                                                                                                                                                                                },
                                                                                                                                                                                function(tx, error){
                                                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                }
                                                                                                                                                                            );
                                                                                                                                                                        },
                                                                                                                                                                        function(error){},
                                                                                                                                                                        function(){}
                                                                                                                                                                    );
                                                                                                                                                                },
                                                                                                                                                                function(tx, error){
                                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                }
                                                                                                                                                            );
                                                                                                                                                        },
                                                                                                                                                        function(error){},
                                                                                                                                                        function(){}
                                                                                                                                                    );
                                                                                                                                            },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){},
                                                                                                                                    function(){}
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "PMP"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM diagnostico_servIndHBE WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    diagnostico_servInd[i] = {'Valor':i,'comentario':item2.comentario,'pregunta':item2.pregunta};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from visita_servInd WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    visita_servInd[i] = {'Valor':i,'no_orden': item3.no_orden, 'fecha': item3.fecha, 'foto_llegada': item3.foto_llegada, 
                                                                    'tipo_servicio': item3.tipo_servicio, 'id_cliente':item3.id_cliente, 'cliente': item3.cliente, 
                                                                    'nombre_comercial': item3.nombre_comercial,'sucursal_cliente': item3.sucursal_cliente,'direccion': item3.direccion,
                                                                    'ciudad': item3.ciudad, 'telefono': item3.telefono,'correo':item3.correo, 'equipo':item3.equio, 'marca': item3.marca,
                                                                    'modelo': item3.modelo,'serie': item3.serie, 'ml': item3.ml,'voltaje': item3.voltaje, 'amp': item3.amp, 'wc': item3.wc , 
                                                                    'tierra_fisica':item3.tierra_fisica, 'falla_reportada': item3.falla_reportada,'como_encontro': item3.como_encontro,
                                                                    'foto_diagnostico': item3.como_encontro,'comentarios_entrega': item3.comentarios_entrega, 'diagnotico_corecto': item3.diagnotico_corecto,
                                                                    'trabajo_realizado': item3.trabajo_realizado,'como_entrego': item3.como_entrego, 'papeleta':item3.papeleta, 
                                                                    'refacciones': item3.refacciones, 'viaticos': item3.viaticos, 'H_viaje': item3.H_viaje, 'H_espera': item3.H_espera, 
                                                                    'H_trabajo': item3.H_trabajo , 'H_totales': item3.H_totales, 'firma_cliente': item3.firma_cliente, 'foto_sello': item3.foto_sello , 
                                                                    'foto_salida':  item3.foto_salida, 'firma_tecnico':item3.firma_tecnico, 'fecha_cliente':item3.fecha_cliente};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from datos_eq WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                var estatus_ced='0';//No pendiente
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item7 = results.rows.item(i);
                                                                                    datos_eq[i] = {'Valor':i,'id_datos': item7.id_datos,'marca': item7.marca,'modelo': item7.modelo,
                                                                                    'serie':item7.serie,'numero_id': item7.numero_id,'volts':item7.volts , 'amp': item7.amp,
                                                                                    'tierra':item7.tierra,'breaker': item7.breaker,'fase': item7.fase,'estatus': item7.estatus,
                                                                                    'observaciones': item7.observaciones,'nombre': item7.nombre,'papeleta': item7.papeleta,
                                                                                    'refacciones': item7.refacciones , 'viaticos': item7.viaticos,'ml': item7.ml,'id_equipo_app':item7.id_equipo};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from checklist_servind WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item4 = results.rows.item(i);
                                                                                                    checklist_servind[i] = {'Valor':i,'fase': item4.fase,'pregunta': item4.pregunta,'tipo': item4.tipo,'valor': item4.valor,'no_pregunta': item4.no_pregunta,'id_equipo':item4.id_equipo};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from fotos_check WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item5= results.rows.item(i);
                                                                                                                    fotos_check[i] = {'Valor':i,'foto': item5.foto, 'pregunta': item5.pregunta , 'fase': item5.fase, 'observaciones': item5.observaciones, 'fecha_foto': item5.fecha_foto,'no_pregunta':item5.no_pregunta,'id_equipo':item5.id_equipo};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from datos_eq where id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item17 = results.rows.item(i);
                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                        function(tx){
                                                                                                                                            tx.executeSql("SELECT * from datos_eq WHERE id_datos = ?",
                                                                                                                                                [item17.id_equipo],
                                                                                                                                                function(tx, results){
                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                        var item11 = results.rows.item(i);
                                                                                                                                                        console.log(item17.id_equipo, item11.papeleta);
                                                                                                                                                        if (item11.papeleta == 'Pendiente'){}else{
                                                                                                                                                            papeleta[i] = {'Valor':i,
                                                                                                                                                            'cantidad':item17.cantidad,
                                                                                                                                                            'descripcion': item17.descripcion,
                                                                                                                                                            'fecha_registro': item17.fecha_registro,
                                                                                                                                                            'foto_papeleta':item17.foto_papeleta,
                                                                                                                                                            'id_papeleta':item17.id_papeleta,
                                                                                                                                                            'numero_parte':item17.numero_parte,'motivo_pr':item17.motivo_pr,
                                                                                                                                                            'prioridad':item17.prioridad,'id_equipo':item17.id_equipo};
                                                                                                                                                        }
                                                                                                                                                    }
                                                                                                                                                },
                                                                                                                                                function(tx, error){
                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                }
                                                                                                                                            );
                                                                                                                                        },
                                                                                                                                        function(error){},
                                                                                                                                        function(){}
                                                                                                                                    );  
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from refacciones WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                                    refacciones[i] = {'Valor':i,
                                                                                                                                                    'descripcion':item8.descripcion,
                                                                                                                                                    'fecha_registro': item8.fecha_registro,
                                                                                                                                                    'foto_refa': item8.foto_refa,
                                                                                                                                                    'id_refaccion':item8.id_refaccion,
                                                                                                                                                    'numero_parte':item8.numero_parte,
                                                                                                                                                    'parte':item8.parte,'id_equipo':item8.id_equipo};
                                                                                                                                                }
                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                        function(tx){
                                                                                                                                                            tx.executeSql("SELECT * from encuesta_serv WHERE id_cedula = ?",
                                                                                                                                                                [id_cedula],
                                                                                                                                                                function(tx, results){
                                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                                        var item4 = results.rows.item(i);
                                                                                                                                                                        encuesta[i] = {'Valor':i,
                                                                                                                                                                        'atencion':item4.atencion,
                                                                                                                                                                        'capacidad': item4.capacidad,
                                                                                                                                                                        'fecha_encuesta': item4.fecha_encuesta,
                                                                                                                                                                        'id_encuesta':item4.id_encuesta,
                                                                                                                                                                        'rapidez':item4.rapidez,
                                                                                                                                                                        'recomienda':item4.recomienda,
                                                                                                                                                                        'satisfaccion':item4.satisfaccion};
                                                                                                                                                                    }
                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                        function(tx){
                                                                                                                                                                            tx.executeSql("SELECT * from fotos_diagnostico WHERE id_cedula = ?",
                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                function(tx, results){
                                                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                                                        var item9 = results.rows.item(i);
                                                                                                                                                                                        fotos_diagnostico[i] = {'Valor':i,
                                                                                                                                                                                        'foto':item9.foto,
                                                                                                                                                                                        'fecha': item9.fecha ,
                                                                                                                                                                                        'tipo': item9.tipo};
                                                                                                                                                                                    }
                                                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                                                        function(tx){
                                                                                                                                                                                            tx.executeSql("SELECT * from datos_generales_serv WHERE id_cedula = ?",
                                                                                                                                                                                                [id_cedula],
                                                                                                                                                                                                function(tx, results){
                                                                                                                                                                                                    var length = results.rows.length;
                                                                                                                                                                                                    for(var i = 0; i< length; i++){
                                                                                                                                                                                                        var item10 = results.rows.item(i);
                                                                                                                                                                                                        datos_generales_serv[i] = {'Valor':i,
                                                                                                                                                                                                        'ciudad':item10.ciudad,
                                                                                                                                                                                                        'cliente':item10.cliente,
                                                                                                                                                                                                        'correo':item10.correo,
                                                                                                                                                                                                        'direccion':item10.direccion,
                                                                                                                                                                                                        'fecha':item10.fecha,
                                                                                                                                                                                                        'id_cliente':item10.id_cliente,
                                                                                                                                                                                                        'no_orden':item10.no_orden,
                                                                                                                                                                                                        'sucursal_cliente':item10.sucursal_cliente,
                                                                                                                                                                                                        'telefono':item10.telefono,
                                                                                                                                                                                                        'tipo_servicio':item10.tipo_servicio,
                                                                                                                                                                                                        'tecnico':item10.tecnico};
                                                                                                                                                                                                    }
                                                                                                                                                                                                    
                                                                                                                                                                                                    console.log('datosCedulaGeneral',datosCedulaGeneral);
                                                                                                                                                                                                    console.log('fotos_check',fotos_check);
                                                                                                                                                                                                    console.log('checklist_servind',checklist_servind);
                                                                                                                                                                                                    console.log('diagnostico_servInd',diagnostico_servInd);
                                                                                                                                                                                                    console.log('visita_servInd',visita_servInd);
                                                                                                                                                                                                    console.log('refra',refacciones);
                                                                                                                                                                                                    console.log('pap',papeleta);
                                                                                                                                                                                                    console.log('encuesta',encuesta); 
                                                                                                                                                                                                    console.log('fotos_diagnostico',fotos_diagnostico);
                                                                                                                                                                                                    console.log('datos_eq',datos_eq);
                                                                                                                                                                                                    console.log('datos_generales_serv',datos_generales_serv);
                                                                                                    
                                                                                                                                                                                                    // $.ajax({
                                                                                                                                                                                                    //     type: "POST",
                                                                                                                                                                                                    //     async : true,
                                                                                                                                                                                                    //     url: "http://www.appbennetts.com/FWM2/app/guardarPMPCIServ.php",
                                                                                                                                                                                                    //     dataType: 'html',
                                                                                                                                                                                                    //     data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'fotos_check': JSON.stringify(fotos_check),
                                                                                                                                                                                                    //     'checklist_servind': JSON.stringify(checklist_servind),'visita_servInd': JSON.stringify(visita_servInd),
                                                                                                                                                                                                    //     'diagnostico_servInd': JSON.stringify(diagnostico_servInd),'refacciones': JSON.stringify(refacciones),
                                                                                                                                                                                                    //     'papeleta': JSON.stringify(papeleta),'encuesta': JSON.stringify(encuesta),'fotos_diagnostico':JSON.stringify(fotos_diagnostico),
                                                                                                                                                                                                    //     'datos_eq':JSON.stringify(datos_eq),'datos_generales_serv':JSON.stringify(datos_generales_serv)},
                                                                                                                                                                                                    //     success: function(respuesta){
                                                                                                                                                                                                    //         console.log('RESPUESTA',respuesta);
                                                                                                                                                                                                    //         var respu1 = respuesta.split("._.");
                                                                                                                                                                                                    //         var dat1 = respu1[0];
                                                                                                                                                                                                    //         var dat2 = respu1[1];
                                                                                                                                                                                                    //         var dat3 = respu1[2];
                                                                                                                                                                                                    //         if(dat1 == "CEDULA"){
                                                                                                                                                                                                    //             if(dat2 > 0){
                                                                                                                                                                                                    //                 databaseHandler.db.transaction(
                                                                                                                                                                                                    //                     function(tx7){
                                                                                                                                                                                                    //                         tx7.executeSql(
                                                                                                                                                                                                    //                             "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                                                    //                             [id_cedula],
                                                                                                                                                                                                    //                             function(tx7, results){
                                                                                                                                                                                                    //                                 localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                                    //                                 swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                                                    //                             }
                                                                                                                                                                                                    //                         );
                                                                                                                                                                                                    //                     }
                                                                                                                                                                                                    //                 );
                                                                                                                                                                                                    //                 if(dat3){// llevar todo
                                                                                                                                                                                                    //                     var datos3 = JSON.parse(dat3);
                                                                                                                                                                                                    //                     var tamanio= datos3.length;
                                                                                                                                                                                                    //                     for(i=0;i<tamanio;i++){
                                                                                                                                                                                                    //                          var id_servidor=datos3[i].id_datos_eq;
                                                                                                                                                                                                    //                          var id_equipo=datos3[i].id_equipo_app;
                                                                                                                                                                                                    //                          console.log(id_servidor, id_equipo);
                                                                                                                                                                                                    //                         databaseHandler.db.transaction(
                                                                                                                                                                                                    //                             function(tx8){
                                                                                                                                                                                                    //                                 tx8.executeSql(
                                                                                                                                                                                                    //                                     "UPDATE datos_eq SET id_servidor = ?, id_servidor2 = ? WHERE id_datos = ?",
                                                                                                                                                                                                    //                                     [dat2,id_servidor,id_equipo],
                                                                                                                                                                                                    //                                     function(tx8, results){
                                                                                                                                                                                                    //                                         databaseHandler.db.transaction(
                                                                                                                                                                                                    //                                             function(tx8){
                                                                                                                                                                                                    //                                                 tx8.executeSql(
                                                                                                                                                                                                    //                                                     "SELECT * FROM datos_eq WHERE id_cedula = ?",
                                                                                                                                                                                                    //                                                     [id_cedula],
                                                                                                                                                                                                    //                                                     function(tx8, results){
                                                                                                                                                                                                    //                                                         var length = results.rows.length;
                                                                                                                                                                                                    //                                                         console.log(length)
                                                                                                                                                                                                    //                                                         for(var i = 0; i< length; i++){
                                                                                                                                                                                                    //                                                             var item = results.rows.item(i);
                                                                                                                                                                                                    //                                                             console.log(item);
                                                                                                                                                                                                    //                                                         }
                                                                                                                                                                                                    //                                                     }
                                                                                                                                                                                                    //                                                 );
                                                                                                                                                                                                    //                                             }
                                                                                                                                                                                                    //                                         );
                                                                                                                                                                                                    //                                     }
                                                                                                                                                                                                    //                                 );
                                                                                                                                                                                                    //                             }
                                                                                                                                                                                                    //                         );
                                                                                                                                                                                                    //                     }
                                                                                                                                                                                                    //                 }
                                                                                                                                                                                                    //             }
                                                                                                                                                                                                    //         }
                                                                                                                                                                                                            
                                                                                                                                                                                                    //     },
                                                                                                                                                                                                    //     error: function(){
                                                                                                                                                                                                    //         console.log("Error en la comunicacion");
                                                                                                                                                                                                    //     }
                                                                                                                                                                                                    // });
                                                                                                                                                                                                },
                                                                                                                                                                                                function(tx, error){
                                                                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                                }
                                                                                                                                                                                            );
                                                                                                                                                                                        },
                                                                                                                                                                                        function(error){},
                                                                                                                                                                                        function(){}
                                                                                                                                                                                    );
                                                                                                                                                                                },
                                                                                                                                                                                function(tx, error){
                                                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                                }
                                                                                                                                                                            );
                                                                                                                                                                        },
                                                                                                                                                                        function(error){},
                                                                                                                                                                        function(){}
                                                                                                                                                                    );
                                                                                                                                                                },
                                                                                                                                                                function(tx, error){
                                                                                                                                                                    console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                                                }
                                                                                                                                                            );
                                                                                                                                                        },
                                                                                                                                                        function(error){},
                                                                                                                                                        function(){}
                                                                                                                                                    );
                                                                                                                                            },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                    function(error){},
                                                                                                                                    function(){}
                                                                                                                                );
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                             }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Bennetts2"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var cobranza = new Array();
            var evidencia = new Array();
            var documentos = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Cobranza"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM cobranza WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    cobranza[i] = {'Valor':i,
                                                    'foto_inicio':item2.foto_inicio,
                                                    'id_visita':item2.id_visita,
                                                    'id_cliente':item2.id_cliente,
                                                    'cliente':item2.cliente,
                                                    'factura':item2.factura,
                                                    'fecha_factura':item2.fecha_factura,
                                                    'importe':item2.importe,
                                                    'movimiento':item2.movimiento,
                                                    'no_documentos':item2.no_documentos,
                                                    'importe_app':item2.importe_app,
                                                    'movimiento_realizado':item2.movimiento_realizado,
                                                    'realizado':item2.realizado,
                                                    'porque':item2.porque,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'calle':item2.calle,
                                                    'bloque':item2.bloque,
                                                    'ciudad':item2.ciudad,
                                                    'no_calle':item2.no_calle,
                                                    'cp':item2.cp,
                                                    'pais':item2.pais,
                                                    'codigo':item2.codigo,
                                                    'revision_lunes':item2.revision_lunes,
                                                    'revision_martes':item2.revision_martes,
                                                    'revision_miercoles':item2.revision_miercoles,
                                                    'revision_jueves':item2.revision_jueves,
                                                    'revision_viernes':item2.revision_viernes,
                                                    'contrarecibo':item2.contrarecibo,
                                                    'entrada_almacen':item2.entrada_almacen,
                                                    'folio_mercancia':item2.folio_mercancia,
                                                    'id_reglas':item2.id_reglas,
                                                    'acuse_soporte':item2.acuse_soporte,
                                                    'firma_bennetts':item2.firma_bennetts,
                                                    'firma_key':item2.firma_key,
                                                    'recibido_bennetts':item2.recibido_bennetts,
                                                    'recibido_key':item2.recibido_key,
                                                    'orden_compra':item2.orden_compra,
                                                    'otro':item2.otro,
                                                    'pago_lunes':item2.pago_lunes,
                                                    'pago_martes':item2.pago_martes,
                                                    'pago_miercoles':item2.pago_miercoles,
                                                    'pago_jueves':item2.pago_jueves,
                                                    'pago_viernes':item2.pago_viernes,
                                                    'proceso_pago':item2.proceso_pago,
                                                    'estado':item2.estado
                                                };
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from evidenciaCobranza WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidencia[i] = {'Valor':i,
                                                                    'observacion': item3.observacion,
                                                                    'foto': item3.foto,
                                                                    'fecha_registro': item3.fecha_registro};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from documentos WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    documentos[i] = {'Valor':i,
                                                                                    'no_documentos': item4.no_documentos,
                                                                                    'importe_app': item4.importe_app,
                                                                                    'movimiento_realizado': item4.movimiento_realizado,
                                                                                    'porque': item4.porque,
                                                                                    'realizado': item4.realizado};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "https://www.fwm.com.mx/app/guardarCobranzaBennetts2.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                    'cobranza': JSON.stringify(cobranza),
                                                                                    'evidencia': JSON.stringify(evidencia),
                                                                                    'documentos': JSON.stringify(documentos)},
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion con el servidor");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar : " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar : " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "MrFixer"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datos_generales_MrFixer = new Array();
            var insumos = new Array();
            var bitacora = new Array();
            var materiales = new Array();

            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Bitacora"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_MrFixer WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datos_generales_MrFixer[i] = {'Valor':i,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'ubicacion':item2.ubicacion,
                                                    'operador':item2.operador,
                                                    'hora':item2.hora,
                                                    'fecha':item2.fecha,
                                                    'nombre_sitio':item2.nombre_sitio,
                                                    'supervisor_estafeta':item2.supervisor_estafeta,
                                                    'no_empleados':item2.no_empleados,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'foto_salida':item2.foto_salida,
                                                    'tipo_servicio':item2.tipo_servicio};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from insumos WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    insumos[i] = {'Valor':i,
                                                                    'nombre': item3.nombre,
                                                                    'cantidad': item3.cantidad,
                                                                    'fin': item3.fin,
                                                                    'unidad': item3.unidad,
                                                                    'Unidad_fin': item3.Unidad_fin};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from bitacora WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    bitacora[i] = {'Valor':i,
                                                                                    'eco': item4.eco,
                                                                                    'placa': item4.placa,
                                                                                    'tipo_unidad': item4.tipo_unidad,
                                                                                    'modelo': item4.modelo,
                                                                                    'observaciones': item4.observaciones,
                                                                                    'foto_evidencia': item4.foto_evidencia,
                                                                                    'fecha': item4.fecha,'nuevo': item4.nuevo,
                                                                                    'id_vehiculo': item4.id_vehiculo};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from material_registrado WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    materiales[i] = {'Valor':i,
                                                                                                    'abrillantador': item5.abrillantador,
                                                                                                    'desengrasante': item5.desengrasante,
                                                                                                    'fecha_registro': item5.fecha_registro,
                                                                                                    'shampoo': item5.shampoo};
                                                                                                }
                                                                                                $.ajax({
                                                                                                    type: "POST",
                                                                                                    async : true,
                                                                                                    url: "https://www.fwm.com.mx/app/guardarBitcoraMrFixer.php",
                                                                                                    dataType: 'html',
                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                    'datos_generales_MrFixer': JSON.stringify(datos_generales_MrFixer),
                                                                                                    'insumos': JSON.stringify(insumos),
                                                                                                    'bitacora': JSON.stringify(bitacora),
                                                                                                    'materiales': JSON.stringify(materiales)},
                                                                                                    success: function(respuesta){
                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                        var dat1 = respu1[0];
                                                                                                        var dat2 = respu1[1];
                                                                                                        if(dat1 == "CEDULA"){
                                                                                                            if(dat2 > 0){
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx7){
                                                                                                                        tx7.executeSql(
                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx7, results){
                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                );
                                                                                                            }
                                                                                                        } else {
                                                                                                            AlmacenarError(respuesta);
                                                                                                        }
                                                                                                    },
                                                                                                    error: function(){
                                                                                                        console.log("Error en la comunicacion con el servidor");
                                                                                                    }
                                                                                                });
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar : " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar : " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar : " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else if(empresa == "Proteus"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosGeneralesProteus = new Array();
            var datos_equipos_proteus = new Array();
            var reposicion_proteus = new Array();
            var evidencias_proteus = new Array();
            var fotos_proteus = new Array();
            var check_limpieza = new Array();
            var check_revision = new Array();
            var mmto_correctivo = new Array();

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "Preventivo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item5 = results.rows.item(i);
                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                    'comentario': item5.comentario,
                                                                                    'fecha': item5.fecha,
                                                                                    'foto': item5.foto,'page':item5.page};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from fotos_proteus WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item6 = results.rows.item(i);
                                                                                                    fotos_proteus[i] = {'Valor':i,
                                                                                                    'apartado': item6.apartado,
                                                                                                    'fase': item6.fase,
                                                                                                    'fecha': item6.fecha,
                                                                                                    'foto': item6.foto};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from check_limpieza WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item7 = results.rows.item(i);
                                                                                                                    check_limpieza[i] = {'Valor':i,
                                                                                                                    'comentarios': item7.comentarios,
                                                                                                                    'componente': item7.componente,
                                                                                                                    'fallos': item7.fallos,
                                                                                                                    'piezas': item7.piezas};
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from check_revision WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item8 = results.rows.item(i);
                                                                                                                                    check_revision[i] = {'Valor':i,
                                                                                                                                    'comentarios': item8.comentarios,
                                                                                                                                    'componente': item8.componente,
                                                                                                                                    'fallos': item8.fallos,
                                                                                                                                    'fuente': item8.fuente,
                                                                                                                                    'piezas': item8.piezas,
                                                                                                                                    'observaciones': item8.observaciones};
                                                                                                                                }
                                                                                                                                    $.ajax({
                                                                                                                                        type: "POST",
                                                                                                                                        async : true,
                                                                                                                                        url: "http://www.appbennetts.com/FWM2/app/guardarProteusPreventivo.php",
                                                                                                                                        dataType: 'html',
                                                                                                                                        data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                    'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                                                                    'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                                                                    'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                                                                    'fotos_proteus': JSON.stringify(fotos_proteus),
                                                                                                                                                    'check_limpieza': JSON.stringify(check_limpieza),
                                                                                                                                                    'check_revision': JSON.stringify(check_revision)},
                                                                                                                                        success: function(respuesta){
                                                                                                                                            var respu1 = respuesta.split("._.");
                                                                                                                                            var dat1 = respu1[0];
                                                                                                                                            var dat2 = respu1[1];
                                                                                                                                            if(dat1 == "CEDULA"){
                                                                                                                                                if(dat2 > 0){
                                                                                                                                                    databaseHandler.db.transaction(
                                                                                                                                                        function(tx7){
                                                                                                                                                            tx7.executeSql(
                                                                                                                                                                "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                [id_cedula],
                                                                                                                                                                function(tx7, results){
                                                                                                                                                                    localStorage.setItem("sendFlag", 0);
                                                                                                                                                                    swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                }
                                                                                                                                                            );
                                                                                                                                                        }
                                                                                                                                                    );
                                                                                                                                                }
                                                                                                                                            } else {
                                                                                                                                                AlmacenarError(respuesta);
                                                                                                                                            }
                                                                                                                                        },
                                                                                                                                        error: function(){
                                                                                                                                            console.log("Error en la comunicacion");
                                                                                                                                        }
                                                                                                                                    });
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar check_revision: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar check_limpieza: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar fotos_proteus: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "Reposicion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from reposicion_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    reposicion_proteus[i] = {'Valor':i,
                                                                                    'kit_micro': item4.kit_micro,
                                                                                    'micro_activados': item4.micro_activados,
                                                                                    'nivelador': item4.nivelador,
                                                                                    'observaciones': item4.observaciones};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                                    'comentario': item5.comentario,
                                                                                                    'fecha': item5.fecha,
                                                                                                    'foto': item5.foto, 'page': item5.page};
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from fotos_proteus WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    fotos_proteus[i] = {'Valor':i,
                                                                                                                    'apartado': item6.apartado,
                                                                                                                    'fase': item6.fase,
                                                                                                                    'fecha': item6.fecha,
                                                                                                                    'foto': item6.foto};
                                                                                                                }
                                                                                                                $.ajax({
                                                                                                                    type: "POST",
                                                                                                                    async : true,
                                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarProteusReposicion.php",
                                                                                                                    dataType: 'html',
                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                             'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                                             'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                                             'reposicion_proteus': JSON.stringify(reposicion_proteus),
                                                                                                                             'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                                             'fotos_proteus': JSON.stringify(fotos_proteus)},
                                                                                                                    success: function(respuesta){
                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                        var dat1 = respu1[0];
                                                                                                                        var dat2 = respu1[1];
                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                            if(dat2 > 0){
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx7){
                                                                                                                                        tx7.executeSql(
                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx7, results){
                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    }
                                                                                                                                );
                                                                                                                            }
                                                                                                                        } else {
                                                                                                                            AlmacenarError(respuesta);
                                                                                                                        }
                                                                                                                    },
                                                                                                                    error: function(){
                                                                                                                        console.log("Error en la comunicacion");
                                                                                                                    }
                                                                                                                });
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar fotos proteus: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar reposicion_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            } else if(tipo == "Correctivo"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item5 = results.rows.item(i);
                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                    'comentario': item5.comentario,
                                                                                    'fecha': item5.fecha,
                                                                                    'foto': item5.foto, 'page':item5.page};
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from mmto_correctivo WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item9 = results.rows.item(i);
                                                                                                    mmto_correctivo[i] = {'Valor':i,
                                                                                                    'funcionamiento': item9.funcionamiento,
                                                                                                    'reparacion': item9.reparacion};
                                                                                                }
                                                                                                $.ajax({
                                                                                                    type: "POST",
                                                                                                    async : true,
                                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarCorrectivoProteus.php",
                                                                                                    dataType: 'html',
                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                             'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                                             'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus),
                                                                                                             'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                                             'mmto_correctivo': JSON.stringify(mmto_correctivo)
                                                                                                            },
                                                                                                    success: function(respuesta){
                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                        var dat1 = respu1[0];
                                                                                                        var dat2 = respu1[1];
                                                                                                        if(dat1 == "CEDULA"){
                                                                                                            if(dat2 > 0){
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx7){
                                                                                                                        tx7.executeSql(
                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx7, results){
                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                            }
                                                                                                                        );
                                                                                                                    }
                                                                                                                );
                                                                                                            }
                                                                                                        } else {
                                                                                                            AlmacenarError(respuesta);
                                                                                                        }
                                                                                                    },
                                                                                                    error: function(){
                                                                                                        console.log("Error en la comunicacion");
                                                                                                    }
                                                                                                });
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar mmto_correctivo: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }else if(tipo == "Instalacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_generales_proteus WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosGeneralesProteus[i] = {'Valor':i,
                                                    'direccion':item2.direccion,
                                                    'email':item2.email,
                                                    'fecha_cliente':item2.fecha_cliente,
                                                    'firma_cliente':item2.firma_cliente,
                                                    'foto_entrada':item2.foto_entrada,
                                                    'foto_salida':item2.foto_salida,
                                                    'local':item2.local,
                                                    'nombre_contacto':item2.nombre_contacto,
                                                    'orden_servicio':item2.orden_servicio,
                                                    'razon_social':item2.razon_social,
                                                    'ruc':item2.ruc,
                                                    'telefono1':item2.telefono1,
                                                    'telefono2':item2.telefono2,
                                                    'tipo_servicio':item2.tipo_servicio,
                                                    'cargo': item2.cargo,
                                                    'dni':item2.dni};
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from datos_equipos_proteus WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    datos_equipos_proteus[i] = {'Valor':i,
                                                                    'id_cliente':item3.id_cliente,
                                                                    'id_equipo':item3.id_equipo,
                                                                    'marca':item3.marca,
                                                                    'modelo':item3.modelo,
                                                                    'ubicacion':item3.ubicacion};
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from evidencias_proteus WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item5 = results.rows.item(i);
                                                                                    evidencias_proteus[i] = {'Valor':i,
                                                                                    'comentario': item5.comentario,
                                                                                    'fecha': item5.fecha,
                                                                                    'foto': item5.foto, 'page':item5.page};
                                                                                }
                                                                                $.ajax({
                                                                                    type: "POST",
                                                                                    async : true,
                                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarInstalacionProteus.php",
                                                                                    dataType: 'html',
                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                             'datosGeneralesProteus': JSON.stringify(datosGeneralesProteus),
                                                                                             'evidencias_proteus': JSON.stringify(evidencias_proteus),
                                                                                             'datos_equipos_proteus': JSON.stringify(datos_equipos_proteus)
                                                                                            },
                                                                                    success: function(respuesta){
                                                                                        var respu1 = respuesta.split("._.");
                                                                                        var dat1 = respu1[0];
                                                                                        var dat2 = respu1[1];
                                                                                        if(dat1 == "CEDULA"){
                                                                                            if(dat2 > 0){
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx7){
                                                                                                        tx7.executeSql(
                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx7, results){
                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                            }
                                                                                                        );
                                                                                                    }
                                                                                                );
                                                                                            }
                                                                                        } else {
                                                                                            AlmacenarError(respuesta);
                                                                                        }
                                                                                    },
                                                                                    error: function(){
                                                                                        console.log("Error en la comunicacion");
                                                                                    }
                                                                                });
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencias_proteus: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar datos_equipos_proteus: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar datos_generales_proteus: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar cedulas generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );

        } else if(empresa == "Aliatonic"){
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datos_gene_aliatonic = new Array();
            var validaAntesServ = new Array();
            var checkPointPacas = new Array();
            var checkoutPacas = new Array();
            var incidenciasPacas = new Array();
            var visita_Aliatonic = new Array();
            var encuesta_Aliationic = new Array();

            var gene_aliatonic = 0;
            var validaAntesServcont = 0;
            var checkPointPacascont = 0;
            var checkoutPacascont = 0;
            var incidenciasPacascont = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "VisitaPacas" || tipo == "VisitaCable"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM datos_gene_aliatonic WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datos_gene_aliatonic[gene_aliatonic] = {'Valor':gene_aliatonic,'id_dato':item2.id_dato,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_inicio,'nombre_cliente':item2.cliente,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    gene_aliatonic++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from validaAntesServ WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    validaAntesServ[validaAntesServcont] = {'Valor':validaAntesServcont,'id_evidencia': item3.id_evidencia,'id_cedula': item3.id_cedula,'observacion': item3.observaciones,'foto': item3.foto,'fecha_regristro': item3.fecha,'tipo_tarima': item3.tipo_tarima,'no_tarimas': item3.no_tarimas};
                                                                    validaAntesServcont++;
                                                                }
                                                                databaseHandler.db.transaction(
                                                                    function(tx){
                                                                        tx.executeSql("SELECT * from checkPointPacas WHERE id_cedula = ?",
                                                                            [id_cedula],
                                                                            function(tx, results){
                                                                                var length = results.rows.length;
                                                                                for(var i = 0; i< length; i++){
                                                                                    var item4 = results.rows.item(i);
                                                                                    checkPointPacas[checkPointPacascont] = {'Valor':checkPointPacascont,'id_evidencia': item4.id_evidencia,'id_cedula': item4.id_cedula,'observacion': item4.observaciones,'foto': item4.foto,'fecha_regristro': item4.fecha,'No_pacas': item4.No_pacas};
                                                                                    checkPointPacascont++;
                                                                                }
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("SELECT * from checkoutPacas WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx, results){
                                                                                                var length = results.rows.length;
                                                                                                for(var i = 0; i< length; i++){
                                                                                                    var item5 = results.rows.item(i);
                                                                                                    checkoutPacas[checkoutPacascont] = {'Valor':checkoutPacascont,'id_evidencia': item5.id_evidencia,'id_cedula': item5.id_cedula,'observacion': item5.observaciones,'foto': item5.foto,'fecha_regristro': item5.fecha,'nombre_operador': item5.nombre_operador,'hora_salida': item5.hora_salida,'tipo_tarima': item5.tipo_tarima,'no_pacasrealizadas': item5.no_pacasrealizadas};
                                                                                                    checkoutPacascont++;
                                                                                                }
                                                                                                databaseHandler.db.transaction(
                                                                                                    function(tx){
                                                                                                        tx.executeSql("SELECT * from incidenciasPacas WHERE id_cedula = ?",
                                                                                                            [id_cedula],
                                                                                                            function(tx, results){
                                                                                                                var length = results.rows.length;
                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                    var item6 = results.rows.item(i);
                                                                                                                    incidenciasPacas[incidenciasPacascont] = {'Valor':incidenciasPacascont,'id_evidencia': item6.id_evidencia,'id_cedula': item6.id_cedula,'observacion': item6.observaciones,'foto': item6.foto,'fecha_regristro': item6.fecha,'tipo_incidencia': item6.tipo_incidencia};
                                                                                                                    incidenciasPacascont++;
                                                                                                                }
                                                                                                                databaseHandler.db.transaction(
                                                                                                                    function(tx){
                                                                                                                        tx.executeSql("SELECT * from visita_Aliatonic WHERE id_cedula = ?",
                                                                                                                            [id_cedula],
                                                                                                                            function(tx, results){
                                                                                                                                var length = results.rows.length;
                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                    var item3 = results.rows.item(i);
                                                                                                                                    visita_Aliatonic[i] = {'Valor':i,
                                                                                                                                    'id_visita':item3.id_visita,
                                                                                                                                    'comentarios_entrega':item3.comentarios_entrega,
                                                                                                                                    'firma_tecnico':item3.firma_tecnico,
                                                                                                                                    'foto_salida':item3.foto_salida,
                                                                                                                                    'firma_cliente':item3.firma_cliente,
                                                                                                                                    'foto_sello':item3.foto_sello,
                                                                                                                                    'fecha_cliente':item3.fecha_cliente,
                                                                                                                                    };
                                                                                                                                }
                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                    function(tx){
                                                                                                                                        tx.executeSql("SELECT * from encuesta_Aliationic WHERE id_cedula = ?",
                                                                                                                                            [id_cedula],
                                                                                                                                            function(tx, results){
                                                                                                                                                var length = results.rows.length;
                                                                                                                                                for(var i = 0; i< length; i++){
                                                                                                                                                    var item3 = results.rows.item(i);
                                                                                                                                                    encuesta_Aliationic[i] = {'Valor':i,
                                                                                                                                                    'fecha_visita':item3.fecha_visita,
                                                                                                                                                    'recomienda':item3.recomienda,
                                                                                                                                                    'rapidez':item3.rapidez,
                                                                                                                                                    'capacidad':item3.capacidad,
                                                                                                                                                    'atencion':item3.atencion,
                                                                                                                                                    'satisfaccion':item3.satisfaccion,
                                                                                                                                                    'fecha_encuesta':item3.fecha_encuesta,
                                                                                                                                                    };
                                                                                                                                                }
                                                                                                                                                $.ajax({
                                                                                                                                                    type: "POST",
                                                                                                                                                    async : true,
                                                                                                                                                    url: "https://www.fwm.com.mx/app/guardarPacasAliatonic.php",
                                                                                                                                                    dataType: 'html',
                                                                                                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),
                                                                                                                                                    'datos_gene_aliatonic': JSON.stringify(datos_gene_aliatonic),
                                                                                                                                                    'validaAntesServ': JSON.stringify(validaAntesServ),
                                                                                                                                                    'checkPointPacas': JSON.stringify(checkPointPacas),
                                                                                                                                                    'checkoutPacas': JSON.stringify(checkoutPacas),
                                                                                                                                                    'incidenciasPacas': JSON.stringify(incidenciasPacas),
                                                                                                                                                    'visita_Aliatonic': JSON.stringify(visita_Aliatonic),
                                                                                                                                                    'encuesta_Aliationic': JSON.stringify(encuesta_Aliationic)
                                                                                                                                                    },
                                                                                                                                                    success: function(respuesta){
                                                                                                                                                        var respu1 = respuesta.split("._.");
                                                                                                                                                        var dat1 = respu1[0];
                                                                                                                                                        var dat2 = respu1[1];
                                                                                                                                                        if(dat1 == "CEDULA"){
                                                                                                                                                            if(dat2 > 0){
                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!"+dat2, "success");
                                                                                                                                                                databaseHandler.db.transaction(
                                                                                                                                                                    function(tx7){
                                                                                                                                                                        tx7.executeSql(
                                                                                                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                                                                                                            [id_cedula],
                                                                                                                                                                            function(tx7, results){
                                                                                                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                                                                                                            }
                                                                                                                                                                        );
                                                                                                                                                                    }
                                                                                                                                                                );
                                                                                                                                                            }
                                                                                                                                                        } else {
                                                                                                                                                            AlmacenarError(respuesta);
                                                                                                                                                        }
                                                                                                                                                    },
                                                                                                                                                    error: function(){
                                                                                                                                                        console.log("Error en la comunicacion con el servidor");
                                                                                                                                                    }
                                                                                                                                                });
                                                                                                                                            },
                                                                                                                                            function(tx, error){
                                                                                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                                                                                            }
                                                                                                                                        );
                                                                                                                                    },
                                                                                                                                function(error){},
                                                                                                                                function(){}
                                                                                                                                ); 
                                                                                                                            },
                                                                                                                            function(tx, error){
                                                                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                                                                            }
                                                                                                                        );
                                                                                                                    },
                                                                                                                    function(error){},
                                                                                                                    function(){}
                                                                                                                );
                                                                                                            },
                                                                                                            function(tx, error){
                                                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                                                            }
                                                                                                        );
                                                                                                    },
                                                                                                    function(error){},
                                                                                                    function(){}
                                                                                                );
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                                            }
                                                                        );
                                                                    },
                                                                    function(error){},
                                                                    function(){}
                                                                );
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar evidencia_levantamiento_smc: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar levantamiento_smc: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        })
                }
            );
        } else {
            var datosCedulaGeneral = new Array();
            var cedulageneral = 0;

            var datosSanitizacion = new Array();
            var evidenciaSanitizacion = new Array();
            var sanitizacion = 0;
            var evidenciaSani = 0;

            var datosLevantamiento = new Array();
            var evidenciaLevantamiento = new Array();
            var levantamiento = 0;
            var evidencialeva = 0;

            var datosFumigacion = new Array();
            var evidenciaFumigacion = new Array();
            var fumigacion = 0;
            var evidenciafumi = 0;

            var tipo = "";
            var fecha = new Date();
            var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item = results.rows.item(i);
                                tipo = item.tipo_cedula;
                                datosCedulaGeneral[cedulageneral] = {'Valor':cedulageneral,'id_cedula':item.id_cedula,'tipo_cedula':item.tipo_cedula,'id_usuario':item.id_usuario,'nombre_usuario':item.nombre_usuario,'fecha_entrada':item.fecha_entrada,'geolocalizacion_entrada': item.geolocalizacion_entrada,'id_cliente': item.id_cliente,'nombre_cliente': item.nombre_cliente,'horario_programado': item.horario_programado,'calificacion': item.calificacion,'fecha_salida':item.fecha_salida,'geolocalizacion_salida':item.geolocalizacion_salida,'nombre_evalua':item.nombre_evalua,'comentario_cliente':item.comentario_cliente,'fecha_envio':fecha_envio};
                                cedulageneral++;
                            }
                            if(tipo == "sanitizacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM sanitizacion WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosSanitizacion[sanitizacion] = {'Valor':sanitizacion,'id_sanitizacion': item2.id_sanitizacion,'id_cedula': item2.id_cedula,'foto_entrada':item2.foto_entrada,'sucursal':item2.sucursal,'direccion':item2.direccion,'persona_recibe':item2.persona_recibe,'documento_ingresar':item2.documento_ingresar,'descripcion_antes':item2.descripcion_antes,'foto_quimico':item2.foto_quimico,'foto_equipo':item2.foto_equipo,'areas_despejadas':item2.areas_despejadas,'descripcion_durante':item2.descripcion_durante,'descripcion_despues':item2.descripcion_despues,'foto_reporte':item2.foto_reporte,'recomendaciones':item2.recomendaciones,'firma_evalua':item2.firma_evalua,'fecha_firma':item2.fecha_firma,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    sanitizacion++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_sanitizacion WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaSanitizacion[evidenciaSani] = {'Valor':evidenciaSani,'id_sanitizacion_foto': item3.id_sanitizacion_foto,'id_cedula': item3.id_cedula,'fase':item3.fase,'foto_area':item3.foto_area,'nombre_area':item3.nombre_area,'fecha_foto':item3.fecha_foto,'fecha_envio':fecha_envio};
                                                                    evidenciaSani++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarSanitizacion.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosSanitizacion': JSON.stringify(datosSanitizacion),'evidenciaSanitizacion': JSON.stringify(evidenciaSanitizacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "levantamiento"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM levantamiento_servicio WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosLevantamiento[levantamiento] = {'Valor':levantamiento,'id_cedula':item2.id_cedula,'foto_entrada':item2.foto_entrada,'nombre_cliente':item2.nombre_cliente,'direccion':item2.direccion,'colonia':item2.colonia,'revision':item2.revision,'grado_infeccion':item2.grado_infeccion,'descripcion':item2.descripcion,'comentarios_tecnico':item2.comentarios_tecnico,'firma_cliente':item2.firma_cliente,'fecha_cliente':item2.fecha_cliente,'foto_salida':item2.foto_salida,'fecha_envio':fecha_envio};
                                                    levantamiento++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from levantamiento_evidencia WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaLevantamiento[evidencialeva] = {'Valor':evidencialeva,'id_cedula': item3.id_cedula,'area': item3.area,'foto_plaga': item3.foto_plaga,'descripcion_plaga': item3.descripcion_plaga,'observacion': item3.observacion,'fecha_regristro': item3.fecha_regristro,'fecha_envio':fecha_envio};
                                                                    evidencialeva++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarLevantamiento.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosLevantamiento': JSON.stringify(datosLevantamiento),'evidenciaLevantamiento': JSON.stringify(evidenciaLevantamiento)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    }
                                                                                );
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                            if(tipo == "fumigacion"){
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("SELECT * FROM fumigacion WHERE id_cedula = ?",
                                            [id_cedula],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var fecha = new Date();
                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                for(var i = 0; i< length; i++){
                                                    var item2 = results.rows.item(i);
                                                    datosFumigacion[fumigacion] = {'Valor':fumigacion,'foto_entrada': item2.foto_entrada,'sucursal': item2.sucursal,'direccion': item2.direccion,'persona_recibe': item2.persona_recibe,'documento_ingresar': item2.documento_ingresar,'alcance_servicio': item2.alcance_servicio,'foto_quimico': item2.foto_quimico,'foto_equipo': item2.foto_equipo,'descripcion_antes': item2.descripcion_antes,'descripcion_durante': item2.descripcion_durante,'descripcion_despues': item2.descripcion_despues,'foto_reporte': item2.foto_reporte,'producto_utilizado': item2.producto_utilizado,'tipo_aplicacion': item2.tipo_aplicacion,'descripcion_tipo': item2.descripcion_tipo,'grado_infestacion': item2.grado_infestacion,'descripcion_infestacion': item2.descripcion_infestacion,'mantenimiento': item2.mantenimiento,'detalle_mantenimiento': item2.detalle_mantenimiento,'recomendaciones': item2.recomendaciones,'firma_evalua': item2.firma_evalua,'fecha_firma': item2.fecha_firma,'foto_salida': item2.foto_salida,'fecha_envio':fecha_envio};
                                                    fumigacion++;
                                                }
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("SELECT * from fotos_fumigacion WHERE id_cedula = ?",
                                                            [id_cedula],
                                                            function(tx, results){
                                                                var length = results.rows.length;
                                                                var fecha = new Date();
                                                                var fecha_envio = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                                                                for(var i = 0; i< length; i++){
                                                                    var item3 = results.rows.item(i);
                                                                    evidenciaFumigacion[evidenciafumi] = {'Valor':evidenciafumi,'fase': item3.fase,'foto_area': item3.foto_area,'nombre_area':item3.nombre_area,'fecha_foto':item3.fecha_foto,'fecha_envio':fecha_envio};
                                                                    evidenciafumi++;
                                                                }
                                                                $.ajax({
                                                                    type: "POST",
                                                                    async : true,
                                                                    url: "http://www.appbennetts.com/FWM2/app/guardarFumigacion.php",
                                                                    dataType: 'html',
                                                                    data: {'datosCedulaGeneral': JSON.stringify(datosCedulaGeneral),'datosFumigacion': JSON.stringify(datosFumigacion),'evidenciaFumigacion': JSON.stringify(evidenciaFumigacion)},
                                                                    success: function(respuesta){
                                                                        var respu1 = respuesta.split("._.");
                                                                        var dat1 = respu1[0];
                                                                        var dat2 = respu1[1];
                                                                        if(dat1 == "CEDULA"){
                                                                            if(dat2 > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx7){
                                                                                        tx7.executeSql(
                                                                                            "UPDATE cedulas_general SET estatus = 3 WHERE id_cedula = ?",
                                                                                            [id_cedula],
                                                                                            function(tx7, results){
                                                                                                localStorage.setItem("sendFlag", 0);
                                                                                                swal("Enviado!", "Ya se envio tu visita!", "success");
                                                                                            }
                                                                                        );
                                                                                    });
                                                                            }
                                                                        } else {
                                                                            AlmacenarError(respuesta);
                                                                        }
                                                                    },
                                                                    error: function(){
                                                                        console.log("Error en la comunicacion");
                                                                    }
                                                                });
                                                            },
                                                            function(tx, error){
                                                                console.log("Error al consultar fotos sanitizacion: " +error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                            },
                                            function(tx, error){
                                                console.log("Error al consultar sanitizacion: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            }
                        },
                        function(tx, error){
                            console.log("Error al consultar datos generales: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    // AyB Fin
    //Inicio MrFixer
    function formatDate1(date) {
        var d = new Date(date),
            month = '' + (d.getMonth() + 1),
            day = '' + d.getDate(),
            year = d.getFullYear();

        if (month.length < 2)
            month = '0' + month;
        if (day.length < 2)
            day = '0' + day;

        return [year, month, day].join('-');
    }
    function regresarRecorridoMrFixer1(){
        app.views.main.router.back('/recorridoMrFixer1/', {force: true, ignoreCache: true, reload: true});
    }
    function continuarCedMrFixer(id_cedula,tipo){
        localStorage.setItem("Opcion", '1');
        localStorage.setItem("IdCedula", id_cedula);
        if (tipo == 1){
            app.views.main.router.back('/recorridoMrFixer1/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function buscarClienteMrFixer(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#cliente-Field").val();
        var ubicacion = $("#ubicacion").val();
        var nombre_sitio = $("#nombre_sitio").val();
        var supervisor_estafeta = $("#supervisor_estafeta").val();
        var no_empleados = $("#no_empleados").val();
        var estatus = 0;
        var nombre_cliente = $("#nombre_sitio").val();
        var datos_v = new Array();
        if(foto_llegada != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            datos_v[0] = {'id_usario':id_usuario ,'nombre_usuario':nombre_usuario ,'id_cliente':id_cliente,'nombre_cliente':nombre_cliente,'fecha_envio':fecha_llegada};
                            $.ajax({
                                type: "POST",
                                async : true,
                                url: "http://www.appbennetts.com/FWM2/app/guardardatosVentaMR.php",
                                dataType: 'html',
                                data: {'datos_v': JSON.stringify(datos_v)},
                                success: function(respuesta){
                                    // console.log("Respuesta",respuesta)
                                },
                                error: function(){
                                    console.log("Error en la comunicacion con el servidor");
                                }
                            });
                            var item = results.rows.item(0);
                            localStorage.setItem("IdCedula", item.Id);
                            localStorage.setItem("foto_llegada", foto_llegada);
                            localStorage.setItem("ubicacion", ubicacion);
                            localStorage.setItem("nombre_sitio", nombre_sitio);
                            localStorage.setItem("supervisor_estafeta", supervisor_estafeta);
                            localStorage.setItem("no_empleados", no_empleados);
                            app.views.main.router.navigate({name: 'menuMrFixer'});
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarBitacoraMrFixer(){
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_cliente = localStorage.getItem("nombreCliente");
        var foto_llegada = localStorage.getItem("foto_llegada");
        var ubicacion =  localStorage.getItem("ubicacion");
        var nombre_sitio = localStorage.getItem("nombre_sitio");
        var supervisor_estafeta = localStorage.getItem("supervisor_estafeta");
        var no_empleados = localStorage.getItem("no_empleados");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var tipoCedula = "Bitacora";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addBitacoraMrFixter(id_cedula,foto_llegada,ubicacion,fecha_llegada,nombre_sitio,supervisor_estafeta,no_empleados,tipoCedula);
                        productHandler.addInsumos(id_cedula,'Shampoo',0,'Mililitros');
                        productHandler.addInsumos(id_cedula,'Abrillantador',0,'Mililitros');
                        productHandler.addInsumos(id_cedula,'Desengrasante',0,'Mililitros');
                        app.views.main.router.navigate({name: 'recorridoMrFixer1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosGeneralesMrFixer(){
        var id_cedula = localStorage.getItem("IdCedula");
        var ubicacion = $("#ubicacion").val();
        var operador = $("#operador").val();
        var horario = $("#horario").val();
        var fecha = $("#fecha").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from datos_generales_MrFixer WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        let length = results.rows.length;
                        for(var i = 0; i< length; i++){
                            var item = results.rows.item(i);
                            if (item.no_empleados==1){
                                swal("", "Se guardaron los datos correctamente" ,"success");
                            }else {
                                if(operador){
                                    if(horario){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE datos_generales_MrFixer SET operador = ?,hora = ? WHERE id_cedula = ?",
                                                    [operador,horario,id_cedula],
                                                    function(tx, results){
                                                        swal("", "Se guardaron los datos correctamente" ,"success");
                                                        $("#operador").css("background-color", "#FFFFFF");
                                                        $("#horario").css("background-color", "#FFFFFF");
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }else{
                                        swal("","Debes colocar el horario de llegada del Operador","warning");
                                    }
                                }else{
                                    swal("","Debes colocar el nombre del Operador","warning");
                                }
                            }
                        }
                    },
                    function(tx, error){
                        console.log("Error al mostar datos: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    // function guardarInsumoMrFixer(){
    //     app.preloader.show('blue');
    //     var id_cedula = localStorage.getItem("IdCedula");
    //     var nombre = $("#nombre").val();
    //     var cantidad = $("#cantidad").val();
    //     if (nombre){
    //         if(cantidad){
    //             databaseHandler.db.transaction(
    //                 function(tx){
    //                     tx.executeSql("INSERT INTO insumos(id_cedula, nombre, cantidad) VALUES (?,?,?)",
    //                         [id_cedula, nombre, cantidad],
    //                         function(tx, results){
    //                             app.preloader.hide();
    //                             swal("","Datos guardados correctamente","success");
    //                             $("#nombre").val('');
    //                             $('#nombre').css("background-color", "#ffffff");
    //                             $("#cantidad").val('');
    //                             $('#cantidad').css("background-color", "#ffffff");
    //                             databaseHandler.db.transaction(
    //                                 function(tx){
    //                                     tx.executeSql("Select * from insumos where id_cedula = ? ORDER BY id_insumo DESC",
    //                                     [id_cedula],
    //                                         function(tx, results){
    //                                             var item = results.rows.item(0);
    //                                             $("#table_insumos").append("<tr id='fila"+ item.id_insumo +
    //                                                 "'><td style='text-align: center;'>" +
    //                                                 item.nombre + "</td><td style='text-align: center;'>" +
    //                                                 item.cantidad + "</td></tr>");
    //                                             $("#message-nr").css("display", "none");
    //                                             $('.preloader').remove();
    //                                             $('.infinite-scroll-preloader').remove();
    //                                             app.preloader.hide();
    //                                         },
    //                                         function(tx, error){
    //                                             console.log("Error al guardar cedula: " + error.message);
    //                                             app.preloader.hide();
    //                                         }
    //                                     );
    //                                 },
    //                                 function(error){},
    //                                 function(){}
    //                             );
    //                         },
    //                         function(tx, error){
    //                             app.preloader.hide();
    //                             swal("Error al guardar",error.message,"error");
    //                         }
    //                     );
    //                 },
    //                 function(error){},
    //                 function(){}
    //             );
    //         }else{
    //             swal("","Debes ingresa una cantidad","warning");
    //         }
    //     }else{
    //         swal("","Debes colocar el nombre del insumo","warning");
    //     }
    // }
    function guardarVehiculoMrFixer(){
        var id_cedula = localStorage.getItem("IdCedula");
        var clave_sitio = localStorage.getItem("rol");
        var eco = $("#eco").val();
        var placa = $("#placa").val();
        var tipo_unidad = $("#unidad").val();
        var modelo = $("#modelo").val();
        var observaciones = $("#observaciones").val();
        var foto_evidencia = $("#imagenC").val();
        var fecha = new Date();
        var fecha_evidencia=fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var id_vehiculo=$("#buscabitacora").val();
        if (id_vehiculo== 'Nuevo Vehículo' || id_vehiculo== 'Nuevo'){
            var nuevo = 1;
            if(eco || placa){
                if(foto_evidencia){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO bitacora(id_cedula, eco, placa, modelo, observaciones, foto_evidencia, fecha,clave_sitio, nuevo, id_vehiculo) VALUES (?,?,?,?,?,?,?,?,?,?)",
                                [id_cedula, eco, placa, modelo, observaciones, foto_evidencia, fecha_evidencia,clave_sitio, nuevo, id_vehiculo],
                                function(tx, results){
                                    app.preloader.hide();
                                    swal("","Datos guardados correctamente","success");
                                    $("#nombre_equipo").val('');
                                    $("#eco").val('');
                                    $("#eco").prop('readonly', true);
                                    $('#eco').css("background-color", "#ffffff");
                                    $("#placa").val('');
                                    $("#placa").prop('readonly', true);
                                    $('#placa').css("background-color", "#ffffff");
                                    $("#unidad").val('');
                                    $("#unidad").prop('readonly', true);
                                    $('#unidad').css("background-color", "#ffffff");
                                    $("#modelo").val('');
                                    $("#modelo").prop('readonly', true);
                                    $('#modelo').css("background-color", "#ffffff");
                                    $("#observaciones").val('');
                                    $('#observaciones').css("background-color", "#ffffff");
                                    $("#imagenC").val('');
                                    $("#buscabitacora").val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from bitacora where id_cedula = ? ORDER BY id_bitacora DESC",
                                            [id_cedula],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    var foto='Sin Foto';
                                                    var observaciones = 'Sin Observaciones';
                                                    var placa = 'Sin Placa';
                                                    var eco = 'Sin Número Económico';
                                                    if (item.eco == undefined || item.eco == '' || item.eco == null){
                                                    }else{
                                                        eco=item.eco;
                                                    }
                                                    if (item.placa == undefined || item.placa == '' || item.placa == null){
                                                    }else{
                                                        placa=item.placa;
                                                    }
                                                    if (item.observaciones == undefined || item.observaciones == '' || item.observaciones == null){
                                                    }else{
                                                        observaciones=item.observaciones;
                                                    }
                                                    if (item.foto_evidencia == undefined || item.foto_evidencia == '' || item.foto_evidencia == null){
                                                    }else{
                                                        foto="<img src='"+item.foto_evidencia +"' width='60px' style='margin-top: 4px;'/>";
                                                    }
                                                    $("#table_bitacora").append("<tr id='fila"+ item.id_bitacora +
                                                        "'><td><a onclick='eliminarFilaMrFixer("+
                                                        item.id_bitacora +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td>"+
                                                        foto+"</td><td style='text-align: center;'>" +
                                                        eco + "</td><td style='text-align: center;'>" +
                                                        placa + "</td><td style='text-align: center;'>" +
                                                        observaciones + "</td><td style='text-align: center;'>" +
                                                        item.fecha + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                    app.preloader.hide();
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    app.preloader.hide();
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else{
                    swal("","La fotografía es obligatoria","warning");
                }
            }else{
                swal("","Debes ingresa el número economico o la placa para poder guardar","warning");
            }
        }else{
            var nuevo = 0;
            if(eco || placa){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO bitacora(id_cedula, eco, placa, tipo_unidad, modelo, observaciones, foto_evidencia, fecha,clave_sitio, nuevo, id_vehiculo) VALUES (?,?,?,?,?,?,?,?,?,?,?)",
                            [id_cedula, eco, placa, tipo_unidad, modelo, observaciones, foto_evidencia, fecha_evidencia,clave_sitio, nuevo, id_vehiculo],
                            function(tx, results){
                                app.preloader.hide();
                                swal("","Datos guardados correctamente","success");
                                $("#nombre_equipo").val('');
                                $("#eco").val('');
                                $("#eco").prop('readonly', true);
                                $('#eco').css("background-color", "#ffffff");
                                $("#placa").val('');
                                $("#placa").prop('readonly', true);
                                $('#placa').css("background-color", "#ffffff");
                                $("#unidad").val('');
                                $("#unidad").prop('readonly', true);
                                $('#unidad').css("background-color", "#ffffff");
                                $("#modelo").val('');
                                $("#modelo").prop('readonly', true);
                                $('#modelo').css("background-color", "#ffffff");
                                $("#observaciones").val('');
                                $('#observaciones').css("background-color", "#ffffff");
                                $("#imagenC").val('');
                                $("#buscabitacora").val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from bitacora where id_cedula = ? ORDER BY id_bitacora DESC",
                                        [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                var foto='Sin Foto';
                                                var observaciones = 'Sin Observaciones';
                                                var placa = 'Sin Placa';
                                                var eco = 'Sin Número Económico';
                                                if (item.eco == undefined || item.eco == '' || item.eco == null){
                                                }else{
                                                    eco=item.eco;
                                                }
                                                if (item.placa == undefined || item.placa == '' || item.placa == null){
                                                }else{
                                                    placa=item.placa;
                                                }
                                                if (item.observaciones == undefined || item.observaciones == '' || item.observaciones == null){
                                                }else{
                                                    observaciones=item.observaciones;
                                                }
                                                if (item.foto_evidencia == undefined || item.foto_evidencia == '' || item.foto_evidencia == null){
                                                }else{
                                                    foto="<img src='"+item.foto_evidencia +"' width='60px' style='margin-top: 4px;'/>";
                                                }
                                                $("#table_bitacora").append("<tr id='fila"+ item.id_bitacora +
                                                    "'><td><a onclick='eliminarFilaMrFixer("+
                                                    item.id_bitacora +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td>"+
                                                    foto+"</td><td style='text-align: center;'>" +
                                                    eco + "</td><td style='text-align: center;'>" +
                                                    placa + "</td><td style='text-align: center;'>" +
                                                    observaciones + "</td><td style='text-align: center;'>" +
                                                    item.fecha + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al guardar cedula: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                app.preloader.hide();
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("","Debes buscar y seleccionar un vehículo para poder guardar los datos","warning");
            }
        }
    }
    function actualizafinMrFixer(fase,id,val){
        var unidad = $("#unidad"+id).val();
        if (fase==1){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Update insumos SET cantidad = ?,unidad = ? where id_insumo = ?",
                    [val,unidad,id],
                        function(tx, results){
                            //swal("","Dato guardado correctamente","success");
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(fase == 2){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Update insumos SET fin = ?,Unidad_fin = ? where id_insumo = ?",
                    [val,unidad,id],
                        function(tx, results){
                            //swal("","Dato guardado correctamente","success");
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarCierreMrFixer(){
        if($("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_MrFixer SET firma_cliente = ?, fecha_cliente = ? WHERE id_cedula = ?",
                [firmaCliente, fecha_firma, id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyMrFixer/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarServicioMrFixer(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_MrFixer SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function eliminarFilaMrFixer(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM bitacora WHERE id_bitacora = ?",
                        [index],
                        function(tx, results){
                                swal("","El registro se elimino satisfactoriamente","success");
                                $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function modalInsumos(){
        app.sheet.open('#sheet-modal');
    }
    function registroMaterialMrFixer(){
        var id_cedula = localStorage.getItem("IdCedula");
        var shampoo = $("#shampoo").val()
        var abrillantador = $("#abrillantador").val()
        var desengrasante = $("#desengrasante").val()
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from material_registrado WHERE id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var length = results.rows.length;
                        if(length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO material_registrado(id_cedula,shampoo,desengrasante,abrillantador,fecha_registro) VALUES (?,?,?,?,?)",
                                        [id_cedula,shampoo,desengrasante,abrillantador,fecha_registro],
                                        function(tx, results){
                                            swal("", "Datos actualizados correctamente", "success");
                                            $("#shampoo").css("background-color","#fff");
                                            $("#abrillantador").css("background-color","#fff");
                                            $("#desengrasante").css("background-color","#fff");
                                            app.sheet.close('#sheet-modal');
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){
                                }
                            );
                        } else {
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE material_registrado SET shampoo = ?, desengrasante = ?, abrillantador=? WHERE id_cedula = ?",
                                        [shampoo,desengrasante,abrillantador,id_cedula],
                                        function(tx, results){
                                            swal("", "Datos actualizados correctamente", "success");
                                            $("#shampoo").css("background-color","#fff");
                                            $("#abrillantador").css("background-color","#fff");
                                            $("#desengrasante").css("background-color","#fff");
                                            app.sheet.close('#sheet-modal');
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar checklits: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarRecorridoMrFixer11(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from insumos where id_cedula = ? AND fin ==''",
                [id_cedula],
                    function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                            app.views.main.router.back('/recorridoMrFixer1/', {force: true, ignoreCache: true, reload: true});
                        } else {
                            swal({
                                title: "Aviso",
                                text: "Faltan aún algunos insumos finales, ¿Estas seguro que deseas regresar?",
                                icon: "warning",
                                buttons: true,
                                dangerMode: false,
                            }).then((willGoBack) => {
                                if (willGoBack){
                                    app.views.main.router.back('/recorridoMrFixer1/', {force: true, ignoreCache: true, reload: true});
                                } else {}
                            });
                        }

                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function cierreMrFixer(){
        var id_cedula = localStorage.getItem("IdCedula");
        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("Select * from insumos where id_cedula = ?",
        //         [id_cedula],
        //             function(tx, results){
        //                 var length = results.rows.length;
        //                 if(length >= 2){
        //                     databaseHandler.db.transaction(
        //                         function(tx){
        //                             tx.executeSql("Select * from insumos where id_cedula = ? AND fin is null OR fin == ''",
        //                             [id_cedula],
        //                                 function(tx, results){
        //                                     var length = results.rows.length;
        //                                     if(length == 0){
                                                app.views.main.router.back('/cierreMrFixer/', {force: true, ignoreCache: true, reload: true});
        //                                     } else {
        //                                         swal("","Debes terminar de ingresar los Insumos Finales para poder continuar","warning");
        //                                     }
        //                                 },
        //                                 function(tx, error){
        //                                     console.log("Error al guardar cedula: " + error.message);
        //                                 }
        //                             );
        //                         },
        //                         function(error){},
        //                         function(){}
        //                     );
        //                 } else {
        //                     swal("","Debes ingresar mínimo 2 Insumos Iniciales para poder continuar","warning");
        //                 }
        //             },
        //             function(tx, error){
        //                 console.log("Error al guardar cedula: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){},
        //     function(){}
        // );
    }
    function actualizafinMrFixer1(fase,id,val){
        if(fase == 1){
            if(val==0){
                swal("","Selecciona una unidad válida","warning");
            }else{
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Update insumos SET unidad = ? where id_insumo = ?",
                        [val,id],
                            function(tx, results){
                                swal("","Dato guardado correctamente","success");
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }
        }else if (fase == 2){
            if(val==0){
                swal("","Selecciona una unidad válida","warning");
            }else{
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Update insumos SET Unidad_fin = ? where id_insumo = ?",
                        [val,id],
                            function(tx, results){
                                swal("","Dato guardado correctamente","success");
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }
        }
    }
    //fin MrFixer
    //Suro Inicio
    function buscarClienteSURO(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = $("#id_cliente").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#Nombre").val() + " " + $("#Sucursal").val();
        var Sucursal = $("#Sucursal").val();
        var Direccion = $("#Direccion").val();
        var correo = $("#correo").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                if(nombre_cliente != ' '){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    localStorage.setItem("IdCedula", item.Id);
                                    localStorage.setItem("nombreCliente", nombre_cliente);
                                    localStorage.setItem("foto_llegada", foto_llegada);
                                    localStorage.setItem("sucursal", Sucursal);
                                    localStorage.setItem("direccion", Direccion);
                                    localStorage.setItem("correo", correo);
                                    localStorage.setItem("nombre_sitio", nombre_cliente);
                                    app.views.main.router.navigate({name: 'menuSURO'});
                                    app.preloader.hide();
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else {
                    swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarSanitizacionSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let tipoCedula = "sanitizacionSURO";
        let direccion = localStorage.getItem("direccion");
        let correo = localStorage.getItem("correo");
        let sucursal = localStorage.getItem("sucursal");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addSanitizacionSURO(id_cedula,foto_llegada,nombre_cliente,nombre_usuario,sucursal,direccion,correo);
                        productHandler.groupInit(id_cedula);
                        app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarDatosSURO(){
        app.preloader.show('blue');
        if($("#nombreCliente").val() =="" || $("#sucursal").val() == "" || $("#direccion").val() == "" || $("#correo").val() == "" || $("#tecnico").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var cliente = $("#nombreCliente").val();
        var sucursal = $("#sucursal").val();
        var direccion = $("#direccion").val();
        var correo = $("#correo").val();
        // var tipo_servicio = $("#servicio").val();
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET nombre_cliente = ?,sucursal = ?,direccion = ?,correo = ?, nombre_usuario =?  WHERE id_cedula = ?",
                    [cliente,sucursal,direccion,correo, nombre_usuario, id_cedula],
                    function(tx, results){
                        $("#nombreCliente").css("background-color", "#FFFFFF");
                        $("#sucursal").css("background-color", "#FFFFFF");
                        $("#direccion").css("background-color", "#FFFFFF");
                        $("#correo").css("background-color", "#FFFFFF");
                        // $("#servicio").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function añadirGrupoSuro(grupo) {
        console.log(grupo)
        var id_cedula = localStorage.getItem("IdCedula",id_cedula);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select MAX(indice) as Id from grupos WHERE id_cedula = ? AND fases = ?",
                    [id_cedula,grupo],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var id_evidencia = item.Id;
                        id_evidencia = (id_evidencia + 1);
                        var nameaGroup = "Grupo " + id_evidencia;
                        app.preloader.hide();
                        //Agregar nuevo grupo
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("insert into grupos(id_cedula,nombre_grupo,fases,indice) values(?,?,?,?)",
                                [id_cedula,nameaGroup,grupo,id_evidencia],
                                    function(tx, results){
                                        $('#grupo').prepend("<option value='"+ nameaGroup +"' >" + nameaGroup + "</option>");
                                        swal("","El grupo fue agregado correctamente","success");
                                        $("#grupo option[value='"+ nameaGroup +"']").attr("selected",true);
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al mostrar Registro guardado",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarRecorridoSURO(){
        app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
    }
    function startFromProgramSURO(nombre_comercial,sucursal,direccion,correo,id_cliente){
        localStorage.setItem("nombreCliente", nombre_comercial);
        localStorage.setItem("sucursal", sucursal);
        localStorage.setItem("id_cliente", id_cliente);
        localStorage.setItem("direccion", direccion);
        localStorage.setItem("correo", correo);
        app.views.main.router.navigate({name: 'yallegueSURO2'});
    }
    function iniciarClienteSURO(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = localStorage.getItem("id_cliente");
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        let tipoCedula = "sanitizacionSURO";
        var nombre_cliente = localStorage.getItem("nombreCliente") + " " + localStorage.getItem("sucursal");
        var sucursal = localStorage.getItem("sucursal");
        var direccion = localStorage.getItem("direccion");
        var correo = localStorage.getItem("correo");
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                var id_cedula = item.Id;
                                localStorage.setItem("IdCedula", item.Id);
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                            [tipoCedula,id_cedula],
                                            function(tx, results){
                                                productHandler.addSanitizacionSURO(id_cedula,foto_llegada,nombre_cliente,nombre_usuario,sucursal,direccion,correo);
                                                productHandler.groupInit(id_cedula);
                                                app.views.main.router.back('/recorridoSURO/', {force: true, ignoreCache: true, reload: true});
                                            },
                                            function(tx, error){
                                                console.error("Error al actualizar el tipo de cedula: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function guardarCierreSanitizacionSURO(){
        if($("#NombreFirma").val() == "" || $("#puesto").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var puesto = $("#puesto").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET firma_cliente = ?,fecha_cliente = ?,puesto = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,puesto,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoySanitizacionSURO/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSanitizacionSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE sanitizacion_Suro SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function eliminarFilaSURO(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencia WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM Fotos_SURO WHERE id_fotos = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM minuta_SURO WHERE id_minuta = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function alertNotReadySURO(){
        var antes = $('#img2').prop('src');
        if(antes.includes("2")){

        } else {
            swal("","Debes llenar el apartado de ANTES, para poder ingresar a este apartado.","warning");
        }
    }
    function generarRecorridoSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let puesto =localStorage.getItem("rol");
        let nombre_sitio =localStorage.getItem("nombre_sitio");
        let tipoCedula = "recorridoSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let titulo = 'Foto de entrada R';
        let proceso = 100;
        let recorrido = 100;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "INSERT INTO Recorrido_SURO(id_cedula,Nombre_remitente,fecha_envio,ubicacion,puesto_re,Nombre_sitio) values(?,?,?,?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada,geolocation,puesto,nombre_sitio],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);
                                        app.views.main.router.back('/recorridoSURO1/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );

                        console.log("Registro de Recorrido_SURO creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Recorrido_SURO:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarVisitaSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "visitaSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let nombre_sitio =localStorage.getItem("nombre_sitio");
        let titulo = 'Foto de entrada V';
        let proceso = 400;
        let recorrido = 400;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into Visita_SURO(id_cedula,Nombre_remitente,fecha_envio,ubicacion,Nombre_sitio) values(?,?,?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada,geolocation,nombre_sitio],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);
                                        app.views.main.router.back('/recorridoSURO2/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );

                        console.log("Registro de Visita_SURO creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Visita_SURO:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarEncuestaSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "encuestaSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let nombre_sitio =localStorage.getItem("nombre_sitio");
        let titulo = 'Foto de entrada E';
        let proceso = 700;
        let recorrido = 700;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into Encuesta_SURO(id_cedula,Nombre_remitente, fecha_envio,ubicacion,nombre_sitio) values(?,?,?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada,geolocation,nombre_sitio],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);

                                        app.views.main.router.back('/recorridoSURO3/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );

                        console.log("Registro de Visita_SURO creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Visita_SURO:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function generarVisitaBSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "visitaBSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let nombre_sitio =localStorage.getItem("nombre_sitio");
        let titulo = 'Foto de entrada VB';
        let proceso = 400;
        let recorrido = 400;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into VisitaB_SURO(id_cedula,responsable,fecha,sitio) values(?,?,?,?)",
                    [id_cedula,nombre_usuario,fecha_llegada,nombre_sitio],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);

                                        app.views.main.router.back('/recorridoSURO4/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );

                        console.log("Registro de Visita_SUROB creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Visita_SUROB:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function generarSeguimientoSURO(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let tipoCedula = "seguimientoSURO";
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        var geolocation = $("#geolocation").val();
        let foto_llegada = localStorage.getItem("foto_llegada");
        let nombre_sitio =localStorage.getItem("nombre_sitio");
        let titulo = 'Foto de entrada S';
        let proceso = 500;
        let recorrido = 500;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "insert into Seguimiento(id_cedula,fecha,sitio) values(?,?,?)",
                    [id_cedula,fecha_llegada,nombre_sitio],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                    [tipoCedula,id_cedula],
                                    function(tx, results){
                                        productHandler.addfotoSURO(id_cedula,foto_llegada,titulo,fecha_llegada,proceso,recorrido);

                                        app.views.main.router.back('/recorridoSURO5/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );

                        console.log("Registro de Seguimiento creado exitosamente");
                    },
                    function(tx, error){
                        console.error("Error al registrar el Seguimiento:" + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function encuestaSURO(elem,val){
        console.log('elemento',elem);
        console.log('val',val);
        if(elem == 1){
            if(val <= 4){
                $('#comentario1').css('display','block');
            }else{
                $('#comentario1').css('display','none');
            }
        }else if(elem == 2){
            if(val <= 4){
                $('#comentario2').css('display','block');
            }else{
                $('#comentario2').css('display','none');
            }
        }else if(elem == 3){
            if(val <= 4){
                $('#comentario3').css('display','block');
            }else{
                $('#comentario3').css('display','none');
            }
        }else if(elem == 4){
            if(val <= 4){
                $('#comentario4').css('display','block');
            }else{
                $('#comentario4').css('display','none');
            }
        }else if(elem == 5){
            if(val <= 4){
                $('#comentario5').css('display','block');
            }else{
                $('#comentario5').css('display','none');
            }
        }else if(elem == 6){
            if(val <= 4){
                $('#comentario6').css('display','block');
            }else{
                $('#comentario6').css('display','none');
            }
        }else if(elem == 7){
            if(val <= 4){
                $('#comentario7').css('display','block');
            }else{
                $('#comentario7').css('display','none');
            }
        }
    }

    function continuarCedSURO(id_cedula,tipo,nombre_cliente){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("nombre_sitio",nombre_cliente)
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoSURO'});
        }else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoSURO1'});
        }else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoSURO2'});
        }else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoSURO3'});
        }else if(tipo == 5){
            app.views.main.router.navigate({ name: 'recorridoSURO4'});
        }else if(tipo == 6){
            app.views.main.router.navigate({ name: 'recorridoSURO5'});
        }
    }
    function guardarCierreSURO1(){
        if($("#NombreFirma").val() == "" || $("#puesto").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var puesto = $("#puesto").val();
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente R'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 200;
        var recorrido = 200;
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Recorrido_SURO SET puesto = ?,nombre_cliente = ? WHERE id_cedula = ?",
                    [puesto,nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO1/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );


    }
    function guardarCierreSURO2(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente V'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 500;
        var recorrido = 500;
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Visita_SURO SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO2/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function guardarCierreSURO3(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente E'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 800;
        var recorrido = 800;
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Encuesta_SURO SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO3/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function guardarCierreSURO4(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente VB'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1000;
        var recorrido = 1000;
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE VisitaB_SURO SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO4/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function guardarCierreSURO5(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == ""  ){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        var nom_cliente = $("#NombreFirma").val();
        var titulo = 'Firma Cliente S'
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#signate').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1200;
        var recorrido = 1200;
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Seguimiento SET nombre_cliente = ? WHERE id_cedula = ?",
                    [nom_cliente,id_cedula],
                    function(tx, results){
                        swal("","Guardado correctamente","success");
                        app.views.main.router.back('/yamevoySURO5/', {force: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function CierreSeguimientoSURO(){
        var id_cedula = localStorage.getItem("IdCedula");
        let com = $("#comentarios").val();
        let comp = $("#compromisos").val();
        if(com && comp){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE Seguimiento SET comentarios  = ?,observacion = ? WHERE id_cedula = ?",
                    [com,comp,id_cedula],
                        function(tx, results){
                            swal("","Evaluacion fue guardada correctamente","success");
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Los campos son obligatorios","warning");
            return false;
        }
    }
    function guardarEncustaSURO(){
        let res1 =  $( "select#select1 option:checked" ).val();
        let res2 =  $( "select#select2 option:checked" ).val();
        let res3 =  $( "select#select3 option:checked" ).val();
        let res4 =  $( "select#select4 option:checked" ).val();
        let res5 =  $( "select#select5 option:checked" ).val();
        let res6 =  $( "select#select6 option:checked" ).val();
        let res7 =  $( "select#select7 option:checked" ).val();
        let com1 = $("#come1").val();
        let com2 = $("#come2").val();
        let com3 = $("#come3").val();
        let com4 = $("#come4").val();
        let com5 = $("#come5").val();
        let com6 = $("#come6").val();
        let com7 = $("#come7").val();
        var id_cedula = localStorage.getItem("IdCedula");
        if(res1 == 0 ||res2 == 0 || res3 == 0 || res4 == 0 || res5 == 0 || res6 == 0 || res7 == 0){
            swal("","Formulario incompleto","warning");
            return false;
        }

    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("UPDATE Encuesta_SURO SET pregunta1 = ?,pregunta2 = ?,pregunta3 = ?,pregunta4 = ?,pregunta5 = ?,pregunta6 = ?,pregunta7 = ?,comentarios1 = ?,comentarios2 = ?,comentarios3 = ?,comentarios4 = ?,comentarios5 = ?,comentarios6 = ?,comentarios7 = ? WHERE id_cedula = ?",
            [res1,res2,res3,res4,res5,res6,res7,com1,com2,com3,com4,com5,com6,com7,id_cedula],
                function(tx, results){
                    swal("","La encuesta fue guardada correctamente","success");
                },
                function(tx, error){
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );

    }
    function CierreVisitaEvaSURO(){
        var id_cedula = localStorage.getItem("IdCedula");
        let com = $("#comentarios").val();
        let comp = $("#compromisos").val();
        let cal1 = $('input:radio[name="rating0"]:checked').val();
        let cali2 = $('input:radio[name="rating1"]:checked').val();
        let cali3 = $('input:radio[name="rating2"]:checked').val();
        if(cal1 && cali2 && cali3 && com && comp){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE Visita_SURO SET cali_limpieza = ?,cali_ejecutivo  = ?,cali_gerente  = ?,Comentarios  = ?,compromiso = ? WHERE id_cedula = ?",
                    [cal1,cali2,cali3,com,comp,id_cedula],
                        function(tx, results){
                            swal("","Evaluacion fue guardada correctamente","success");
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Todos los campos son obligatorios","warning");
        }
    }
    function terminarRecorridoSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var firma = $('#signate').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 300;
        var recorrido = 300;
        var titulo = 'Foto Salida R'
        var proceso1= 350;
        var recorrido1 = 350;
        var titulo1 = 'Firma Responsable R'
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarVisitaSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 600;
        var recorrido = 600;
        var titulo = 'Foto Salida V'
        var titulo1 = 'Firma Responsable V'
        var firma = $('#signate').val();
        var proceso1= 650;
        var recorrido1 = 650;
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function terminarEncuestaSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 900;
        var recorrido = 900;
        var titulo = 'Foto Salida E'
        var titulo1 = 'Firma Responsable E'
        var firma = $('#signate').val();
        var proceso1= 950;
        var recorrido1 = 950;
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarvisitaBSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 1100;
        var recorrido = 1100;
        var titulo = 'Foto Salida VB'
        var titulo1 = 'Firma Responsable VB'
        var firma = $('#signate').val();
        var proceso1= 1150;
        var recorrido1 = 1150;
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarSegSURO(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        if($('#signate').val() == ""){
            swal("","La firma es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        var proceso= 1300;
        var recorrido = 1300;
        var titulo = 'Foto Salida S'
        var titulo1 = 'Firma Responsable S'
        var firma = $('#signate').val();
        var proceso1= 1350;
        var recorrido1 = 1350;
        productHandler.addfotoSURO(id_cedula,firma,titulo1,fecha_salida,proceso1,recorrido1);
        productHandler.addfotoSURO(id_cedula,foto_salida,titulo,fecha_salida,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                    function(tx, results){
                        window.location.href = "./menu.html";
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function GuardarSUROF1(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }else{
            swal("","Se guardaron los datos correctamente", "success");
            app.preloader.hide();
        }
        var titulo = $('#titulo').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1;
        var recorrido = 1;
        $("#tabla_SURO1 tbody").empty("");
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ?",
                [id_cedula,recorrido],
                    function(tx, results){

                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");

                                        $("#titulo").css("background-color", "#FFFFFF");

                                        $("#tabla_SURO1 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function GuardarSUROF2(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = $('#titulo').val();
        var comentarios = $('#Comentarios').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        if(comentarios == ""){
            swal("","Agregar comentarios","warning");
            return false;
        }
        if($('input:radio[name=pregunta1]:checked').val() == 1 || $('input:radio[name=pregunta1]:checked').val() == 2){
            var pregunta = $('input:radio[name=pregunta1]:checked').val();
        } else {
            swal("","Para avanzar necesitas contestar la pregunta 2.1","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1;
        var recorrido = 2;

        $("#tabla_SURO2 tbody").empty("");
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Recorrido_SURO SET Pregunta_bodega = ?,Comentarios_bodega = ? WHERE id_cedula = ?",
              [pregunta,comentarios,id_cedula],
              function(tx, results){
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
            },
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ?",
                [id_cedula, recorrido],
                    function(tx, results){
                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");
                                        $("#titulo").css("background-color", "#FFFFFF");
                                        $("#tabla_SURO2 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }

                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF3(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = $('#titulo').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        var comentarios = $('#comentarios').val();
        var p1 = $('#p1').val();
        var p2 = $('#p2').val();
        if(comentarios == "" || p1 == "" || p2 == ""){
            swal("","Debe de llenar todos los campos","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 1;
        var recorrido = 3;

        $("#tabla_SURO3 tbody").empty("");
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Recorrido_SURO SET Pregunta_maq1 = ? ,Pregunta_maq2 = ?,Comentarios_maq = ? WHERE id_cedula = ?",
              [p1,p2,comentarios,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#comentarios").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ?",
                [id_cedula,recorrido],
                    function(tx, results){

                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");

                                        $("#titulo").css("background-color", "#FFFFFF");

                                        $("#tabla_SURO3 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF4(){

        var p1 = $('input:radio[name=p1]:checked').val();
        var p2 = $('input:radio[name=p2]:checked').val();
        var p3 = $('input:radio[name=p3]:checked').val();
        var p4 = $('input:radio[name=p4]:checked').val();
        var p5 = $('input:radio[name=p5]:checked').val();
        var p6 = $('input:radio[name=p6]:checked').val();
        var p7 = $('input:radio[name=p7]:checked').val();
        var p8 = $('input:radio[name=p8]:checked').val();
        var p9 = $('#p9').val();

        if(p1 == ""|| p2 == "" || p3 == ""||p4 == ""|| p5 == "" || p6 == ""||p7== ""|| p8 == "" || p9 == ""){
            swal("","Encuesta incompleta","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET gestion1 = ? ,gestion2 = ?,gestion3 = ?,gestion4 = ? ,gestion5 = ?,gestion6 = ?,gestion7 = ? ,gestion8 = ?,gestion9 = ? WHERE id_cedula = ?",
              [p1,p2,p3,p4,p5,p6,p7,p8,p9,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#p3").css("background-color", "#FFFFFF");
                $("#p4").css("background-color", "#FFFFFF");
                $("#p5").css("background-color", "#FFFFFF");
                $("#p6").css("background-color", "#FFFFFF");
                $("#p7").css("background-color", "#FFFFFF");
                $("#p8").css("background-color", "#FFFFFF");
                $("#p9").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );


    }
    function GuardarSUROF5(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }else{
            swal("","Se guardaron los datos correctamente", "success");
            app.preloader.hide();
        }
        var titulo = $('#titulo').val();
        if(titulo == ""){
            swal("","Agregar Nombre del Area","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 2;
        var recorrido = 4;
        var comentarios = $('#comentarios').val();
        $("#tabla_SURO4 tbody").empty("");
        // var p1 = $('#p1').val();
        // var p2 = $('#p2').val();
        // var p3 = $('#p3').val();
        // var p4 = $('#p4').val();
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        // databaseHandler.db.transaction(
        //     function(tx){
        //       tx.executeSql("UPDATE VisitaB_SURO SET frecuencia1 = ? ,frecuencia2 = ?,frecuencia3 = ?,frecuencia4 = ? WHERE id_cedula = ?",
        //       [p1,p2,p3,p4,id_cedula],
        //       function(tx, results){
        //         $("#p1").css("background-color", "#FFFFFF");
        //         $("#p2").css("background-color", "#FFFFFF");
        //         $("#p3").css("background-color", "#FFFFFF");
        //         $("#p4").css("background-color", "#FFFFFF");
        //         swal("","Se guardaron los datos correctamente", "success");
        //         app.preloader.hide();
        //       },
        //       function(tx, error){
        //         swal("Error al guardar", error.message, "error");
        //         app.preloader.hide();
        //       }
        //       );
        //     },
        //     function(error){},
        //     function(){}
        //   );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                [id_cedula,recorrido,proceso],
                    function(tx, results){

                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");

                                        $("#titulo").css("background-color", "#FFFFFF");

                                        $("#tabla_SURO4 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF6(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = 'Almacen';
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 3;
        var recorrido = 4;
        var p1 = $('#p1').val();
        var p2 = $('#p2').val();
        var p3 = $('#p3').val();
        var p4 = $('#p4').val();
        $("#tabla_SURO5 tbody").empty("");
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET almacen1 = ? ,almacen2 = ?,almacen3 = ?,almacen4 = ? WHERE id_cedula = ?",
              [p1,p2,p3,p4,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#p3").css("background-color", "#FFFFFF");
                $("#p4").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                [id_cedula,recorrido,proceso],
                    function(tx, results){

                        var length = results.rows.length;
                        var item = results.rows.item(0);
                        console.log("item",item);
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");
                                        $("#titulo").css("background-color", "#FFFFFF");
                                        $("#tabla_SURO5 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }
                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function GuardarSUROF7(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var titulo = 'Recorrido';
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 4;
        var recorrido = 4;
        var p1 = $('#p1').val();
        var p2 = $('#p2').val();
        var p3 = $('#p3').val();
        $("#tabla_SURO6 tbody").empty("");
        productHandler.addfotoSURO(id_cedula,foto,titulo,fecha_E,proceso,recorrido);
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET recorrido1 = ? ,recorrido2 = ?,recorrido3 = ? WHERE id_cedula = ?",
              [p1,p2,p3,id_cedula],
              function(tx, results){
                $("#p1").css("background-color", "#FFFFFF");
                $("#p2").css("background-color", "#FFFFFF");
                $("#p3").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                [id_cedula,recorrido,proceso],
                    function(tx, results){
                        var length = results.rows.length;
                        if(length == 0){
                                    $("#message-nr").css("display", "block");
                                } else {
                                    for(var i = 0; i< length; i++){
                                        var item = results.rows.item(i);
                                        $("#smallImage").attr("src","img/blank.png");
                                        $('#imagenC').val("");
                                        $('#titulo').val("");
                                        $("#photoIcon").attr("src","img/camera.svg");

                                        $("#titulo").css("background-color", "#FFFFFF");

                                        $("#tabla_SURO6 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }
                                }

                        $('.preloader').remove();
                        $('.infinite-scroll-preloader').remove();
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("Error al guardar cedula: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function GuardarSUROF8(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $('#imagenC').val();
        var fecha = new Date();
        var fecha_E = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var proceso= 5;
        var recorrido = 1;
        var p1 = $('#p1').val();
        if(p1){
            $("#tabla_SURO9 tbody").empty("");
            productHandler.addfotoSURO(id_cedula,foto,p1,fecha_E,proceso,recorrido);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select * from Fotos_SURO where id_cedula = ? and recorrido = ? and proceso = ?",
                    [id_cedula,recorrido,proceso],
                        function(tx, results){
                            var length = results.rows.length;
                            var item = results.rows.item(0);
                            if(length == 0){
                                        $("#message-nr").css("display", "block");
                                    } else {
                                        for(var i = 0; i< length; i++){
                                            var item = results.rows.item(i);
                                            $("#smallImage").attr("src","img/blank.png");
                                            $('#imagenC').val("");
                                            $("#photoIcon").attr("src","img/camera.svg");
                                            $("#p1").css("background-color", "#FFFFFF");
                                            $("#p1").val('');
                                            swal("","Se guardaron los datos correctamente", "success");
                                            $("#tabla_SURO9 tbody").append("<tr id='fila"+ item.id_fotos +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_fotos +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.titulo + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                            $("#message-nr").css("display", "none");
                                        }
                                    }

                            $('.preloader').remove();
                            $('.infinite-scroll-preloader').remove();
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Favor de ingresar un comentario","warning");
        }
    }
    function guardarDGSURO1(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        if(remitente == "" || Fecha == ""|| sitio == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Recorrido_SURO SET Nombre_remitente = ?, fecha_envio = ?, Nombre_sitio = ? WHERE id_cedula = ?",
              [remitente,Fecha,sitio,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        var motivo = $('#motivo').val();
        if(remitente == "" || Fecha == ""|| sitio == "" || motivo == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Visita_SURO SET Nombre_remitente = ?, fecha_envio = ?, Nombre_sitio = ?, motivo_vista = ? WHERE id_cedula = ?",
              [remitente,Fecha,sitio,motivo,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                $("#motivo").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO3(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        if(remitente == "" || Fecha == ""|| sitio == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Encuesta_SURO SET nombre_sitio = ? WHERE id_cedula = ?",
              [sitio,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                $("#motivo").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO4(){
        var id_cedula = localStorage.getItem("IdCedula");
        var remitente = $('#remitente').val();
        var Fecha = $('#Fecha').val();
        var sitio = $('#sitio').val();
        var Pendientes = $('#Pendientes').val();
        var numero = $('#numero').val();
        if(remitente == "" || Fecha == ""|| sitio == "" || Pendientes == "" || numero == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE VisitaB_SURO SET responsable = ?, fecha = ?, sitio = ?, pendientes = ?, numero_ti = ? WHERE id_cedula = ?",
              [remitente,Fecha,sitio,Pendientes,numero,id_cedula],
              function(tx, results){
                $("#remitente").css("background-color", "#FFFFFF");
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#sitio").css("background-color", "#FFFFFF");
                $("#Pendientes").css("background-color", "#FFFFFF");
                $("#numero").css("background-color", "#FFFFFF");
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarDGSURO5(){
        var id_cedula = localStorage.getItem("IdCedula");
        var Fecha = $('#Fecha').val();
        var sitio = $('#Sitio').val();
        var motivo = $('#Motivo').val();
        if(motivo == "" || Fecha == ""|| sitio == ""){
            swal("","Debes de llenar todos los campos","warning");
            return false;
        }
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE Seguimiento SET fecha = ?, sitio = ?, motivo = ? WHERE id_cedula = ?",
              [Fecha,sitio,motivo,id_cedula],
              function(tx, results){
                swal("","Se guardaron los datos correctamente", "success");
                app.preloader.hide();
                $("#Fecha").css("background-color", "#FFFFFF");
                $("#Sitio").css("background-color", "#FFFFFF");
                $("#Motivo").css("background-color", "#FFFFFF");
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function guardarMinutaSuro(){
        var id_cedula = localStorage.getItem("IdCedula");
        var id_usuario = localStorage.getItem("id_usuario");
        var id_cliente = localStorage.getItem("nombre_sitio");
        var acuerdo = $('#acuerdo').val();
        var select2 = $('#select2').val();
        var fechaComp = $('#fechaComp').val();
        var fecha = new Date();
        var fecha = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("insert into  minuta_SURO (id_cedula,id_user,id_cliente,acuerdo, urgencia, fecha, fecha_compromiso,status) values (?,?,?,?,?,?,?,?)",
              [id_cedula,id_usuario,id_cliente,acuerdo,select2,fecha,fechaComp,1],
              function(tx, results){
                swal("","Se guardaron los datos correctamenteee", "success");
                app.preloader.hide();
                $("#acuerdo").css("background-color", "#FFFFFF");
                $("#select2").css("background-color", "#FFFFFF");
                $("#fechaComp").css("background-color", "#FFFFFF");
                tx.executeSql("Select * from minuta_SURO where status = ? and id_cliente = ? ORDER BY id_minuta DESC",
                    [1,id_cliente],
                        function(tx, results){
                            var length = results.rows.length;
                            var item = results.rows.item(0);
                            if(length == 0){
                                        $("#message-nr").css("display", "block");
                                    } else {
                                        var item = results.rows.item(0);
                                        $("#tabla_SURO12b").append("<tr id='fila"+ item.id_minuta +"'><td><a href='#' onclick='eliminarFilaSURO("+ item.id_minuta +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" + item.acuerdo + "</td><td style='text-align: center;'>" + item.urgencia + "</td><td style='text-align: center;'>" + item.fecha_compromiso + "</td><td style='text-align: center;'>" + item.fecha_entrega + "</td><td><img src='"+
                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td><a href='#' onclick='TomaEvidenciaMinuta("+ item.id_minuta +");' style='border: none; outline:none;'><img src='img/editar.svg' width='30px' /></a></td></tr>");
                                        $("#message-nr").css("display", "none");
                                    }

                            $('.preloader').remove();
                            $('.infinite-scroll-preloader').remove();
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
               
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
    }
    function updateMinuta(){
       
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC").val();
        var observa = $("#falla").val();
        var id_minuta = localStorage.getItem('id_minuta');
        var fecha = new Date();
        var fecha = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        
        databaseHandler.db.transaction(
            function(tx){
              tx.executeSql("UPDATE minuta_SURO SET fecha_entrega = ?, foto = ?, status = ? WHERE id_minuta = ?",
              [fecha,foto,2,id_minuta],
              function(tx, results){
                console.log('si me ves',id_minuta);
                swal("","Se guardaron los datos correctamente", "success");
                app.sheet.close('#sheet-modal');
                app.preloader.hide();
                app.views.main.router.navigate({name: 'formSUROE12'});
              },
              function(tx, error){
                swal("Error al guardar", error.message, "error");
                app.preloader.hide();
              }
              );
            },
            function(error){},
            function(){}
          );
          
    }
    function TomaEvidenciaMinuta(id){
        localStorage.setItem("id_minuta",id)
        var popEvidencia = app.popup.create({
            content: `
            <div class="sheet-modal my-sheet" id="sheet-modal" name="sheet">
            <div class="toolbar">
                <div class="toolbar-inner">
                    <div class="left"></div>
                    <div class="right"><a class="link" id="close_sheet" href="#">Cerrar</a></div>
                </div>
            </div>
            <div class="sheet-modal-inner">
                <div class="block">
                    <h3 class="FWN-titulo-2">Agregar Evidencia</h3>
                    <form class="list FWM-fixing-form">
                        <input type="hidden" id="inputEvidencia" value=`+id+`>
                        <input type="hidden" id="pasa" value="0">
                            <span class="span FWM-span-form">Foto:</span>
                                    <div class="FWM-photo-container">
                                        <div class="border-capture">
                                            <a onclick="capturePhoto();">
                                                <img class="FWM-photo" src="img/camera.svg" id="photoIcon" width="45px" style="margin-left: 50px;"/>
                                            </a>
                                        </div>
                                        <img class="FWM-photo-hide" id="smallImage" src=""/>
                                        <input type="hidden" id="imagenC" name="imagenC"/>
                                    </div>
                                    <br>
                                <div class="block grid-resizable-demo" style="margin-bottom: 70px;">
                                    <div class="row align-items-stretch" style="text-align: center;">
                                        <div class="col-100 medium-50" style="min-width: 50px; border-style: none;">
                                            <span class="resize-handler"></span>
                                            <a href="#" onclick="updateMinuta();" style="background-color: #063E7F;" class="boton-equipo">Guardar</a>
                                        </div>
                                    </div>
                                </div>
                    </form>
                </div>
            </div>
        </div>`,
        swipeToClose:false,
        closeByOutsideClick:false,
        closeByBackdropClick:false,
        closeOnEscape:false,
                  on: {
                    open: function (popup) {
    
                        $('#close_sheet').click(function () {
                            if($('#pasa').val()!=0){
                                app.sheet.close('#sheet-modal');
                            }else{
                                app.sheet.close('#sheet-modal');
                            }
                        });
                    },
                }
          });
          popEvidencia.open();
    }
    //Suro Fin
    //Inicio SURO2
    function buscarClienteSURO2(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var nombre_cliente = $("#cliente-Field").val();
        var encargado = 'encargado test';
        var turno = 'Vespertino';
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("encargado", encargado);
                                localStorage.setItem("turno", turno);
                                app.views.main.router.navigate({name: 'menuSURO2'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarMaquinariasSURO2(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let encargado = localStorage.getItem("encargado");
        let turno = localStorage.getItem("turno");
        let tipoCedula = "Maquinaria";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMaquinariaSuro2(id_cedula,foto_llegada,nombre_cliente,encargado,turno);
                        app.views.main.router.back('/recorridoSUROE1/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarMaterialesSURO2(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let encargado = localStorage.getItem("encargado");
        let turno = localStorage.getItem("turno");
        let tipoCedula = "Materiales";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMaquinariaSuro2(id_cedula,foto_llegada,nombre_cliente,encargado,turno);
                        app.views.main.router.back('/recorridoSUROE2/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarListadoSitio(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let encargado = localStorage.getItem("encargado");
        let turno = localStorage.getItem("turno");
        let tipoCedula = "Sitio";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addMaquinariaSuro2(id_cedula,foto_llegada,nombre_cliente,encargado,turno);
                        app.views.main.router.back('/recorridoSUROE3/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardardatosMaquinaSuro2(){
        let id_cedula = localStorage.getItem("IdCedula");
        var cliente = $("#cliente").val();
        var encargado_turno = $("#encargado_turno").val();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_maquinaria SET cliente = ?, encargado_turno = ? WHERE id_cedula = ?",
                    [cliente,encargado_turno,id_cedula],
                    function(tx, results){
                        swal("", "Se guardaron los datos correctamente", "success");
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarMaquinariasSuro(){
        var id_cedula = localStorage.getItem("IdCedula");
        var sitio = $("#sitio").val();
        var nombre_recibe = $("#nombre_recibe").val();
        var nombre_maquina = $("#nombre_maquina").val();
        var no_serie = $("#no_serie").val();
        var marca = $("#marca").val();
        var modelo = $("#modelo").val();
        var propietario = $("#propietario").val();
        var propietario_mmto = $("#propietario_mmto").val();
        var tipo = $("#tipo").val();
        var fecha_maquina = $("#fecha_maquina").val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Insert into maquinarias(id_cedula,sitio,nombre_recibe,nombre_maquina,no_serie,marca,modelo,propietario,propietario_mmto,tipo,fecha_maquina) values(?,?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,sitio,nombre_recibe,nombre_maquina,no_serie,marca,modelo,propietario,propietario_mmto,tipo,fecha_maquina],
                    function (tx, results) {
                        swal("", "Se guardaron los datos correctamente", "success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from maquinarias where id_cedula = ? ORDER BY id_maquina DESC",
                                [id_cedula],
                                    function(tx, results){
                                        $("#message-nr").css("display","none");
                                        $("#sitio").css("background-color","#fff");
                                        $("#nombre_recibe").css("background-color","#fff");
                                        $("#nombre_maquina").css("background-color","#fff");
                                        $("#no_serie").css("background-color","#fff");
                                        $("#marca").css("background-color","#fff");
                                        $("#modelo").css("background-color","#fff");
                                        $("#propietario").css("background-color","#fff");
                                        $("#propietario_mmto").css("background-color","#fff");
                                        $("#tipo").css("background-color","#fff");
                                        $("#sitio").val('');
                                        $("#nombre_recibe").val('');
                                        $("#nombre_maquina").val('');
                                        $("#no_serie").val('');
                                        $("#marca").val('');
                                        $("#modelo").val('');
                                        $("#propietario").val(0);
                                        $("#propietario_mmto").val(0);
                                        $("#tipo").val('');
                                        var item = results.rows.item(0);
                                        $("#tabla_registros").append("<tr id='fila"+
                                            item.id_maquina +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaSURO2("+
                                            item.id_maquina +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td>"+
                                            item.sitio+"</td><td style='text-align: center;'>" +unescape(item.nombre_recibe) + "</td><td style='text-align: center;'>" +
                                            unescape(item.nombre_maquina) + "</td><td style='text-align: center;'>" + item.no_serie + "</td><td style='text-align: center;'>" +
                                            item.marca + "</td><td style='text-align: center;'>" + item.modelo + "</td><td style='text-align: center;'>" +
                                            item.propietario + "</td><td style='text-align: center;'>" + item.propietario_mmto + "</td><td style='text-align: center;'>" +
                                            item.tipo + "</td><td style='text-align: center;'>" + item.fecha_maquina + "</td></tr>"
                                        );
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function (tx, error) {
                        console.error("Error al registrar: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarFallaSuro2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var accion = $("#accion").val();
        var estatus = $("#estatus").val();
        var id_ticket = $("#id_ticket").val();
        var fecha = $("#fecha").val();
        var folio_mmto = $("#folio_mmto").val();
        var nombre_entrega = $("#nombre_entrega").val();
        var consumibles = $("#consumibles").val();
        var costo_reparacion = $("#costo_reparacion").val();
        var recomendaciones = $("#recomendaciones").val();

        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Insert into corecciones(id_cedula,accion,estatus,id_ticket,fecha,folio_mmto,nombre_entrega,consumibles,costo_reparacion,recomendaciones) values(?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,accion,estatus,id_ticket,fecha,folio_mmto,nombre_entrega,consumibles,costo_reparacion,recomendaciones],
                    function (tx, results) {
                        swal("", "Se guardaron los datos correctamente", "success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from corecciones where id_cedula = ? ORDER BY id_coreccion DESC",
                                [id_cedula],
                                    function(tx, results){
                                        $("#message-nr").css("display","none");
                                        $("#accion").css("background-color","#fff");
                                        $("#estatus").css("background-color","#fff");
                                        $("#id_ticket").css("background-color","#fff");
                                        $("#fecha").css("background-color","#fff");
                                        $("#folio_mmto").css("background-color","#fff");
                                        $("#nombre_entrega").css("background-color","#fff");
                                        $("#consumibles").css("background-color","#fff");
                                        $("#costo_reparacion").css("background-color","#fff");
                                        $("#recomendaciones").css("background-color","#fff");
                                        $("#accion").val('');
                                        $("#estatus").val('');
                                        $("#id_ticket").val('');
                                        $("#fecha").val('');
                                        $("#folio_mmto").val('');
                                        $("#nombre_entrega").val('');
                                        $("#consumibles").val('');
                                        $("#costo_reparacion").val('');
                                        $("#recomendaciones").val('');
                                        var item = results.rows.item(0);
                                        $("#tabla_registros").append("<tr id='fila"+
                                            item.id_coreccion +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaSURO2("+
                                            item.id_coreccion +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td>"+
                                            item.accion+"</td><td style='text-align: center;'>" +unescape(item.estatus) + "</td><td style='text-align: center;'>" +
                                            unescape(item.id_ticket) + "</td><td style='text-align: center;'>" + item.fecha + "</td><td style='text-align: center;'>" +
                                            item.folio_mmto + "</td><td style='text-align: center;'>" + item.nombre_entrega + "</td><td style='text-align: center;'>" +
                                            item.consumibles + "</td><td style='text-align: center;'>" + item.costo_reparacion + "</td><td style='text-align: center;'>" +
                                            item.recomendaciones + "</td></tr>"
                                        );
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function (tx, error) {
                        console.error("Error al registrar: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarListadoSuro2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_sitio = $("#nombre_sitio").val();
        var sucursal = $("#sucursal").val();
        var nombre_comercial = $("#nombre_comercial").val();
        var sitio = $("#sitio").val();
        var presupuesto = $("#presupuesto").val();
        var direccion = $("#direccion").val();
        var nombre_contacto = $("#nombre_contacto").val();
        var telefono_contacto = $("#telefono_contacto").val();
        var correo_contacto = $("#correo_contacto").val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Insert into listado_material(id_cedula,nombre_sitio,sucursal,nombre_comercial,sitio,presupuesto,direccion,nombre_contacto,telefono_contacto,correo_contacto) values(?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,nombre_sitio,sucursal,nombre_comercial,sitio,presupuesto,direccion,nombre_contacto,telefono_contacto,correo_contacto],
                    function (tx, results) {
                        swal("", "Se guardaron los datos correctamente", "success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from listado_material where id_cedula = ? ORDER BY id_entrada DESC",
                                [id_cedula],
                                    function(tx, results){
                                        $("#message-nr").css("display","none");
                                        $("#nombre_sitio").css("background-color","#fff");
                                        $("#sucursal").css("background-color","#fff");
                                        $("#nombre_comercial").css("background-color","#fff");
                                        $("#sitio").css("background-color","#fff");
                                        $("#presupuesto").css("background-color","#fff");
                                        $("#direccion").css("background-color","#fff");
                                        $("#nombre_contacto").css("background-color","#fff");
                                        $("#telefono_contacto").css("background-color","#fff");
                                        $("#correo_contacto").css("background-color","#fff");
                                        $("#nombre_sitio").val('');
                                        $("#sucursal").val('');
                                        $("#nombre_comercial").val('');
                                        $("#sitio").val('');
                                        $("#presupuesto").val('');
                                        $("#direccion").val('');
                                        $("#nombre_contacto").val('');
                                        $("#telefono_contacto").val('');
                                        $("#correo_contacto").val('');
                                        var item = results.rows.item(0);
                                        $("#tabla_registros").append("<tr id='fila"+
                                            item.id_entrada +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaSURO2("+
                                            item.id_entrada +",8);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td>"+
                                            item.nombre_sitio+"</td><td style='text-align: center;'>" +unescape(item.sucursal) + "</td><td style='text-align: center;'>" +
                                            unescape(item.nombre_comercial) + "</td><td style='text-align: center;'>" + item.sitio + "</td><td style='text-align: center;'>" +
                                            item.presupuesto + "</td><td style='text-align: center;'>" + item.direccion + "</td><td style='text-align: center;'>" +
                                            item.nombre_contacto + "</td><td style='text-align: center;'>" + item.telefono_contacto + "</td><td style='text-align: center;'>" +
                                            item.correo_contacto + "</td></tr>"
                                        );
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function (tx, error) {
                        console.error("Error al registrar: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarTicketSURO2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var id_usuario = $("#id_usuario").val();
        var nombre_maquina = $("#nombre_maquina").val();
        var no_serie = $("#no_serie").val();
        var folio = $("#folio").val();
        var comentarios = $("#comentarios").val();
        var tipo_ticket = $("#tipo_ticket").val();
        var id_ticket = $("#id_ticket").val();
        var foto = $("#imagenC").val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Insert into ticket(id_cedula,id_usuario,nombre_maquina,no_serie,folio,comentarios,tipo_ticket,id_ticket,foto_ticket,fecha_registro) values(?,?,?,?,?,?,?,?,?,?)",
                    [id_cedula,id_usuario,nombre_maquina,no_serie,folio,comentarios,tipo_ticket,id_ticket,foto,fecha_registro],
                    function (tx, results) {
                        swal("", "Se guardaron los datos correctamente", "success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from ticket where id_cedula = ? ORDER BY id_tickets DESC",
                                [id_cedula],
                                    function(tx, results){
                                        $("#message-nr").css("display","none");
                                        $("#id_usuario").css("background-color","#fff");
                                        $("#nombre_maquina").css("background-color","#fff");
                                        $("#no_serie").css("background-color","#fff");
                                        $("#folio").css("background-color","#fff");
                                        $("#comentarios").css("background-color","#fff");
                                        $("#tipo_ticket").css("background-color","#fff");
                                        $("#id_ticket").css("background-color","#fff");
                                        $("#id_usuario").val('');
                                        $("#nombre_maquina").val('');
                                        $("#no_serie").val('');
                                        $("#folio").val('');
                                        $("#comentarios").val('');
                                        $("#tipo_ticket").val(0);
                                        $("#id_ticket").val('');
                                        $("#imagenC").val('');
                                        $("#smallImage").attr("src","img/blank.png");
                                        $("#photoIcon").attr("src","img/camera.svg");
                                        var item = results.rows.item(0);
                                        $("#tabla_registros").append("<tr id='fila"+
                                            item.id_tickets +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaSURO2("+
                                            item.id_tickets +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td><img src='"+
                                            item.foto_ticket+"' width='60px' style='margin-top: 4px;'/></td><td>"+
                                            item.id_usuario+"</td><td style='text-align: center;'>" +unescape(item.nombre_maquina) + "</td><td style='text-align: center;'>" +
                                            unescape(item.no_serie) + "</td><td style='text-align: center;'>" + item.folio + "</td><td style='text-align: center;'>" +
                                            item.comentarios + "</td><td style='text-align: center;'>" + item.tipo_ticket + "</td><td style='text-align: center;'>" +
                                            item.id_ticket + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>"
                                        );
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function (tx, error) {
                        console.error("Error al registrar: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function guardarconsumibleSURO2(){
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_maquina = $("#nombre_maquina").val();
        var modelo_maquina = $("#modelo_maquina").val();
        var consumible = $("#consumible").val();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Insert into consumibles(id_cedula,nombre_maquina,modelo_maquina,consumible) values(?,?,?,?)",
                    [id_cedula,nombre_maquina,modelo_maquina,consumible],
                    function (tx, results) {
                        swal("", "Se guardaron los datos correctamente", "success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from consumibles where id_cedula = ? ORDER BY id_consumible DESC",
                                [id_cedula],
                                    function(tx, results){
                                        $("#message-nr").css("display","none");
                                        $("#nombre_maquina").css("background-color","#fff");
                                        $("#modelo_maquina").css("background-color","#fff");
                                        $("#consumible").css("background-color","#fff");
                                        $("#nombre_maquina").val('');
                                        $("#modelo_maquina").val('');
                                        $("#consumible").val('');
                                        var item = results.rows.item(0);
                                        $("#tabla_registros").append("<tr id='fila"+
                                            item.id_consumible +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaSURO2("+
                                            item.id_consumible +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td>"+
                                            item.nombre_maquina+"</td><td style='text-align: center;'>" +unescape(item.modelo_maquina) + "</td><td style='text-align: center;'>" +
                                            unescape(item.consumible) + "</td></tr>"
                                        );
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function (tx, error) {
                        console.error("Error al registrar: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function continuarCedSURO2(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        if(tipo == 1){
            localStorage.setItem("Opcion", '1');
            app.views.main.router.navigate({ name: 'recorridoSUROE1'});
        }else if(tipo == 2){
            localStorage.setItem("Opcion", '1');
            app.views.main.router.navigate({ name: 'recorridoSUROE2'});
        }else if(tipo == 3){
            localStorage.setItem("Opcion", '1');
            app.views.main.router.navigate({ name: 'recorridoSUROE3'});
        }
    }
    function regresarMaquinariaSuro2(){
        app.views.main.router.back('/recorridoSUROE1/', {force: true, ignoreCache: true, reload: true});
    }
    function eliminarFilaSURO2(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM maquinarias WHERE id_maquina = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM consumibles WHERE id_consumible = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM ticket WHERE id_tickets = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM corecciones WHERE id_coreccion = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(opc == 8) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM listado_material WHERE id_entrada = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    //Fin SURO2
    //INCIO SALES SURO
    function buscarClienteSales_suro() {
        console.log('ENTRO')
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario =
        localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var id_cliente = $("#id_cliente").val();
        var nombre_cliente = $("#nombre_cliente").val();
        var nombre_comercial = $("#NombreComercial").val();
        var nombre_contacto = $("#NombreContacto").val();
        var telefono = $("#Telefono").val();
        var correo = $("#Correo").val();
        var estatus_cliente = 'Estatus';
        var estatus = 0;
        var datos_v = new Array();
        // if (foto_llegada!=''){

            // if (nombre_cliente!=''){
            productHandler.addCedulaSalesSuro(id_usuario, nombre_usuario, fecha_llegada, geolocation, id_cliente, nombre_cliente, horario_programado, estatus);
            databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                "Select MAX(id_cedula) as Id from cedulas_general",
                [],
                function (tx, results) {
                    var item = results.rows.item(0);
                    datos_v[0] = {'id_usario':id_usuario ,'nombre_usuario':nombre_usuario ,'id_cliente':id_cliente,'nombre_cliente':nombre_cliente,'fecha_envio':fecha_llegada};
                    console.log('datos_v',datos_v)
                    localStorage.setItem("IdCedula", item.Id);
                    localStorage.setItem("foto_llegada", foto_llegada);
                    localStorage.setItem("id_cliente", id_cliente);
                    localStorage.setItem("nombre_cliente", nombre_cliente);
                    localStorage.setItem("nombre_comercial", nombre_comercial);
                    localStorage.setItem("nombre_contacto", nombre_contacto);
                    localStorage.setItem("telefono", telefono);
                    localStorage.setItem("correo", correo);
                    localStorage.setItem("estatus_cliente", estatus_cliente);
                    $.ajax({
                        type: "POST",
                        async : true,
                        url: "http://www.appbennetts.com/FWM2/app/guardarDatosVentasSales_suro_D.php",
                        dataType: 'html',
                        data: {'datos_v': JSON.stringify(datos_v)},
                        success: function(respuesta){
                        // console.log("Respuesta",respuesta)
                        },
                        error: function(){
                            console.log("Error en la comunicacion con el servidor");
                        }
                    });

                    generarTablaVentasSales_suro();
                    app.preloader.hide();
                },
                function (tx, error) {
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
                );
            },
            function (error) {},
            function () {}
            );
            // }else{
            //     swal("", "Favor de seleccionar un Cliente" , "warning");
            //     app.preloader.hide();
            // }
        // }else{
        //     swal("", "La foto es requerida para continuar" , "warning");
        //     app.preloader.hide();
        // }
    }
    function generarTablaVentasSales_suro(){
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_proyecto = 0;
        let nivel = 0;
        let id_cedula = localStorage.getItem("IdCedula");
        productHandler.addSUROSALESVentas(id_cedula, foto_llegada,id_proyecto,nivel);
    }
    function generarVentasSales_suro(tipo){
        //console.log('generarVentaas');
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        localStorage.setItem("IdProyecto",0);
        if (tipo==1){
            var tipoCedula = "VentasVIC_SinV";
        }else if (tipo==2){
            var tipoCedula = "VentasVIC_ConV";
        }else if (tipo==3){
            var tipoCedula = "VentasVIC_Acompa";
        }
        let id_proyecto = 0;
        let nivel = 0;
        var id_usuario = localStorage.getItem("id_usuario");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        if (tipoCedula == "VentasVIC_SinV"){
                            app.views.main.router.navigate({name: 'datosgeneralesSales_suro'});
                        }else if (tipoCedula == "VentasVIC_ConV"){
                            app.views.main.router.navigate({name: 'recorridoSales_suro1'});
                        }else if (tipoCedula == "VentasVIC_Acompa"){
                            app.views.main.router.navigate({name: 'recorridoSales_suro2'});
                        }

                },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarProyectoSales_suro(op){
        //console.log('Guarda proyecto');
        var id_cedula = localStorage.getItem("IdCedula");
        // var metodo=$('#metodo').val();
        var grupo=$('#grupo').val();
        var nombre_proyecto=$('#nombre_proyecto').val();
        var potencial=$('#potencial').val();
        var segmento=$('#segmento').val();
        var estrategia=$('#estrategia').val();
        var division=1;
        var estatus=0;
        var enviado=0;
        var id_usuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_creacion = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate();
        var estatusEn = 1;

        if (nombre_proyecto!=''){
            if (potencial!=''){
                if(segmento!='0'){
                //console.log(nombre_proyecto +", "+potencial + ", " +segmento);
                //console.log(id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado);
                var nivel = 0;
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Insert into proyectos_vic_SS (id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,nivel,id_cedula,grupo) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)",
                            [id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,nivel,id_cedula,grupo],
                            function(tx, results){
                               // console.log("guardado",id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, estatus, enviado,estrategia,metodo,grupo,nivel);
                                var id_proyecto = results.insertId;
                                $('#nombre_proyecto').val('');
                                $('#potencial').val('');
                                $('#segmentos').val('0');
                                $('#Estrategias').val('0');
                                $('#grupo').val('');
                                // $('#metodo').val('');
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from proyectos_vic_SS where id_usuario = ? ORDER BY id_proyecto DESC",
                                        [id_usuario],
                                            function(tx, results){
                                                var length = results.rows.length;
                                                var item = results.rows.item(0);

                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("UPDATE ventas_bennetts_SS SET id_proyecto = ?, nivel = ? WHERE id_cedula = ?",
                                                                [id_proyecto,nivel,id_cedula],
                                                                function(tx, results){
                                                                    if(op==2){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("UPDATE cedulas_general SET estatus = ?, fecha_salida = ?, id_cliente = ?,nombre_cliente = ? WHERE id_cedula = ?",
                                                                            [estatusEn,fecha_creacion,id_proyecto,nombre_proyecto,id_cedula],
                                                                                function(tx, results){
                                                                                    swal("","El proyecto se guardo correctamente", "success");
                                                                                    window.location.href = "./menu.html";
                                                                                },
                                                                                function(tx, error){
                                                                                    swal("Error al guardar",error.message,"error");
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                }else{
                                                                    console.log('ID-> ',id_proyecto)
                                                                    console.log('item.nombre_proyecto',nombre_proyecto)
                                                                    localStorage.setItem("IdProyecto", id_proyecto);
                                                                    databaseHandler.db.transaction(
                                                                        function (tx) {
                                                                          tx.executeSql(
                                                                            "UPDATE cedulas_general SET id_cliente = ?, nombre_cliente = ? WHERE id_cedula = ?",
                                                                            [id_proyecto,nombre_proyecto,id_cedula],
                                                                            function (tx, results) {
                                                                                databaseHandler.db.transaction(
                                                                                    function (tx) {
                                                                                      tx.executeSql(
                                                                                        "UPDATE ventas_bennetts_SS SET id_proyecto = ? WHERE id_cedula = ?",
                                                                                        [id_proyecto, id_cedula],
                                                                                        function (tx, results) {
                                                                                            console.log('Act');
                                                                                        },
                                                                                        function (tx, error) {
                                                                                          console.error("Error al guardar cierre: " + error.message);
                                                                                        }
                                                                                      );
                                                                                    },
                                                                                    function (error) {},
                                                                                    function () {}
                                                                                );
                                                                            },
                                                                            function (tx, error) {
                                                                              console.error("Error al guardar cierre: " + error.message);
                                                                            }
                                                                          );
                                                                        },
                                                                        function (error) {},
                                                                        function () {}
                                                                    );
                                                                    $("#proyectos").append("<option value="+id_proyecto+">"+item.nombre_proyecto+"</option>");
                                                                    $('#proyectos').val(id_proyecto);
                                                                    app.smartSelect.get('.smart-select').setTextValue();
                                                                    app.sheet.close('.my-sheet');
                                                                    swal("","El proyecto se guardo correctamente", "success");
                                                                }
                                                                },
                                                                function(tx, error){
                                                                    console.error("Error al actualizar: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );





                                            },
                                            function(tx, error){
                                                console.log("Error al guardar: " + error.message);
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
                }else {
                    app.dialog.alert('El segmento es requerido.', 'Aviso');
                }
            }else{
                app.dialog.alert('El potencial es requerido.', 'Aviso');
            }
        }else{
            app.dialog.alert('El nombre es requerido.', 'Aviso');
        }
    }
    function visitaP3Sales_suro(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from ventas_bennetts_SS WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var avanza1=item.id_proyecto;
                            if(avanza1 != 0){
                                app.views.main.router.navigate({name: 'datosProyectoSales_suro'});
                                }else{
                                    swal("", "Favor de primero llenar los datos generales" , "warning");
                            }
                    },
                    function(tx, error){
                        console.log('Error:'+ error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarActividadComercialSales_suro(){
        let id_cedula = localStorage.getItem("IdCedula");
        let proyecto = localStorage.getItem("IdProyecto");
        var foto_visita=$('#imagenC').val();
        var nivel=$('#niveles').val();
        var act=$('#actividadSe').val();
        var pendiente_vendedor=$('#pendiente_vendor').val();
        if($('#V1').is(':checked') || $('#V2').is(':checked')|| $('#V3').is(':checked')){
            if($('#V1').is(':checked')){
                var tipo_visita=$('#V1').val();
            }else if ($('#V2').is(':checked')){
                var tipo_visita=$('#V2').val();
            }else if ($('#V3').is(':checked')){
                var tipo_visita=$('#V3').val();
            }
            console.log('->',tipo_visita);
            if(tipo_visita == 'Llamada telefonica'){
                if(pendiente_vendedor && nivel && act ){
                    console.log(tipo_visita, nivel, pendiente_vendedor,act,id_cedula,proyecto);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE ventas_bennetts_SS SET tipo_visita = ?, foto_visita = ?, nivel = ?, pendiente_vendedor= ?,actividadSelect = ?  WHERE  id_cedula = ?",
                            [tipo_visita,foto_visita,nivel,pendiente_vendedor,act,id_cedula],
                                function(tx, results){
                                console.log("results",results);
                                swal("","Se guardaron los datos correctamente", "success");
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                }else{
                    swal("", "Todos los campos son requeridos para continuar", "warning");
                }
            }else{
                if(foto_visita){
                    if(pendiente_vendedor && nivel && act ){
                        console.log(tipo_visita, nivel, pendiente_vendedor,act,id_cedula,proyecto);
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE ventas_bennetts_SS SET tipo_visita = ?, foto_visita = ?, nivel = ?, pendiente_vendedor= ?,actividadSelect = ?  WHERE  id_cedula = ?",
                                [tipo_visita,foto_visita,nivel,pendiente_vendedor,act,id_cedula],
                                    function(tx, results){
                                    console.log("results",results);
                                    swal("","Se guardaron los datos correctamente", "success");
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Todos los campos son requeridos para continuar", "warning");
                    }
            }else{
                swal("", "La foto es requerida", "warning");
            }
            }

        }else{
            swal("", "Favor de seleccionar el tipo de visita", "warning");
        }

    }
    function visitaP1Sales_suro(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from ventas_bennetts_SS WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var avanza=item.nivel;
                            if(avanza >=  0){
                                app.views.main.router.navigate({name: 'visitaProyectoSales_suro'});
                                }else{
                                    swal("", "Favor de llenar los datos en actividad comercial" , "warning");
                            }
                    },
                    function(tx, error){
                        console.log('Error:'+ error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarVentasSales_suro(){
        let id_cedula = localStorage.getItem("IdCedula");
        var tema=$('#tema').val();
        var compromiso=$('#compromiso').val();
        var fecha_compromiso=$('#fecha').val();
        var h_inicio=$('#hora_inicio').val();
        var h_fin=$('#hora_fin').val();
        var fecha = new Date();
        var fecha_tomada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        //console.log("patiende: "+Patiende+"- Ppuesto: "+Ppuesto+"- Ptelefono: "+Ptelefono+"- Pcorreo:"+Pcorreo+" actividades:"+actividades+" - tema:"+tema+"- compromiso: "+compromiso+"- fecha:"+fecha);
        if (tema && compromiso && fecha_compromiso && h_inicio && h_fin){
                app.preloader.show('blue');
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO minuta_SS(id_cedula,tema,compromiso,fecha,fecha_foto,h_inicio,h_fin) VALUES (?,?,?,?,?,?,?)",
                            [id_cedula,tema,compromiso,fecha_compromiso,fecha_tomada,h_inicio,h_fin],
                            function(tx, results){
                                //console.log("Datos Guardados");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#tema').val('');
                                $('#tema').css("background-color","#ffffff");
                                $('#compromiso').val('');
                                $('#compromiso').css("background-color","#ffffff");
                                $('#fecha').val('');
                                $('#fecha').css("background-color","#ffffff");
                                $('#hora_inicio').val('');
                                $('#hora_inicio').css("background-color","#ffffff");
                                $('#hora_fin').val('');
                                $('#hora_fin').css("background-color","#ffffff");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from minuta_SS where id_cedula = ? ORDER BY id_minuta DESC",
                                        [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#VentasBennetts_content").append("<tr id='fila"+ item.id_minuta +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_minuta +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtema' style='text-align: center;'>" + item.tema + "</td><td id='tdcompromiso' style='text-align: center;'>" + item.compromiso + "</td><td id='tdfecha' style='text-align: center;'>" + item.fecha + "</td><td id='tdfecha' style='text-align: center;'>" + item.h_inicio + "</td><td id='tdfecha' style='text-align: center;'>" + item.h_fin + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al Mostrar los datos: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                        },
                            function(tx, error){
                                console.error("Error al guardar: " + error.message);
                                swal("","Ha ocurrido un error al guardar", "error");
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        }else{
            swal("", "Todos los campos son obligatorios", "warning");
        }
    }
    function visitaP2Sales_suro(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from ventas_bennetts_SS WHERE id_cedula = ?",
                    [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var avanza1=item.id_proyecto;
                            if(avanza1 != 0){
                                app.views.main.router.navigate({name: 'cierreSales_suro'});
                                }else{
                                    swal("", "Favor de primero llenar los datos generales" , "warning");
                            }
                    },
                    function(tx, error){
                        console.log('Error:'+ error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

    function guardarCierredeVentasSales_suro(){
        console.log("Cierre ventas");
        if ($("#NombreFirma").val() == ""){
            swal("", "Todos los campos son obligatorios", "warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var correo_apoyo = $('#correo_cliente').val();
        console.log(nombrefirma)
        console.log(correo_apoyo)
        databaseHandler.db.transaction(
            function (tx) {
            tx.executeSql("UPDATE ventas_bennetts_SS SET correo_apoyo = ? WHERE id_cedula = ?",
                [correo_apoyo, id_cedula],
                function (tx, results) {
                    console.log(results)
                databaseHandler.db.transaction(
                    function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                        [nombrefirma, id_cedula],
                        function (tx, results) {
                            console.log(results)
                        swal("", "Guardado correctamente", "success");
                        //console.log(calificacion, nombrefirma, comentarioCliente, id_cedula);
                        app.views.main.router.back("/yamevoySales_suro/", {
                            force: true,
                            ignoreCache: true,
                            reload: true,
                        });
                        },
                        function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                        }
                    );
                    },
                    function (error) {},
                    function () {}
                );
                },
                function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
                }
            );
            },
            function (error) {},
            function () {}
        );
    }
    function terminarVentasSales_suro(){
        //console.log("terminar ventas");
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventas_bennetts_SS SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function ProyectoSales_suro(value){
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_proyecto = $("#proyectos option:selected").text();
        if (value == 0){
            $('#Patiende').val('');
            $('#Ppuesto').val('');
            $('#Ptelefono').val('');
            $('#Pcorreo').val('');
            window.localStorage.removeItem("IdProyecto");
                var nombre_cliente = 'PROYECTO SALES';
                var nivel = 0;
                var puesto_cliente = '';
                var telefono = '';
                var correo = '';
                databaseHandler.db.transaction(
                    function (tx) {
                    tx.executeSql(
                        "UPDATE cedulas_general SET id_cliente = ?, nombre_cliente = ? WHERE id_cedula = ?",
                        [value,nombre_proyecto,id_cedula],
                        function (tx, results) {
                            databaseHandler.db.transaction(
                                function (tx) {
                                tx.executeSql(
                                    "UPDATE ventas_bennetts_SS SET id_proyecto = ?, nivel = ?, nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo = ? WHERE id_cedula = ?",
                                    [value,nivel,nombre_cliente,puesto_cliente, telefono, correo, id_cedula],
                                    function (tx, results) {},
                                    function (tx, error) {
                                    console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                                },
                                function (error) {},
                                function () {}
                            );
                        },
                        function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                        }
                    );
                    },
                    function (error) {},
                    function () {}
                );
        }else{
            $('#Patiende').val('');
            $('#Ppuesto').val('');
            $('#Ptelefono').val('');
            $('#Pcorreo').val('');
            localStorage.setItem("IdProyecto", value);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from proyectos_vic_SS WHERE id_proyecto = ?",
                            [value],
                                function(tx, results){
                                    let length = results.rows.length;
                                    for(var x = 0; x < length; x++) {
                                    var item = results.rows.item(x);
                                        if(item.nombre_cliente) {
                                            $('#Patiende').val(item.nombre_cliente);
                                            $('#Ppuesto').val(item.puesto_cliente);
                                            $('#Ptelefono').val(item.telefono);
                                            $('#Pcorreo').val(item.correo);
                                            $('#Patiende').css(item.nombre_cliente);

                                        }
                                    var nivel = item.nivel;
                                    var nombre_cliente = item.nombre_cliente;
                                    var puesto_cliente = item.puesto_cliente;
                                    var telefono = item.telefono;
                                    var correo = item.correo;
                                    databaseHandler.db.transaction(
                                        function (tx) {
                                        tx.executeSql(
                                            "UPDATE cedulas_general SET id_cliente = ?, nombre_cliente = ? WHERE id_cedula = ?",
                                            [value,nombre_proyecto,id_cedula],
                                            function (tx, results) {
                                                databaseHandler.db.transaction(
                                                    function (tx) {
                                                    tx.executeSql(
                                                        "UPDATE ventas_bennetts_SS SET id_proyecto = ?, nivel = ?, nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo = ? WHERE id_cedula = ?",
                                                        [value,nivel,nombre_cliente,puesto_cliente, telefono, correo, id_cedula],
                                                        function (tx, results) {},
                                                        function (tx, error) {
                                                        console.error("Error al guardar cierre: " + error.message);
                                                        }
                                                    );
                                                    },
                                                    function (error) {},
                                                    function () {}
                                                );
                                            },
                                            function (tx, error) {
                                            console.error("Error al guardar cierre: " + error.message);
                                            }
                                        );
                                        },
                                        function (error) {},
                                        function () {}
                                    );
                                    }
                                    app.smartSelect.close('.smart-select');
                                },
                                    function(tx, error){
                                        console.log("Error: " + error.message);
                                        app.preloader.hide();
                                    }
                    );
                },
                    function(error){},
                    function(){}
            );
        }
    }
    function guardarDatosGVentasSales_suro(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende').val();
        var Ppuesto=$('#Ppuesto').val();
        var Ptelefono=$('#Ptelefono').val();
        var Pcorreo=$('#Pcorreo').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
                    console.log(id_proyecto);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql(
                                "Select * from proyectos_vic_SS WHERE id_proyecto = ?",
                                [id_proyecto],
                                function(tx, results){
                                    let length = results.rows.length;
                                    var item = results.rows.item(0);
                                    var actual_nivel = item.nivel;
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE ventas_bennetts_SS SET id_proyecto = ?,nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo= ?, nivel = ? WHERE id_cedula = ?",
                                            [id_proyecto,Patiende,Ppuesto,Ptelefono,Pcorreo,actual_nivel,id_cedula],
                                                function(tx, results){
                                                //console.log("actualizados datos de evidencia");
                                                swal("","Se guardaron los datos correctamente", "success");
                                                $('#Patiende').css("background-color","#ffffff");
                                                $('#Ppuesto').css("background-color","#ffffff");
                                                $('#Ptelefono').css("background-color","#ffffff");
                                                $('#Pcorreo').css("background-color","#ffffff");
                                                databaseHandler.db.transaction(
                                                    function(tx){
                                                        tx.executeSql("UPDATE proyectos_vic_SS SET nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo= ?, nivel = ? WHERE id_proyecto = ?",
                                                            [Patiende,Ppuesto,Ptelefono,Pcorreo,actual_nivel,id_proyecto],
                                                            function(tx, results){
                                                            },
                                                            function(tx, error){
                                                                console.error("Error al actualizar: " + error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }
    }
    function guardarDclienteSales_suro (){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende2').val();
        var Ppuesto=$('#Ppuesto2').val();
        var Ptelefono=$('#Ptelefono2').val();
        var Pcorreo=$('#Pcorreo2').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
            //console.log(actividades);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO datos_contacto_SS(id_cedula ,id_proyecto , nombre_cliente , puesto_cliente, telefono, correo) VALUES (?,?,?,?,?,?)",
                                [id_cedula,id_proyecto,Patiende,Ppuesto,Ptelefono,Pcorreo],
                                function(tx, results){
                                //console.log("actualizados datos de evidencia");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Patiende').css("background-color","#ffffff");
                                $('#Ppuesto').css("background-color","#ffffff");
                                $('#Ptelefono').css("background-color","#ffffff");
                                $('#Pcorreo').css("background-color","#ffffff");
                                app.sheet.close('#sheet-modal');
                                document.getElementById('sheet-modal').style.display = 'none';
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );

            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }
    }
    function guardarDatosApoyoSales_suro(){
        let id_cedula = localStorage.getItem("IdCedula");
        var  proyecto=$('#noPro').val();
        var comentarios=$('#comentarios').val();
        var companero=$('#noCom').val();
        var fecha = new Date();
        var fecha_creacion = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate();
        var estatusEn = 1;
        var fecha = new Date();
        var fecha_tomada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        if(proyecto && comentarios && companero){
            app.preloader.show('blue');
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO apoyo_venta_vic_SS(id_cedula, proyecto , companero , comentario,fecha ) VALUES (?,?,?,?,?)",
                        [id_cedula,proyecto,comentarios,companero,fecha_tomada],
                        function(tx, results){
                            //console.log("Datos Guardados");
                            swal("","Se guardaron los datos correctamente", "success");
                            //$('#nombreCliente').css("background-color","#ffffff");
                            $('#noPro').val('');
                            $('#comentarios').val('');
                            $('#noCom').val('');
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET estatus = ?, fecha_salida = ? WHERE id_cedula = ?",
                                        [estatusEn,fecha_creacion,id_cedula],
                                        function(tx, results){
                                            swal("","El proyecto se guardo correctamente", "success");
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );

                    },
                        function(tx, error){
                            console.error("Error al guardar: " + error.message);
                            swal("","Ha ocurrido un error al guardar", "error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Todos los campos son obligatorios", "warning");
        }
    }
    function sincronizaSales_suro(){
        var IdUsuario = localStorage.getItem("id_usuario");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM cedulas_general WHERE id_usuario = ? AND (estatus = 1 OR estatus = 2 OR estatus = 0) ORDER BY estatus ASC;",
                    [IdUsuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        if(length == 0){
                            RecargarJSON_SALES_Suro();
                        }else{
                            for(var i = 0; i < length; i++){
                                var item = results.rows.item(i);
                                var estatus = item.estatus;
                                var cedula_id = item.id_cedula;
                                    if(estatus == 0){
                                        cedula_sale1_suro(cedula_id,i,(length-1))
                                    }else{
                                    if(localStorage.getItem('sendFlag') == 0){
                                        llevarTodo(item.id_cedula,item.tipo_cedula);
                                    }
                                }
                            }
                        }
                    },
                    function(tx5, error){
                        console.error("Error al consultar bandeja de salida: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function RecargarJSON_SALES_Suro(){
        var IdUsuario = localStorage.getItem("id_usuario");
        var Nom = 'Gestion-SE-SS';
        const namep = [];
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * FROM proyectos_vic_SS_resguardo",
                    [],
                    function(tx, results){
                        var length = results.rows.length;
                    // console.log('TAMA  ',length)
                        if(length == 0){
                            console.log('SIN CONTINUAR CEDULA---');
                        }else{
                            for(var i = 0; i < length; i++){
                                var item = results.rows.item(i);
                                console.log('App',item.nombre_proyecto);
                                namep.push(item.nombre_proyecto);

                            }

                        }
                    },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

        app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
            var content = JSON.parse(data);
            var Proyect = content[3];
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("DELETE FROM proyectos_vic_SS",
                        [],
                        function(tx, results){
                            for(let i = 0; i < Proyect.length ;i++){
                                if(Proyect[i].id_usuario == IdUsuario && Proyect[i].nivel != 6 && Proyect[i].estatus == 1)  {
                                    var flag = 0;
                                    for(let j = 0; j< namep.length ;j++){
                                        if(namep[j]==Proyect[i].nombre_proyecto){
                                            flag =1;
                                        }
                                    }
                                    console.log(Proyect[i].nombre_proyecto)
                                    if(flag==0){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                console.log('nombre_proyecto',Proyect[i].nombre_proyecto );
                                                tx.executeSql("Insert into proyectos_vic_SS(id_proyecto,id_usuario,nombre_proyecto,nombre_cliente,puesto_cliente , telefono , correo,potencial,segmento,division,fecha_creacion,enviado,estrategia,metodo,grupo,nivel) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                                    [Proyect[i].id_proyecto,Proyect[i].id_usuario, Proyect[i].nombre_proyecto,Proyect[i].nombre_cliente,Proyect[i].puesto_cliente,Proyect[i].telefono,Proyect[i].correo, Proyect[i].potencial, Proyect[i].segmento, Proyect[i].division, Proyect[i].fecha_creacion,  Proyect[i].enviado,Proyect[i].estrategia,Proyect[i].metodo,Proyect[i].grupo,Proyect[i].nivel],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM ventas_bennetts_SS",
                                                                [],
                                                                function(tx, results){},
                                                                function(tx, error){
                                                                console.error("Error: " + error.message);
                                                                }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );

                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }

                                }

                            }
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * FROM ventas_bennetts_SS_resguardo",
                                        [],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            console.log('TAMA  - resguardo ventas ',length)
                                            if(length == 0){
                                                //SIN CONTINUAR CEDULA
                                                console.log('SIN CONTINUAR CEDULA');
                                            }else{
                                                for(var i = 0; i < length; i++){
                                                    var item = results.rows.item(i);
                                                    var cedula = item.id_cedula;
                                                    var proyecto_id = item.id_proyecto;
                                                    console.log('ENTRO')
                                                    RegresarResguardo_SURO(proyecto_id,item.nivel,item.nombre_cliente,item.puesto_cliente,item.telefono,item.correo,cedula,item.actividadSelect,item.tipo_visita,item.foto_visita,item.pendiente_vendedor);
                                                }

                                            }
                                        },
                                        function(tx, error){
                                            console.error("Error al actualizar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );

                    },
                        function(tx, error){
                            console.error("Error: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        });
    }
    function RegresarResguardo_SURO(proyecto_id,nivel,nombre_cliente,puesto_cliente,telefono,correo,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor){
        console.log('ENTRO a LA FUNCION CON',proyecto_id)
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT MAX(id_proyecto) as id2,MAX(id_proyecto)+1 as id FROM proyectos_vic_SS",
                    [],
                    function(tx, results){
                        var item3 = results.rows.item(0);
                        var id_proyecto2 = item3.id2;
                        var id_proyecto = item3.id;
                        console.log('id_proyecto_entad',id_proyecto2)
                        console.log('id_proyecto_con suma',id_proyecto)
                        resguardo_sales_1_SURO(proyecto_id,id_proyecto,nivel,nombre_cliente,puesto_cliente,telefono,correo,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor);
                        },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function resguardo_sales_1_SURO(proyecto_id,id_proyecto,nivel,nombre_cliente,puesto_cliente,telefono,correo,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * FROM proyectos_vic_SS_resguardo where id_proyecto = ?",
                    [proyecto_id],
                    function(tx, results){
                        var item2 = results.rows.item(0);
                        console.log(item2);
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Insert into proyectos_vic_SS(id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, enviado,estrategia,metodo,grupo,nivel,nombre_cliente,puesto_cliente,telefono,correo) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                [item2.id_usuario, item2.nombre_proyecto, item2.potencial, item2.segmento, item2.division, item2.fecha_creacion,  item2.enviado,item2.estrategia,item2.metodo,item2.grupo,item2.nivel,nombre_cliente,puesto_cliente,telefono,correo],
                                function(tx, results){
                                        var id_PPP = results.insertId;
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                            tx.executeSql(
                                                "UPDATE cedulas_general SET id_cliente = ?, nombre_cliente = ? WHERE id_cedula = ?",
                                                [id_PPP,item2.nombre_proyecto,cedula],
                                                function (tx, results) {},
                                                function (tx, error) {
                                                console.error("Error al guardar cierre: " + error.message);
                                                }
                                            );
                                            },
                                            function (error) {},
                                            function () {}
                                        );
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Insert into ventas_bennetts_SS(nivel,nombre_cliente , puesto_cliente , telefono , correo, id_proyecto,id_cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor)  VALUES (?,?,?,?,?,?,?,?,?,?,?)",
                                                [nivel,nombre_cliente,puesto_cliente,telefono,correo,id_PPP,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM ventas_bennetts_SS_resguardo where id_cedula = ?",
                                                                [cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM proyectos_vic_SS_resguardo where id_proyecto = ?",
                                                                                [proyecto_id],
                                                                                function(tx, results){
                                                                                },
                                                                                function(tx, error){
                                                                                    console.error("Error al actualizar: " + error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                console.error("Error: " + error.message);
                                                                }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );

                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );

                    },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function cedula_sale1_suro(cedula_id,i,length2){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * FROM ventas_bennetts_SS WHERE id_cedula = ?",
                [cedula_id],
                function(tx, results){
                    var length = results.rows.length;
                    var item2 = results.rows.item(0);
                    var id_proyecto = item2.id_proyecto;
                    if(id_proyecto == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general where id_cedula = ?",
                                    [cedula_id],
                                    function(tx, results){
                                        console.log('Se elimino')
                                        databaseHandler.db.transaction(
                                            function(tx4){
                                            let id_usuario = localStorage.getItem("id_usuario");
                                            let estatus = 0;
                                            tx4.executeSql("SELECT COUNT(id_cedula) as total FROM cedulas_general WHERE id_usuario = ? AND estatus = ? AND (tipo_cedula = 'levantamiento' OR tipo_cedula = 'fumigacion' OR tipo_cedula = 'sanitizacion' OR tipo_cedula = 'mantenimiento' OR tipo_cedula = 'reporteTecnico' OR tipo_cedula = 'minutaCoordinador' OR tipo_cedula = 'baja' OR tipo_cedula = 'sanitizacionSURO' OR tipo_cedula = 'ventaSMC' OR tipo_cedula = 'servicioSMC' OR tipo_cedula = 'checklistServ' OR tipo_cedula = 'reporteGeneral' OR tipo_cedula = 'AuditoriaTecnico' OR tipo_cedula = 'AuditoriaSupervisorTecnico' OR tipo_cedula = 'AuditoriaLider' OR tipo_cedula = 'reporteFotografico' OR tipo_cedula = 'conteo' OR tipo_cedula = 'Plato Limpio' OR tipo_cedula = 'Visita' OR tipo_cedula = 'Entrega' OR tipo_cedula = 'Venta' OR tipo_cedula = 'ApoyoVIC' OR tipo_cedula = 'VentasVIC' OR tipo_cedula = 'VIC' OR tipo_cedula = 'Caliente' OR tipo_cedula = 'visitaDilimpio' OR tipo_cedula = 'Entregas' OR tipo_cedula = 'Rational' OR tipo_cedula = 'recorridoSURO' OR tipo_cedula = 'visitaSURO' OR tipo_cedula = 'encuestaSURO' OR tipo_cedula = 'visitaBSURO' OR tipo_cedula = 'seguimientoSURO' OR tipo_cedula = 'Reposicion' OR tipo_cedula = 'Preventivo' OR tipo_cedula = 'Correctivo' OR tipo_cedula = 'Instalacion'   OR tipo_cedula = 'VentasVIC_ConV'  OR tipo_cedula = 'Bitacora' OR tipo_cedula = 'Trampa' OR tipo_cedula = 'Extraccion' OR tipo_cedula = 'Mantenimiento' OR tipo_cedula = 'Desasolve' OR tipo_cedula = 'logistica' OR tipo_cedula = 'servicio_tecnico' OR tipo_cedula = 'Cobranza' OR tipo_cedula = 'Checklist' OR tipo_cedula = 'Maquinaria' OR tipo_cedula = 'Materiales' OR tipo_cedula = 'Sitio')",
                                                [id_usuario,estatus],
                                                function(tx4, results){
                                                var item = results.rows.item(0);
                                                $('#contce').html(item.total);
                                                },
                                                function(tx4, error){
                                                console.error("Error al guardar registro: " + error.message);
                                                }
                                            );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                        if(i == length2)  {
                                                RecargarJSON_SALES_Suro();
                                        }
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        var id_pro = id_proyecto;
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("SELECT * FROM proyectos_vic_SS WHERE id_proyecto = ?",
                                [id_pro],
                                function(tx, results){
                                    console.log(results);
                                    var item3 = results.rows.item(0);
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Insert into ventas_bennetts_SS_resguardo (nivel,nombre_cliente , puesto_cliente , telefono , correo, id_proyecto,id_cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor)  VALUES (?,?,?,?,?,?,?,?,?,?,?)",
                                                [item2.nivel,item2.nombre_cliente,item2.puesto_cliente,item2.telefono,item2.correo,item2.id_proyecto,cedula_id,item2.actividadSelect,item2.tipo_visita,item2.foto_visita,item2.pendiente_vendedor],
                                                function(tx, results){
                                                    console.log('Insert ventas')
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("Insert into proyectos_vic_SS_resguardo(id_proyecto,id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, enviado,estrategia,metodo,grupo,nivel) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)",
                                                                [item3.id_proyecto,item3.id_usuario, item3.nombre_proyecto, item3.potencial, item3.segmento, item3.division, item3.fecha_creacion,  item3.enviado,item3.estrategia,item3.metodo,item3.grupo,item3.nivel],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM ventas_bennetts_SS where id_cedula = ?",
                                                                            [cedula_id],
                                                                            function(tx, results){
                                                                                console.log('deleete ventas')
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("DELETE FROM proyectos_vic_SS where id_proyecto = ?",
                                                                                            [id_pro],
                                                                                            function(tx, results){
                                                                                                if(i == length2)  {
                                                                                                    RecargarJSON_SALES_Suro();
                                                                                                }
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.error("Error al actualizar: " + error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                            console.error("Error: " + error.message);
                                                                            }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );

                                                                },
                                                                function(tx, error){
                                                                    swal("Error al guardar",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){console.error("Error al actualizar: " + error.message);},
                                                        function(error){console.error("Error al actualizar: " + error.message);}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){ console.error("Error: " + error.message);},
                                        function(error){console.error("Error al actualizar: " + error.message);}
                                    );
                                },
                                function(tx, error){
                                console.error("Error: " + error.message);
                                }
                                );
                            },
                            function(error){ console.error("Error: " + error.message);},
                            function(){}
                        );
                    }

                    },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function continuarCedSales_suro(id_cedula,tipo,id_proyecto){
        localStorage.setItem("IdCedula",id_cedula);
        if(tipo == 4){
            localStorage.setItem("Opcion", '4');
            app.views.main.router.navigate({name: 'datosgeneralesSales_suro'});
        }else if(tipo == 5){
            localStorage.setItem("Opcion", '5');
            localStorage.setItem("IdProyecto",id_proyecto);
            app.views.main.router.navigate({ name: 'recorridoSales_suro1'});
        }else if(tipo == 6){
            localStorage.setItem("Opcion", '6');
            app.views.main.router.navigate({name: 'recorridoSales_suro2'});
        }
    }
    function regresarRecorridoSales_suro1(opcion){
        if(opcion){
            var IdProyecto = localStorage.getItem('IdProyecto');
            if(IdProyecto == 0){
                swal({
                    title: "Aviso",
                    text: "Aún no tienes proyecto seleccionado, ¿Estás seguro que deseas regresar?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: false,
                }).then((willGoBack) => {
                    if (willGoBack){
                        app.views.main.router.back('/recorridoSales_suro1/', {force: true, ignoreCache: true, reload: true});
                    }
                });
            }else{
                var id_cedula = localStorage.getItem("IdCedula");
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql(
                            "Select * from ventas_bennetts_SS where id_cedula= ?",
                                [id_cedula],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        if(item.id_proyecto == 0){
                                            swal({
                                                title: "Aviso",
                                                text: "Aún no haz guardado los datos, ¿Estás seguro que deseas regresar?",
                                                icon: "warning",
                                                buttons: true,
                                                dangerMode: false,
                                            }).then((willGoBack) => {
                                                if (willGoBack){
                                                    app.views.main.router.back('/recorridoSales_suro1/', {force: true, ignoreCache: true, reload: true});
                                                }
                                            });
                                        }else{
                                            app.views.main.router.back('/recorridoSales_suro1/', {force: true, ignoreCache: true, reload: true});
                                        }
                                    },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                        );
                    },
                        function(error){},
                        function(){}
                );
            }
        }else{
            app.views.main.router.back('/recorridoSales_suro1/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function regresarRecorridoSales_suro2(){
        app.views.main.router.back('/menuSales_suro/', {force: true, ignoreCache: true, reload: true});
    }
    // FIN SALES SURO



//Inicio Devlyn
function buscarClientedevlyn(){
    var id_usuario = localStorage.getItem("id_usuario");
    var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
    var fecha = new Date();
    var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geolocation = $("#geolocation").val();
    var id_cliente = "N/A";
    var horario_programado = fecha_llegada;
    var foto_llegada = $("#imagenC").val();
    var nombre_cliente = $("#autocomplete-dropdown-ajax").val();
    var estatus = 0;
    if(foto_llegada != ''){
       if(nombre_cliente != ''){
            productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                        [],
                        function(tx, results){
                            var item = results.rows.item(0);
                            localStorage.setItem("IdCedula", item.Id);
                            localStorage.setItem("nombreCliente", nombre_cliente);
                            localStorage.setItem("foto_llegada", foto_llegada);

                            app.views.main.router.navigate({name: 'recorridoDevlyn'});
                            app.preloader.hide();
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        } else {
            swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    } else {
        swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
        app.preloader.hide();
    }
}
function guardarObservacionesDevlyn(){
    app.preloader.show('blue');
    if($("#tema").val() == "" || $('#imagenC').val() == ""){
        swal("","El tema y la fotografia son obligatorios","warning");
        app.preloader.hide();
        return false;
    }
    var id_cedula = localStorage.getItem("IdCedula");
    var tema = $("#tema").val();
    var observacion = $("#observacion").val();
    var foto = $('#imagenC').val();
    var fecha = new Date();
    var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    databaseHandler.db.transaction(
        function(tx){
            tx.executeSql("INSERT INTO evidenciaDevlyn(id_cedula,tema,observacion,foto,fecha_registro) VALUES (?,?,?,?,?)",
                [id_cedula,tema,observacion,foto,fecha_registro],
                function(tx, results){
                    app.preloader.hide();
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_evidencia) as Id from evidenciaDevlyn",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    var id_evidencia = item.Id;
                                    app.preloader.hide();
                                    //Consultar el producto
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from evidenciaDevlyn where id_evidencia = ?",
                                            [id_evidencia],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#smallImage").attr("src","img/blank.png");
                                                    $("#photoIcon").attr("src","img/camera.svg");
                                                    $('#imagenC').val("");
                                                    $("#titulo").val("");
                                                    $("#observacion").val("");
                                                    $("#titulo").css("background-color", "#FFFFFF");
                                                    $("#observacion").css("background-color", "#FFFFFF");
                                                    $("#tabla_evidencias tbody").append("<tr id='fila"+ item.id_evidencia +"'><td class='FWM-table-options'><a href='#' onclick='eliminarFilaDIPREC("+ item.id_evidencia +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' style='margin-top:10%' /></a></td><td><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + unescape(item.tema) + "</td><td style='text-align: center;'>" + unescape(item.observacion) + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                    app.preloader.hide();
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al mostrar Registro guardado",error.message,"error");
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                    swal("","Acuerdo guardado","success");
                    app.preloader.hide();
                },
                function(tx, error){
                    swal("Error al guardar plaga",error.message,"error");
                    app.preloader.hide();
                }
            );
        },
        function(error){},
        function(){}
    );
}
function guardarDGDevlyn(){
app.preloader.show('blue');
if ($("#proveedor").val() == "" || $("#sucursal").val() == "" || $("#rfc").val() == "" || $("#fecha").val() == "") {
        swal("", "Debes llenar todos los campos", "warning");
        app.preloader.hide();
        return false;
    }
        var proveedor = $("#proveedor").val();
        var sucursal = $("#sucursal").val();
        var rfc = $("#rfc").val();
        var fecha = $("#fecha").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE datosDevlyn SET proveedor  = ? , sucursal = ?, rfc = ? , fecha = ? WHERE id_cedula = ?",
                    [proveedor,sucursal,rfc,fecha,id_cedula],
                    function (tx, results) {
                        $("#proveedor").css("background-color", "#FFFFFF");
                        $("#sucursal").css("background-color", "#FFFFFF");
                        $("#rfc").css("background-color", "#FFFFFF");
                        $("#fecha").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente", "success");
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        swal("Error al guardar", error.message, "error");
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function generarDevlyDG() {
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        let foto_llegada = localStorage.getItem("foto_llegada");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        let tipoCedula = "Devlyn";
        let direccion = localStorage.getItem("direccion");
        let correo = localStorage.getItem("correo");
        let sucursal = localStorage.getItem("sucursal");
        let proveedor = localStorage.getItem("proveedor");
        let rfc = localStorage.getItem("rfc");
        let id_proveedor = localStorage.getItem("id_proveedor");
        let proceso = 0;
        let recorrido = 0;
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula, id_cedula],
                    function (tx, results) {
                        databaseHandler.db.transaction(
                            function (tx) {
                                tx.executeSql("select * from datosDevlyn WHERE id_cedula = ?",
                                    [id_cedula],
                                    function (tx, results) {
                                        let length = results.rows.length;
                                        var item = results.rows.item(i);
                                        if (length > 0) {
                                            app.views.main.router.navigate({ name: 'datosgeneralesDevlyn' });
                                        }else{
                                            productHandler.addDV(id_cedula, nombre_cliente,fecha_llegada, foto_llegada,proveedor,rfc,sucursal,id_proveedor);
                                            app.views.main.router.navigate({ name: 'datosgeneralesDevlyn' });
                                        }

                                    },
                                    function (tx, error) {
                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                    }
                                );
                            },
                            function (error) { },
                            function () { }
                        );

                    },
                    function (tx, error) {
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function (error) { },
            function () { }
        );

    }
    function guardarCierreDevlyn(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datosDevlyn SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyDevlyn/', {force: true, ignoreCache: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        console.error("Error al guardar cierre: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarDevlyn(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datosDevlyn SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //Fin Devlyn
    //INICIO VIC
    function guardarFotoVIC(proceso,limite,id_p) {
        app.preloader.show('blue');

        var mesg = '#message-nr' + proceso;
        var smallImage = '#smallImage' + proceso;
        var photoIcon = '#photoIcon' + proceso;
        var tabla2 = '#tabla_fotos' + proceso + ' tbody';
        var id_cedula = localStorage.getItem("IdCedula");
        var FotoVIC= $('#imagenC'+proceso).val();

        var fecha = new Date();
        var fecha_foto = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        $(tabla2).empty("");
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from VIC_Fotos WHERE ID_Cedula = ? and pregunta = ?",
                    [id_cedula,id_p],
                    function (tx, results) {
                        let length = results.rows.length;
                        if (length < limite){
                            if (FotoVIC) {
                                databaseHandler.db.transaction(
                                    function (tx) {
                                        tx.executeSql(
                                            "insert into VIC_Fotos(ID_Cedula, pregunta, FechaHora,Foto,orden) values(?,?,?,?,?)",
                                            [id_cedula,  id_p, fecha_foto, FotoVIC,proceso],
                                            function (tx, results) {
                                                        var id = results.insertId;
                                                        $("#imagenC"+proceso).val();
                                                        $(tabla2).append("<tr id='fila" +id+ "'><td><a href='#' onclick='eliminarFila(" + id+ ",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + FotoVIC + "' width='60px'/></td><td style='text-align: center;'>" + fecha_foto + "</td></tr>");
                                                        $(mesg).hide();
                                                        $(smallImage).attr('src', 'img/blank.png');
                                                        $(photoIcon).attr("src", "img/camera.svg");

                                                        databaseHandler.db.transaction(
                                                            function (tx) {
                                                                tx.executeSql(
                                                                    "Select * from VIC_Fotos WHERE ID_Cedula = ? and pregunta = ?",
                                                                    [id_cedula,id_p],
                                                                    function (tx, results) {
                                                                        if (length > 0) {
                                                                            for (var i = 0; i < length; i++) {
                                                                                var item = results.rows.item(i);
                                                                                $("#imagenC"+proceso).val();
                                                                                $("#Titulo"+proceso).val("");
                                                                                $("#Titulo"+proceso).css("background","#FFFFFFFF");
                                                                                $(tabla2).append("<tr id='fila" + item.ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.ID_Fotos + ",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.FechaHora + "</td></tr>");
                                                                                $(mesg).hide();
                                                                                $(smallImage).attr('src', 'img/blank.png');
                                                                                $(photoIcon).attr("src", "img/camera.svg");
                                                                            }
                                                                        } else {
                                                                           // $(mesg).show();
                                                                        }
                                                                        app.preloader.hide();
                                                                    },
                                                                    function (tx, error) {
                                                                        console.log("Error: " + error.message);
                                                                        app.preloader.hide();


                                                                    }
                                                                );
                                                            },
                                                            function (error) { },
                                                            function () { }
                                                        );



                                            },
                                            function (tx, error) {
                                                console.error("Error al registrar SV_Fotos: " + error.message);
                                            }
                                        );
                                    },
                                    function (error) { },
                                    function () { }
                                );

                                }
                        }else{
                            swal("", "Ya acompleto el numero de fotos permitidas para esta pregunta", "warning");
                            databaseHandler.db.transaction(
                                function (tx) {
                                    tx.executeSql(
                                        "Select * from VIC_Fotos WHERE ID_Cedula = ? and pregunta = ?",
                                        [id_cedula,id_p],
                                        function (tx, results) {
                                            console.log('length',length);
                                            if (length > 0) {
                                                for (var i = 0; i < length; i++) {
                                                    console.log(i)
                                                    console.log(item)
                                                    var item = results.rows.item(i);
                                                    $("#imagenC"+proceso).val();
                                                    $("#Titulo"+proceso).val("");
                                                    $("#Titulo"+proceso).css("background","#FFFFFFFF");
                                                    $(tabla2).append("<tr id='fila" + item.ID_Fotos + "'><td><a href='#' onclick='eliminarFila(" + item.ID_Fotos + ",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a><td><img src='" + item.Foto + "' width='60px'/></td><td style='text-align: center;'>" + item.FechaHora + "</td></tr>");
                                                    $(mesg).hide();
                                                    $(smallImage).attr('src', 'img/blank.png');
                                                    $(photoIcon).attr("src", "img/camera.svg");
                                                }
                                            } else {
                                               // $(mesg).show();
                                            }
                                            app.preloader.hide();
                                        },
                                        function (tx, error) {
                                            console.log("Error: " + error.message);
                                            app.preloader.hide();


                                        }
                                    );
                                },
                                function (error) { },
                                function () { }
                            );
                        }



                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }

    function generarAuditoriaVIC(emp){
        // localStorage.setItem("tipoEmpresa", emp);

    let id_cedula = localStorage.getItem("IdCedula");
    if(emp == 1){
        var nom = "Dominos";
     }else if(emp == 2){
         var nom = "Vips";
     }else if(emp == 3){
         var nom ="Italianis";
     }else if(emp == 4){
        var nom ="Taquearte";
    }
        swal({
         title: "Aviso",
         text: "el tipo de empresa no se podrar modificar, ¿Seguro que deseas continuar con la empresa "+nom+" ?",
         icon: "warning",
         buttons: true,
         dangerMode: false,
     })
     .then((willGoBack) => {
         if (willGoBack){
         databaseHandler.db.transaction(
             function(tx){
                 tx.executeSql("UPDATE datosVIC SET tipo_empresa = ? WHERE id_cedula = ?",
                     [emp,id_cedula],
                         function(tx, results){
                             },
                     function(tx, error){
                         console.log("Error: " + error.message);
                         app.preloader.hide();
                     }
                 );
             },
                 function(error){
                     console.log("Error: " + error.message);
                 },
                 function(){}
         );

         // if (emp == undefined){
         //     swal("", "No Existen auditorías disponibles para este cliente", "warning");
         //     return false;
         // }
         var Nom = 'Preguntas-VIC-1';
         app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
             var content2 = JSON.parse(data);
             var VIC ;
             if(emp == 1){
                 var VIC =content2[0];
             }else if(emp == 2){
                 var VIC =content2[1];
             }else if(emp == 3){
                 var VIC =content2[2];
             }else if(emp == 4){
                var VIC =content2[3];
            }
             databaseHandler.db.transaction(
                 function (tx) {
                     tx.executeSql(
                         "Select * from VIC_Respuesta where id_cedula = ?",
                         [id_cedula],
                         function (tx, results) {
                             let length = results.rows.length;
                             var item = results.rows.item(0);
                             if(length == 0){
                                 for(let i = 0; i < VIC.length ;i++){
                                     var orden = VIC[i].Orden;
                                     var id_pregunta = VIC[i].id_pregunta;
                                     databaseHandler.db.transaction(
                                         function (tx) {
                                             tx.executeSql("insert into VIC_Respuesta(id_cedula, orden ,id_pregunta,obligatorio) values(?,?,?,?)",
                                             [id_cedula, VIC[i].Orden,VIC[i].id_pregunta,VIC[i].OB],
                                                 function (tx, results) {
                                                     // var item = results.rows.item(0);
                                                     // swal("", "Se actualizaron los datos correctamente", "success");
                                                 },
                                                 function (tx, error) {
                                                     console.error("Error al registrar Aud_Tec: " + error.message);
                                                 }
                                             );
                                         });
                                 }
                             }
                             app.preloader.hide();
                         },
                         function (tx, error) {
                             console.log("Error: " + error.message);
                             app.preloader.hide();
                         }
                     );
                 },
                 function (error) { },
                 function () { }
             );
             app.views.main.router.navigate({ name: 'Recorrido1VIC' });
         });
         } else {}
     });
    }

    function RespuestaVIC(res,orden,id_pregunta,factor){
        var id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fechaL = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE VIC_Respuesta SET respuesta = ? ,fecha = ? , factor = ? WHERE id_cedula = ?  and id_pregunta =?  ",
                    [res,fechaL,factor,id_cedula,id_pregunta],
                    function (tx, results) {
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroVIC: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }

    function terminarAuditoriaVIC() {
        id_cedula =localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "Select * from VIC_Respuesta where id_cedula = ?",
                    [id_cedula],
                    function (tx, results) {
                        let length = results.rows.length;
                        var obl = '';
                        for (var i = 0; i < length; i++) {
                            var item = results.rows.item(i);
                            var recom = $("#Re"+item.orden).val();
                            var a = i+1;
                            if(item.obligatorio == 1 && item.respuesta == null){
                                obl += a+',';
                            }
                        }
                        if(obl != ''){
                            var obli = obl.substring(0, obl.length -1)
                            swal("Falta Pregunta", "Debe de contestar las pregunta numero: "+obli,"warning");
                            return false;
                        }else{
                            // for (var i = 0; i < length; i++) {
                            //     var item = results.rows.item(i);
                            //     var recom = $("#RE"+item.orden).val();
                            //     tx.executeSql(
                            //     "UPDATE VIC_Respuesta SET recomendacion = ?  WHERE id_cedula = ? and orden =?",
                            //     [recom,id_cedula,item.orden],
                            //     function (tx, results) {
                            //         app.preloader.hide();
                                    app.views.main.router.navigate({name: 'recorridoVIC3'});

                            //     },
                            //     function (tx, error) {
                            //         console.log("Error al guardar registroVIC: " + error.message);
                            //         app.preloader.hide();
                            //     }
                            // );
                            // }
                        }
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroPL: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }

    function regresarVIC(){
            swal({
                title: "Aviso",
                text: "¿Que acción desea realizar?",
                icon: "warning",
                buttons: {
                  bt1: {
                    text: "Salir a Menu",
                    value: "1",
                  },
                  bt2: {
                    text: "Guardar y Salir",
                    value: "2",
                  },
                  cancel: true
                },
              })
              .then((value) => {
                console.log(value);
                switch (value) {

                  case "1":
                    app.views.main.router.navigate({name: 'recorridoVIC3'});
                    break;

                  case "2":
                    terminarAuditoriaVIC();
                    break;

                  default:

                }
              });
    }
    function buscarClienteVIC() {
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario =
          localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var id_cliente = $("#id_cliente").val();
        var nombre_cliente = $("#nombre_cliente").val();
        var nombre_comercial = $("#NombreComercial").val();
        var nombre_contacto = $("#NombreContacto").val();
        var telefono = $("#Telefono").val();
        var correo = $("#Correo").val();
        var estatus_cliente = 'Estatus';
        var estatus = 0;
        var datos_v = new Array();
        if (foto_llegada!=''){
            if (nombre_cliente!=''){
            productHandler.addCedulaVIC(id_usuario, nombre_usuario, fecha_llegada, geolocation, id_cliente, nombre_cliente, horario_programado, estatus);
            databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                "Select MAX(id_cedula) as Id from cedulas_general",
                [],
                function (tx, results) {
                    var item = results.rows.item(0);
                    datos_v[0] = {'id_usario':id_usuario ,'nombre_usuario':nombre_usuario ,'id_cliente':id_cliente,'nombre_cliente':nombre_cliente,'fecha_envio':fecha_llegada};
                    localStorage.setItem("IdCedula", item.Id);
                    localStorage.setItem("foto_llegada", foto_llegada);
                    localStorage.setItem("id_cliente", id_cliente);
                    localStorage.setItem("nombre_cliente", nombre_cliente);
                    localStorage.setItem("nombre_comercial", nombre_comercial);
                    localStorage.setItem("nombre_contacto", nombre_contacto);
                    localStorage.setItem("telefono", telefono);
                    localStorage.setItem("correo", correo);
                    localStorage.setItem("estatus_cliente", estatus_cliente);
                    $.ajax({
                        type: "POST",
                        async : true,
                        url: "http://www.appbennetts.com/FWM2/app/guardardatosVenta.php",
                        dataType: 'html',
                        data: {'datos_v': JSON.stringify(datos_v)},
                        success: function(respuesta){
                           // console.log("Respuesta",respuesta)
                        },
                        error: function(){
                            console.log("Error en la comunicacion con el servidor");
                        }
                    });

                    app.views.main.router.navigate({ name: "menuVIC" });
                    app.preloader.hide();
                },
                function (tx, error) {
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
                );
            },
            function (error) {},
            function () {}
            );
            }else{
                swal("", "Favor de seleccionar un Cliente" , "warning");
                app.preloader.hide();
            }
        }else{
            swal("", "La foto es requerida para continuar" , "warning");
            app.preloader.hide();
        }
    }
      function generarApoyoVIC(){
            let id_cedula = localStorage.getItem("IdCedula");
            let foto_llegada = localStorage.getItem("foto_llegada");
            let id_cliente = localStorage.getItem("id_cliente");
            let nombre_cliente = localStorage.getItem("nombre_cliente");
            let nombre_comercial = localStorage.getItem("nombre_comercial");
            let nombre_contacto = localStorage.getItem("nombre_contacto");
            let telefono = localStorage.getItem("telefono");
            let correo = localStorage.getItem("correo");
            let estatus_cliente = localStorage.getItem("estatus_cliente");
            let tipoCedula = "ApoyoVIC";
            productHandler.addVICDatos(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_comercial, nombre_contacto, telefono, correo, estatus_cliente);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            app.views.main.router.navigate({name: 'recorridoVIC1'});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        function guardarDatosGeneralesVIC(){
            app.preloader.show('blue');
            //swal("", "Debes de llenar todos los campos" , "warning");
            var id_cedula = localStorage.getItem("IdCedula");
            var nombre_cliente = $('#nombreCliente').val();
            var nombre_comercial = $('#nombreComercial').val();
            var nombre_contacto = $('#nombreContacto').val();
            var telefono = $('#telefonoContacto').val();
            var correo = $('#correoContacto').val();
            var estatus_cliente = 'Estatus';
            if (nombre_cliente !='' && nombre_comercial !='' && nombre_contacto !='' && telefono != '' && correo !='' && estatus_cliente !=''){
                databaseHandler.db.transaction(
                    function (tx) {
                    tx.executeSql(
                        "UPDATE apoyo_bennetts SET nombre_contacto = ?, telefono = ?, correo = ?, estatus_cliente = ? WHERE id_cedula = ?",
                        [nombre_contacto, telefono, correo, estatus_cliente, id_cedula],
                        function (tx, results) {
                        swal("", "Datos actualizados correctamente", "success");
                        app.preloader.hide();
                        $('#nombreCliente').css("background-color","#ffffff");
                        $('#nombreComercial').css("background-color","#ffffff");
                        $('#nombreContacto').css("background-color","#ffffff");
                        $('#telefonoContacto').css("background-color","#ffffff");
                        $('#correoContacto').css("background-color","#ffffff");
                        $('#estatus').css("background-color","#ffffff");
                        },
                        function (tx, error) {
                        console.error("Error al actualizar Datos: " + error.message);
                        app.preloader.hide();
                        }
                    );
                    },
                    function (error) {},
                    function () {}
                );
            }else {
                swal("", "Debes de llenar todos los campos" , "warning");
                app.preloader.hide();
            }
        }
      function guardarApoyoCampo(){
          //console.log("Datos apoyo en campo");
          //console.log("comentario");
          var tipo = $('#tipos').val();
          var id_cedula = localStorage.getItem("IdCedula");
          var smartSelect = app.smartSelect.get('.smart-select');
          var foto = $('#imagenC').val();
          var comentarios = $('#comentarios').val();
          var fecha = new Date();
          var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
          if (tipo!=1){
            //console.log(tipo);
            if (comentarios){
                if(foto){
                    if (tipo!='otros'){
                        //console.log('normal');
                        app.preloader.show('blue');
                        //swal("","Foto y comentario OKay","success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO fotos_apoyo(id_cedula, foto, tipo_apoyo, comentario,  fechaYHora) VALUES (?,?,?,?,?)",
                                    [id_cedula, foto, tipo, comentarios, fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        swal("","Datos guardados correctamente","success");
                                        smartSelect.setValue('1');
                                        $('#imagenC').val("");
                                        $('#comentarios').val("");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_apoyo where id_cedula = ? ORDER BY fechaYHora DESC",
                                                [id_cedula],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#ApoyoCampo_content").append("<tr id='fila"+ item.id_foto_apoyo +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_foto_apoyo +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtipo' style='text-align: center;'>" + item.tipo_apoyo + "</td><td id='tdfoto'><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td id='tdcomentario' style='text-align: center;'>" + item.comentario + "</td><td id='tdfecha' style='text-align: center;'>" + item.fechaYHora + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        app.preloader.hide();
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        var tipo=$('#otroA').val();
                        //console.log(tipo);
                        app.preloader.show('blue');
                        //swal("","Foto y comentario OKay","success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO fotos_apoyo(id_cedula, foto, tipo_apoyo, comentario,  fechaYHora) VALUES (?,?,?,?,?)",
                                    [id_cedula, foto, tipo, comentarios, fecha_registro],
                                    function(tx, results){
                                        app.preloader.hide();
                                        swal("","Datos guardados correctamente","success");
                                        smartSelect.setValue('1');
                                        $('#imagenC').val("");
                                        $('#comentarios').val("");
                                        $('#otroA').val("");
                                        $('span[name="otroApoyo"]').hide();
                                        $('input[name="otroApoyo"]').hide();
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select * from fotos_apoyo where id_cedula = ? ORDER BY fechaYHora DESC",
                                                [id_cedula],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#smallImage").attr("src","img/blank.png");
                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                        $("#ApoyoCampo_content").append("<tr id='fila"+ item.id_foto_apoyo +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_foto_apoyo +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtipo' style='text-align: center;'>" + item.tipo_apoyo + "</td><td id='tdfoto'><img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/></td><td id='tdcomentario' style='text-align: center;'>" + item.comentario + "</td><td id='tdfecha' style='text-align: center;'>" + item.fechaYHora + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                        app.preloader.hide();
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        app.preloader.hide();
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                }else{
                    swal("","Favor de tomar una foto","warning");
                }
            }else{
                swal("","Favor de colocar un comentario","warning");
            }
          }else{
            //console.log(tipo);
            swal("", "Selecciona un tipo de apoyo", "warning");
          }
      }

      function guardarCierredeApoyo(){
          //console.log("guardarCierredeApoyo");
          if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
          swal("", "Todos los campos son obligatorios", "warning");
          return false;
        }

        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();
        databaseHandler.db.transaction(
          function (tx) {
            tx.executeSql(
              "UPDATE apoyo_bennetts SET firma_cliente = ?, fecha_cliente = ? WHERE id_cedula = ?",
              [firmaCliente, fecha_firma, id_cedula],
              function (tx, results) {
                databaseHandler.db.transaction(
                  function (tx) {
                    tx.executeSql(
                      "UPDATE cedulas_general SET calificacion = ?, nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                      [calificacion, nombrefirma, comentarioCliente, id_cedula],
                      function (tx, results) {
                        swal("", "Guardado correctamente", "success");
                        app.views.main.router.back("/yamevoyVICApoyo/", {
                          force: true,
                          ignoreCache: true,
                          reload: true,
                        });
                      },
                      function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                      }
                    );
                  },
                  function (error) {},
                  function () {}
                );
              },
              function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
              }
            );
          },
          function (error) {},
          function () {}
        );
      }

    function tipos2() {
        var option = document.getElementById("tipos").value;
        var smartSelect = app.smartSelect.get('.smart-select');
        //console.log("clic"+option);
        if (option=='otros'){
            //console.log("otroclick")
            app.dialog.prompt("Por favor especifica que tipo de apoyo sería", `Otro Apoyo`, function (name) {
                    //eliminarubicacion();
                    if(name==''){
                        swal("", "Hay que llenar el campo, la operación se cancelá por la falta de este campo" , "warning");
                        smartSelect.setValue('1');
                        smartSelect.close();
                    }else{
                        $('#otroA').val(name);
                        smartSelect.close();
                        $('span[name="otroApoyo"]').show();
                        $('input[name="otroApoyo"]').show();
                    }
              },function(){
                swal("", "Operación cancelada" , "warning");
                smartSelect.setValue('1');
                smartSelect.close();
                //document.getElementById("tipos").selectedIndex = "6";
                //$('#tipos option[value="Mantenimientos a equipos"]').prop("selected", "selected");
              });
        }else{
            //$('#otroA').val(smartSelect.getValue());
            $('#otroA').val('');
            $('span[name="otroApoyo"]').hide();
            $('input[name="otroApoyo"]').hide();
            smartSelect.close();
        }
    }

    function continuarCedVIC(id_cedula,tipo,id_proyecto){
        localStorage.setItem("IdCedula",id_cedula);
         if(tipo == 1){
            localStorage.setItem("Opcion", '1');
            app.views.main.router.navigate({ name: 'recorridoVIC1'});
        }else if(tipo == 2){
            localStorage.setItem("Opcion", '2');
            app.views.main.router.navigate({ name: 'recorridoVIC2'});
        }else if(tipo == 3){
            localStorage.setItem("Opcion", '3');
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("Select * from datosVIC where id_cedula = ?",
                    [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var tipos = item.tipo_visita;
                            var nombre_cliente=item.nombre_cliente;
                            var id_cliente=item.id_cliente;
                            if (tipos =='Llamada'){
                                app.views.main.router.navigate({ name: 'recorridoVIC3-1'});
                                localStorage.setItem("TipoVIC", 1);
                                localStorage.setItem("nombre_cliente", nombre_cliente);
                                localStorage.setItem("id_cliente", id_cliente);
                            } else if (tipos =='Visita'){
                                app.views.main.router.navigate({ name: 'recorridoVIC3'});
                                localStorage.setItem("TipoVIC", 2);
                                localStorage.setItem("nombre_cliente", nombre_cliente);
                                localStorage.setItem("id_cliente", id_cliente);
                            }
                        },
                        function(tx, error){
                            console.log("Error al guardar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(tipo == 4){
            localStorage.setItem("Opcion", '4');
            app.views.main.router.navigate({name: 'datosgeneralesVIC4'});
        }else if(tipo == 5){
            localStorage.setItem("Opcion", '5');
            localStorage.setItem("IdProyecto",id_proyecto);
            app.views.main.router.navigate({ name: 'recorridoVIC2'});
        }else if(tipo == 6){
            localStorage.setItem("Opcion", '6');
            app.views.main.router.navigate({name: 'recorridoVIC4'});
        }
    }


    function eliminarFilaVIC(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_apoyo WHERE id_foto_apoyo = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM minuta WHERE id_minuta = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM equiposVIC WHERE id_equipos = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM imagenVIC WHERE id_imagen = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM entrenaVIC WHERE id_entrena = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM almacenVIC WHERE id_almacen = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM pedidosVIC WHERE id_producto = ?",
                        [index],
                        function(tx, results){
                            console.log(tx, results);
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }

    function terminarServicioVIC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE apoyo_bennetts SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function irCierreVIC(){
        var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from datosVIC WHERE id_cedula = ?",
                            [id_cedula],
                            function(tx, results){
                                let length = results.rows.length;
                                for(var i = 0; i< length; i++){
                                    var item = results.rows.item(i);
                                    var emp = item.tipo_empresa;
                                    console.log("empresa",emp);
                                        if(item.nombre_contacto=='' || item.telefono == '' || item.correo==''){
                                            swal({
                                                title: "Aviso",
                                                text: "Tienes los datos generales incompletos. ¿Seguro que deseas continuar así?",
                                                icon: "warning",
                                                buttons: true,
                                                dangerMode: false,
                                            })
                                            .then((willGoBack) => {
                                                if (willGoBack){
                                                    if(emp){
                                                        var Nom = 'Preguntas-VIC-1';
                                                        app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
                                                            var content2 = JSON.parse(data);
                                                            var VIC ;
                                                            if(emp == 1){
                                                                var VIC =content2[0];
                                                            }else if(emp == 2){
                                                                var VIC =content2[1];
                                                            }else if(emp == 3){
                                                                var VIC =content2[2];
                                                            } else if(emp == 4){
                                                                var VIC =content2[3];
                                                            }
                                                            var tamaVic = VIC.length;
                                                            databaseHandler.db.transaction(
                                                                function (tx) {
                                                                    tx.executeSql(
                                                                        "Select * from VIC_Respuesta where id_cedula = ? and respuesta IS NOT NULL",
                                                                        [id_cedula],
                                                                        function (tx, results) {
                                                                            let length = results.rows.length;
                                                                            var obl = '';
                                                                            if (length == tamaVic){
                                                                                app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                            }else{
                                                                                swal({
                                                                                    title: "Aviso",
                                                                                    text: "Tienes la auditoria incompleta. ¿Seguro que deseas continuar así?",
                                                                                    icon: "warning",
                                                                                    buttons: true,
                                                                                    dangerMode: false,
                                                                                })
                                                                                .then((willGoBack) => {
                                                                                    if (willGoBack){
                                                                                        app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                                    } else {}
                                                                                });
                                                                            }
                                                                        },
                                                                        function (tx, error) {
                                                                            console.log("Error al guardar registroPL: " + error.message);
                                                                            app.preloader.hide();
                                                                        }
                                                                    );
                                                                },
                                                                function (error) { },
                                                                function () { }
                                                            );
                                                        });
                                                    } else{
                                                        app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                    }
                                                    // app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                } else {}
                                            });
                                        }else{
                                            if(emp){
                                                var Nom = 'Preguntas-VIC-1';
                                                app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
                                                    var content2 = JSON.parse(data);
                                                    var VIC ;
                                                    if(emp == 1){
                                                        var VIC =content2[0];
                                                    }else if(emp == 2){
                                                        var VIC =content2[1];
                                                    }else if(emp == 3){
                                                        var VIC =content2[2];
                                                    }else if(emp == 4){
                                                        var VIC =content2[3];
                                                    }
                                                    var tamaVic = VIC.length;

                                                    databaseHandler.db.transaction(
                                                        function (tx) {
                                                            tx.executeSql(
                                                                "Select * from VIC_Respuesta where id_cedula = ? and respuesta IS NOT NULL",
                                                                [id_cedula],
                                                                function (tx, results) {
                                                                    let length = results.rows.length;
                                                                    var obl = '';
                                                                    if (length == tamaVic){
                                                                        app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                    }else{
                                                                        swal({
                                                                            title: "Aviso",
                                                                            text: "Tienes la auditoria incompleta. ¿Seguro que deseas continuar así?",
                                                                            icon: "warning",
                                                                            buttons: true,
                                                                            dangerMode: false,
                                                                        })
                                                                        .then((willGoBack) => {
                                                                            if (willGoBack){
                                                                                app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});
                                                                            } else {}
                                                                        });
                                                                    }
                                                                },
                                                                function (tx, error) {
                                                                    console.log("Error al guardar registroPL: " + error.message);
                                                                    app.preloader.hide();
                                                                }
                                                            );
                                                        },
                                                        function (error) { },
                                                        function () { }
                                                    );

                                                });
                                            } else{

                                                app.views.main.router.back('/cierreVIC/', {force: true, ignoreCache: true, reload: true});

                                            }
                                        }
                                }
                                },
                                    function(tx, error){
                                        console.log("Error: " + error.message);
                                        app.preloader.hide();
                                    }
                    );
                },
                    function(error){},
                    function(){}
            );
    }
    function guardarActividadComercial(){
        let id_cedula = localStorage.getItem("IdCedula");
        let proyecto = localStorage.getItem("IdProyecto");
        // var foto_visita=$('#imagenC').val();
        var nivel=$('#niveles').val();
        var act=$('#actividadSe').val();
        var pendiente_vendedor=$('#pendiente_vendor').val();
        if($('#V1').is(':checked') || $('#V2').is(':checked')){
            if($('#V1').is(':checked')){
                var tipo_visita=$('#V1').val();
            }else if ($('#V2').is(':checked')){
                var tipo_visita=$('#V2').val();
            }
                    if(pendiente_vendedor && nivel && act ){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE ventas_bennetts SET tipo_visita = ?,  nivel = ?, pendiente_vendedor= ?,actividadSelect = ?  WHERE  id_cedula = ?",
                                    [tipo_visita,nivel,pendiente_vendedor,act,id_cedula],
                                    function(tx, results){
                                        swal("","Se guardaron los datos correctamente", "success");
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Todos los campos son requeridos para continuar", "warning");
                    }

        }else{
            swal("", "Favor de seleccionar el tipo de visita", "warning");
        }
    }
    function continuarVentaVIC(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '2');
            app.views.main.router.navigate({ name: 'recorridoVIC2'});
    }

    function guardarVentasVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        var tema=$('#tema').val();
        var compromiso=$('#compromiso').val();
        var fecha_compromiso=$('#fecha').val();
        var h_inicio=$('#hora_inicio').val();
        var h_fin=$('#hora_fin').val();
        var fecha = new Date();
        var fecha_tomada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        //console.log("patiende: "+Patiende+"- Ppuesto: "+Ppuesto+"- Ptelefono: "+Ptelefono+"- Pcorreo:"+Pcorreo+" actividades:"+actividades+" - tema:"+tema+"- compromiso: "+compromiso+"- fecha:"+fecha);
        if (tema && compromiso && fecha_compromiso && h_inicio && h_fin){
                app.preloader.show('blue');
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO minuta(id_cedula,tema,compromiso,fecha,fecha_foto,h_inicio,h_fin) VALUES (?,?,?,?,?,?,?)",
                            [id_cedula,tema,compromiso,fecha_compromiso,fecha_tomada,h_inicio,h_fin],
                            function(tx, results){
                                //console.log("Datos Guardados");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#tema').val('');
                                $('#tema').css("background-color","#ffffff");
                                $('#compromiso').val('');
                                $('#compromiso').css("background-color","#ffffff");
                                $('#fecha').val('');
                                $('#fecha').css("background-color","#ffffff");
                                $('#hora_inicio').val('');
                                $('#hora_inicio').css("background-color","#ffffff");
                                $('#hora_fin').val('');
                                $('#hora_fin').css("background-color","#ffffff");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql("Select * from minuta where id_cedula = ? ORDER BY id_minuta DESC",
                                        [id_cedula],
                                            function(tx, results){
                                                var item = results.rows.item(0);
                                                $("#VentasBennetts_content").append("<tr id='fila"+ item.id_minuta +"'><td id='tdaccion'><a href='#' onclick='eliminarFilaVIC("+ item.id_minuta +",2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td id='tdtema' style='text-align: center;'>" + item.tema + "</td><td id='tdcompromiso' style='text-align: center;'>" + item.compromiso + "</td><td id='tdfecha' style='text-align: center;'>" + item.fecha + "</td><td id='tdfecha' style='text-align: center;'>" + item.h_inicio + "</td><td id='tdfecha' style='text-align: center;'>" + item.h_fin + "</td></tr>");
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                                app.preloader.hide();
                                            },
                                            function(tx, error){
                                                console.log("Error al Mostrar los datos: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    },
                                    function(error){},
                                    function(){}
                                );
                        },
                            function(tx, error){
                                console.error("Error al guardar: " + error.message);
                                swal("","Ha ocurrido un error al guardar", "error");
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        }else{
            swal("", "Todos los campos son obligatorios", "warning");
        }
    }

    function guardarDatosGVentasVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende').val();
        var Ppuesto=$('#Ppuesto').val();
        var Ptelefono=$('#Ptelefono').val();
        var Pcorreo=$('#Pcorreo').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if(Patiende && Ppuesto && Ptelefono && Pcorreo){
                    console.log(id_proyecto);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql(
                                "Select * from proyectos_vic WHERE id_proyecto = ?",
                                [id_proyecto],
                                function(tx, results){
                                    let length = results.rows.length;
                                    var item = results.rows.item(0);
                                    var actual_nivel = item.nivel;
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("UPDATE ventas_bennetts SET id_proyecto = ?,nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo= ?, nivel = ? WHERE id_cedula = ?",
                                                [id_proyecto,Patiende,Ppuesto,Ptelefono,Pcorreo,actual_nivel,id_cedula],
                                                function(tx, results){
                                                    swal("","Se guardaron los datos correctamente", "success");
                                                    $('#Patiende').css("background-color","#ffffff");
                                                    $('#Ppuesto').css("background-color","#ffffff");
                                                    $('#Ptelefono').css("background-color","#ffffff");
                                                    $('#Pcorreo').css("background-color","#ffffff");
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("UPDATE proyectos_vic SET nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo= ?, nivel = ? WHERE id_proyecto = ?",
                                                                [Patiende,Ppuesto,Ptelefono,Pcorreo,actual_nivel,id_proyecto],
                                                                function(tx, results){
                                                                },
                                                                function(tx, error){
                                                                    console.error("Error al actualizar: " + error.message);
                                                                }
                                                            );
                                                        },
                                                        function(error){},
                                                        function(){}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }
    }

    function guardarCierredeVentasVIC(){
        if ($("#NombreFirma").val() == ""){
            swal("", "Todos los campos son obligatorios", "warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var correo_apoyo = $('#correo_cliente').val();
        databaseHandler.db.transaction(
            function (tx) {
            tx.executeSql("UPDATE ventas_bennetts SET correo_apoyo = ? WHERE id_cedula = ?",
                [correo_apoyo, id_cedula],
                function (tx, results) {
                databaseHandler.db.transaction(
                    function (tx) {
                    tx.executeSql("UPDATE cedulas_general SET nombre_evalua = ? WHERE id_cedula = ?",
                        [nombrefirma, id_cedula],
                        function (tx, results) {
                        swal("", "Guardado correctamente", "success");
                        app.views.main.router.back("/yamevoyVICVentas/", {
                            force: true,
                            ignoreCache: true,
                            reload: true,
                        });
                        },
                        function (tx, error) {
                        console.error("Error al guardar cierre: " + error.message);
                        }
                    );
                    },
                    function (error) {},
                    function () {}
                );
                },
                function (tx, error) {
                console.error("Error al guardar cierre: " + error.message);
                }
            );
            },
            function (error) {},
            function () {}
        );
    }



    function terminarVentasVIC(){
        //console.log("terminar ventas");
        // if($('#imagenC').val() == ""){
        //     swal("","La fotografia es obligatoria","warning");
        //     return false;
        // }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE ventas_bennetts SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }

        function visitaP3(){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from ventas_bennetts WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var avanza1=item.id_proyecto;
                                if(avanza1 != 0){
                                    app.views.main.router.navigate({name: 'datosProyectoVentasVIC'});
                                    }else{
                                        swal("", "Favor de primero llenar los datos generales" , "warning");
                                }
                        },
                        function(tx, error){
                            console.log('Error:'+ error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        function visitaP1(){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from ventas_bennetts WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var avanza=item.nivel;
                                if(avanza  >=  0){
                                    app.views.main.router.navigate({name: 'visitaProyectoVIC'});
                                }else{
                                    swal("", "Favor de llenar los datos en actividad comercial" , "warning");
                                }
                        },
                        function(tx, error){
                            console.log('Error:'+ error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        function visitaP2(){
            var id_cedula = localStorage.getItem("IdCedula");
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("SELECT * from ventas_bennetts WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx, results){
                            var item = results.rows.item(0);
                            var avanza1=item.id_proyecto;
                                if(avanza1 != 0){
                                    app.views.main.router.navigate({name: 'cierreVIC2'});
                                    }else{
                                        swal("", "Favor de primero llenar los datos generales" , "warning");
                                }
                        },
                        function(tx, error){
                            console.log('Error:'+ error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        function ParaCargaProyecto(id){
            var smartSelect = app.smartSelect.get('.smart-select');
            if (id=='asas')
            {}else{
                smartSelect.setValue('1');
            }
        }
    function recorrido3(reco){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_cliente = localStorage.getItem("id_cliente");
        let nombre_cliente = localStorage.getItem("nombre_cliente");
        let nombre_comercial = localStorage.getItem("nombre_comercial");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let telefono = localStorage.getItem("telefono");
        let correo = localStorage.getItem("correo");
        let estatus_cliente = localStorage.getItem("estatus_cliente");
        let tipoCedula = "VIC";
        if(reco==1){
            let tipoVisita = "Llamada";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            productHandler.addVICVIC(id_cedula, foto_llegada, tipoVisita, id_cliente, nombre_cliente, nombre_cliente, nombre_contacto, telefono, correo,estatus_cliente);
                            localStorage.setItem("TipoVIC", reco);
                            app.views.main.router.back('/recorridoVIC3-1/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else if(reco==2){
            let tipoVisita = "Visita";
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            productHandler.addVICVIC(id_cedula, foto_llegada, tipoVisita, id_cliente, nombre_cliente, nombre_cliente, nombre_contacto, telefono, correo,estatus_cliente);
                            localStorage.setItem("TipoVIC", reco);
                            app.views.main.router.back('/recorridoVIC3/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function regresarRecorridoVIC1(){
        app.views.main.router.back('/recorridoVIC1/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoVIC2(opcion){
        if(opcion){
            var IdProyecto = localStorage.getItem('IdProyecto');
            if(IdProyecto == 0){
                swal({
                    title: "Aviso",
                    text: "Aún no tienes proyecto seleccionado, ¿Estás seguro que deseas regresar?",
                    icon: "warning",
                    buttons: true,
                    dangerMode: false,
                }).then((willGoBack) => {
                    if (willGoBack){
                        app.views.main.router.back('/recorridoVIC2/', {force: true, ignoreCache: true, reload: true});
                    }
                });
            }else{
                var id_cedula = localStorage.getItem("IdCedula");
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql(
                            "Select * from ventas_bennetts where id_cedula = ?",
                                [id_cedula],
                                    function(tx, results){
                                        var item = results.rows.item(0);                                        
                                        console.log(item)
                                        if(item){
                                            if(item.id_proyecto == 0){
                                                swal({
                                                    title: "Aviso",
                                                    text: "Aún no haz guardado los datos, ¿Estás seguro que deseas regresar?",
                                                    icon: "warning",
                                                    buttons: true,
                                                    dangerMode: false,
                                                }).then((willGoBack) => {
                                                    if (willGoBack){
                                                        app.views.main.router.back('/recorridoVIC2/', {force: true, ignoreCache: true, reload: true});
                                                    }
                                                });
                                            }else{
                                                app.views.main.router.back('/recorridoVIC2/', {force: true, ignoreCache: true, reload: true});
                                            }

                                        }else{
                                            swal("", "Intente de nuevo" , "warning");
                                            EliminarReg(id_cedula, "VentasVIC_ConV",2);
                                            app.views.main.router.back('/menuVentas/', {force: true, ignoreCache: true, reload: true});

                                        }                                     
                                        
                                    },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                        );  
                    },
                        function(error){},
                        function(){}
                );
            }
        }else{
            app.views.main.router.back('/recorridoVIC2/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function regresarRecorridoVIC3(){
        let tipo = localStorage.getItem("TipoVIC");
        if (tipo==1){
            app.views.main.router.back('/recorridoVIC3-1/', {force: true, ignoreCache: true, reload: true});
        }else if (tipo==2){
            app.views.main.router.back('/recorridoVIC3/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function ProyectoVIC(value){
        var id_cedula = localStorage.getItem("IdCedula");
        var nombre_proyecto = $("#proyectos option:selected").text();

        if (value == 0){
            $('#Patiende').val('');
            $('#Ppuesto').val('');
            $('#Ptelefono').val('');
            $('#Pcorreo').val('');
            window.localStorage.removeItem("IdProyecto");
            var nombre_cliente = 'PROYECTO SALES';
            var nivel = 0;
            var puesto_cliente = '';
            var telefono = '';
            var correo = '';
            databaseHandler.db.transaction(
                function (tx) {
                  tx.executeSql(
                    "UPDATE cedulas_general SET id_cliente = ?, nombre_cliente = ? WHERE id_cedula = ?",
                    [value,nombre_proyecto,id_cedula],
                    function (tx, results) {
                        databaseHandler.db.transaction(
                            function (tx) {
                              tx.executeSql(
                                "UPDATE ventas_bennetts SET id_proyecto = ?, nivel = ?, nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo = ? WHERE id_cedula = ?",
                                [value,nivel,nombre_cliente,puesto_cliente, telefono, correo, id_cedula],
                                function (tx, results) {},
                                function (tx, error) {
                                  console.error("Error al guardar cierre: " + error.message);
                                }
                              );
                            },
                            function (error) {},
                            function () {}
                        );
                    },
                    function (tx, error) {
                      console.error("Error al guardar cierre: " + error.message);
                    }
                  );
                },
                function (error) {},
                function () {}
            );
        }else{
            $('#Patiende').val('');
            $('#Ppuesto').val('');
            $('#Ptelefono').val('');
            $('#Pcorreo').val('');
            localStorage.setItem("IdProyecto", value);
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "Select * from proyectos_vic WHERE id_proyecto = ?",
                        [value],
                        function(tx, results){
                            let length = results.rows.length;
                            for(var x = 0; x < length; x++) {
                                var item = results.rows.item(x);
                                if(item.nombre_cliente) {
                                    $('#Patiende').val(item.nombre_cliente);
                                    $('#Ppuesto').val(item.puesto_cliente);
                                    $('#Ptelefono').val(item.telefono);
                                    $('#Pcorreo').val(item.correo);
                                    $('#Patiende').css(item.nombre_cliente);
                                }
                                var nivel = item.nivel;
                                var nombre_cliente = item.nombre_cliente;
                                var puesto_cliente = item.puesto_cliente;
                                var telefono = item.telefono;
                                var correo = item.correo;
                                databaseHandler.db.transaction(
                                    function (tx) {
                                      tx.executeSql(
                                        "UPDATE cedulas_general SET id_cliente = ?, nombre_cliente = ? WHERE id_cedula = ?",
                                        [value,nombre_proyecto,id_cedula],
                                        function (tx, results) {
                                            databaseHandler.db.transaction(
                                                function (tx) {
                                                  tx.executeSql(
                                                    "UPDATE ventas_bennetts SET id_proyecto = ?, nivel = ?, nombre_cliente = ?, puesto_cliente = ?, telefono = ?, correo = ? WHERE id_cedula = ?",
                                                    [value,nivel,nombre_cliente,puesto_cliente, telefono, correo, id_cedula],
                                                    function (tx, results) {},
                                                    function (tx, error) {
                                                      console.error("Error al guardar cierre: " + error.message);
                                                    }
                                                  );
                                                },
                                                function (error) {},
                                                function () {}
                                            );
                                        },
                                        function (tx, error) {
                                          console.error("Error al guardar cierre: " + error.message);
                                        }
                                      );
                                    },
                                    function (error) {},
                                    function () {}
                                );
                            }
                            app.smartSelect.close('.smart-select');
                        },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarDatosGVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let cliente = $("#cliente").val();
        let comercial = $("#nombre_comercial").val();
        let contacto = $("#nombre_contacto").val();
        let telefono = $("#telefono").val();
        let correo = $("#correo").val();
        let estatus = 'Estatus';
        if(cliente && comercial && contacto && telefono && estatus && correo){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET nombre_comercial=?, nombre_contacto=?, telefono=?, correo=?, estatus_cliente =? WHERE id_cedula = ?",
                        [comercial,contacto,telefono,correo,estatus,id_cedula],
                        function(tx, results){
                        //console.log("actualizados datos de evidencia");
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#cliente').css("background-color","#ffffff");
                        $('#nombre_comercial').css("background-color","#ffffff");
                        $('#nombre_contacto').css("background-color","#ffffff");
                        $('#telefono').css("background-color","#ffffff");
                        $('#correo').css("background-color","#ffffff");
                        $('#estatus_cliente').css("background-color","#ffffff");
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }

    function guardarEquipoVIC(){
        var id_cliente = localStorage.getItem("id_cliente");
        var id_usuario = localStorage.getItem("id_usuario");
        var enviado=0;
        var agrega=0;
        let nombreEquipo=$('#nombre_equipo').val();
        let codigoEquipo = $('#codigoEquipo').val();
        if (codigoEquipo==''){
            app.dialog.alert('Ingresa un equipo válido.', 'Aviso');
        }else{
            if(nombreEquipo){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql(
                            "Select * from equiposCargados where id_cliente = ? and codigo = ? ORDER BY id_equipo DESC",
                                [id_cliente, codigoEquipo],
                                function(tx, results){
                                    let length = results.rows.length;
                                        var item = results.rows.item(0);
                                        if (length!=0){
                                            console.log('existe en base');
                                            swal("","Equipo guardado correctamente", "success");
                                            app.sheet.close('#sheet-modal');
                                            $('#nombre_equipo').val('');
                                            $('#codigoEquipo').val('');
                                        }
                                        else{
                                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargados(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+nombreEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                                        };
                                    },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                        );
                    },
                        function(error){
                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargados(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+nombreEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                        },
                        function(){}
                );
            }else{
                app.dialog.alert('Debes seleccionar un proyecto.', 'Aviso');
            }
        }
    }

    function guardaEquipoVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let equipos=$('#select-equipo').val();
        let decripcion=$('#descripcionEquipo').val();
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let motivos=$('#motivos').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
            swal("", "Selecciona una opción de la pregunta" , "warning");
            return false;
            }else{
                    if($("#radio1").prop("checked") == true){
                        estado = "Buen Estado";
                    } else if($("#radio2").prop("checked") == true){
                        estado = "Mal Estado";
                        if(motivos == 0){
                            swal("", "Debes de seleccionar un motivo" , "warning");
                            return false;
                        }
                    }
                if(equipos==0){
                    swal("", "Selecciona un equipo" , "warning");
                }else{
                    if (estado && cantidad && ubicacion && comentarios){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO equiposVIC(id_cedula, estado, equipo, descripcion, cantidad, ubicacion, motivo, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?,?,?)",
                                    [id_cedula,estado,equipos,decripcion,cantidad,ubicacion,motivos,comentarios, foto, fecha_foto],
                                    function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $('#select-equipo').val(0);
                                    $('#motivos').val(0);
                                    $('#motivos').css("background-color","#ffffff");
                                    $('#cantidad').val('');
                                    $('#cantidad').css("background-color","#ffffff");
                                    $("#radio1").prop("checked", false);
                                    $("#radio2").prop("checked", false);
                                    $('#ubicacion').val('');
                                    $('#ubicacion').css("background-color","#ffffff");
                                    $("#select-equipo").css("background","#FFFFFF");
                                    $('#comentarios').val('');
                                    $('#descripcionEquipo').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                    $('#motivos').css("display","block");
                                    $('#spanMotivos').css("display","block");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql(
                                                    "Select * from equiposVIC where id_cedula = ? ORDER BY id_equipos DESC",
                                                        [id_cedula],
                                                        function(tx, results){
                                                                var item = results.rows.item(0);
                                                                let motivo="";
                                                                if (item.motivo==1){
                                                                    motivo="Daño del equipo por uso normal";
                                                                }else if (item.motivo==2){
                                                                    motivo="Equipo dañado por descuido";
                                                                }else if (item.motivo==3){
                                                                    motivo="Mantenimieto correctivo";
                                                                }else if (item.motivo==4){
                                                                    motivo="Cambio de equipos (Despachadores de Jabón, Toallero o Higiénico)";
                                                                }else if (item.motivo==5){
                                                                    motivo="Envío de Rack de 10 o 20 Litros y Rack para atomizadores";
                                                                }
                                                                if (item.foto == ''){
                                                                }else{
                                                                    foto="<img src='"+item.foto+"' width='60px' style='margin-top: 4px;'/>";
                                                                }
                                                                $("#tabla_equipoVIC").append("<tr id='fila"+ item.id_equipos +"'><td><a href='#' onclick='eliminarFilaVIC("+item.id_equipos +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td>"+
                                                                foto+"</td><td style='text-align: center;'>" + item.equipo
                                                                + "</td><td style='text-align: center;'>" + item.descripcion
                                                                + "</td><td style='text-align: center;'>" + item.cantidad
                                                                + "</td><td style='text-align: center;'>" + item.ubicacion
                                                                + "</td><td style='text-align: center;'>" + item.estado
                                                                + "</td><td style='text-align: center;'>" + item.comentarios
                                                                + "</td><td style='text-align: center;'>" + motivo + "</td></tr>");

                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                            },
                                                                function(tx, error){
                                                                    console.log("Error: " + error.message);
                                                                    app.preloader.hide();
                                                                }
                                                );
                                            },
                                                function(error){
                                                    console.log("Error: " + error.message);
                                                },
                                                function(){}
                                        );
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Debes de llenar todos los campos" , "warning");
                    }
                }
            }
        }else{
            if($("#radio1").prop("checked") == true){
                estado = "Buen Estado";
            } else if($("#radio2").prop("checked") == true){
                estado = "Mal Estado";
                    if(motivos == 0){
                        swal("", "Debes de seleccionar un motivo" , "warning");
                        return false;
                    }
            }
            if(equipos==0){
                swal("", "Debes de llenar todos los campos" , "warning");
            }else{
                if (estado && cantidad && ubicacion && comentarios && foto){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO equiposVIC(id_cedula, estado, equipo, descripcion, cantidad, ubicacion, motivo, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?,?,?)",
                                [id_cedula,estado,equipos,decripcion,cantidad,ubicacion,motivos,comentarios, foto, fecha_foto],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#select-equipo').val(0);
                                $('#motivos').val(0);
                                $('#motivos').css("background-color","#ffffff");
                                $('#cantidad').val('');
                                $('#cantidad').css("background-color","#ffffff");
                                $("#radio1").prop("checked", false);
                                $("#radio2").prop("checked", false);
                                $('#ubicacion').val('');
                                $('#ubicacion').css("background-color","#ffffff");
                                $("#select-equipo").css("background","#ffffff");
                                $('#comentarios').val('');
                                $('#comentarios').css("background-color","#ffffff");
                                $('#imagenC').val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                $('#motivos').css("display","block");
                                $('#spanMotivos').css("display","block");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql(
                                                "Select * from equiposVIC where id_cedula = ? ORDER BY id_equipos DESC",
                                                    [id_cedula],
                                                    function(tx, results){
                                                            var item = results.rows.item(0);
                                                            let motivo="";
                                                            if (item.motivo==1){
                                                                motivo="Daño del equipo por uso normal";
                                                            }else if (item.motivo==2){
                                                                motivo="Equipo dañado por descuido";
                                                            }else if (item.motivo==3){
                                                                motivo="Mantenimieto correctivo";
                                                            }else if (item.motivo==4){
                                                                motivo="Cambio de equipos (Despachadores de Jabón, Toallero o Higiénico)";
                                                            }else if (item.motivo==5){
                                                                motivo="Envío de Rack de 10 o 20 Litros y Rack para atomizadores";
                                                            }
                                                            $("#tabla_equipoVIC").append("<tr id='fila"+ item.id_equipos +"'><td><a href='#' onclick='eliminarFilaVIC("+item.id_equipos +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                            "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo
                                                            + "</td><td style='text-align: center;'>" + item.descripcion
                                                            + "</td><td style='text-align: center;'>" + item.cantidad
                                                            + "</td><td style='text-align: center;'>" + item.ubicacion
                                                            + "</td><td style='text-align: center;'>" + item.estado
                                                            + "</td><td style='text-align: center;'>" + item.comentarios
                                                            + "</td><td style='text-align: center;'>" + motivo + "</td></tr>");

                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                        },
                                                            function(tx, error){
                                                                console.log("Error: " + error.message);
                                                                app.preloader.hide();
                                                            }
                                            );
                                        },
                                            function(error){
                                                console.log("Error: " + error.message);
                                            },
                                            function(){}
                                    );
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){
                            console.error("Error: " + error.message);
                        },
                        function(){}
                    );
                }else{
                    swal("", "Debes de llenar todos los campos" , "warning");
                }
            }
        }
    }

    function validaradio(id){
        //console.log(id);
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
        }
    }

    function validaradio1(id, apartado){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio11"){
            permite='Sí';
            $("#radio11").prop("checked", true);
            $("#radio12").prop("checked", false);
            if (apartado==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_equipo = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }else if (apartado==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_img = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==3){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_entrena = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==4){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_pedido = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }
        }else if (id=="radio12"){
            permite='No';
            $("#radio12").prop("checked", true);
            $("#radio11").prop("checked", false);
            if (apartado==1){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_equipo = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }else if (apartado==2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_img = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==3){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_entrena = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }if (apartado==4){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE datosVIC SET pregunta_pedido = ? WHERE id_cedula = ?",
                            [permite,id_cedula],
                                function(tx, results){
                                    },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }
        }
    }

    function validaradioAlmacen(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            permite='Sí';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }

    function validaradioestadoCuenta(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            $("#div_radios").css("display", "block");
            permite='Sí';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            $("#div_radios").css("display", "none");
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }

    function guardarImagenVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposIV').val();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
                swal("", "Selecciona una opción de la pregunta" , "warning");
                return false;
            }else{
                if($("#radio1").prop("checked") == true){
                    estado = "Buen Estado";
                } else if($("#radio2").prop("checked") == true){
                    estado = "Mal Estado";
                }
                if(tipo == 0 ){
                    swal("", "Selecciona un tipo" , "warning");
                }else{
                    if (estado && cantidad && ubicacion && comentarios && foto){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO imagenVIC(id_cedula, tipo, estado, cantidad, ubicacion, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                                    [id_cedula,tipo,estado,cantidad,ubicacion,comentarios, foto, fecha_foto],
                                    function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $('#tiposIV').val(0);
                                    $('#tiposIV').css("background-color","#ffffff");
                                    $("#radio1").prop("checked", false);
                                    $("#radio2").prop("checked", false);
                                    $('#cantidad').val('');
                                    $('#cantidad').css("background-color","#ffffff");
                                    $('#ubicacion').val('');
                                    $('#ubicacion').css("background-color","#ffffff");
                                    $('#comentarios').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql(
                                                    "Select * from imagenVIC where id_cedula = ? ORDER BY id_imagen DESC",
                                                        [id_cedula],
                                                        function(tx, results){
                                                                var item = results.rows.item(0);
                                                                let tipo="";
                                                                if (item.tipo==1){
                                                                    tipo="Wallchart";
                                                                }else if (item.tipo==2){
                                                                    tipo="Etiqueta";
                                                                }else if (item.tipo==3){
                                                                    tipo="Imagen del Cliente";
                                                                }else if (item.tipo==4){
                                                                    tipo="Carpeta del Cliente";
                                                                }else if (item.tipo==5){
                                                                    tipo="Concentración de Equipos";
                                                                }else if (item.tipo==6){
                                                                    tipo="Envío de Etiquetas";
                                                                }else if (item.tipo==7){
                                                                    tipo="Envío de FT electrónicas";
                                                                }
                                                                $("#tabla_imagen").append("<tr id='fila"+ item.id_imagen +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_imagen +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                                    item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo
                                                                        + "</td><td style='text-align: center;'>" + item.cantidad + "</td><td style='text-align: center;'>" + item.ubicacion + "</td><td style='text-align: center;'>" + item.estado + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                            },
                                                                function(tx, error){
                                                                    console.log("Error: " + error.message);
                                                                    app.preloader.hide();
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                                }
                                                );
                                            },
                                                function(error){},
                                                function(){}
                                        );
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Debes de llenar todos los campos" , "warning");
                    }
                }
            }
        }else{
        if($("#radio1").prop("checked") == true){
            estado = "Buen Estado";
        } else if($("#radio2").prop("checked") == true){
            estado = "Mal Estado";
        }
        if(tipo == 0 ){
            swal("", "Selecciona un tipo" , "warning");
        }else{
            if (estado && cantidad && ubicacion && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO imagenVIC(id_cedula, tipo, estado, cantidad, ubicacion, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,estado,cantidad,ubicacion,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposIV').val(0);
                            $('#tiposIV').css("background-color","#ffffff");
                            $("#radio1").prop("checked", false);
                            $("#radio2").prop("checked", false);
                            $('#cantidad').val('');
                            $('#cantidad').css("background-color","#ffffff");
                            $('#ubicacion').val('');
                            $('#ubicacion').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from imagenVIC where id_cedula = ? ORDER BY id_imagen DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                        var item = results.rows.item(0);
                                                        let tipo="";
                                                        if (item.tipo==1){
                                                            tipo="Wallchart";
                                                        }else if (item.tipo==2){
                                                            tipo="Etiqueta";
                                                        }else if (item.tipo==3){
                                                            tipo="Imagen del Cliente";
                                                        }else if (item.tipo==4){
                                                            tipo="Carpeta del Cliente";
                                                        }else if (item.tipo==5){
                                                            tipo="Concentración de Equipos";
                                                        }else if (item.tipo==6){
                                                            tipo="Envío de Etiquetas";
                                                        }else if (item.tipo==7){
                                                            tipo="Envío de FT electrónicas";
                                                        }
                                                        $("#tabla_imagen").append("<tr id='fila"+ item.id_imagen +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_imagen +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo
                                                                + "</td><td style='text-align: center;'>" + item.cantidad + "</td><td style='text-align: center;'>" + item.ubicacion + "</td><td style='text-align: center;'>" + item.estado + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                        );
                                    },
                                        function(error){},
                                        function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    }

    function guardaEntrenamiento(){
        //console.log('entrena');
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposCapaV').val();
        let pcapacita=$('#Pcapacitada').val();
        let ppuesto=$('#Ppuesto').val();
        let tema=$('#tema').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
                swal("", "Selecciona una opción de la pregunta" , "warning");
                return false;
            }else{
                if(tipo == 0 ){
                    swal("", "Selecciona un tipo de capacitación" , "warning");
                }else{
                    if (pcapacita && ppuesto && tema && comentarios && foto){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("INSERT INTO entrenaVIC(id_cedula, tipo, persona_capacita, puesto_capacita, tema_capacita, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                                    [id_cedula,tipo,pcapacita,ppuesto,tema,comentarios, foto, fecha_foto],
                                    function(tx, results){
                                    swal("","Se guardaron los datos correctamente", "success");
                                    $('#tiposCapaV').val(0);
                                    $('#tiposCapaV').css("background-color","#ffffff");
                                    $('#Pcapacitada').val('');
                                    $('#Pcapacitada').css("background-color","#ffffff");
                                    $('#Ppuesto').val('');
                                    $('#Ppuesto').css("background-color","#ffffff");
                                    $('#tema').val('');
                                    $('#tema').css("background-color","#ffffff");
                                    $('#comentarios').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg");
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql(
                                                    "Select * from entrenaVIC where id_cedula = ? ORDER BY id_entrena DESC",
                                                        [id_cedula],
                                                        function(tx, results){
                                                                var item = results.rows.item(0);
                                                                let tipo="";
                                                                if (item.tipo==1){
                                                                    tipo="Capacitación en línea";
                                                                }else if (item.tipo==2){
                                                                    tipo="Capacitación presencial";
                                                                }
                                                                $("#tabla_entrena").append("<tr id='fila"+ item.id_entrena +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_entrena +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                                    item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo
                                                                        + "</td><td style='text-align: center;'>" + item.persona_capacita + "</td><td style='text-align: center;'>" + item.puesto_capacita + "</td><td style='text-align: center;'>" + item.tema_capacita + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                            },
                                                                function(tx, error){
                                                                    console.log("Error: " + error.message);
                                                                    app.preloader.hide();
                                                                    $("#message-nr").css("display", "none");
                                                                    $('.preloader').remove();
                                                                    $('.infinite-scroll-preloader').remove();
                                                                }
                                                );
                                            },
                                                function(error){},
                                                function(){}
                                        );
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        swal("", "Debes de llenar todos los campos" , "warning");
                    }
                }
            }
        }else{
        if(tipo == 0 ){
            swal("", "Selecciona un tipo de capacitación" , "warning");
        }else{
            if (pcapacita && ppuesto && tema && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO entrenaVIC(id_cedula, tipo, persona_capacita, puesto_capacita, tema_capacita, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,pcapacita,ppuesto,tema,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposCapaV').val(0);
                            $('#tiposCapaV').css("background-color","#ffffff");
                            $('#Pcapacitada').val('');
                            $('#Pcapacitada').css("background-color","#ffffff");
                            $('#Ppuesto').val('');
                            $('#Ppuesto').css("background-color","#ffffff");
                            $('#tema').val('');
                            $('#tema').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from entrenaVIC where id_cedula = ? ORDER BY id_entrena DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                        var item = results.rows.item(0);
                                                        let tipo="";
                                                        if (item.tipo==1){
                                                            tipo="Capacitación en línea";
                                                        }else if (item.tipo==2){
                                                            tipo="Capacitación presencial";
                                                        }
                                                        $("#tabla_entrena").append("<tr id='fila"+ item.id_entrena +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_entrena +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo
                                                                + "</td><td style='text-align: center;'>" + item.persona_capacita + "</td><td style='text-align: center;'>" + item.puesto_capacita + "</td><td style='text-align: center;'>" + item.tema_capacita + "</td><td style='text-align: center;'>" + item.comentarios + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                        );
                                    },
                                        function(error){},
                                        function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    }

    function guardaAlmacen(){
        //console.log('Almacen');
        let id_cedula = localStorage.getItem("IdCedula");
        let foto=$('#imagenC').val();
        let observaciones=$('#observaciones').val();
        let almacen='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if($("#radio1").prop("checked") == true){
            almacen = "Sí";
        } else if($("#radio2").prop("checked") == true){
            almacen = "No";
        }
        if (almacen && observaciones && foto){
            databaseHandler.db.transaction(
                function(tx){//observaciones text, foto blob, fecha text)",
                    tx.executeSql("INSERT INTO almacenVIC(id_cedula, observaciones, foto, fecha) VALUES (?,?,?,?)",
                        [id_cedula,observaciones, foto, fecha_foto],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#observaciones').val('');
                        $('#observaciones').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from almacenVIC where id_cedula = ? ORDER BY id_almacen DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#tabla_almacen").append("<tr id='fila"+ item.id_almacen +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_almacen +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.observaciones + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );
                                },
                                    function(error){},
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
        }else {
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardaPedido(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let producto=$('#Busca_producto').val();
        let codigo=$('#codigo').val();
        let descripcion=$('#descripcion').val();
        let inventario=$('#inventario').val();
        let cantidad=$('#cantidad').val();
        let comentarios=$('#comentarios').val();
        if (tipoVIC==1){
            if ($("#radio11").prop("checked") == false && $("#radio12").prop("checked") == false){
                swal("", "Selecciona una opción de la pregunta" , "warning");
                return false;
            }else{
                if (producto && inventario && cantidad && comentarios){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO pedidosVIC(id_cedula, codigo, producto, descripcion, inventario_dia, cantidad_solicitada, comentarios) VALUES (?,?,?,?,?,?,?)",
                                [id_cedula, codigo, producto, descripcion, inventario, cantidad, comentarios],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Busca_producto').val('');
                                $('#Busca_producto').css("background-color","#ffffff");
                                $('#codigo').val('');
                                $('#codigo').css("background-color","#ffffff");
                                $('#cantidad').val('');
                                $('#cantidad').css("background-color","#ffffff");
                                $('#descripcion').val('');
                                $('#descripcion').css("background-color","#ffffff");
                                $('#inventario').val('');
                                $('#inventario').css("background-color","#ffffff");
                                $('#comentarios').val('');
                                $('#comentarios').css("background-color","#ffffff");
                                $('#imagenC').val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql(
                                                "Select * from pedidosVIC where id_cedula = ? ORDER BY id_producto DESC",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        var item = results.rows.item(0);
                                                            $("#tabla_pedidos").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_producto +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" +
                                                            item.codigo + "</td><td style='text-align: center;'>" +
                                                            item.descripcion + "</td><td style='text-align: center;'>" +
                                                            item.inventario_dia + "</td><td style='text-align: center;'>" +
                                                            item.cantidad_solicitada + "</td><td style='text-align: center;'>" +
                                                            item.comentarios + "</td><td style='text-align: center;'>promedio</td><td style='text-align: center;'>fecha compra</td></tr>");
                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                        },
                                                            function(tx, error){
                                                                console.log("Error: " + error.message);
                                                                app.preloader.hide();
                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                            }
                                            );
                                        },
                                            function(error){},
                                            function(){}
                                    );
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){
                            console.error("Error al actualizar: " + error.message);
                        },
                        function(){}
                    );
                }else{
                    swal("", "Debes de llenar todos los campos" , "warning");
                }
            }
        }else{
        if (producto && codigo && descripcion && inventario && cantidad && comentarios){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO pedidosVIC(id_cedula, codigo, producto, descripcion, inventario_dia, cantidad_solicitada, comentarios) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, codigo, producto, descripcion, inventario, cantidad, comentarios],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#Busca_producto').val('');
                        $('#Busca_producto').css("background-color","#ffffff");
                        $('#codigo').val('');
                        $('#codigo').css("background-color","#ffffff");
                        $('#descripcion').val('');
                        $('#descripcion').css("background-color","#ffffff");
                        $('#producto').val('');
                        $('#producto').css("background-color","#ffffff");
                        $('#cantidad').val('');
                        $('#cantidad').css("background-color","#ffffff");
                        $('#inventario').val('');
                        $('#inventario').css("background-color","#ffffff");
                        $('#comentarios').val('');
                        $('#comentarios').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from pedidosVIC where id_cedula = ? ORDER BY id_producto DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    //producto text, codigo text, descripcion text, inventario_dia text, cantidad_solicitada integer, comentarios
                                                    $("#tabla_pedidos").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaVIC("+ item.id_producto +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" +
                                                    item.codigo + "</td><td style='text-align: center;'>" +
                                                    item.descripcion + "</td><td style='text-align: center;'>" +
                                                    item.inventario_dia + "</td><td style='text-align: center;'>" +
                                                        item.cantidad_solicitada + "</td><td style='text-align: center;'>" + item.comentarios
                                                        + "</td><td style='text-align: center;'>promedio</td><td style='text-align: center;'>fecha compra</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );
                                },
                                    function(error){},
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                        console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    function guardaObservaGeneral(){
        let id_cedula = localStorage.getItem("IdCedula");
        let observaciones_generales=$('#observaciones_generales').val();
        if (observaciones_generales){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE datosVIC SET observaciones_generales = ? WHERE id_cedula = ?",
                        [observaciones_generales,id_cedula],
                            function(tx, results){
                                swal("","Comentario General Guardado Correctamente", "success");
                                $('#observaciones_generales').css("background-color","#ffffff");
                            },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else{
            swal("", "Debes Colocar un Comentario General" , "warning");
        }
    }
    function cierreVIC(){
        var persona_cuenta='N/A';
        var correo_cuenta='N/A';
        var tipoVIC=localStorage.getItem("TipoVIC");

        if (tipoVIC==1){//Llamada
            if ($("#NombreFirma").val() == "" || $("#eval").val() == ""){
                swal("", "Todos los campos son obligatorios", "warning");
                return false;
            }
        }else if (tipoVIC==2){//Visita
            if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
                swal("", "Todos los campos son obligatorios", "warning");
                return false;
            }
        }

        if ($("#radio1").prop("checked") == true){
            if ($("#persona_cuenta").val() == "" || ($("#correo_cuenta").val()== "")){
                swal("", "Agrega una persona y correo para el estado de cuenta", "warning");
                return false;
            }else{
                persona_cuenta=$("#persona_cuenta").val();
                correo_cuenta=$("#correo_cuenta").val();
            }
        }

        if ($("#radio1").prop("checked") == false && $("#radio2").prop("checked") == false){
            swal("", "Elige una opción para el estado de cuenta", "warning");
            return false;
        }

      var id_cedula = localStorage.getItem("IdCedula");
      var nombrefirma = $("#NombreFirma").val();
      var firmaCliente = $("#signate").val();
      if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
          swal("","Por favor, ingresa el motivo de tu calificacion","warning");
          return false;
      }
      var calificacion = $("#eval").val();
      var comentarioCliente = $('#comentario_cliente').val();
      var fecha = new Date();
      var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();

      databaseHandler.db.transaction(
        function (tx) {
          tx.executeSql(
            "UPDATE datosVIC SET firma_cliente = ?, persona_cuenta = ?, correo_cuenta = ? WHERE id_cedula = ?",
            [firmaCliente, persona_cuenta, correo_cuenta, id_cedula],
            function (tx, results) {
              databaseHandler.db.transaction(
                function (tx) {
                  tx.executeSql(
                    "UPDATE cedulas_general SET calificacion = ?, nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                    [calificacion, nombrefirma, comentarioCliente, id_cedula],
                    function (tx, results) {
                      swal("", "Guardado correctamente", "success");
                      app.views.main.router.back("/yamevoyVICVIC/", {
                        force: true,
                        ignoreCache: true,
                        reload: true,
                      });
                    },
                    function (tx, error) {
                      console.error("Error al guardar cierre: " + error.message);
                    }
                  );
                },
                function (error) {},
                function () {}
              );
            },
            function (tx, error) {
              console.error("Error al guardar cierre: " + error.message);
            }
          );
        },
        function (error) {},
        function () {}
      );
    }

    function terminarVICVIC(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datosVIC SET foto_salida = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function validaradio2(id){
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            $('#motivos').css("display","none");
            $('#spanMotivos').css("display","none");
            $('#motivos').val(0);
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            $('#motivos').css("display","block");
            $('#spanMotivos').css("display","block");
        }
    }
    function equipos(){
        var id_cliente = localStorage.getItem("id_cliente");
        var rol = localStorage.getItem("rol");
        var roles = rol.split("-");
        var empresa1=roles[1];

        app.preloader.show('blue');
        var enviado=1;
        if (empresa1=='B'){
            var NomDescCli = "Equipos_1BEN1";
        }else if (empresa1=='K'){
            var NomDescCli = "Equipos_1KEY1";
        }

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("DELETE FROM equiposCargados WHERE enviado = ?",
                [enviado],
                function(tx, results){
                    app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
                        var content = JSON.parse(data);
                        var content1=content.length;
                        if(content1==0){
                        }else{
                            for (var i = 0; i < content.length; i++) {
                                if(id_cliente == content[i].id_cliente){
                                    var id_clientes = (content[i].id_cliente);
                                    var codigo=(content[i].codigo);
                                    var descripcion = (content[i].descripcion);
                                    productHandler.addVICEquipos(id_clientes,codigo,descripcion, enviado);
                                }else{}
                            }
                        }
                        app.preloader.hide();
                    });
                },
                function(tx, error){
                    swal("Error al borrar equipos cargados", error.message, "error");
                    app.preloader.hide();
                }
                );
            },
            function(error){app.preloader.hide();},
            function(){}
        );
    }
    function validarAud(){
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("Select * from datosVIC where id_cedula = ?",
                [id_cedula],
                    function(tx, results){
                        var item = results.rows.item(0);
                        var emp = item.tipo_empresa;
                        console.log("empresa",emp);
                        if(emp){
                            app.views.main.router.navigate({ name: 'Recorrido1VIC' });
                        }else{
                            app.views.main.router.navigate({ name: 'tipoAud' });
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function RecomendacionVIC(res,orden,id_pregunta,factor){
        var id_cedula = localStorage.getItem("IdCedula");
         databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                    "UPDATE VIC_Respuesta SET recomendacion = ? WHERE id_cedula = ?   and orden =? and id_pregunta =?  ",
                    [res,id_cedula,orden,id_pregunta],
                    function (tx, results) {
                        app.preloader.hide();
                    },
                    function (tx, error) {
                        console.log("Error al guardar registroVIC: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function (error) { },
            function () { }
        );
    }
    function AlmacenarError(respuesta){
        var datos = new Array();
        var id_usuario = localStorage.getItem("id_usuario"); ;
        var id_empresa = localStorage.getItem("id_empresa");;
        datos[0] = {'id_usario':id_usuario,'id_empresa':id_empresa,'respuesta':respuesta};
        console.log(datos)
        $.ajax({
            type: "POST",
            async : true,
            url: "http://www.appbennetts.com/FWM2/app/guardarErrorRespuesta.php",
            dataType: 'html',
            data: {'datos': JSON.stringify(datos)},
            success: function(respuesta){
                if(respuesta != 'ok'){
                   // AlmacenarError(respuesta)
                }

            },
            error: function(){
                console.log("Error en la comunicacion con el servidor");
            }
        });
    }
    function guardarDatosApoyoVIC(){
        let id_cedula = localStorage.getItem("IdCedula");
        var  proyecto=$('#noPro').val();
        var comentarios=$('#comentarios').val();
        var companero=$('#noCom').val();
        var fecha = new Date();
        var fecha_creacion = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate();
        var estatusEn = 1;
        var fecha = new Date();
        var fecha_tomada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        if(proyecto && comentarios && companero){
            app.preloader.show('blue');
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO apoyo_venta_vic(id_cedula, proyecto , companero , comentario,fecha ) VALUES (?,?,?,?,?)",
                        [id_cedula,proyecto,comentarios,companero,fecha_tomada],
                        function(tx, results){
                            //console.log("Datos Guardados");
                            swal("","Se guardaron los datos correctamente", "success");
                            //$('#nombreCliente').css("background-color","#ffffff");
                            $('#noPro').val('');
                            $('#comentarios').val('');
                            $('#noCom').val('');
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE cedulas_general SET estatus = ?, fecha_salida = ? WHERE id_cedula = ?",
                                        [estatusEn,fecha_creacion,id_cedula],
                                        function(tx, results){
                                            swal("","El proyecto se guardo correctamente", "success");
                                            window.location.href = "./menu.html";
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );

                    },
                        function(tx, error){
                            console.error("Error al guardar: " + error.message);
                            swal("","Ha ocurrido un error al guardar", "error");
                            app.preloader.hide();
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Todos los campos son obligatorios", "warning");
        }
    }
    function guardarDcliente(){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto = localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende2').val();
        var Ppuesto=$('#Ppuesto2').val();
        var Ptelefono=$('#Ptelefono2').val();
        var Pcorreo=$('#Pcorreo2').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
            //console.log(actividades);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO datos_contacto(id_cedula ,id_proyecto , nombre_cliente , puesto_cliente, telefono, correo) VALUES (?,?,?,?,?,?)",
                                [id_cedula,id_proyecto,Patiende,Ppuesto,Ptelefono,Pcorreo],
                                function(tx, results){
                                //console.log("actualizados datos de evidencia");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Patiende').css("background-color","#ffffff");
                                $('#Ppuesto').css("background-color","#ffffff");
                                $('#Ptelefono').css("background-color","#ffffff");
                                $('#Pcorreo').css("background-color","#ffffff");
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );

            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }
    }
    function sincronizaSales(){
        var IdUsuario = localStorage.getItem("id_usuario");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM cedulas_general WHERE id_usuario = ? AND (estatus = 1 OR estatus = 2 OR estatus = 0) ORDER BY estatus ASC;",
                    [IdUsuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        if(length == 0){
                            RecargarJSON_SALES();
                        }else{
                            for(var i = 0; i < length; i++){
                                var item = results.rows.item(i);
                                var estatus = item.estatus;
                                var cedula_id = item.id_cedula;
                                    if(estatus == 0){
                                        cedula_sale1(cedula_id,i,(length-1))
                                    }else{
                                    if(localStorage.getItem('sendFlag') == 0){
                                        llevarTodo(item.id_cedula,item.tipo_cedula);
                                    }
                                }
                            }
                        }
                    },
                    function(tx5, error){
                        console.error("Error al consultar bandeja de salida: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function inicio_sales(){
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario =
          localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var id_cliente = $("#id_cliente").val();
        var nombre_cliente = $("#nombre_cliente").val();
        var nombre_comercial = $("#NombreComercial").val();
        var nombre_contacto = $("#NombreContacto").val();
        var telefono = $("#Telefono").val();
        var correo = $("#Correo").val();
        var estatus_cliente = 'Estatus';
        var estatus = 0;
        var datos_v = new Array();
            productHandler.addCedulaVIC(id_usuario, nombre_usuario, fecha_llegada, geolocation, id_cliente, nombre_cliente, horario_programado, estatus);
            databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                "Select MAX(id_cedula) as Id from cedulas_general",
                [],
                function (tx, results) {
                    var item = results.rows.item(0);
                    datos_v[0] = {'id_usario':id_usuario ,'nombre_usuario':nombre_usuario ,'id_cliente':id_cliente,'nombre_cliente':nombre_cliente,'fecha_envio':fecha_llegada};
                    localStorage.setItem("IdCedula", item.Id);
                    localStorage.setItem("foto_llegada", foto_llegada);
                    localStorage.setItem("id_cliente", id_cliente);
                    localStorage.setItem("nombre_cliente", nombre_cliente);
                    localStorage.setItem("nombre_comercial", nombre_comercial);
                    localStorage.setItem("nombre_contacto", nombre_contacto);
                    localStorage.setItem("telefono", telefono);
                    localStorage.setItem("correo", correo);
                    localStorage.setItem("estatus_cliente", estatus_cliente);
                    $.ajax({
                        type: "POST",
                        async : true,
                        url: "http://www.appbennetts.com/FWM2/app/guardardatosVenta.php",
                        dataType: 'html',
                        data: {'datos_v': JSON.stringify(datos_v)},
                        success: function(respuesta){
                           // console.log("Respuesta",respuesta)
                        },
                        error: function(){
                            console.log("Error en la comunicacion con el servidor");
                        }
                    });
                    generarTablaVentas();
                    app.views.main.router.navigate({ name: "menuVentas" });
                    app.preloader.hide();
                },
                function (tx, error) {
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
                );
            },
            function (error) {},
            function () {}
            );

    }
    function RecargarJSON_SALES(){
        var IdUsuario = localStorage.getItem("id_usuario");
        var Nom = 'Gestion-SE-VIC';
        const namep = [];
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * FROM proyectos_vic_resguardo",
                    [],
                    function(tx, results){
                        var length = results.rows.length;
                        console.log('TAMA  ',length)
                        if(length == 0){
                            console.log('SIN CONTINUAR CEDULA---');
                        }else{
                            for(var i = 0; i < length; i++){
                                var item = results.rows.item(i);
                                console.log('App',item.nombre_proyecto);
                                namep.push(item.nombre_proyecto);

                            }

                        }
                    },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

        app.request.get(cordova.file.dataDirectory + "jsons/"+Nom+".json", function (data) {
            var content = JSON.parse(data);
            var Proyect = content[3];
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("DELETE FROM proyectos_vic",
                        [],
                        function(tx, results){
                            for(let i = 0; i < Proyect.length ;i++){
                                if(Proyect[i].id_usuario == IdUsuario && Proyect[i].nivel != 6 && Proyect[i].estatus == 1)  {
                                    var flag = 0;
                                    for(let j = 0; j< namep.length ;j++){
                                        if(namep[j]==Proyect[i].nombre_proyecto){
                                            flag =1;
                                        }
                                    }
                                    if(flag==0){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                console.log('nombre_proyecto',Proyect[i].nombre_proyecto );
                                                tx.executeSql("Insert into proyectos_vic(id_proyecto,id_usuario,nombre_proyecto,nombre_cliente,puesto_cliente , telefono , correo,potencial,segmento,division,fecha_creacion,enviado,estrategia,metodo,grupo,nivel) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                                    [Proyect[i].id_proyecto,Proyect[i].id_usuario, Proyect[i].nombre_proyecto,Proyect[i].nombre_cliente,Proyect[i].puesto_cliente,Proyect[i].telefono,Proyect[i].correo, Proyect[i].potencial, Proyect[i].segmento, Proyect[i].division, Proyect[i].fecha_creacion,  Proyect[i].enviado,Proyect[i].estrategia,Proyect[i].metodo,Proyect[i].grupo,Proyect[i].nivel],
                                                    function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM ventas_bennetts",
                                                                [],
                                                                function(tx, results){},
                                                                function(tx, error){
                                                                console.error("Error: " + error.message);
                                                                }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );

                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }

                                }

                            }
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("SELECT * FROM ventas_bennetts_resguardo",
                                        [],
                                        function(tx, results){
                                            var length = results.rows.length;
                                            console.log('TAMA  - resguardo ventas ',length)
                                            if(length == 0){
                                                //SIN CONTINUAR CEDULA
                                                console.log('SIN CONTINUAR CEDULA');
                                            }else{
                                                for(var i = 0; i < length; i++){
                                                    var item = results.rows.item(i);
                                                    var cedula = item.id_cedula;
                                                    var proyecto_id = item.id_proyecto;
                                                    console.log('ENTRO')
                                                    RegresarResguardo(proyecto_id,item.nivel,item.nombre_cliente,item.puesto_cliente,item.telefono,item.correo,cedula,item.actividadSelect,item.tipo_visita,item.foto_visita,item.pendiente_vendedor);
                                                }

                                            }
                                        },
                                        function(tx, error){
                                            console.error("Error al actualizar: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );

                       },
                        function(tx, error){
                            console.error("Error: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        });
    }
    function RegresarResguardo(proyecto_id,nivel,nombre_cliente,puesto_cliente,telefono,correo,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor){
        console.log('ENTRO a LA FUNCION CON',proyecto_id)
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT MAX(id_proyecto) as id2,MAX(id_proyecto)+1 as id FROM proyectos_vic",
                    [],
                    function(tx, results){
                        var item3 = results.rows.item(0);
                        var id_proyecto2 = item3.id2;
                        var id_proyecto = item3.id;
                        console.log('id_proyecto_entad',id_proyecto2)
                        console.log('id_proyecto_con suma',id_proyecto)
                        resguardo_sales_1(proyecto_id,id_proyecto,nivel,nombre_cliente,puesto_cliente,telefono,correo,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor);
                        },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function resguardo_sales_1(proyecto_id,id_proyecto,nivel,nombre_cliente,puesto_cliente,telefono,correo,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * FROM proyectos_vic_resguardo where id_proyecto = ?",
                    [proyecto_id],
                    function(tx, results){
                        var item2 = results.rows.item(0);
                        console.log(item2);
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Insert into proyectos_vic(id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, enviado,estrategia,metodo,grupo,nivel,nombre_cliente,puesto_cliente,telefono,correo) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)",
                                [item2.id_usuario, item2.nombre_proyecto, item2.potencial, item2.segmento, item2.division, item2.fecha_creacion,  item2.enviado,item2.estrategia,item2.metodo,item2.grupo,item2.nivel,nombre_cliente,puesto_cliente,telefono,correo],
                                   function(tx, results){
                                        var id_PPP = results.insertId;
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                              tx.executeSql(
                                                "UPDATE cedulas_general SET id_cliente = ?, nombre_cliente = ? WHERE id_cedula = ?",
                                                [id_PPP,item2.nombre_proyecto,cedula],
                                                function (tx, results) {},
                                                function (tx, error) {
                                                  console.error("Error al guardar cierre: " + error.message);
                                                }
                                              );
                                            },
                                            function (error) {},
                                            function () {}
                                        );
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Insert into ventas_bennetts(nivel,nombre_cliente , puesto_cliente , telefono , correo, id_proyecto,id_cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor)  VALUES (?,?,?,?,?,?,?,?,?,?,?)",
                                                [nivel,nombre_cliente,puesto_cliente,telefono,correo,id_PPP,cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor],
                                                     function(tx, results){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("DELETE FROM ventas_bennetts_resguardo where id_cedula = ?",
                                                                [cedula],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM proyectos_vic_resguardo where id_proyecto = ?",
                                                                                [proyecto_id],
                                                                                function(tx, results){
                                                                                },
                                                                                function(tx, error){
                                                                                    console.error("Error al actualizar: " + error.message);
                                                                                }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );
                                                                },
                                                                function(tx, error){
                                                                console.error("Error: " + error.message);
                                                                }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );

                                                    },
                                                    function(tx, error){
                                                        swal("Error al guardar",error.message,"error");
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );

                    },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function cedula_sale1(cedula_id,i,length2){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * FROM ventas_bennetts WHERE id_cedula = ?",
                [cedula_id],
                function(tx, results){
                    var length = results.rows.length;
                    var item2 = results.rows.item(0);
                    var id_proyecto = item2.id_proyecto;
                    if(id_proyecto == 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("DELETE FROM cedulas_general where id_cedula = ?",
                                    [cedula_id],
                                    function(tx, results){
                                        console.log('Se elimino')
                                        databaseHandler.db.transaction(
                                            function(tx4){
                                              let id_usuario = localStorage.getItem("id_usuario");
                                              let estatus = 0;
                                              tx4.executeSql("SELECT COUNT(id_cedula) as total FROM cedulas_general WHERE id_usuario = ? AND estatus = ? AND (tipo_cedula = 'levantamiento' OR tipo_cedula = 'fumigacion' OR tipo_cedula = 'sanitizacion' OR tipo_cedula = 'mantenimiento' OR tipo_cedula = 'reporteTecnico' OR tipo_cedula = 'minutaCoordinador' OR tipo_cedula = 'baja' OR tipo_cedula = 'sanitizacionSURO' OR tipo_cedula = 'ventaSMC' OR tipo_cedula = 'servicioSMC' OR tipo_cedula = 'checklistServ' OR tipo_cedula = 'reporteGeneral' OR tipo_cedula = 'AuditoriaTecnico' OR tipo_cedula = 'AuditoriaSupervisorTecnico' OR tipo_cedula = 'AuditoriaLider' OR tipo_cedula = 'reporteFotografico' OR tipo_cedula = 'conteo' OR tipo_cedula = 'Plato Limpio' OR tipo_cedula = 'Visita' OR tipo_cedula = 'Entrega' OR tipo_cedula = 'Venta' OR tipo_cedula = 'ApoyoVIC' OR tipo_cedula = 'VentasVIC' OR tipo_cedula = 'VIC' OR tipo_cedula = 'Caliente' OR tipo_cedula = 'visitaDilimpio' OR tipo_cedula = 'Entregas' OR tipo_cedula = 'Rational' OR tipo_cedula = 'recorridoSURO' OR tipo_cedula = 'visitaSURO' OR tipo_cedula = 'encuestaSURO' OR tipo_cedula = 'visitaBSURO' OR tipo_cedula = 'seguimientoSURO' OR tipo_cedula = 'Reposicion' OR tipo_cedula = 'Preventivo' OR tipo_cedula = 'Correctivo' OR tipo_cedula = 'Instalacion'   OR tipo_cedula = 'VentasVIC_ConV'  OR tipo_cedula = 'Bitacora' OR tipo_cedula = 'Trampa' OR tipo_cedula = 'Extraccion' OR tipo_cedula = 'Mantenimiento' OR tipo_cedula = 'Desasolve' OR tipo_cedula = 'logistica' OR tipo_cedula = 'servicio_tecnico' OR tipo_cedula = 'Cobranza' OR tipo_cedula = 'Checklist' OR tipo_cedula = 'Maquinaria' OR tipo_cedula = 'Materiales' OR tipo_cedula = 'Sitio')",
                                                [id_usuario,estatus],
                                                function(tx4, results){
                                                  var item = results.rows.item(0);
                                                  $('#contce').html(item.total);
                                                },
                                                function(tx4, error){
                                                  console.error("Error al guardar registro: " + error.message);
                                                }
                                              );
                                            },
                                            function(error){},
                                            function(){}
                                          );
                                          if(i == length2)  {
                                                RecargarJSON_SALES();
                                          }
                                    },
                                    function(tx, error){
                                        console.error("Error al actualizar: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        var id_pro = id_proyecto;
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("SELECT * FROM proyectos_vic WHERE id_proyecto = ?",
                                [id_pro],
                                function(tx, results){
                                    console.log(results);
                                    var item3 = results.rows.item(0);
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Insert into ventas_bennetts_resguardo (nivel,nombre_cliente , puesto_cliente , telefono , correo, id_proyecto,id_cedula,actividadSelect,tipo_visita,foto_visita,pendiente_vendedor)  VALUES (?,?,?,?,?,?,?,?,?,?,?)",
                                                [item2.nivel,item2.nombre_cliente,item2.puesto_cliente,item2.telefono,item2.correo,item2.id_proyecto,cedula_id,item2.actividadSelect,item2.tipo_visita,item2.foto_visita,item2.pendiente_vendedor],
                                                function(tx, results){
                                                    console.log('Insert ventas')
                                                    databaseHandler.db.transaction(
                                                        function(tx){
                                                            tx.executeSql("Insert into proyectos_vic_resguardo(id_proyecto,id_usuario, nombre_proyecto, potencial, segmento, division, fecha_creacion, enviado,estrategia,metodo,grupo,nivel) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)",
                                                                [item3.id_proyecto,item3.id_usuario, item3.nombre_proyecto, item3.potencial, item3.segmento, item3.division, item3.fecha_creacion,  item3.enviado,item3.estrategia,item3.metodo,item3.grupo,item3.nivel],
                                                                function(tx, results){
                                                                    databaseHandler.db.transaction(
                                                                        function(tx){
                                                                            tx.executeSql("DELETE FROM ventas_bennetts where id_cedula = ?",
                                                                            [cedula_id],
                                                                            function(tx, results){
                                                                                console.log('deleete ventas')
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("DELETE FROM proyectos_vic where id_proyecto = ?",
                                                                                            [id_pro],
                                                                                            function(tx, results){
                                                                                                if(i == length2)  {
                                                                                                    RecargarJSON_SALES();
                                                                                                }
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.error("Error al actualizar: " + error.message);
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            },
                                                                            function(tx, error){
                                                                            console.error("Error: " + error.message);
                                                                            }
                                                                            );
                                                                        },
                                                                        function(error){},
                                                                        function(){}
                                                                    );

                                                                },
                                                                function(tx, error){
                                                                    swal("Error al guardar",error.message,"error");
                                                                }
                                                            );
                                                        },
                                                        function(error){console.error("Error al actualizar: " + error.message);},
                                                        function(error){console.error("Error al actualizar: " + error.message);}
                                                    );
                                                },
                                                function(tx, error){
                                                    console.error("Error al actualizar: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){ console.error("Error: " + error.message);},
                                        function(error){console.error("Error al actualizar: " + error.message);}
                                    );
                                },
                                function(tx, error){
                                console.error("Error: " + error.message);
                                }
                                );
                            },
                            function(error){ console.error("Error: " + error.message);},
                            function(){}
                        );
                    }

                    },
                    function(tx, error){
                        console.error("Error al actualizar: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );

    }
    function comprobarproyect(id_proyecto,nombre_proyecto){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "Select * from ventas_bennetts WHERE id_proyecto = ?",
                    [id_proyecto],
                    function(tx, results){
                        let length = results.rows.length;
                        var item2 = results.rows.item(0);
                        $("#proyectos").append("<option value="+id_proyecto+">"+nombre_proyecto+"</option>");
                    },
                    function(tx, error){
                        console.log("Error: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function generarVentas(tipo){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let sucursal = localStorage.getItem("sucursal");
        localStorage.setItem("IdProyecto",0);
        if (tipo==1){
            var tipoCedula = "VentasVIC_SinV";
        }else if (tipo==2){
            var tipoCedula = "VentasVIC_ConV";
        }else if (tipo==3){
            var tipoCedula = "VentasVIC_Acompa";
        }
        let id_proyecto = 0;
        let nivel = 0;
        var id_usuario = localStorage.getItem("id_usuario");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        if (tipoCedula == "VentasVIC_SinV"){
                            app.views.main.router.navigate({name: 'datosgeneralesVIC4'});
                        }else if (tipoCedula == "VentasVIC_ConV"){
                            app.views.main.router.navigate({name: 'recorridoVIC2'});
                        }else if (tipoCedula == "VentasVIC_Acompa"){
                            app.views.main.router.navigate({name: 'recorridoVIC4'});
                        }
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarRecorridoVIC4(){
        app.views.main.router.back('/menuVentas/', {force: true, ignoreCache: true, reload: true});
    }
    function generarTablaVentas(){
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_proyecto = 0;
        let nivel = 0;
        let id_cedula = localStorage.getItem("IdCedula");
        productHandler.addVICVentas(id_cedula, foto_llegada,id_proyecto,nivel);
    }
    function guardarDcliente (){
        let id_cedula = localStorage.getItem("IdCedula");
        let id_proyecto= localStorage.getItem("IdProyecto");
        var Patiende=$('#Patiende2').val();
        var Ppuesto=$('#Ppuesto2').val();
        var Ptelefono=$('#Ptelefono2').val();
        var Pcorreo=$('#Pcorreo2').val();
        if (id_proyecto==0){
            swal("", "Favor de seleccionar un proyecto", "warning");
        }else{
            if (Patiende && Ppuesto && Ptelefono && Pcorreo){
            //console.log(actividades);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO datos_contacto(id_cedula ,id_proyecto , nombre_cliente , puesto_cliente, telefono, correo) VALUES (?,?,?,?,?,?)",
                                [id_cedula,id_proyecto,Patiende,Ppuesto,Ptelefono,Pcorreo],
                                function(tx, results){
                                //console.log("actualizados datos de evidencia");
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#Patiende').css("background-color","#ffffff");
                                $('#Ppuesto').css("background-color","#ffffff");
                                $('#Ptelefono').css("background-color","#ffffff");
                                $('#Pcorreo').css("background-color","#ffffff");
                                app.sheet.close('#sheet-modal');
                                document.getElementById('sheet-modal').style.display = 'none';
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );

            }else{
                swal("", "Todos los campos son obligatorios", "warning");
            }
        }
    }
    // Fin VIC
    //inicio Rocadi
    function buscarClienteRocadi(){
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var id_cliente = "N/A";
        var foto_llegada = $("#imagenC").val();
        var horario_programado = fecha_llegada;
        var nombre_cliente = $("#cliente-Field").val();
        var estatus = 0;
        if(foto_llegada != ''){
            if(nombre_cliente != ''){
                productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                            [],
                            function(tx, results){
                                var item = results.rows.item(0);
                                localStorage.setItem("IdCedula", item.Id);
                                localStorage.setItem("nombreCliente", nombre_cliente);
                                localStorage.setItem("foto_llegada", foto_llegada);
                                localStorage.setItem("horario_programado", horario_programado);
                                app.views.main.router.navigate({name: 'menuRocadi'});
                                app.preloader.hide();
                            },
                            function(tx, error){
                                console.log("Error al guardar cedula: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            } else {
                swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        } else {
            swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
            app.preloader.hide();
        }
    }
    function generarCheckListRocadi(){
        let id_cedula = localStorage.getItem("IdCedula");
        let nombre_cliente = localStorage.getItem("nombreCliente");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let fecha = localStorage.getItem("horario_programado");
        let tipoCedula = "Checklist";
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addCheckListRocadi(id_cedula,foto_llegada,nombre_cliente,fecha);
                        localStorage.setItem("tipoServicio",tipoCedula);
                        app.views.main.router.navigate({name: 'recorridoRocadi1'});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function regresarRecorridoRocadi(){
        app.views.main.router.back('/recorridoRocadi1/', {force: true, ignoreCache: true, reload: true});
    }
    function GuardarDatosRocadi(){
        app.preloader.show('blue');
        if($("#nombre_sitio").val() =="" || $("#fecha").val() == ""){
            swal("", "Debes llenar todos los campos" ,"warning");
            app.preloader.hide();
            return false;
        }
        var nombre_sitio = $("#nombre_sitio").val();
        var fecha = $("#fecha").val();
        var id_cedula = localStorage.getItem("IdCedula");
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_rocadi SET nombre_sitio = ?, fecha = ? WHERE id_cedula = ?",
                    [nombre_sitio,fecha,id_cedula],
                    function(tx, results){
                        $("#nombre_sitio").css("background-color", "#FFFFFF");
                        $("#fecha").css("background-color", "#FFFFFF");
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        app.preloader.hide();
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function checkStatus2(id){
        var ids = id.split("-");
        var check = ids[0];
        if(check.includes('1')){
            var valCheck = document.getElementById(check+"-"+ids[1]).checked;
            if(valCheck ==true){
                var name = check.replace('1','');
                var otherCheck = name + '0'+"-"+ids[1];
                document.getElementById(otherCheck).checked = false;
            }
        } else {
            var valCheck = document.getElementById(check+"-"+ids[1]).checked;
            if(valCheck ==true){
                var name = check.replace('0','');
                var otherCheck = name + '1'+"-"+ids[1];
                document.getElementById(otherCheck).checked = false;
            }
        }
    }
    function guardacheckRocadi(id,val){
        if($("#"+id).prop("checked")){
            var ids = id.split("-");
            var apartado = ids[1];
            var pertenece = $("#"+id).attr("name");
            var pages = pertenece.split("-");
            var page = pages[1];
            var apartados = $("#observaciones"+page).attr("name");
            var secciones =$("#observaciones"+page).attr("alt");
            if(apartados.includes("_")){
                var apartado = apartados.replaceAll('_',' ');
            }else{
                apartado = apartados;
            }
            if(secciones.includes("_")){
                var seccion = secciones.replaceAll('_',' ');
            }else{
                seccion = secciones;
            }
            if(seccion){
                var apartado_con_seccion = apartado+" - "+seccion;
            }else{
                var apartado_con_seccion = apartado;
            }

            var id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            if (val == 1){
                var motivo = 'N/A';
                guardarCheckRocadiBase(id_cedula,apartado,val,fecha_registro,apartado_con_seccion,motivo);
            }else if(val == 0){
                app.dialog.prompt("Favor de Ingresar el motivo por el cual no se esta cumpliendo", 'FIELD',function (name) {
                    if(name){
                        var motivo = name;
                        guardarCheckRocadiBase(id_cedula,apartado,val,fecha_registro,apartado_con_seccion,motivo);

                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql(
                                    "Select * from cedulas_general  WHERE id_cedula = ?",
                                    [id_cedula],
                                    function(tx, results){
                                        let length = results.rows.length;
                                        var item = results.rows.item(0);
                                        var nombre_sitio = item.nombre_cliente;
                                        var usuario = item.nombre_usuario;
                                            app.request.get('http://www.appbennetts.com/FWM2/app/EnviarFIELD_Rocadi.php', { apartado_con_seccion: apartado_con_seccion, fecha_registro: fecha_registro, nombre_sitio: nombre_sitio, usuario: usuario, motivo: motivo }, function (data) {
                                        });
                                    },
                                    function(tx, error){
                                        console.log("Error al mostar datos: " + error.message);
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }
                });
            }
        }
    }
    function guardarCheckRocadiBase(){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("SELECT * from checks_rocadi WHERE id_cedula = ? AND apartado = ? ",
                [id_cedula,apartado],
                    function(tx, results){
                        var item = results.rows.item(0);
                        if(results.rows.length == 0){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("INSERT INTO checks_rocadi(id_cedula, apartado, value, fecha_registro,page,descripcion) VALUES (?,?,?,?,?,?)",
                                        [id_cedula,apartado,val,fecha_registro,apartado_con_seccion],
                                        function(tx, results){
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){
                                }
                            );
                        } else {

                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("UPDATE checks_rocadi SET value = ?, page = ?,descripcion = ? WHERE id_cedula = ? AND apartado = ?",
                                        [val,apartado_con_seccion,motivo,id_cedula,apartado],
                                        function(tx, results){
                                        },
                                        function(tx, error){
                                            swal("Error al guardar",error.message,"error");
                                            app.preloader.hide();
                                        }
                                    );
                                },function(error){},function(){}
                            );
                        }
                    },
                    function(tx, error){
                        console.log("Error al guardar checklits: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEvidenciaRocadi2(apartado){
        var id_cedula = localStorage.getItem("IdCedula");
        var comentario = $("#observaciones"+apartado).val();
        var foto ='';
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("INSERT INTO fotos_rocadi(id_cedula,foto, observaciones ,apartado ,fecha_registro) VALUES (?,?,?,?,?)",
                    [id_cedula,foto,comentario, apartado,fecha_registro],
                    function(tx, results){
                        swal("", "Se guardaron los datos correctamente" ,"success");
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("Select * from fotos_rocadi where id_cedula = ? ORDER BY id_foto DESC",
                                [id_cedula],
                                    function(tx, results){
                                        var item = results.rows.item(0);
                                        $("#observaciones"+apartado).val("");
                                        $("#observaciones"+apartado).css("background-color","#fff");
                                        $("#tabla_evidencias").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaRocadi("+
                                            item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td>N/A</td><td style='text-align: center;'>" +
                                            item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                        $("#message-nr").css("display", "none");
                                    },
                                    function(tx, error){
                                        console.log("Error al guardar cedula: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar plaga",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guardarEvidenciaRocadi(apartado){
        var id_cedula = localStorage.getItem("IdCedula");
        var foto = $("#imagenC"+apartado).val();
        var comentario = $("#observaciones"+apartado).val();
        var fecha = new Date();
        var fecha_registro = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if(foto){
            if(comentario){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO fotos_rocadi(id_cedula,foto, observaciones ,apartado ,fecha_registro) VALUES (?,?,?,?,?)",
                                [id_cedula,foto,comentario, apartado,fecha_registro],
                                function(tx, results){
                                    swal("", "Se guardaron los datos correctamente" ,"success");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from fotos_rocadi where id_cedula = ? ORDER BY id_foto DESC",
                                            [id_cedula],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#smallImage"+apartado).attr("src","img/blank.png");
                                                    $("#observaciones"+apartado).val("");
                                                    $("#observaciones"+apartado).css("background-color","#fff");
                                                    $('#imagenC'+apartado).val("");
                                                    $("#photoIcon"+apartado).attr("src","img/camera.svg");
                                                    $("#tabla_evidencias").append("<tr id='fila"+ item.id_foto +"'><td><a href='#' onclick='eliminarFilaRocadi("+
                                                        item.id_foto +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                                        item.observaciones + "</td><td style='text-align: center;'>" + item.fecha_registro + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al guardar plaga",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
            }else{
                    swal("", "Favor de ingresar un comentario" ,"warning");
            }
        }else{
                swal("", "Favor de tomar una fotografía" ,"warning");
        }
    }
    function continuarCedRocadi(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            app.views.main.router.navigate({ name: 'recorridoRocadi1'});
        }
    }
    function capturesPhotos(photo) {
        localStorage.setItem("photo",photo);
        navigator.camera.getPicture(onPhotosSucceess, onPhotosFail, {
            quality: 50,
            destinationType: destinationType.DATA_URL,
            targetWidth: 500,
            targetHeight: 500,
            correctOrientation: true
        });
    }
    function onPhotosSucceess(imageData) {
        var photo = localStorage.getItem("photo");
        var smallImage = document.getElementById('smallImage'+photo);
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $("#imagenC"+photo).val(nameima);
        $("#photoIcon"+photo).attr("src","img/reload.svg");
    }
    function onPhotosFail(message) {
        swal("Error al tomar foto:",message,"error");
    }
    function eliminarFilaRocadi(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_rocadi WHERE id_foto = ?",
                        [index],
                        function(tx, results){
                                swal("","El registro se elimito satisfactoriamente","success");
                                $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function guardarCierreRocadi(){
        if($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("","Todos los campos son obligatorios","warning");
            return false;
        }
        if($("#eval").val() <= '2' && $("#comentario_cliente").val() == ""){
            swal("","Por favor, ingresa el motivo de tu calificacion","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var nombrefirma = $("#NombreFirma").val();
        var firmaCliente = $("#signate").val();
        var calificacion = $("#eval").val();
        var comentarioCliente = $('#comentario_cliente').val();
        var fecha = new Date();
        var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_rocadi SET firma_cliente = ?,fecha_cliente = ? WHERE id_cedula = ?",
                    [firmaCliente,fecha_firma,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET calificacion = ?,nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                                    [calificacion,nombrefirma,comentarioCliente,id_cedula],
                                    function(tx, results){
                                        swal("","Guardado correctamente","success");
                                        app.views.main.router.back('/yamevoyRocadi/', {force: true, reload: true});
                                    },
                                    function(tx, error){
                                        console.error("Error al guardar cierre: " + error.message);
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function terminarServicioRocadi(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var tipoServicio = localStorage.getItem("tipoServicio");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE datos_generales_rocadi SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    //fin rocadi
    //Inicio Ivy
    function buscarClienteIvy() {
        app.preloader.show('blue');
        // var id_usuario = localStorage.getItem("id_usuario");
        // var nombre_usuario =
        //   localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        // var fecha = new Date();
        // var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        // var geolocation = $("#geolocation").val();
        // var horario_programado = fecha_llegada;
        // var foto_llegada = $("#imagenC").val();
        // var id_cliente = $("#id_cliente").val();
        // var nombre_cliente = $("#nombre_cliente").val();
        // var nombre_comercial = $("#NombreComercial").val();
        // var nombre_contacto = $("#NombreContacto").val();
        // var telefono = $("#Telefono").val();
        // var correo = $("#Correo").val();
        // var estatus_cliente = 'Estatus';
        // var estatus = 0;
        // if (foto_llegada!=''){
        //     if (nombre_cliente!=''){
        //     productHandler.addCedulaDilimpio(id_usuario, nombre_usuario, fecha_llegada, geolocation, id_cliente, nombre_cliente, horario_programado, estatus);
        //     databaseHandler.db.transaction(
        //     function (tx) {
        //         tx.executeSql(
        //         "Select MAX(id_cedula) as Id from cedulas_general",
        //         [],
        //         function (tx, results) {
        //             var item = results.rows.item(0);
        //             localStorage.setItem("IdCedula", item.Id);
        //             localStorage.setItem("foto_llegada", foto_llegada);
        //             localStorage.setItem("id_cliente", id_cliente);
        //             localStorage.setItem("nombre_cliente", nombre_cliente);
        //             localStorage.setItem("nombre_comercial", nombre_comercial);
        //             localStorage.setItem("nombre_contacto", nombre_contacto);
        //             localStorage.setItem("telefono", telefono);
        //             localStorage.setItem("correo", correo);
        //             localStorage.setItem("estatus_cliente", estatus_cliente);

                    app.views.main.router.navigate({ name: "menuIvy" });
                    app.preloader.hide();
        //         },
        //         function (tx, error) {
        //             console.log("Error al guardar cedula: " + error.message);
        //             app.preloader.hide();
        //         }
        //         );
        //     },
        //     function (error) {},
        //     function () {}
        //     );
        //     }else{
        //         swal("", "Favor de seleccionar un Cliente" , "warning");
        //         app.preloader.hide();
        //     }
        // }else{
        //     swal("", "La foto es requerida para continuar" , "warning");
        //     app.preloader.hide();
        // }
    }
    function generarVisitaIvy(){
        // let id_cedula = localStorage.getItem("IdCedula");
        // let foto_llegada = localStorage.getItem("foto_llegada");
        // let id_cliente = localStorage.getItem("id_cliente");
        // let nombre_cliente = localStorage.getItem("nombre_cliente");
        // let nombre_contacto = localStorage.getItem("nombre_contacto");
        // let correo = localStorage.getItem("correo");
        // let estatus_cliente = localStorage.getItem("estatus_cliente");
        // let telefono = localStorage.getItem("telefono");
        // let tipoCedula = "Entregas";

        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
        //             [tipoCedula,id_cedula],
        //             function(tx, results){
        //                 productHandler.addVentasDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo, telefono);
                        app.views.main.router.back('/recorridoIvy1/', {force: true, ignoreCache: true, reload: true});
        //             },
        //             function(tx, error){
        //                 console.error("Error al actualizar el tipo de cedula: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){console.error("Error al actualizar el tipo de cedula: " + error.message);},
        //     function(){}
        // );
    }
    function generarChecklistIvy(){
        // let id_cedula = localStorage.getItem("IdCedula");
        // let foto_llegada = localStorage.getItem("foto_llegada");
        // let id_cliente = localStorage.getItem("id_cliente");
        // let nombre_cliente = localStorage.getItem("nombre_cliente");
        // let nombre_contacto = localStorage.getItem("nombre_contacto");
        // let correo = localStorage.getItem("correo");
        // let estatus_cliente = localStorage.getItem("estatus_cliente");
        // let telefono = localStorage.getItem("telefono");
        // let tipoCedula = "Entregas";

        // databaseHandler.db.transaction(
        //     function(tx){
        //         tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
        //             [tipoCedula,id_cedula],
        //             function(tx, results){
        //                 productHandler.addVentasDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo, telefono);
                        app.views.main.router.back('/recorridoIvy2/', {force: true, ignoreCache: true, reload: true});
        //             },
        //             function(tx, error){
        //                 console.error("Error al actualizar el tipo de cedula: " + error.message);
        //             }
        //         );
        //     },
        //     function(error){console.error("Error al actualizar el tipo de cedula: " + error.message);},
        //     function(){}
        // );
    }
    function regresarRecorridoIvy1(){
        app.views.main.router.back('/recorridoIvy1/', {force: true, ignoreCache: true, reload: true});
    }
    function regresarRecorridoIvy2(){
        app.views.main.router.back('/recorridoIvy2/', {force: true, ignoreCache: true, reload: true});
    }
    //Fin Ivy
    // Dilimipio Inicio
    function buscarClienteDilimpio() {
        app.preloader.show('blue');
        var id_usuario = localStorage.getItem("id_usuario");
        var nombre_usuario =
          localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
        var fecha = new Date();
        var fecha_llegada = fecha.getFullYear() + "-" + (fecha.getMonth() + 1) + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        var geolocation = $("#geolocation").val();
        var horario_programado = fecha_llegada;
        var foto_llegada = $("#imagenC").val();
        var id_cliente = $("#id_cliente").val();
        var nombre_cliente = $("#nombre_cliente").val();
        var nombre_comercial = $("#NombreComercial").val();
        var nombre_contacto = $("#NombreContacto").val();
        var telefono = $("#Telefono").val();
        var correo = $("#Correo").val();
        var estatus_cliente = 'Estatus';
        var estatus = 0;
        if (foto_llegada!=''){
            if (nombre_cliente!=''){
            productHandler.addCedulaDilimpio(id_usuario, nombre_usuario, fecha_llegada, geolocation, id_cliente, nombre_cliente, horario_programado, estatus);
            databaseHandler.db.transaction(
            function (tx) {
                tx.executeSql(
                "Select MAX(id_cedula) as Id from cedulas_general",
                [],
                function (tx, results) {
                    var item = results.rows.item(0);
                    localStorage.setItem("IdCedula", item.Id);
                    localStorage.setItem("foto_llegada", foto_llegada);
                    localStorage.setItem("id_cliente", id_cliente);
                    localStorage.setItem("nombre_cliente", nombre_cliente);
                    localStorage.setItem("nombre_comercial", nombre_comercial);
                    localStorage.setItem("nombre_contacto", nombre_contacto);
                    localStorage.setItem("telefono", telefono);
                    localStorage.setItem("correo", correo);
                    localStorage.setItem("estatus_cliente", estatus_cliente);

                    app.views.main.router.navigate({ name: "menuDilimpio" });
                    app.preloader.hide();
                },
                function (tx, error) {
                    console.log("Error al guardar cedula: " + error.message);
                    app.preloader.hide();
                }
                );
            },
            function (error) {},
            function () {}
            );
            }else{
                swal("", "Favor de seleccionar un Cliente" , "warning");
                app.preloader.hide();
            }
        }else{
            swal("", "La foto es requerida para continuar" , "warning");
            app.preloader.hide();
        }
    }
    function generarVisitaDilimpio(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_cliente = localStorage.getItem("id_cliente");
        let nombre_cliente = localStorage.getItem("nombre_cliente");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let correo = localStorage.getItem("correo");
        let estatus_cliente = localStorage.getItem("estatus_cliente");
        let telefono = localStorage.getItem("telefono");
        let id_visita = localStorage.getItem("id_visita");

        let tipoCedula = "visitaDilimpio";

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addVisitaDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo,telefono, id_visita);
                        app.views.main.router.back('/recorridoDL1/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){console.error("Error al actualizar el tipo de cedula: " + error.message);},
            function(){}
        );
    }
    function continuarCedDL(id_cedula,tipo){
        localStorage.setItem("IdCedula",id_cedula);
        localStorage.setItem("Opcion", '1');
        if(tipo == 1){
            databaseHandler.db.transaction(
                function(tx5){
                    tx5.executeSql("SELECT * FROM cedulas_general WHERE id_cedula = ?",
                        [id_cedula],
                        function(tx5, results){
                            var length = results.rows.length;
                            for(var i = 0; i< length; i++){
                                var item2 = results.rows.item(i);
                                localStorage.setItem("id_cliente", item2.id_cliente);
                            }
                        },
                        function(tx5, error){
                            console.error("Error al consultar bandeja de salida: " + error.message);
                        }
                    );
                },
            function(error){},
            function(){}
            );
            app.views.main.router.navigate({ name: 'recorridoDL1'});
        } else if(tipo == 2){
            app.views.main.router.navigate({ name: 'recorridoDL2'});
        } else if(tipo == 3){
            app.views.main.router.navigate({ name: 'recorridoDL3'});
        } else if(tipo == 4){
            app.views.main.router.navigate({ name: 'recorridoDL4'});
            localStorage.setItem("tipo_servicio", "Lavanderia");
        }else if(tipo == 5){
            app.views.main.router.navigate({ name: 'recorridoDL5'});
            localStorage.setItem("tipo_servicio", "Control");
        }else if(tipo == 6){
            app.views.main.router.navigate({ name: 'recorridoDL6'});
            localStorage.setItem("tipo_servicio", "Instalacion");
        }else if(tipo == 7){
            app.views.main.router.navigate({ name: 'recorridoDL7'});
            localStorage.setItem("tipo_servicio", "Desinstalacion");
        }else if(tipo == 8){
            app.views.main.router.navigate({ name: 'recorridoDL8'});
            localStorage.setItem("tipo_servicio", "Mantenimiento");
        }
    }

    function guardarDatosGDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let cliente = $("#cliente").val();
        let contacto = $("#nombre_contacto").val();
        let correo = $("#correo").val();
        let estatus = 'Estatus';
        let telefono = $("#telefono").val();
        if(cliente && contacto && estatus && correo && telefono){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET nombre_contacto=?, correo=?, estatus_cliente =?,telefono=? WHERE id_cedula = ?",
                        [contacto,correo,estatus,telefono,id_cedula],
                        function(tx, results){
                        //console.log("actualizados datos de evidencia");
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#cliente').css("background-color","#ffffff");
                        $('#nombre_contacto').css("background-color","#ffffff");
                        $('#correo').css("background-color","#ffffff");
                        $('#estatus_cliente').css("background-color","#ffffff");
                        $('#telefono').css("background-color","#ffffff");
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardaEquipoDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let tipoVIC = localStorage.getItem("TipoVIC");
        let equipos=$('#select-equipo').val();
        let decripcion=$('#descripcionEquipo').val();
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let motivos=$('#motivos').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
            if($("#radio1").prop("checked") == true){
                estado = "Buen Estado";
            } else if($("#radio2").prop("checked") == true){
                estado = "Mal Estado";
                    if(motivos == 0){
                        swal("", "Debes de seleccionar un motivo" , "warning");
                        return false;
                    }
            }
            if(equipos==0){
                swal("", "Debes de llenar todos los campos" , "warning");
            }else{
                if (estado && cantidad && ubicacion && comentarios && foto){
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO equiposDL(id_cedula, estado, equipo, descripcion, cantidad, ubicacion, motivo, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?,?,?)",
                                [id_cedula,estado,equipos,decripcion,cantidad,ubicacion,motivos,comentarios, foto, fecha_foto],
                                function(tx, results){
                                swal("","Se guardaron los datos correctamente", "success");
                                $('#select-equipo').val(0);
                                $('#motivos').val(0);
                                $('#motivos').css("background-color","#ffffff");
                                $('#cantidad').val('');
                                $('#cantidad').css("background-color","#ffffff");
                                $("#radio1").prop("checked", false);
                                $("#radio2").prop("checked", false);
                                $('#ubicacion').val('');
                                $('#ubicacion').css("background-color","#ffffff");
                                $("#select-equipo").css("background","#ffffff");
                                $('#comentarios').val('');
                                $('#comentarios').css("background-color","#ffffff");
                                $('#imagenC').val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg");
                                $('#motivos').css("display","block");
                                $('#spanMotivos').css("display","block");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql(
                                                "Select * from equiposDL where id_cedula = ? ORDER BY id_equipos DESC",
                                                    [id_cedula],
                                                    function(tx, results){
                                                            var item = results.rows.item(0);
                                                            let motivo="";
                                                            if (item.motivo==1){
                                                                motivo="Daño del equipo por uso normal";
                                                            }else if (item.motivo==2){
                                                                motivo="Equipo dañado por descuido";
                                                            }else if (item.motivo==3){
                                                                motivo="Mantenimieto correctivo";
                                                            }else if (item.motivo==4){
                                                                motivo="Cambio de equipos (Despachadores de Jabón, Toallero o Higiénico)";
                                                            }else if (item.motivo==5){
                                                                motivo="Envío de Rack de 10 o 20 Litros y Rack para atomizadores";
                                                            }
                                                            $("#tabla_equipoVIC").append("<tr id='fila"+ item.id_equipos +"'><td><a href='#' onclick='eliminarFilaDL("+item.id_equipos +",3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item.foto+
                                                            "' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo
                                                            + "</td><td style='text-align: center;'>" + item.descripcion
                                                            + "</td><td style='text-align: center;'>" + item.cantidad
                                                            + "</td><td style='text-align: center;'>" + item.ubicacion
                                                            + "</td><td style='text-align: center;'>" + item.estado
                                                            + "</td><td style='text-align: center;'>" + item.comentarios
                                                            + "</td><td style='text-align: center;'>" + motivo
                                                            + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");

                                                                $("#message-nr").css("display", "none");
                                                                $('.preloader').remove();
                                                                $('.infinite-scroll-preloader').remove();
                                                        },
                                                            function(tx, error){
                                                                console.log("Error: " + error.message);
                                                                app.preloader.hide();
                                                            }
                                            );
                                        },
                                            function(error){
                                                console.log("Error: " + error.message);
                                            },
                                            function(){}
                                    );
                                },
                                function(tx, error){
                                    console.error("Error al actualizar: " + error.message);
                                }
                            );
                        },
                        function(error){
                            console.error("Error: " + error.message);
                        },
                        function(){}
                    );
                }else{
                    swal("", "Debes de llenar todos los campos" , "warning");
                }
            }
    }
    function guardarEquipoDL(){
        var id_cliente = localStorage.getItem("id_cliente");
        var id_usuario = localStorage.getItem("id_usuario");
        var enviado=0;
        var agrega=0;
        let nombreEquipo=$('#nombre_equipo').val();
        let codigoEquipo = $('#codigoEquipo').val();
        if (codigoEquipo==''){
            app.dialog.alert('Ingresa un equipo válido.', 'Aviso');
        }else{
            if(nombreEquipo){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql(
                            "Select * from equiposCargadosDL where id_cliente = ? and codigo = ? ORDER BY id_equipo DESC",
                                [id_cliente, codigoEquipo],
                                function(tx, results){
                                    let length = results.rows.length;
                                        var item = results.rows.item(0);
                                        if (length!=0){
                                            console.log('existe en base');
                                            swal("","Equipo guardado correctamente", "success");
                                            app.sheet.close('#sheet-modal');
                                            $('#nombre_equipo').val('');
                                            $('#codigoEquipo').val('');
                                        }
                                        else{
                                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargadosDL(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+codigoEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                                        };
                                    },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                        );
                    },
                        function(error){
                            console.log('NO existe en base');
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("INSERT INTO equiposCargadosDL(id_cliente, codigo, descripcion, id_usuario, enviado) VALUES (?,?,?,?,?)",
                                                        [id_cliente,codigoEquipo, nombreEquipo, id_usuario, enviado],
                                                            function(tx, results){
                                                                let length = results.rows.length;
                                                                    var item = results.rows.item(0);
                                                                    $("#select-equipo").append("<option value="+codigoEquipo+">"+nombreEquipo+"</option>");
                                                                    swal("","Equipo guardado correctamente", "success");
                                                                    app.sheet.close('#sheet-modal');
                                                                    $('#nombre_equipo').val('');
                                                                    $('#codigoEquipo').val('');
                                                                },
                                                            function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            }
                                                    );
                                                },
                                                    function(error){},
                                                    function(){}
                                            );
                        },
                        function(){}
                );
            }else{
                app.dialog.alert('Debes seleccionar un proyecto.', 'Aviso');
            }
        }
    }
    function eliminarFilaDL(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM entregasDL WHERE id_entrega = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM equiposDL WHERE id_equipos = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 4) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM imagenDL WHERE id_imagen = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM entrenaDL WHERE id_entrena = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 6) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM almacenDL WHERE id_almacen = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 7) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM pedidosDL WHERE id_producto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 8) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM cobranzasDL WHERE id_entrega = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 9) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM evidencias_equipo_comision WHERE id_evidencia = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 10) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM formula_lavado WHERE id_formula = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimino satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }


    }
    function guardarImagenDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let estado='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposIV').val();
        let cantidad=$('#cantidad').val();
        let ubicacion=$('#ubicacion').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if($("#radio1").prop("checked") == true){
            estado = "Buen Estado";
        } else if($("#radio2").prop("checked") == true){
            estado = "Mal Estado";
        }
        if(tipo == 0 ){
            swal("", "Selecciona un tipo" , "warning");
        }else{
            if (estado && cantidad && ubicacion && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO imagenDL(id_cedula, tipo, estado, cantidad, ubicacion, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,estado,cantidad,ubicacion,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposIV').val(0);
                            $('#tiposIV').css("background-color","#ffffff");
                            $("#radio1").prop("checked", false);
                            $("#radio2").prop("checked", false);
                            $('#cantidad').val('');
                            $('#cantidad').css("background-color","#ffffff");
                            $('#ubicacion').val('');
                            $('#ubicacion').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from imagenDL where id_cedula = ? ORDER BY id_imagen DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                        var item = results.rows.item(0);
                                                        let tipo="";
                                                        if (item.tipo==1){
                                                            tipo="Wallchart";
                                                        }else if (item.tipo==2){
                                                            tipo="Etiqueta";
                                                        }else if (item.tipo==3){
                                                            tipo="Imagen del Cliente";
                                                        }else if (item.tipo==4){
                                                            tipo="Carpeta del Cliente";
                                                        }else if (item.tipo==5){
                                                            tipo="Concentración de Equipos";
                                                        }else if (item.tipo==6){
                                                            tipo="Envío de Etiquetas";
                                                        }else if (item.tipo==7){
                                                            tipo="Envío de FT electrónicas";
                                                        }
                                                        $("#tabla_imagen").append("<tr id='fila"+ item.id_imagen +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_imagen +",4);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + tipo
                                                                + "</td><td style='text-align: center;'>" + item.cantidad + "</td><td style='text-align: center;'>" + item.ubicacion + "</td><td style='text-align: center;'>" + item.estado + "</td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                        );
                                    },
                                        function(error){},
                                        function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    function guardaEntrenamientoDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        let tipo=$('#tiposCapaV').val();
        let pcapacita=$('#Pcapacitada').val();
        let ppuesto=$('#Ppuesto').val();
        let tema=$('#tema').val();
        let comentarios=$('#comentarios').val();
        let foto=$('#imagenC').val();
        if(tipo == 0 ){
            swal("", "Selecciona un tipo de capacitación" , "warning");
        }else{
            if (pcapacita && ppuesto && tema && comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO entrenaDL(id_cedula, tipo, persona_capacita, puesto_capacita, tema_capacita, comentarios, foto, fecha) VALUES (?,?,?,?,?,?,?,?)",
                            [id_cedula,tipo,pcapacita,ppuesto,tema,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#tiposCapaV').val(0);
                            $('#tiposCapaV').css("background-color","#ffffff");
                            $('#Pcapacitada').val('');
                            $('#Pcapacitada').css("background-color","#ffffff");
                            $('#Ppuesto').val('');
                            $('#Ppuesto').css("background-color","#ffffff");
                            $('#tema').val('');
                            $('#tema').css("background-color","#ffffff");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from entrenaDL where id_cedula = ? ORDER BY id_entrena DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                    var item = results.rows.item(0);
                                                    let tipo="";
                                                    if (item.tipo==1){
                                                        tipo="Capacitación en línea";
                                                    }else if (item.tipo==2){
                                                        tipo="Capacitación presencial";
                                                    }
                                                    $("#tabla_entrena").append("<tr id='fila"+ item.id_entrena +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_entrena +",5);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                                        tipo + "</td><td style='text-align: center;'>" +
                                                        item.persona_capacita + "</td><td style='text-align: center;'>" +
                                                        item.puesto_capacita + "</td><td style='text-align: center;'>" +
                                                        item.tema_capacita + "</td><td style='text-align: center;'>" +
                                                        item.comentarios + "</td><td style='text-align: center;'>" +
                                                        item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                        );
                                    },
                                        function(error){},
                                        function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
        }
    }
    function validaradioAlmacenDL(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            permite='Sí';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET permite_almacen = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }
    function guardaAlmacenDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto=$('#imagenC').val();
        let observaciones=$('#observaciones').val();
        let almacen='';
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        if($("#radio1").prop("checked") == true){
            almacen = "Sí";
        } else if($("#radio2").prop("checked") == true){
            almacen = "No";
        }
        if (almacen && observaciones && foto){
            databaseHandler.db.transaction(
                function(tx){//observaciones text, foto blob, fecha text)",
                    tx.executeSql("INSERT INTO almacenDL(id_cedula, observaciones, foto, fecha) VALUES (?,?,?,?)",
                        [id_cedula,observaciones, foto, fecha_foto],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#observaciones').val('');
                        $('#observaciones').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from almacenDL where id_cedula = ? ORDER BY id_almacen DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#tabla_almacen").append("<tr id='fila"+ item.id_almacen +"'><td><a href='#' onclick='eliminarFilaDL("+
                                                        item.id_almacen +",6);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" +
                                                        item.observaciones + "</td><td style='text-align: center;'>" +
                                                        item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );
                                },
                                    function(error){},
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
        }else {
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardaPedidoDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let producto=$('#Busca_producto').val();
        let codigo=$('#codigo').val();
        let descripcion=$('#descripcion').val();
        let inventario=$('#inventario').val();
        let cantidad=$('#cantidad').val();
        let comentarios=$('#comentarios').val();
        if (producto && codigo && descripcion && inventario && cantidad && comentarios){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO pedidosDL(id_cedula, codigo, producto, descripcion, inventario_dia, cantidad_solicitada, comentarios) VALUES (?,?,?,?,?,?,?)",
                        [id_cedula, codigo, producto, descripcion, inventario, cantidad, comentarios],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#Busca_producto').val('');
                        $('#Busca_producto').css("background-color","#ffffff");
                        $('#codigo').val('');
                        $('#codigo').css("background-color","#ffffff");
                        $('#descripcion').val('');
                        $('#descripcion').css("background-color","#ffffff");
                        $('#producto').val('');
                        $('#producto').css("background-color","#ffffff");
                        $('#cantidad').val('');
                        $('#cantidad').css("background-color","#ffffff");
                        $('#inventario').val('');
                        $('#inventario').css("background-color","#ffffff");
                        $('#comentarios').val('');
                        $('#comentarios').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from pedidosDL where id_cedula = ? ORDER BY id_producto DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    //producto text, codigo text, descripcion text, inventario_dia text, cantidad_solicitada integer, comentarios
                                                    $("#tabla_pedidos").append("<tr id='fila"+ item.id_producto +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_producto +",7);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" +
                                                    item.codigo + "</td><td style='text-align: center;'>" +
                                                    item.descripcion + "</td><td style='text-align: center;'>" +
                                                    item.inventario_dia + "</td><td style='text-align: center;'>" +
                                                    item.cantidad_solicitada + "</td><td style='text-align: center;'>" +
                                                    item.comentarios + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );
                                },
                                    function(error){},
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                        console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
            }else{
                swal("", "Debes de llenar todos los campos" , "warning");
            }
    }
    function guardaObservaGeneralDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let observaciones_generales=$('#observaciones_generales').val();
        if (observaciones_generales){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET observaciones_generales = ? WHERE id_cedula = ?",
                        [observaciones_generales,id_cedula],
                            function(tx, results){
                                swal("","Comentario General Guardado Correctamente", "success");
                                $('#observaciones_generales').css("background-color","#ffffff");
                            },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else{
            swal("", "Debes Colocar un Comentario General" , "warning");
        }
    }
    function cierreDL(){
        var persona_cuenta='N/A';
        var correo_cuenta='N/A';

        if ($("#NombreFirma").val() == "" || $("#signate").val() == "" || $("#eval").val() == ""){
            swal("", "Todos los campos son obligatorios", "warning");
            return false;
        }

        if ($("#radio1").prop("checked") == true){
            if ($("#persona_cuenta").val() == "" || ($("#correo_cuenta").val()== "")){
                swal("", "Agrega una persona y correo para el estado de cuenta", "warning");
                return false;
            }else{
                persona_cuenta=$("#persona_cuenta").val();
                correo_cuenta=$("#correo_cuenta").val();
            }
        }

        if ($("#radio1").prop("checked") == false && $("#radio2").prop("checked") == false){
            swal("", "Elige una opción para el estado de cuenta", "warning");
            return false;
        }

      var id_cedula = localStorage.getItem("IdCedula");
      var nombrefirma = $("#NombreFirma").val();
      var firmaCliente = $("#signate").val();
      if($("#eval").val() <= '3' && $("#comentario_cliente").val() == ""){
          swal("","Por favor, ingresa el motivo de tu calificacion","warning");
          return false;
      }
      var calificacion = $("#eval").val();
      var comentarioCliente = $('#comentario_cliente').val();
      var fecha = new Date();
      var fecha_firma =
          fecha.getFullYear() +
          "-" +
          (fecha.getMonth() + 1) +
          "-" +
          fecha.getDate() +
          " " +
          fecha.getHours() +
          ":" +
          fecha.getMinutes() +
          ":" +
          fecha.getSeconds();

      databaseHandler.db.transaction(
        function (tx) {
          tx.executeSql(
            "UPDATE visitaDilimpio SET firma_cliente = ?, persona_cuenta = ?, correo_cuenta = ? WHERE id_cedula = ?",
            [firmaCliente, persona_cuenta, correo_cuenta, id_cedula],
            function (tx, results) {
              databaseHandler.db.transaction(
                function (tx) {
                  tx.executeSql(
                    "UPDATE cedulas_general SET calificacion = ?, nombre_evalua = ?,comentario_cliente = ? WHERE id_cedula = ?",
                    [calificacion, nombrefirma, comentarioCliente, id_cedula],
                    function (tx, results) {
                      swal("", "Guardado correctamente", "success");
                      app.views.main.router.back("/yamevoyDL/", {
                        force: true,
                        ignoreCache: true,
                        reload: true,
                      });
                    },
                    function (tx, error) {
                      console.error("Error al guardar cierre: " + error.message);
                    }
                  );
                },
                function (error) {},
                function () {}
              );
            },
            function (tx, error) {
              console.error("Error al guardar cierre: " + error.message);
            }
          );
        },
        function (error) {},
        function () {}
      );
    }
    function terminarServicioDL(){
        if($('#imagenC').val() == ""){
            swal("","La fotografia es obligatoria","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var foto_salida = $('#imagenC').val();
        var fecha = new Date();
        var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var ubicacion_salida = $('#geolocation').val();
        var estatus = 1;
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE visitaDilimpio SET foto_salida  = ? WHERE id_cedula = ?",
                    [foto_salida,id_cedula],
                    function(tx, results){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida  = ?,geolocalizacion_salida = ?,estatus = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,id_cedula],
                                    function(tx, results){
                                        window.location.href = "./menu.html";
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function validaradioestadoCuentaDL(id){
        let id_cedula = localStorage.getItem("IdCedula");
        let permite='';
        if (id=="radio1"){
            $("#radio1").prop("checked", true);
            $("#radio2").prop("checked", false);
            $("#div_radios").css("display", "block");
            permite='Sí';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }else if (id=="radio2"){
            $("#radio2").prop("checked", true);
            $("#radio1").prop("checked", false);
            $("#div_radios").css("display", "none");
            permite='No';
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE visitaDilimpio SET estado_cuenta = ? WHERE id_cedula = ?",
                        [permite,id_cedula],
                            function(tx, results){
                                },
                        function(tx, error){
                            console.log("Error: " + error.message);
                            app.preloader.hide();
                        }
                    );
                },
                    function(error){
                        console.log("Error: " + error.message);
                    },
                    function(){}
            );
        }
    }
    function generarEntrgasDL(){
        console.log("Entregas");
        let id_cedula = localStorage.getItem("IdCedula");
        let foto_llegada = localStorage.getItem("foto_llegada");
        let id_cliente = localStorage.getItem("id_cliente");
        let nombre_cliente = localStorage.getItem("nombre_cliente");
        let nombre_contacto = localStorage.getItem("nombre_contacto");
        let correo = localStorage.getItem("correo");
        let estatus_cliente = localStorage.getItem("estatus_cliente");
        let telefono = localStorage.getItem("telefono");
        let tipoCedula = "Entregas";

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                    [tipoCedula,id_cedula],
                    function(tx, results){
                        productHandler.addVentasDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo, telefono);
                        app.views.main.router.back('/recorridoDL2/', {force: true, ignoreCache: true, reload: true});
                    },
                    function(tx, error){
                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                    }
                );
            },
            function(error){console.error("Error al actualizar el tipo de cedula: " + error.message);},
            function(){}
        );
    }
    function guardarDatosGDL2(){
        let id_cedula = localStorage.getItem("IdCedula");
        let cliente = $("#cliente").val();
        let contacto = $("#nombre_contacto").val();
        let correo = $("#correo").val();
        let telefono = $("#telefono").val();
        if(cliente && contacto && correo && telefono){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE DatosentregasDL SET nombre_contacto=?, correo=?, telefono =? WHERE id_cedula = ?",
                        [contacto,correo,telefono,id_cedula],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#cliente').css("background-color","#ffffff");
                        $('#nombre_contacto').css("background-color","#ffffff");
                        $('#correo').css("background-color","#ffffff");
                        $('#estatus_cliente').css("background-color","#ffffff");
                        $('#telefono').css("background-color","#ffffff");
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardarDatosGDL3(){
        if ($("#tipo_servicio").val()==0){swal("", "Debes seleccionar un tipo de servicio" , "warning");return false;}
        var id_cedula = localStorage.getItem("IdCedula");
        var cliente = $("#cliente").val();
        var contacto = $("#nombre_contacto").val();
        var telefono = $("#telefono").val();
        var direccion = $("#direccion").val();
        var puesto = $("#puesto").val();
        var ciudad = $("#Ciudad").val();
        var tipo_servicio = $("#tipo_servicio option:selected").text();
        if(cliente && contacto && telefono && direccion && puesto && ciudad){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE Datos_lavanderia SET nombre_contacto=?, telefono =?,direccion = ?,puesto = ?,ciudad = ?,tipo_servicio = ? WHERE id_cedula = ?",
                        [contacto,telefono,direccion,puesto,ciudad,tipo_servicio,id_cedula],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#cliente').css("background-color","#ffffff");
                        $('#nombre_contacto').css("background-color","#ffffff");
                        $('#correo').css("background-color","#ffffff");
                        $('#estatus_cliente').css("background-color","#ffffff");
                        $('#telefono').css("background-color","#ffffff");
                        $('#direccion').css("background-color","#ffffff");
                        $('#puesto').css("background-color","#ffffff");
                        $('#Ciudad').css("background-color","#ffffff");
                        $('#tipo_servicio').css("background-color","#ffffff");
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("", "Debes de llenar todos los campos" , "warning");
        }
    }
    function guardarEntregasDL(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto=$('#imagenC').val();
        let comentarios=$('#comentarios').val();
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        if (comentarios && foto){
            databaseHandler.db.transaction(
                function(tx){//observaciones text, foto blob, fecha text)",
                    tx.executeSql("INSERT INTO entregasDL(id_cedula, comentarios, foto_entrega, fecha) VALUES (?,?,?,?)",
                        [id_cedula,comentarios, foto, fecha_foto],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#comentarios').val('');
                        $('#comentarios').css("background-color","#ffffff");
                        $('#imagenC').val('');
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from entregasDL where id_cedula = ? ORDER BY id_entrega DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#tabla_entregas").append("<tr id='fila"+ item.id_entrega +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_entrega +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto_entrega+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                    );
                                },
                                    function(error){},
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
        }else {
            swal("", "Debes de tomar una fotografía e ingresar un comentario" , "warning");
        }
    }
    function terminarentregaDL(){
        if ($("#NombreFirma").val() == "" || $("#signate").val() == "" ){
            swal({
                title: "Aviso",
                text: "Los campos de nombre y firma estan vacíos, ¿Estas seguro que deseas continuar?",
                icon: "warning",
                buttons: true,
                dangerMode: false,
            }).then((willGoBack) => {
                if (willGoBack){
                    if ($("#NombreFirma").val() == ""){var nombrefirma = 'Sin Evidencia';}else{var nombrefirma = $("#NombreFirma").val();}
                    if ($("#signate").val() == ""){var firmaCliente = '';}else{var firmaCliente = $("#signate").val();}
                    var id_cedula = localStorage.getItem("IdCedula");
                    var fecha = new Date();
                    var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                    var ubicacion_salida = $('#geolocation').val();
                    var estatus = 1;
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ?, nombre_evalua = ? WHERE id_cedula = ?",
                                    [fecha_salida,ubicacion_salida,estatus,nombrefirma,id_cedula],
                                    function(tx, results){
                                        databaseHandler.db.transaction(
                                            function (tx) {
                                            tx.executeSql(
                                                "UPDATE DatosentregasDL SET firma_cliente = ? WHERE id_cedula = ?",
                                                [firmaCliente, id_cedula],
                                                function (tx, results) {
                                                    window.location.href = "./menu.html";
                                                },
                                                function (tx, error) {
                                                console.error("Error al guardar cierre: " + error.message);
                                                }
                                            );
                                            },
                                            function (error) {},
                                            function () {}
                                        );
                                    },
                                    function(tx, error){
                                        swal("Error al guardar",error.message,"error");
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                } else {}
            });
        }else{
            var nombrefirma = $("#NombreFirma").val();
            var firmaCliente = $("#signate").val();
            var id_cedula = localStorage.getItem("IdCedula");
            var fecha = new Date();
            var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var ubicacion_salida = $('#geolocation').val();
            var estatus = 1;
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ?, nombre_evalua = ? WHERE id_cedula = ?",
                            [fecha_salida,ubicacion_salida,estatus,nombrefirma,id_cedula],
                            function(tx, results){
                                databaseHandler.db.transaction(
                                    function (tx) {
                                    tx.executeSql(
                                        "UPDATE DatosentregasDL SET firma_cliente = ? WHERE id_cedula = ?",
                                        [firmaCliente, id_cedula],
                                        function (tx, results) {
                                            window.location.href = "./menu.html";
                                        },
                                        function (tx, error) {
                                        console.error("Error al guardar cierre: " + error.message);
                                        }
                                    );
                                    },
                                    function (error) {},
                                    function () {}
                                );
                            },
                            function(tx, error){
                                swal("Error al guardar",error.message,"error");
                            }
                        );
                    },
                    function(error){},
                    function(){}
                );
        }
    }
    function regresarDilimpio1(){
        app.views.main.router.navigate({ name: 'recorridoDL1'});
    }
    function regresarDilimpio2(){
        app.views.main.router.navigate({ name: 'recorridoDL2'});
    }
    function equiposDL(){
        app.preloader.show('blue');
        var NomDescCli = "Equipos_1DL";
        var enviado=1;
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("DELETE FROM equiposCargadosDL WHERE enviado = ?",
                    [enviado],
                    function(tx, results){
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", function (data) {
                            var content = JSON.parse(data);
                            for (var i = 0; i < content.length; i++) {
                                var id_cliente = (content[i].id_cliente);
                                var codigo=(content[i].codigo);
                                var descripcion = (content[i].descripcion);
                                productHandler.addVICEquiposDL(id_cliente,codigo,descripcion, enviado);
                            }
                            app.preloader.hide();
                        });
                    },
                    function(tx, error){
                        swal("Error al borrar equipos cargados", error.message, "error");
                        app.preloader.hide();
                    }
                    );
                },
                function(error){app.preloader.hide();},
                function(){}
            );
        }
        function startFromProgramDILIMPIO2(id_visita,id_cliente,nombre_comercial,contact_name,horario_programado,telefono,correo,tipo_servicio,LGS,O2,H2,VIBE,Odocontrol_SPRAY,despachador_higienico,despachador_toalla,dispensador_jabon,dosificador_quimico,sistema_olores,dosificador_biodigestor,dosificador_Nova,dosificador_prodose,boton_1galon,boton_4galon,dosificador_lavandaeria,trampa_grasa){
            localStorage.setItem("id_visita", id_visita);
            localStorage.setItem("id_cliente", id_cliente);
            localStorage.setItem("nombre_comercial", nombre_comercial);
            localStorage.setItem("contact_name", contact_name);
            localStorage.setItem("horario_programado", horario_programado);
            localStorage.setItem("telefono", telefono);
            localStorage.setItem("correo", correo);
            localStorage.setItem("tipo_servicio", tipo_servicio);
            localStorage.setItem("LGS", LGS);
            localStorage.setItem("O2", O2);
            localStorage.setItem("H2", H2);
            localStorage.setItem("VIBE", VIBE);
            localStorage.setItem("Odocontrol_SPRAY", Odocontrol_SPRAY);
            localStorage.setItem("despachador_higienico", despachador_higienico);
            localStorage.setItem("despachador_toalla", despachador_toalla);
            localStorage.setItem("dispensador_jabon", dispensador_jabon);
            localStorage.setItem("dosificador_quimico", dosificador_quimico);
            localStorage.setItem("sistema_olores", sistema_olores);
            localStorage.setItem("dosificador_biodigestor", dosificador_biodigestor);
            localStorage.setItem("dosificador_Nova", dosificador_Nova);
            localStorage.setItem("dosificador_prodose", dosificador_prodose);
            localStorage.setItem("boton_1galon", boton_1galon);
            localStorage.setItem("boton_4galon", boton_4galon);
            localStorage.setItem("dosificador_lavandaeria", dosificador_lavandaeria);
            localStorage.setItem("trampa_grasa", trampa_grasa);
            app.views.main.router.navigate({name: 'yallegueDilimpio2'});
        }
        function startFromProgramDILIMPIO(id_visita,id_cliente,nombre_comercial,contact_name,horario_programado,telefono,correo,tipo_servicio){
            localStorage.setItem("id_visita", id_visita);
            localStorage.setItem("id_cliente", id_cliente);
            localStorage.setItem("nombre_comercial", nombre_comercial);
            localStorage.setItem("contact_name", contact_name);
            localStorage.setItem("horario_programado", horario_programado);
            localStorage.setItem("telefono", telefono);
            localStorage.setItem("correo", correo);
            localStorage.setItem("tipo_servicio", tipo_servicio);
            app.views.main.router.navigate({name: 'yallegueDilimpio2'});
        }
        function iniciarClienteDilimpio(){
            var id_usuario = localStorage.getItem("id_usuario");
            var nombre_usuario = localStorage.getItem("nombre") + " " + localStorage.getItem("apellido_paterno");
            var fecha = new Date();
            var fecha_llegada = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var geolocation = $("#geolocation").val();
            var id_cliente = localStorage.getItem("id_cliente");
            var horario_programado = localStorage.getItem("horario_programado");;
            var foto_llegada = $("#imagenC").val();
            var nombre_cliente = localStorage.getItem("nombre_comercial");
            var tipo = localStorage.getItem("tipo_servicio");
            var nombre_contacto = localStorage.getItem("contact_name");
            var telefono = localStorage.getItem("telefono");
            var correo = localStorage.getItem("correo");
            var id_visita = localStorage.getItem("id_visita");
            if(tipo == "visitaDilimpio"){
                var tipoCedula = "visitaDilimpio";
            } else if(tipo == "Entregas"){
                var tipoCedula = "Entregas";
            } else if(tipo == "Cobranza"){
                var tipoCedula = "Cobranza";
            }else{
                var tipoCedula = tipo;
            }
            var estatus = 0
            if(foto_llegada != ''){
                if(nombre_cliente != ''){
                    productHandler.addCedulayb(id_usuario,nombre_usuario,fecha_llegada,geolocation,id_cliente,nombre_cliente,horario_programado,estatus);
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("Select MAX(id_cedula) as Id from cedulas_general",
                                [],
                                function(tx, results){
                                    var item = results.rows.item(0);
                                    var id_cedula = item.Id;
                                    localStorage.setItem("IdCedula", item.Id);
                                    if(tipo == "visitaDilimpio"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                    [tipoCedula,id_cedula],
                                                    function(tx, results){
                                                        productHandler.addVisitaDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                        app.views.main.router.back('/recorridoDL1/', {force: true, ignoreCache: true, reload: true});
                                                    },
                                                    function(tx, error){
                                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    } else if(tipo == "Entregas"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                    [tipoCedula,id_cedula],
                                                    function(tx, results){
                                                        productHandler.addVentasDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                        app.views.main.router.back('/recorridoDL2/', {force: true, ignoreCache: true, reload: true});
                                                    },
                                                    function(tx, error){
                                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    } else if(tipo == "Cobranza"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                    [tipoCedula,id_cedula],
                                                    function(tx, results){
                                                        productHandler.addCobranzaDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo, telefono);
                                                        app.views.main.router.back('/recorridoDL3/', {force: true, ignoreCache: true, reload: true});
                                                    },
                                                    function(tx, error){
                                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    } else if(tipo == "Lavanderia"){
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                    [tipoCedula,id_cedula],
                                                    function(tx, results){
                                                        productHandler.addDatosLavanderia(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo, telefono);
                                                        app.views.main.router.back('/recorridoDL4/', {force: true, ignoreCache: true, reload: true});
                                                    },
                                                    function(tx, error){
                                                        console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    } else {
                                        var LGS = localStorage.getItem("LGS");
                                        var O2 = localStorage.getItem("O2");
                                        var H2 = localStorage.getItem("H2");
                                        var VIBE = localStorage.getItem("VIBE");
                                        var Odocontrol_SPRAY = localStorage.getItem("Odocontrol_SPRAY");
                                        var despachador_higienico = localStorage.getItem("despachador_higienico");
                                        var despachador_toalla = localStorage.getItem("despachador_toalla");
                                        var dispensador_jabon = localStorage.getItem("dispensador_jabon");
                                        var dosificador_quimico = localStorage.getItem("dosificador_quimico");
                                        var sistema_olores = localStorage.getItem("sistema_olores");
                                        var dosificador_biodigestor = localStorage.getItem("dosificador_biodigestor");
                                        var dosificador_Nova = localStorage.getItem("dosificador_Nova");
                                        var dosificador_prodose = localStorage.getItem("dosificador_prodose");
                                        var boton_1galon = localStorage.getItem("boton_1galon");
                                        var boton_4galon = localStorage.getItem("boton_4galon");
                                        var dosificador_lavandaeria = localStorage.getItem("dosificador_lavandaeria");
                                        var trampa_grasa = localStorage.getItem("trampa_grasa");
                                        if(tipo == "Control"){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                        [tipoCedula,id_cedula],
                                                        function(tx, results){
                                                            productHandler.addVentasDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                            if(LGS == 0 || LGS == ''){}else{
                                                                var tipo2= 'LGS';
                                                                productHandler.addControl(id_cedula,LGS,tipo,tipo2);
                                                            }
                                                            if(O2 == 0 || O2 == ''){}else{
                                                                var tipo2= 'O2';
                                                                productHandler.addControl(id_cedula,O2,tipo,tipo2);
                                                            }
                                                            if(H2 == 0 || H2 == ''){}else{
                                                                var tipo2= 'H2';
                                                                productHandler.addControl(id_cedula,H2,tipo,tipo2);
                                                            }
                                                            if(VIBE == 0 || VIBE == ''){}else{
                                                                var tipo2= 'VIBE';
                                                                productHandler.addControl(id_cedula,VIBE,tipo,tipo2);
                                                            }
                                                            if(Odocontrol_SPRAY == 0 || Odocontrol_SPRAY == ''){}else{
                                                                var tipo2= 'Odocontrol';
                                                                productHandler.addControl(id_cedula,Odocontrol_SPRAY,tipo,tipo2);
                                                            }
                                                            app.views.main.router.back('/recorridoDL5/', {force: true, ignoreCache: true, reload: true});
                                                        },
                                                        function(tx, error){
                                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        } else if(tipo == "Instalacion"){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                        [tipoCedula,id_cedula],
                                                        function(tx, results){
                                                            productHandler.addVentasDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                            if(despachador_higienico == 0 || despachador_higienico == ''){}else{
                                                                var tipo2= 'Despachador higiénico';
                                                                productHandler.addControl(id_cedula,despachador_higienico,tipo,tipo2);
                                                            }
                                                            if(despachador_toalla == 0 || despachador_toalla == ''){}else{
                                                                var tipo2= 'Despachador toalla';
                                                                productHandler.addControl(id_cedula,despachador_toalla,tipo,tipo2);
                                                            }
                                                            if(dispensador_jabon == 0 || dispensador_jabon == ''){}else{
                                                                var tipo2= 'Dispensador jabón';
                                                                productHandler.addControl(id_cedula,dispensador_jabon,tipo,tipo2);
                                                            }
                                                            if(dosificador_quimico == 0 || dosificador_quimico == ''){}else{
                                                                var tipo2= 'Dosificador químico';
                                                                productHandler.addControl(id_cedula,dosificador_quimico,tipo,tipo2);
                                                            }
                                                            if(sistema_olores == 0 || sistema_olores == ''){}else{
                                                                var tipo2= 'Sistema de Control de olores';
                                                                productHandler.addControl(id_cedula,sistema_olores,tipo,tipo2);
                                                            }
                                                            app.views.main.router.back('/recorridoDL6/', {force: true, ignoreCache: true, reload: true});
                                                        },
                                                        function(tx, error){
                                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        } else if(tipo == "Desinstalacion"){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                        [tipoCedula,id_cedula],
                                                        function(tx, results){
                                                            productHandler.addVentasDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                            if(despachador_higienico == 0 || despachador_higienico == ''){}else{
                                                                var tipo2= 'Despachador higiénico';
                                                                productHandler.addControl(id_cedula,despachador_higienico,tipo,tipo2);
                                                            }
                                                            if(despachador_toalla == 0 || despachador_toalla == ''){}else{
                                                                var tipo2= 'Despachador toalla';
                                                                productHandler.addControl(id_cedula,despachador_toalla,tipo,tipo2);
                                                            }
                                                            if(dispensador_jabon == 0 || dispensador_jabon == ''){}else{
                                                                var tipo2= 'Dispensador jabón';
                                                                productHandler.addControl(id_cedula,dispensador_jabon,tipo,tipo2);
                                                            }
                                                            if(dosificador_quimico == 0 || dosificador_quimico == ''){}else{
                                                                var tipo2= 'Dosificador químico';
                                                                productHandler.addControl(id_cedula,dosificador_quimico,tipo,tipo2);
                                                            }
                                                            if(sistema_olores == 0 || sistema_olores == ''){}else{
                                                                var tipo2= 'Sistema de Control de olores';
                                                                productHandler.addControl(id_cedula,sistema_olores,tipo,tipo2);
                                                            }
                                                            app.views.main.router.back('/recorridoDL7/', {force: true, ignoreCache: true, reload: true});
                                                        },
                                                        function(tx, error){
                                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        } else if(tipo == "Mantenimiento"){
                                            databaseHandler.db.transaction(
                                                function(tx){
                                                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ? WHERE id_cedula = ?",
                                                        [tipoCedula,id_cedula],
                                                        function(tx, results){
                                                            productHandler.addVentasDL(id_cedula,foto_llegada,id_cliente,nombre_cliente,nombre_contacto,correo,telefono,id_visita);
                                                            if(dosificador_biodigestor == 0 || dosificador_biodigestor == ''){}else{
                                                                var tipo2= 'Dosificador biodigestor';
                                                                productHandler.addControl(id_cedula,dosificador_biodigestor,tipo,tipo2);
                                                            }
                                                            if(dosificador_Nova == 0 || dosificador_Nova == ''){}else{
                                                                var tipo2= 'Dosificador Nova';
                                                                productHandler.addControl(id_cedula,dosificador_Nova,tipo,tipo2);
                                                            }
                                                            if(dosificador_prodose == 0 || dosificador_prodose == ''){}else{
                                                                var tipo2= 'Dosificador PRODOSE';
                                                                productHandler.addControl(id_cedula,dosificador_prodose,tipo,tipo2);
                                                            }
                                                            if(boton_1galon == 0 || boton_1galon == ''){}else{
                                                                var tipo2= 'Dosificador 1 botón 1 galón SEKO';
                                                                productHandler.addControl(id_cedula,boton_1galon,tipo,tipo2);
                                                            }
                                                            if(boton_4galon == 0 || boton_4galon == ''){}else{
                                                                var tipo2= 'Dosificador 4 botones 1 galón SEKO';
                                                                productHandler.addControl(id_cedula,boton_4galon,tipo,tipo2);
                                                            }
                                                            if(dosificador_lavandaeria == 0 || dosificador_lavandaeria == ''){}else{
                                                                var tipo2= 'Dosificador Lavanderia';
                                                                productHandler.addControl(id_cedula,dosificador_lavandaeria,tipo,tipo2);
                                                            }
                                                            if(trampa_grasa == 0 || trampa_grasa == ''){}else{
                                                                var tipo2= 'Dosificador para trampa de grasa';
                                                                productHandler.addControl(id_cedula,trampa_grasa,tipo,tipo2);
                                                            }
                                                            app.views.main.router.back('/recorridoDL8/', {force: true, ignoreCache: true, reload: true});
                                                        },
                                                        function(tx, error){
                                                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                                                        }
                                                    );
                                                },
                                                function(error){},
                                                function(){}
                                            );
                                        }
                                        app.preloader.hide();
                                    }
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    swal("Falta un campo", "El nombre del cliente es requerida para este proceso" ,"warning");
                    app.preloader.hide();
                }
            } else {
                swal("Falta un campo", "La fotografía es requerida para este proceso" ,"warning");
                app.preloader.hide();
            }
        }
        function guardaObservaGeneralDL2(){
            let id_cedula = localStorage.getItem("IdCedula");
            let observaciones_generales=$('#observaciones_generales').val();
            if (observaciones_generales){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("UPDATE DatosentregasDL SET observaciones_generales = ? WHERE id_cedula = ?",
                            [observaciones_generales,id_cedula],
                                function(tx, results){
                                    swal("","Comentario General Guardado Correctamente", "success");
                                    $('#observaciones_generales').css("background-color","#ffffff");
                                },
                            function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){
                            console.log("Error: " + error.message);
                        },
                        function(){}
                );
            }else{
                swal("", "Debes Colocar un Comentario General" , "warning");
            }
        }
        function generarCobranzaDL(){
            let id_cedula = localStorage.getItem("IdCedula");
            let foto_llegada = localStorage.getItem("foto_llegada");
            let id_cliente = localStorage.getItem("id_cliente");
            let nombre_cliente = localStorage.getItem("nombre_cliente");
            let nombre_contacto = localStorage.getItem("nombre_contacto");
            let correo = localStorage.getItem("correo");
            let estatus_cliente = localStorage.getItem("estatus_cliente");
            let telefono = localStorage.getItem("telefono");
            let tipoCedula = "Cobranza";

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE cedulas_general SET tipo_cedula = ?  WHERE id_cedula = ?",
                        [tipoCedula,id_cedula],
                        function(tx, results){
                            productHandler.addCobranzaDL(id_cedula, foto_llegada, id_cliente, nombre_cliente, nombre_contacto, correo, telefono);
                            app.views.main.router.back('/recorridoDL3/', {force: true, ignoreCache: true, reload: true});
                        },
                        function(tx, error){
                            console.error("Error al actualizar el tipo de cedula: " + error.message);
                        }
                    );
                },
                function(error){console.error("Error al actualizar el tipo de cedula: " + error.message);},
                function(){}
            );
        }
    function guardarEntregasDL2(){
            let id_cedula = localStorage.getItem("IdCedula");
            let foto=$('#imagenC').val();
            let comentarios=$('#comentarios').val();
            var fecha = new Date();
            var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

            if (comentarios && foto){
                databaseHandler.db.transaction(
                    function(tx){//observaciones text, foto blob, fecha text)",
                        tx.executeSql("INSERT INTO cobranzasDL(id_cedula, comentarios, foto_entrega, fecha) VALUES (?,?,?,?)",
                            [id_cedula,comentarios, foto, fecha_foto],
                            function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            $('#razon_fac').css("background-color","#ffffff");
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from cobranzasDL where id_cedula = ? ORDER BY id_entrega DESC",
                                                [id_cedula],
                                                function(tx, results){
                                                        var item = results.rows.item(0);
                                                        $("#tabla_entregas").append("<tr id='fila"+ item.id_entrega +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_entrega +",8);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto_entrega+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                        );
                                    },
                                        function(error){},
                                        function(){}
                                );
                            },
                            function(tx, error){
                                console.error("Error al actualizar: " + error.message);
                            }
                        );
                    },
                    function(error){
                        console.error("Error al actualizar: " + error.message);
                    },
                    function(){}
                );
            }else {
                swal("", "Debes de tomar una fotografía e ingresar un comentario" , "warning");
            }
        }
        function terminarentregaDL2(){
            if ($("#NombreFirma").val() == "" || $("#signate").val() == "" ){
                swal("","Todos los campos son obligatorios para poder terminar","warning");
            }else{
                var nombrefirma = $("#NombreFirma").val();
                var firmaCliente = $("#signate").val();
                var id_cedula = localStorage.getItem("IdCedula");
                var fecha = new Date();
                var fecha_salida = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                var ubicacion_salida = $('#geolocation').val();
                var estatus = 1;
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE cedulas_general SET fecha_salida = ?,geolocalizacion_salida = ?,estatus = ?, nombre_evalua = ? WHERE id_cedula = ?",
                                [fecha_salida,ubicacion_salida,estatus,nombrefirma,id_cedula],
                                function(tx, results){
                                    databaseHandler.db.transaction(
                                        function (tx) {
                                        tx.executeSql(
                                            "UPDATE DatoscobranzasDL SET firma_cliente = ? WHERE id_cedula = ?",
                                            [firmaCliente, id_cedula],
                                            function (tx, results) {
                                                window.location.href = "./menu.html";
                                            },
                                            function (tx, error) {
                                            console.error("Error al guardar cierre: " + error.message);
                                            }
                                        );
                                        },
                                        function (error) {},
                                        function () {}
                                    );
                                },
                                function(tx, error){
                                    swal("Error al guardar",error.message,"error");
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
            }
        }
    function checkAndSaveDL(id,valor,parte){
            var id_cedula = localStorage.getItem("IdCedula");
            var currentId = id.split("-");
            if (parte==1){
                if(id.includes("1")){
                    if($("#"+id).prop("checked") == true){
                        $("#"+currentId[0]+"-2").prop("checked", false);
                        valor = "1";
                    }
                    if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-2").prop("checked") == false){
                        valor = "0";
                    }
                } else {
                    if($("#"+id).prop("checked") == true){
                        $("#"+currentId[0]+"-1").prop("checked", false);
                        valor = "0";
                    }
                    if($("#"+id).prop("checked") == false && $("#"+currentId[0]+"-1").prop("checked") == false){
                        valor = "0";
                    }
                }
            }
            savecheckDL()
        }
        function savecheckDL(){
            var id_cedula = localStorage.getItem("IdCedula");
            if($("#extraccion-2").prop("checked") == true){
                var valor = 2;
                var porque = $("#razon_fac").val();
            }else if($("#extraccion-1").prop("checked") == true){
                var valor = 1;
                var porque = $("#razon_fac").val();
            }
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE DatoscobranzasDL SET cobro = ?, porque_cobro = ? WHERE id_cedula = ?",
                        [valor,porque, id_cedula],
                        function(tx, results){
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                            app.preloader.hide();
                        }
                    );
                },function(error){},function(){}
            );
        }
        function regresarDilimpio3(form){
            var id_cedula = localStorage.getItem("IdCedula");
            if (form == 1){
                app.views.main.router.navigate({ name: 'recorridoDL3'});
            }else if(form == 2){
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql(
                            "Select cobro, porque_cobro from DatoscobranzasDL WHERE id_cedula = ?",
                                [id_cedula],
                                function(tx, results){
                                    let length = results.rows.length;
                                    var item = results.rows.item(0);
                                    if(item.cobro=='0' || item.cobro==undefined){
                                        swal("","Favor de indicar si se cobro la factura.","warning");
                                    }else{
                                        if(item.porque_cobro == undefined || item.porque_cobro == ''){
                                            swal("","Favor de indicar los comentarios de la entrega de la factura.","warning");
                                        }else{
                                            app.views.main.router.navigate({ name: 'recorridoDL3'});
                                        }
                                    }
                            },function(tx, error){
                                console.log("Error: " + error.message);
                                app.preloader.hide();
                            }
                        );
                    },
                        function(error){},
                        function(){}
                );
            }
        }
        function cobranzaRutaDL(){
            app.views.main.router.back('/cobranzaDL/', {force: true, ignoreCache: true, reload: true});
        }
    function regresarDilimpio(){
        var tipo_servicio = localStorage.getItem("tipo_servicio");
        if(tipo_servicio == 'Control'){
            app.views.main.router.back('/recorridoDL5/', {force: true, ignoreCache: true, reload: true});
        }else if(tipo_servicio == 'Instalacion'){
            app.views.main.router.back('/recorridoDL6/', {force: true, ignoreCache: true, reload: true});
        }else if(tipo_servicio == 'Desinstalacion'){
            app.views.main.router.back('/recorridoDL7/', {force: true, ignoreCache: true, reload: true});
        }else if(tipo_servicio == 'Mantenimiento'){
            app.views.main.router.back('/recorridoDL8/', {force: true, ignoreCache: true, reload: true});
        } else if(tipo_servicio == 'Lavanderia'){
            app.views.main.router.back('/recorridoDL4/', {force: true, ignoreCache: true, reload: true});
        }
    }
    function guardarOloresDL(modulo){
        if(modulo){
            if(modulo == 3){
                if ($("#equipos").val() == '0'){
                    swal("","Favor de seleccionar un equipo a tomar evidencia","warning");
                    return false;
                }
                var id_cedula = localStorage.getItem("IdCedula");
                var equipos = $("#equipos option:selected").text();
                var cantidad = $("#cantidad").val();
                var foto=$('#imagenC').val();
                var comentarios=$('#comentarios').val();
                var fecha = new Date();
                var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                var fase = 3;
                if(foto){
                    if(comentarios){}else{comentarios='Sin comentarios';}
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO evidencias_equipo_comision(id_cedula,foto,equipo,fecha,comentarios,fase) VALUES (?,?,?,?,?,?)",
                                [id_cedula,foto,equipos,fecha_foto,comentarios,fase],
                                function(tx, results){
                                    $("#equipos").val(0);
                                    $("#cantidad").css("background-color","#ffffff");
                                    $("#cantidad").val('');
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg")
                                    $('#comentarios').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    swal("","Se guardaron los datos correctamente", "success");
                                    var id_cedula = localStorage.getItem("IdCedula");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql(
                                                "Select * from evidencias_equipo_comision where id_cedula = ? AND fase = 3 ORDER BY id_evidencia desc",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        let length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                            $("#tabla_entregas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo + "</td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                            );
                                        },
                                            function(error){  console.log("Error: " + error.message);},
                                            function(error){  console.log("Error: " + error.message);}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                            );
                        },function(error){
                            console.log("Error: " + error.message);
                        },function(error){
                            console.log("Error: " + error.message);
                        }
                    );
                }else{
                    swal("","La foto es obligatoria para poder guardar","warning");
                }
            }else if(modulo == 4){
                if ($("#equipos").val() == '0'){
                    swal("","Favor de seleccionar un equipo a tomar evidencia","warning");
                    return false;
                }
                var id_cedula = localStorage.getItem("IdCedula");
                var equipos = $("#equipos option:selected").text();
                var cantidad = $("#cantidad").val();
                var foto=$('#imagenC').val();
                var comentarios=$('#comentarios').val();
                var fecha = new Date();
                var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                var fase = 4;
                if(foto){
                    if(comentarios){}else{comentarios='Sin comentarios';}
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO evidencias_equipo_comision(id_cedula,foto,equipo,fecha,comentarios,fase) VALUES (?,?,?,?,?,?)",
                                [id_cedula,foto,equipos,fecha_foto,comentarios,fase],
                                function(tx, results){
                                    $("#equipos").val(0);
                                    $("#cantidad").css("background-color","#ffffff");
                                    $("#cantidad").val('');
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg")
                                    $('#comentarios').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    swal("","Se guardaron los datos correctamente", "success");
                                    var id_cedula = localStorage.getItem("IdCedula");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql(
                                                "Select * from evidencias_equipo_comision where id_cedula = ? AND fase = 4 ORDER BY id_evidencia desc",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        let length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                            $("#tabla_entregas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo + "</td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                            );
                                        },
                                            function(error){  console.log("Error: " + error.message);},
                                            function(error){  console.log("Error: " + error.message);}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                            );
                        },function(error){
                            console.log("Error: " + error.message);
                        },function(error){
                            console.log("Error: " + error.message);
                        }
                    );
                }else{
                    swal("","La foto es obligatoria para poder guardar","warning");
                }
            }else if(modulo == 5){
                if ($("#equipos").val() == '0'){
                    swal("","Favor de seleccionar un equipo a tomar evidencia","warning");
                    return false;
                }
                if ($("#condiciones_equipo").val() == '0'){
                    swal("","Favor de seleccionar las condiciones del equipo","warning");
                    return false;
                }
                var id_cedula = localStorage.getItem("IdCedula");
                var equipos = $("#equipos option:selected").text();
                var condiciones_equipo = $("#condiciones_equipo option:selected").text();
                var cantidad = $("#cantidad").val();
                var foto=$('#imagenC').val();
                var comentarios=$('#comentarios').val();
                var fecha = new Date();
                var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
                var fase = 5;
                if(foto){
                    if(comentarios){}else{comentarios='Sin comentarios';}
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("INSERT INTO evidencias_equipo_comision(id_cedula,foto,equipo,fecha,comentarios,fase,condiciones_equipo) VALUES (?,?,?,?,?,?,?)",
                                [id_cedula,foto,equipos,fecha_foto,comentarios,fase,condiciones_equipo],
                                function(tx, results){
                                    $("#equipos").val(0);
                                    $("#condiciones_equipo").val(0);
                                    $("#cantidad").css("background-color","#ffffff");
                                    $("#cantidad").val('');
                                    $('#imagenC').val('');
                                    $("#smallImage").attr("src","img/blank.png");
                                    $("#photoIcon").attr("src","img/camera.svg")
                                    $('#comentarios').val('');
                                    $('#comentarios').css("background-color","#ffffff");
                                    swal("","Se guardaron los datos correctamente", "success");
                                    var id_cedula = localStorage.getItem("IdCedula");
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql(
                                                "Select * from evidencias_equipo_comision where id_cedula = ? AND fase = 5 ORDER BY id_evidencia desc",
                                                    [id_cedula],
                                                    function(tx, results){
                                                        let length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                            $("#tabla_entregas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                            item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo + "</td><td style='text-align: center;'>" + item.condiciones_equipo + "</td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                            $("#message-nr").css("display", "none");
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                    },
                                                        function(tx, error){
                                                            console.log("Error: " + error.message);
                                                            app.preloader.hide();
                                                            $('.preloader').remove();
                                                            $('.infinite-scroll-preloader').remove();
                                                        }
                                            );
                                        },
                                            function(error){  console.log("Error: " + error.message);},
                                            function(error){  console.log("Error: " + error.message);}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error: " + error.message);
                                }
                            );
                        },function(error){
                            console.log("Error: " + error.message);
                        },function(error){
                            console.log("Error: " + error.message);
                        }
                    );
                }else{
                    swal("","La foto es obligatoria para poder guardar","warning");
                }
            }
        }else{
            if ($("#equipos").val() == '0'){
                swal("","Favor de seleccionar un equipo a tomar evidencia","warning");
                return false;
            }
            var id_cedula = localStorage.getItem("IdCedula");
            var equipos = $("#equipos option:selected").text();
            var cantidad = $("#cantidad").val();
            var foto=$('#imagenC').val();
            var comentarios=$('#comentarios').val();
            var fecha = new Date();
            var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var fase = 1;
            if(foto){
                if(comentarios){}else{comentarios='Sin comentarios';}
                databaseHandler.db.transaction(
                    function(tx){
                        tx.executeSql("INSERT INTO evidencias_equipo_comision(id_cedula,foto,equipo,fecha,comentarios,fase) VALUES (?,?,?,?,?,?)",
                            [id_cedula,foto,equipos,fecha_foto,comentarios,fase],
                            function(tx, results){
                                $("#equipos").val(0);
                                $("#cantidad").css("background-color","#ffffff");
                                $("#cantidad").val('');
                                $('#imagenC').val('');
                                $("#smallImage").attr("src","img/blank.png");
                                $("#photoIcon").attr("src","img/camera.svg")
                                $('#comentarios').val('');
                                $('#comentarios').css("background-color","#ffffff");
                                swal("","Se guardaron los datos correctamente", "success");
                                var id_cedula = localStorage.getItem("IdCedula");
                                databaseHandler.db.transaction(
                                    function(tx){
                                        tx.executeSql(
                                            "Select * from evidencias_equipo_comision where id_cedula = ? AND fase = 1 ORDER BY id_evidencia desc",
                                                [id_cedula],
                                                function(tx, results){
                                                    let length = results.rows.length;
                                                    var item = results.rows.item(0);
                                                        $("#tabla_entregas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo + "</td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                                    function(tx, error){
                                                        console.log("Error: " + error.message);
                                                        app.preloader.hide();
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                    }
                                        );
                                    },
                                        function(error){  console.log("Error: " + error.message);},
                                        function(error){  console.log("Error: " + error.message);}
                                );
                            },
                            function(tx, error){
                                console.log("Error: " + error.message);
                            }
                        );
                    },function(error){
                        console.log("Error: " + error.message);
                    },function(error){
                        console.log("Error: " + error.message);
                    }
                );
            }else{
                swal("","La foto es obligatoria para poder guardar","warning");
            }
        }
    }
    function guardarOloresDL2(){
        if ($("#banio").val() == '0'){
            swal("","Favor de seleccionar un baño a tomar evidencia","warning");
            return false;
        }
        var id_cedula = localStorage.getItem("IdCedula");
        var equipos = $("#banio option:selected").text();
        var cantidad = $("#cantidad").val();
        var foto=$('#imagenC').val();
        var comentarios=$('#comentarios').val();
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
        var fase = 2
        if(cantidad){}else{
            swal("","Favor de ingresar la cantidad de baños","warning");
            return false;
        }
        if(foto){
            if(comentarios){}else{comentarios='Sin comentarios';}
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO evidencias_equipo_comision(id_cedula,foto,equipo,fecha,comentarios,fase) VALUES (?,?,?,?,?,?)",
                        [id_cedula,foto,equipos,fecha_foto,comentarios,fase],
                        function(tx, results){
                            $("#banio").val(0);
                            $("#cantidad").css("background-color","#ffffff");
                            $("#cantidad").val('');
                            $('#imagenC').val('');
                            $("#smallImage").attr("src","img/blank.png");
                            $("#photoIcon").attr("src","img/camera.svg")
                            $('#comentarios').val('');
                            $('#comentarios').css("background-color","#ffffff");
                            swal("","Se guardaron los datos correctamente", "success");
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from evidencias_equipo_comision where id_cedula = ? AND fase = 2 ORDER BY id_evidencia desc",
                                            [id_cedula],
                                            function(tx, results){
                                                let length = results.rows.length;
                                                var item = results.rows.item(0);
                                                    $("#tabla_entregas").append("<tr id='fila"+ item.id_evidencia +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_evidencia +",1);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                    item.foto+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.equipo + "</td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                    $("#message-nr").css("display", "none");
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                            },
                                                function(tx, error){
                                                    console.log("Error: " + error.message);
                                                    app.preloader.hide();
                                                    $('.preloader').remove();
                                                    $('.infinite-scroll-preloader').remove();
                                                }
                                    );
                                },
                                    function(error){},
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.log("Error: " + error.message);
                        }
                    );
                },function(error){
                    console.log("Error: " + error.message);
                },function(error){
                    console.log("Error: " + error.message);
                }
            );
        }else{
            swal("","La foto es obligatoria para poder guardar","warning");
        }
    }
    function CheckCantidadDL(val){
        value = val.split("._.");
        $("#cantidad").val(value[1]);
    }
    function guardarlavodoDL(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var apariencia = $("#apariencia").val();
            var rango = $("#rango").val();
            var olor = $("#olor").val();
            var estatico = $("#estatico").val();
            var suavidad = $("#suavidad").val();
            var remocion_mancha = $("#remocion_mancha").val();
            var hierro = $("#hierro").val();
            var cloro = $("#cloro").val();
            var pH = $("#pH").val();
            var efecto_cebra = $("#efecto_cebra").val();
            var efecto_piling = $("#efecto_piling").val();
            var temperatura = $("#temperatura").val();
            var niveles_agua = $("#niveles_agua").val();
            var extraccion = $("#extraccion").val();
            var drenajes = $("#drenajes").val();
            var rotacion = $("#rotacion").val();
            var incrustacion = $("#incrustacion").val();
            var manual_auto = $("#manual_auto").val();
            var capacidad_lavadora = $("#capacidad_lavadora").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_lavanderia SET apariencia = ?, rango = ?, olor = ?, estatico = ?, suavidad = ?, remocion_mancha = ?, hierro = ?, cloro = ?, pH = ?, efecto_cebra = ?, efecto_piling = ?, temperatura = ?, niveles_agua = ?, extraccion = ?, drenajes = ?, rotacion = ?, incrustacion = ?, manual_auto = ?, capacidad_lavadora = ? WHERE id_cedula = ?",
                        [apariencia, rango, olor, estatico, suavidad, remocion_mancha, hierro, cloro, pH, efecto_cebra, efecto_piling, temperatura, niveles_agua, extraccion, drenajes, rotacion, incrustacion, manual_auto, capacidad_lavadora,id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#potencia").css("background-color", "#FFFFFF");
                            $("#apariencia").css("background-color", "#ffffff");
                            $("#rango").css("background-color", "#ffffff");
                            $("#olor").css("background-color", "#ffffff");
                            $("#estatico").css("background-color", "#ffffff");
                            $("#suavidad").css("background-color", "#ffffff");
                            $("#remocion_mancha").css("background-color", "#ffffff");
                            $("#hierro").css("background-color", "#ffffff");
                            $("#cloro").css("background-color", "#ffffff");
                            $("#pH").css("background-color", "#ffffff");
                            $("#efecto_cebra").css("background-color", "#ffffff");
                            $("#efecto_piling").css("background-color", "#ffffff");
                            $("#temperatura").css("background-color", "#ffffff");
                            $("#niveles_agua").css("background-color", "#ffffff");
                            $("#extraccion").css("background-color", "#ffffff");
                            $("#drenajes").css("background-color", "#ffffff");
                            $("#rotacion").css("background-color", "#ffffff");
                            $("#incrustacion").css("background-color", "#ffffff");
                            $("#manual_auto").css("background-color", "#ffffff");
                            $("#capacidad_lavadora").css("background-color", "#ffffff");

                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarmetodosDL(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var cartulinas_lavado = $("#cartulinas_lavado").val();
            var formulas_lavado = $("#formulas_lavado").val();
            var clasificacion_ropa = $("#clasificacion_ropa").val();
            var peso_ropa = $("#peso_ropa").val();
            var cargado_ropa = $("#cargado_ropa").val();
            var tiempo_secado = $("#tiempo_secado").val();
            var filtros_secadora = $("#filtros_secadora").val();
            var mangles = $("#mangles").val();
            var otros = $("#otros").val();
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_lavanderia SET cartulinas_lavado = ?, formulas_lavado = ?, clasificacion_ropa = ?, peso_ropa = ?, cargado_ropa = ?, tiempo_secado = ?, filtros_secadora = ?, mangles = ?, otros = ? WHERE id_cedula = ?",
                        [cartulinas_lavado, formulas_lavado, clasificacion_ropa, peso_ropa, cargado_ropa, tiempo_secado, filtros_secadora, mangles, otros, id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#cartulinas_lavado").css("background-color", "#FFFFFF");
                            $("#formulas_lavado").css("background-color", "#FFFFFF");
                            $("#clasificacion_ropa").css("background-color", "#FFFFFF");
                            $("#peso_ropa").css("background-color", "#FFFFFF");
                            $("#cargado_ropa").css("background-color", "#FFFFFF");
                            $("#tiempo_secado").css("background-color", "#FFFFFF");
                            $("#filtros_secadora").css("background-color", "#FFFFFF");
                            $("#mangles").css("background-color", "#FFFFFF");
                            $("#otros").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarsuministroDL(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var cloro_residual = $("#cloro_residual").val();
            var dureza_agua = $("#dureza_agua").val();
            var bicarbonatos = $("#bicarbonatos").val();
            var pH2 = $("#pH2").val();
            var hierro2 = $("#hierro2").val();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("UPDATE check_lavanderia SET cloro_residual = ?, dureza_agua = ?, bicarbonatos = ?, pH2 = ?, hierro2 = ? WHERE id_cedula = ?",
                        [cloro_residual, dureza_agua, bicarbonatos, pH2, hierro2, id_cedula],
                        function(tx, results){
                            swal("","Se guardaron los datos correctamente", "success");
                            $("#cloro_residual").css("background-color", "#FFFFFF");
                            $("#dureza_agua").css("background-color", "#FFFFFF");
                            $("#bicarbonatos").css("background-color", "#FFFFFF");
                            $("#pH2").css("background-color", "#FFFFFF");
                            $("#hierro2").css("background-color", "#FFFFFF");
                        },
                        function(tx, error){
                            swal("Error al guardar",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function guardarFormulaDL(){
        var values = get_datos_completos();
        var quita_coma = values.response;
        var valido = values.valido;
        if (valido) {
            var id_cedula = localStorage.getItem("IdCedula");
            var peso = $("#peso").val();
            var tiempo = $("#tiempo").val();
            var nivel = $("#nivel").val();
            var temp = $("#temp").val();
            var quimicos = $("#quimicos").val();
            var volumen = $("#volumen").val();
            var alcalis_activa = $("#alcalis_activa").val();
            var alcalis_inactiva = $("#alcalis_inactiva").val();
            var total = $("#total").val();
            var pH = $("#pH").val();
            var cloro = $("#cloro").val();

            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql("INSERT INTO formula_lavado (id_cedula, peso, tiempo, nivel, temp, quimicos, volumen, alcalis_activa, alcalis_inactiva, total, pH, cloro) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
                        [id_cedula, peso, tiempo, nivel, temp, quimicos, volumen, alcalis_activa, alcalis_inactiva, total, pH, cloro],
                        function(tx, results){
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql("Select * from formula_lavado where id_cedula = ? ORDER BY id_formula DESC",
                                    [id_cedula],
                                        function(tx, results){
                                            let length = results.rows.length;
                                                var item = results.rows.item(0);
                                                $("#tabla_entregas").append("<tr id='fila"+ item.id_formula +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_formula +
                                                ",10);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td style='text-align: center;'>" +
                                                 item.peso + "</td><td style='text-align: center;'>" + item.tiempo + "</td><td style='text-align: center;'>" + item.nivel +
                                                  "</td><td style='text-align: center;'>" + item.temp + "</td><td style='text-align: center;'>" + item.quimicos + "</td><td style='text-align: center;'>" +
                                                  item.volumen + "</td><td style='text-align: center;'>" + item.alcalis_activa + "</td><td style='text-align: center;'>" +
                                                  item.alcalis_inactiva + "</td><td style='text-align: center;'>" + item.total + "</td><td style='text-align: center;'>" +
                                                  item.pH + "</td><td style='text-align: center;'>" + item.cloro + "</td></tr>");
                                                    swal("","Se guardaron los datos correctamente", "success");
                                                    $("#peso").css("background-color", "#FFFFFF");
                                                    $("#tiempo").css("background-color", "#FFFFFF");
                                                    $("#nivel").css("background-color", "#FFFFFF");
                                                    $("#temp").css("background-color", "#FFFFFF");
                                                    $("#quimicos").css("background-color", "#FFFFFF");
                                                    $("#volumen").css("background-color", "#FFFFFF");
                                                    $("#alcalis_activa").css("background-color", "#FFFFFF");
                                                    $("#alcalis_inactiva").css("background-color", "#FFFFFF");
                                                    $("#total").css("background-color", "#FFFFFF");
                                                    $("#pH").css("background-color", "#FFFFFF");
                                                    $("#cloro").css("background-color", "#FFFFFF");
                                                    $("#peso").val('');
                                                    $("#tiempo").val('');
                                                    $("#nivel").val('');
                                                    $("#temp").val('');
                                                    $("#quimicos").val('');
                                                    $("#volumen").val('');
                                                    $("#alcalis_activa").val('');
                                                    $("#alcalis_inactiva").val('');
                                                    $("#total").val('');
                                                    $("#pH").val('');
                                                    $("#cloro").val('');
                                                $("#message-nr").css("display", "none");
                                                $('.preloader').remove();
                                                $('.infinite-scroll-preloader').remove();
                                        },
                                        function(tx, error){
                                            console.log("Error al guardar cedula: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );
                        },
                        function(tx, error){
                            console.log("Error al guardar cedula: " + error.message);
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }else{
            swal("","Debes llenar estos campos para poder guardar: "+quita_coma,"warning");
        }
    }
    function comentariosLavanderiaDL(){
        var comentario = $("#comentarios").val();
        var id_cedula = localStorage.getItem("IdCedula");

        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql("UPDATE Datos_lavanderia SET comentarios_servicio = ? WHERE id_cedula = ?",
                    [comentario, id_cedula],
                    function(tx, results){
                        swal("","Se guardo correctamente el comentario", "success");
                        $("#comentarios").css("background-color", "#FFFFFF");
                    },
                    function(tx, error){
                        swal("Error al guardar",error.message,"error");
                    }
                );
            },
            function(error){},
            function(){}
        );
    }
    function guradarEvidenciasDLs(){
        let id_cedula = localStorage.getItem("IdCedula");
        let foto=$('#imagenC').val();
        let comentarios=$('#comentarios').val();
        var fecha = new Date();
        var fecha_foto = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();

        if (comentarios && foto){
            databaseHandler.db.transaction(
                function(tx){//observaciones text, foto blob, fecha text)",
                    tx.executeSql("INSERT INTO cobranzasDL(id_cedula, comentarios, foto_entrega, fecha) VALUES (?,?,?,?)",
                        [id_cedula,comentarios, foto, fecha_foto],
                        function(tx, results){
                        swal("","Se guardaron los datos correctamente", "success");
                        $('#comentarios').val('');
                        $('#comentarios').css("background-color","#ffffff");
                        $("#smallImage").attr("src","img/blank.png");
                        $("#photoIcon").attr("src","img/camera.svg");
                        $('#imagenC').val('');
                            databaseHandler.db.transaction(
                                function(tx){
                                    tx.executeSql(
                                        "Select * from cobranzasDL where id_cedula = ? ORDER BY id_entrega DESC",
                                            [id_cedula],
                                            function(tx, results){
                                                    var item = results.rows.item(0);
                                                    $("#tabla_entregas").append("<tr id='fila"+ item.id_entrega +"'><td><a href='#' onclick='eliminarFilaDL("+ item.id_entrega +",8);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+
                                                        item.foto_entrega+"' width='60px' style='margin-top: 4px;'/></td><td style='text-align: center;'>" + item.comentarios + "</td><td style='text-align: center;'>" + item.fecha + "</td></tr>");
                                                        $("#message-nr").css("display", "none");
                                                        $('.preloader').remove();
                                                        $('.infinite-scroll-preloader').remove();
                                                },
                                        function(tx, error){
                                        }
                                    );
                                },
                                    function(error){},
                                    function(){}
                            );
                        },
                        function(tx, error){
                            console.error("Error al actualizar: " + error.message);
                        }
                    );
                },
                function(error){
                    console.error("Error al actualizar: " + error.message);
                },
                function(){}
            );
        }else {
            swal("", "Debes de tomar una fotografía e ingresar un comentario" , "warning");
        }
    }
    // Dilimpio Fin
    // Funcion global Inicio
    function eliminaCache(){
        var success = function(status) {
            console.log('Message: ' + status);
            $("#process").hide();
            updateData();
        };
        var error = function(status) {
          $("#process").hide();
          console.log('Error: ' + status);
        };
        window.CacheClear(success, error);
    }
    function RegresarCedula(){
        console.log("ENTRO");
        app.dialog.prompt("Por favor escribe la contraseña", 'FIELD',function (pws) {
            $.ajax({
                type: "POST",
                async : true,
                url: "http://www.appbennetts.com/FWM2/app/validapsw.php",
                dataType: 'html',
                data: {'psw':pws },
                success: function(respuesta){
                    if(respuesta == "OK"){
                        $("#bandeja2").css('display', 'block');
                        $("#bandeja").css('display', 'none');
                    }else{
                        app.dialog.alert('Contraseña Incorrecta.', 'Aviso');
                    }
                },
                error: function(){
                    console.log("Error en la comunicacion");
                }
            });
        });
    }
    function moveProgram(){
        if(localStorage.getItem("programa") == 1){
            if(localStorage.getItem("id_empresa") == 8){
                localStorage.setItem("paso",1);
            }
            app.views.main.router.back('/calendar/', {force: true, ignoreCache: true, reload: true});
        } else {
            app.views.main.router.back('/excel/', {force: true, ignoreCache: true, reload: true});
        }

    }
    function changeCamera(check){
        if(check.includes('0')){
            localStorage.setItem("camera", "0");
            swal("","Se cambio exitosamente la configuracion de la camara.","success");
        } else {
            localStorage.setItem("camera", "1");
            swal("","Se cambio exitosamente la configuracion de la camara.","success");
        }
    }
    function changeProgram(check){
        if(check.includes('0')){
            localStorage.setItem("programa", "0");
            swal("","Se cambio exitosamente la configuracion del programa de visitas.","success");
        } else {
            localStorage.setItem("programa", "1");
            swal("","Se cambio exitosamente la configuracion del programa de visitas.","success");
        }
    }
    function capturePhoto() {
        var camera = localStorage.getItem("camera");
        if(camera == 0){
            var camera = app.popup.create({
                content: `
                <div class="popup" id="camera">
                    <div class="app">
                    <div id="deviceready camera-Field-frame">
                        <div class="top"></div>
                        <canvas id="camera-frame" style="display: none;"></canvas>
                        <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                        <img src="" id="phototaked">
                        <div class="camera">
                            <div class="take" id="take" onclick="onTake()">
                                <div class="bubble-take"></div>
                            </div>
                            <div class="select" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                        </div>
                        <div class="left-action">
                            <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                            <div class="cancel " id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        </div>
                        <div class="actions">
                            <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                            <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                            <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                        </div>
                        <div class="right-action">
                            <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                        </div>
                        <audio id="audio" controls style="display: none;">
                            <source type="audio/mp3" src="img/camera.mp3">
                        </audio>
                        <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                    </div>
                    <fwm></fwm>
                    </div>
                </div>
                `,
                on: {
                    open: function (popup) {
                        var permissions = cordova.plugins.permissions;
                        permissions.checkPermission(permissions.CAMERA, function( status ){
                            if (status.hasPermission){
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                    cameraStart(onPhotoDataSuccess)
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }else{
                                permissions.requestPermission(permissions.CAMERA, success, error);
                                function error() {
                                    app.sheet.close('.popup')
                                    swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                                }
                                function success( status ){
                                    if(!status.hasPermission){
                                        error();
                                    } else {
                                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                        function empresaCargada(){
                                            cameraStart(onPhotoDataSuccess)
                                        }
                                        function cargarEmpresa(url, callback){
                                            var pie = document.getElementsByTagName('fwm')[0];
                                            var script = document.createElement('script');
                                            script.type = 'text/javascript';
                                            script.src = url;
                                            script.id = "cameraSource";
                                            script.onload = callback;
                                            pie.appendChild(script);
                                        }
                                    }

                                }
                            }
                        });
                    },
                    opened: function (popup) {
                      localStorage.setItem("cameraField", "Active");
                    },
                    closed: function (popup) {
                      window.localStorage.removeItem("cameraField");
                    },
                }
            });
            camera.open();
        } else {
            navigator.camera.getPicture(onPhotoDataSuccess, onFail, {
                quality: 100,
                destinationType: destinationType.DATA_URL,
                targetWidth: 500,
                targetHeight: 500,
                correctOrientation: true,
            });
        }
    }
    //Opcion para ir a menu
    function checkStatus(check){
        if(check.includes('1')){
            var valCheck = document.getElementById(check).checked;
            if(valCheck ==true){
                var name = check.replace('1','');
                var otherCheck = name + '0';
                document.getElementById(otherCheck).checked = false;
            }
        } else {
            var valCheck = document.getElementById(check).checked;
            if(valCheck ==true){
                var name = check.replace('0','');
                var otherCheck = name + '1';
                document.getElementById(otherCheck).checked = false;
            }
        }
    }
    function moveMenu() {
        var empresa = localStorage.getItem("nombre_empresa");
        if(empresa == "SMC"){
            app.views.main.router.navigate({ name: 'yallegueSMC'});
        } else if(empresa == "DIPREC"){
            app.views.main.router.navigate({ name: 'yallegueDIPREC'});
        } else if(empresa == "Bennetts"){
            app.views.main.router.navigate({ name: 'yallegueBennetts'});
        } else if(empresa == "SURO"){
            app.views.main.router.navigate({ name: 'yallegueSURO'});
        } else if(empresa == "SURO2"){
            app.views.main.router.navigate({ name: 'yallegueSuroE'});
        } else if(empresa == "Field"){
            app.views.main.router.navigate({ name: 'yallegueField'});
        } else if(empresa == "PlatoLimpio"){
            app.views.main.router.navigate({ name: 'yalleguePlatoLimpio'});
        } else if(empresa == "ServInd"){
            moveMenuServ();
        } else if(empresa == "Devlyn"){
            app.views.main.router.navigate({ name: 'yalleguedevlyn'});
        } else if(empresa == "MerGroup"){
            app.views.main.router.navigate({ name: 'yallegueMerGroup'});
        } else if(empresa == "VIC"){
            app.views.main.router.navigate({ name: 'yallegueVIC'});
        } else if(empresa == "MT"){
            app.views.main.router.navigate({ name: 'yallegueMT'});
        } else if(empresa == "CarnesIdeal"){
            app.views.main.router.navigate({ name: 'yallegueCI'});
        } else if(empresa == "Dilimpio"){
            app.views.main.router.navigate({ name: 'yallegueDilimpio'});
        } else if(empresa == "Proteus"){
            app.views.main.router.navigate({ name: 'yallegueProteus'});
        } else if(empresa == "MrFixer"){
            app.views.main.router.navigate({ name: 'yallegueMrFixer'});
        } else if(empresa == "Restatools"){
            app.views.main.router.navigate({ name: 'yallegueRestatools'});
        } else if(empresa == "Bennetts2"){
            app.views.main.router.navigate({ name: 'yallegueBennetts2'});
        } else if(empresa == "Rocadi"){
            app.views.main.router.navigate({ name: 'yallegueRocadi'});
        } else if(empresa == "sales_suro"){
            app.views.main.router.navigate({ name: 'yallegueSales_suro'});
        } else if(empresa == "BennettsL"){
            app.views.main.router.navigate({ name: 'yallegueBennettsL'});
        } else if(empresa == "Ivy"){
            app.views.main.router.navigate({ name: 'yallegueIvy'});
        } else if(empresa == "Zona04"){
            app.views.main.router.navigate({ name: 'yallegueZona'});
        } else if(empresa == "Aliatonic"){
            var division = localStorage.getItem('division')
            if(division == 1){
                app.views.main.router.navigate({ name: 'yallegueAliatonic'});
            }else if(division == 2){
                app.views.main.router.navigate({ name: 'yallegueAliatonic2'});
            }
        }
        localStorage.setItem("Opcion", '1');
        app.views.main.router.navigate({ name: 'yallegue'});
    }
    function EliminarActualizacionesAntiguas(){
        var IdUsuario = localStorage.getItem("id_usuario");
        var fecha = new Date();
        var fecha_ingreso = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
        fecha_eliminar = editar_fecha(fecha_ingreso, "-30", "d","-");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql("SELECT * FROM Actualizaciones  WHERE Fecha < ? AND IdUsuario = ?",
                    [fecha_eliminar,IdUsuario],
                    function(tx5, results){
                        var length = results.rows.length;
                        for(var i = 0; i< length; i++){
                            var item2 = results.rows.item(i);
                            var IdEliminar = item2.idActualizacion;
                            databaseHandler.db.transaction(
                                function(tx4){
                                    tx4.executeSql(
                                        "DELETE FROM Actualizaciones WHERE idActualizacion = ?",
                                        [IdEliminar],
                                        function(tx4, results){
                                        },
                                        function(tx4, error){
                                            console.errror("Error al eliminar: " + error.message);
                                        }
                                    );
                                },
                                function(error){
                                    console.error("Error al seleccionar actualzaciones:" + error.message)
                                },
                                function(){}
                            );
                        }
                    }
                )
            }
        );
    }
    function inputLleno(id,value){
        id = "#"+id;
        if (value == "") {
            $(id).css("background-color","#ffffff");
        } else if(value == "0"){
            $(id).css("background-color","#ffffff");
        } else {
            $(id).css("background-color","#E0F8F7");
        }
    }

    function eliminarFila(index, opc){
        if(opc == 1) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM levantamiento_evidencia WHERE id_levantamiento_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 2) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_fumigacion WHERE id_fumigacion_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 3) {
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM fotos_sanitizacion WHERE id_sanitizacion_foto = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
        if(opc == 5){
            databaseHandler.db.transaction(
                function(tx){
                    tx.executeSql(
                        "DELETE FROM VIC_Fotos WHERE ID_Fotos = ?",
                        [index],
                        function(tx, results){
                             swal("","El registro se elimito satisfactoriamente","success");
                             $("#fila" + index).remove();
                        },
                        function(tx, error){
                            swal("Error al eliminar registro",error.message,"error");
                        }
                    );
                },
                function(error){},
                function(){}
            );
        }
    }
    function DeleteDatos(){
        var id_empresa = localStorage.getItem("id_empresa");
        databaseHandler.db.transaction(
            function(tx5){
                tx5.executeSql(
                    "Select * from cedulas_general where estatus in (1,2)",
                    [],
                    function(tx5, results){
                        let length = results.rows.length;
                        console.log('length',length);
                        if(length == 0){
                            databaseHandler.db.transaction(
                                function(tx5){
                                    tx5.executeSql(
                                        "Select * from cedulas_general where estatus in (0)",
                                        [],
                                        function(tx5, results){
                                            let length = results.rows.length;
                                            console.log('length',length);
                                            if(length == 0){
                                                app.dialog.prompt("Para eliminar los datos de la app, por favor escribe 'Eliminar'", 'FIELD',function (name) {
                                                    if(name == "Eliminar"){
                                                      swal({
                                                          title: "Aviso",
                                                          text: "¿Estas Seguro de querer eiminar los datos de la aplicación?",
                                                          icon: "warning",
                                                          buttons: true,
                                                          dangerMode: true,
                                                      })
                                                        .then((RESP) => {
                                                            if (RESP == true) {
                                                                window.sqlitePlugin.deleteDatabase({name: "field.db", location:'default'});
                                                                location.reload();
                                                            } else {}
                                                        });
                                                    }else{}
                                                  });
                                            }else{
                                                swal("","Favor de concluir o eliminar las cedulas pendientes para poder eliminar los datos de la app","warning");
                                            }
                                        },
                                        function(tx5, error){
                                            console.log("Error al consultar registro: " + error.message);
                                            app.preloader.hide();
                                        }
                                    );
                                },
                                function(error){console.log("Error al consultar registro: " + error.message);},
                                function(){}
                            );
                        }else{
                            swal({
                                title: "Aviso",
                                text: "¿Aun tienes cedulas pendientes por enviar estas seguro que deseas realizar esta accción? Se perderan los datos de tu visita!",
                                icon: "warning",
                                buttons: true,
                                dangerMode: true,
                            })
                              .then((RESP) => {
                                  if (RESP == true) {
                                    databaseHandler.db.transaction(
                                        function(tx5){
                                            tx5.executeSql(
                                                "Select * from cedulas_general where estatus in (0)",
                                                [],
                                                function(tx5, results){
                                                    let length = results.rows.length;
                                                    console.log('length',length);
                                                    if(length == 0){
                                                        app.dialog.prompt("Para eliminar los datos de la app, por favor escribe 'Eliminar'", 'FIELD',function (name) {
                                                            if(name == "Eliminar"){
                                                              swal({
                                                                  title: "Aviso",
                                                                  text: "¿Estas Seguro de querer eiminar los datos de la aplicación?",
                                                                  icon: "warning",
                                                                  buttons: true,
                                                                  dangerMode: true,
                                                              })
                                                                .then((RESP) => {
                                                                    if (RESP == true) {
                                                                        window.sqlitePlugin.deleteDatabase({name: "field.db", location:'default'});
                                                                        location.reload();
                                                                    } else {}
                                                                });
                                                            }else{}
                                                          });
                                                    }else{
                                                        swal("","Favor de concluir o eliminar las cedulas pendientes para poder eliminar los datos de la app","warning");
                                                    }
                                                },
                                                function(tx5, error){
                                                    console.log("Error al consultar registro: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){console.log("Error al consultar registro: " + error.message);},
                                        function(){}
                                    );
                                  } else {}
                              });
                        }
                    },
                    function(tx5, error){
                        console.log("Error al consultar registro: " + error.message);
                        app.preloader.hide();
                    }
                );
            },
            function(error){console.log("Error al consultar registro: " + error.message);},
            function(){}
        );
    }
    // Funcion global Fin

    function buscarC(){
        app.preloader.show('blue');
        var opc = localStorage.getItem("Opcion");
        var Division = localStorage.getItem("Division");
        if(opc == 1){
            var icedulas = localStorage.getItem("IdCedula");
            var cte = $('#cte').val();
            var geolocation = $("#geolocation").val();
            var imagenC = $("#imagenC").val();
            var fecha = new Date();
            var fFinal = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
            var ncomercial = $("#ncomercial").val();
            var ncontacto = $("#ncontacto").val();
            var telefono = $("#telefono").val();
            var correo = $("#correo").val();
            var estatusc = $("#estatusc").val();
            var Nomcte = $("#Nomcte").val();
            if(cte != ''){
                if(icedulas > 0){  //Actualizar la cedula de seguimiento
                    databaseHandler.db.transaction(
                        function(tx){
                            tx.executeSql("UPDATE Cedula SET IdCte = ? WHERE IdCedula = ?",
                                [cte, icedulas],
                                function(tx, results){
                                    app.dialog.alert('El registro se actualizo correctamente.', 'Aviso');
                                    app.preloader.hide();
                                    databaseHandler.db.transaction(
                                        function(tx){
                                            tx.executeSql("Select * from Clientes where IdCte = ? AND Division = ?",
                                                [cte, Division],
                                                function(tx, results){
                                                    var length = results.rows.length;
                                                    if(length > 0){
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("UPDATE Clientes SET NomComercial = ?, NomContacto = ?, Telefono = ?, Email = ?, Estatus = ?, Cliente = ? WHERE IdCte = ? AND Division = ?",
                                                                    [ncomercial, ncontacto, telefono, correo, estatusc, Nomcte ,cte, Division],
                                                                    function(tx, results){
                                                                        app.views.main.router.navigate({name: 'recorrido1'});
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    } else {
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("INSERT INTO Clientes (NomComercial, NomContacto, Telefono, Email, IdCte, Estatus, Cliente, Division) VALUES (?,?,?,?,?,?,?,?)",
                                                                    [ncomercial, ncontacto, telefono, correo, cte, estatusc, Nomcte, Division ],
                                                                    function(tx, results){
                                                                        app.views.main.router.navigate({name: 'recorrido1'});
                                                                        app.preloader.hide();
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    }
                                                },
                                                function(tx, error){
                                                    console.log("Error al guardar cedula: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                },
                                function(tx, error){
                                    console.log("Error al guardar cedula: " + error.message);
                                    app.preloader.hide();
                                }
                            );
                        },
                        function(error){},
                        function(){}
                    );
                } else {
                    var Division = localStorage.getItem("Division");
                    if(Division == 3){
                        var NomJson ='ClientesCDC';
                        var NomDescCli = 'ClientesCDCDesc';
                    }else{
                        var NomJson = 'clientes_desc';
                        var NomDescCli = "Clientes";
                    }
                    if(imagenC != ''){//insertar la cedula
                        app.request.get(cordova.file.dataDirectory + "jsons/"+NomDescCli+".json", { IdCed: cte}, function (data) {
                            var content = JSON.parse(data);
                            var valor='';
                            for(var i=0; i < content.length; i++){
                                for (var i = 0; i < data.length; i++) {
                                    if(content[i].IdCte == cte){
                                        //DATOS A GUARDAR
                                        productHandler.addCedula(IdUsuario,cte,fFinal,imagenC,geolocation);
                                        databaseHandler.db.transaction(
                                            function(tx){
                                                tx.executeSql("Select MAX(IdCedula) as Id from Cedula",
                                                    [],
                                                    function(tx, results){
                                                        var length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        localStorage.setItem("IdCedula", item.Id);
                                                        localStorage.setItem("IdCte", cte);
                                                        app.preloader.hide();
                                                        databaseHandler.db.transaction(
                                                            function(tx){
                                                                tx.executeSql("Select * from Clientes where IdCte = ? AND Division = ?",
                                                                    [cte, Division],
                                                                    function(tx, results){
                                                                        var length = results.rows.length;
                                                                            if(length > 0){
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("UPDATE Clientes SET NomComercial = ?, NomContacto = ?, Telefono = ?, Email = ?, Estatus = ?, Cliente = ? WHERE IdCte = ? AND Division = ?",
                                                                                            [ncomercial, ncontacto, telefono, correo, estatusc, Nomcte ,cte, Division],
                                                                                            function(tx, results){
                                                                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                                                                app.preloader.hide();
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al guardar cedula: " + error.message);
                                                                                                app.preloader.hide();
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            } else {
                                                                                databaseHandler.db.transaction(
                                                                                    function(tx){
                                                                                        tx.executeSql("INSERT INTO Clientes (NomComercial, NomContacto, Telefono, Email, IdCte, Estatus, Cliente, Division) VALUES (?,?,?,?,?,?,?,?)",
                                                                                            [ncomercial, ncontacto, telefono, correo, cte, estatusc, Nomcte , Division],
                                                                                            function(tx, results){
                                                                                                app.views.main.router.navigate({name: 'recorrido1'});
                                                                                            },
                                                                                            function(tx, error){
                                                                                                console.log("Error al guardar cedula: " + error.message);
                                                                                                app.preloader.hide();
                                                                                            }
                                                                                        );
                                                                                    },
                                                                                    function(error){},
                                                                                    function(){}
                                                                                );
                                                                            }
                                                                    },
                                                                    function(tx, error){
                                                                        console.log("Error al guardar cedula: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                    },
                                                    function(tx, error){
                                                        console.log("Error al guardar cedula: " + error.message);
                                                        app.preloader.hide();
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                        );
                                    }
                                }
                            }
                        });
                    } else {
                        app.dialog.alert('El campo: Fotograf\u00eda. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                }
            } else {
                app.dialog.alert('Favor de seleccionar un cliente.', 'Aviso');
                app.preloader.hide();
            }
        }
    }
function ObservacionesPe(){
    var icedula = localStorage.getItem("IdCedula");
    var observaciones = $("#Obser").val();
    databaseHandler.db.transaction(
        function(tx1){
            tx1.executeSql(
                "select * from ObservacionesPedido WHERE IdCedula= ?",
                [icedula],
                function(tx1, results){
                    var valor = results.rows.length;
                    if(valor > 0){
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "UPDATE ObservacionesPedido SET Observaciones = ? WHERE IdCedula = ? ",
                                    [observaciones,icedula],
                                    function(tx1, results){
                                        var valor = results.rows.length;
                                        app.preloader.hide();
                                    }
                            )},
                            function(error){},
                            function(){}
                        );
                    }else{
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "INSERT INTO ObservacionesPedido (IdCedula, Observaciones) VALUES (?,?)",
                                    [icedula,observaciones],
                                    function(tx1, results){
                                        var valor = results.rows.length;
                                        app.preloader.hide();
                                    }
                            )},
                            function(error){},
                            function(){}
                        );
                    }
                }
        )},
        function(error){},
        function(){}
    );
}

//imagen
function gimagen(){
    //IMAGEN EN BUEN ESTADO NO PEDIR NADA
    app.preloader.show('blue');
    var file_data = $('#imagenC').val();
    var icedula = localStorage.getItem("IdCedula");
    var tipoimagen = document.getElementById("tipoimagen").value;
    var cantidad = $("#cantidad").val();
    var ubicacion =  $("#ubicacion").val();
    var comentario = $("#comentario").val();
    var radio = $('input[name=demo-radio1]:checked').val();
    app.preloader.hide();
    if(tipoimagen != 0){
        if(radio == 1 || radio == 2){
            if(radio == 1){ //Buen estado
                databaseHandler.db.transaction(
                function(tx1){
                    tx1.executeSql(
                        "INSERT INTO imagen (IdTipoImagen,Cantidad, Ubicacion ,checkbox, Comentario, FotoImagen, IdCedula) VALUES (?,?,?,?,?,?,?)",
                        [tipoimagen, cantidad, ubicacion, radio,comentario, file_data, icedula ],
                        function(tx2, results){
                           //Extraer el ultimo registro
                            databaseHandler.db.transaction(
                            function(tx3){
                                tx3.executeSql(
                                "Select MAX(IdImagen) as Id from imagen",
                                [],
                                function(tx4, results){
                                    var length = results.rows.length;
                                    var item = results.rows.item(0);
                                    var IdCEq = item.Id;
                                    //Consultar el producto
                                    databaseHandler.db.transaction(
                                        function(tx5){
                                            tx5.executeSql(
                                                "Select * from imagen where IdImagen = ?",
                                                [IdCEq],
                                                function(tx5, results){
                                                    var length = results.rows.length;
                                                    var item2 = results.rows.item(0);
                                                    if(item2.IdTipoImagen == 1){ var TipoImagen = "Wallchart"; }
                                                    if(item2.IdTipoImagen == 2){ var TipoImagen = "Etiqueta"; }
                                                    if(item2.IdTipoImagen == 3){ var TipoImagen = "Imagen del cliente"; }
                                                    if(item2.IdTipoImagen == 4){ var TipoImagen = "Carpeta del cliente"; }
                                                    if(item2.IdTipoImagen == 5){ var TipoImagen = "Concentraci&oacute;n de Equipos"; }
                                                    if(item2.IdTipoImagen == 6){ var TipoImagen = "Env&iacute;o de Etiquetas"; }
                                                    if(item2.IdTipoImagen == 7){ var TipoImagen = "Env&iacute;o de FT electrónicas"; }
                                                    if(item2.checkBox == 1){ var Estado ="Imagen en buen estado"; }
                                                    if(item2.checkBox == 2){ var Estado ="Imagen en mal estado"; }
                                                    $("#tablaimagen tbody").append("<tr id='fila"+ item2.IdImagen +"'><td><a href='#' onclick='eliminarFila("+ item2.IdImagen +", 2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></td><td text-align: center;><img src='"+item2.FotoImagen+"' width='60px'/></td><td text-align: center;>" + TipoImagen + "</td><td text-align: center;>" + item2.Cantidad + "</td><td  text-align: center;>"+ item2.Ubicacion+"</td><td  text-align: center;>"+ Estado + "</td><td  text-align: center;>"+ item2.Comentario + "</td></tr>");
                                                    $("#cantidad").val('');
                                                    $("#ubicacion").val('');
                                                    $("#comentario").val('');
                                                    $('#imagenC').val('');

                                                    $("#cantidad").css("background-color", "#ffffff");
                                                    $("#ubicacion").css("background-color", "#ffffff");
                                                    $("#comentario").css("background-color", "#ffffff");
                                                    $("#tipoimagen").css("background-color", "#ffffff");
                                                    document.getElementById("BradioI").checked = false;
                                                    document.getElementById("MradioI").checked = false;

                                                    document.ready = document.getElementById("tipoimagen").value = '0';

                                                    app.preloader.hide();
                                                },
                                                function(tx5, error){
                                                    console.log("Error al guardar registro: " + error.message);
                                                    app.preloader.hide();
                                                }
                                            );
                                        },
                                        function(error){},
                                        function(){}
                                    );
                                        //Fin de consulgtar el producto
                                },
                                function(tx4, error){
                                    console.log("Error al guardar registro: " + error.message);
                                }
                            );
                            },
                            function(error){},
                            function(){}
                        ); //FIN DE Extraer el ultimo registro
                           app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                        },
                        function(tx2, error){
                            console.log("Error al guardar el imagen: " + error.message);

                        }
                    );
                },
                function(error){},
                function(){}
                );
            }else if(radio == 2){ //mal estado
            if(cantidad != ''){
                if(ubicacion != ''){
                    if(comentario != ''){
                        databaseHandler.db.transaction(
                            function(tx1){
                                tx1.executeSql(
                                    "INSERT INTO imagen (IdTipoImagen,Cantidad, Ubicacion ,checkbox, Comentario, FotoImagen, IdCedula) VALUES (?,?,?,?,?,?,?)",
                                    [tipoimagen, cantidad, ubicacion, radio,comentario, file_data, icedula ],
                                    function(tx2, results){
                                       //Extraer el ultimo registro
                                        databaseHandler.db.transaction(
                                        function(tx3){
                                            tx3.executeSql(
                                            "Select MAX(IdImagen) as Id from imagen",
                                            [],
                                            function(tx4, results){
                                                var length = results.rows.length;
                                                var item = results.rows.item(0);
                                                var IdCEq = item.Id;
                                                //Consultar el producto
                                                databaseHandler.db.transaction(
                                                    function(tx5){
                                                        tx5.executeSql(
                                                            "Select * from imagen where IdImagen = ?",
                                                            [IdCEq],
                                                            function(tx5, results){
                                                                var length = results.rows.length;
                                                                var item2 = results.rows.item(0);
                                                                if(item2.IdTipoImagen == 1){ var TipoImagen = "Wallchart"; }
                                                                if(item2.IdTipoImagen == 2){ var TipoImagen = "Etiqueta"; }
                                                                if(item2.IdTipoImagen == 3){ var TipoImagen = "Imagen del cliente"; }
                                                                if(item2.IdTipoImagen == 4){ var TipoImagen = "Carpeta del cliente"; }
                                                                if(item2.IdTipoImagen == 5){ var TipoImagen = "Concentraci&oacute;n de Equipos"; }
                                                                if(item2.IdTipoImagen == 6){ var TipoImagen = "Env&iacute;o de Etiquetas"; }
                                                                if(item2.IdTipoImagen == 7){ var TipoImagen = "Env&iacute;o de FT electrónicas"; }
                                                                if(item2.checkBox == 1){ var Estado ="Imagen en buen estado"; }
                                                                if(item2.checkBox == 2){ var Estado ="Imagen en mal estado"; }
                                                                $("#tablaimagen tbody").append("<tr id='fila"+ item2.IdImagen +"'><td><a href='#' onclick='eliminarFila("+ item2.IdImagen +", 2);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></td><td text-align: center;><img src='"+item2.FotoImagen+"' width='60px'/></td><td text-align: center;>" + TipoImagen + "</td><td text-align: center;>" + item2.Cantidad + "</td><td  text-align: center;>"+ item2.Ubicacion+"</td><td  text-align: center;>"+ Estado + "</td><td  text-align: center;>"+ item2.Comentario + "</td></tr>");
                                                                $("#cantidad").val('');
                                                                $("#ubicacion").val('');
                                                                $("#comentario").val('');
                                                                $('#imagenC').val('');

                                                                $("#cantidad").css("background-color", "#ffffff");
                                                                $("#ubicacion").css("background-color", "#ffffff");
                                                                $("#comentario").css("background-color", "#ffffff");
                                                                $("#tipoimagen").css("background-color", "#ffffff");
                                                                document.getElementById("BradioI").checked = false;
                                                                document.getElementById("MradioI").checked = false;
                                                                document.ready = document.getElementById("tipoimagen").value = '0';
                                                                app.preloader.hide();
                                                            },
                                                            function(tx5, error){
                                                                console.log("Error al guardar registro: " + error.message);
                                                            }
                                                        );
                                                    },
                                                    function(error){},
                                                    function(){}
                                                );
                                                    //Fin de consulgtar el producto
                                            },
                                            function(tx4, error){
                                                console.log("Error al guardar registro: " + error.message);
                                            }
                                        );
                                        },
                                        function(error){},
                                        function(){}
                                    ); //FIN DE Extraer el ultimo registro
                                       app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                                    },
                                    function(tx2, error){
                                        console.log("Error al guardar el imagen: " + error.message);

                                    }
                                );
                            },
                            function(error){},
                            function(){}
                            );
                    } else {
                        app.dialog.alert('El campo: Comentario. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                } else {
                    app.dialog.alert('El campo: Ubicacion. Es requerido.', 'Aviso');
                    app.preloader.hide();
                }
            }else {
                app.dialog.alert('El campo: Cantidad. Es requerido.', 'Aviso');
                app.preloader.hide();
            }
            }
        }else {
            app.dialog.alert('Favor de seleccionar en que estado se encuentra. Es requerido.', 'Aviso');
            app.preloader.hide();
        }
    } else {
        app.dialog.alert('El campo: Tipo. Es requerido.', 'Aviso');
        app.preloader.hide();
    }

}
//entrenamiento
function gentrenamiento(){
    app.preloader.show('blue');
    var icedula = localStorage.getItem("IdCedula");
    var file_data = $('#imagenC').val();
    var personaCapacitada = $("#personaCapacitada").val();
    var puesto  = $("#puesto").val();
    var temaCapacitacion = $("#temaCapacitacion").val()
    var comentario = $("#comentario").val();
    var TipoCapacitacion = document.getElementById("TipoCapacitacion").value;

    if(TipoCapacitacion != 0) {
        if($("#personaCapacitada").val() != '' ){
            if($("#puesto").val() != ''){
                if($("#temaCapacitacion").val() != ''){
                    if($("#comentario").val() != ''){
                            databaseHandler.db.transaction(
                                function(tx1){
                                    tx1.executeSql(
                                        "INSERT INTO entrenamiento (IdCedula,PersonaCapacitada, Puesto, TemaCapacitacion, Comentario, ImagenFirma, Tipo) VALUES (?,?,?,?,?,?,?)",
                                        [icedula, personaCapacitada, puesto, temaCapacitacion, comentario, file_data, TipoCapacitacion ],
                                        function(tx2, results){
                                           //Extraer el ultimo registro
                                            databaseHandler.db.transaction(
                                            function(tx3){
                                                tx3.executeSql(
                                                    "Select MAX(IdEntrenamiento) as Id from entrenamiento",
                                                    [],
                                                    function(tx4, results){
                                                        var length = results.rows.length;
                                                        var item = results.rows.item(0);
                                                        var IdCEq = item.Id;
                                                        //Consultar el producto
                                                        databaseHandler.db.transaction(
                                                            function(tx5){
                                                                tx5.executeSql(
                                                                    "Select * from entrenamiento where IdEntrenamiento = ?",
                                                                    [IdCEq],
                                                                    function(tx5, results){
                                                                        var length = results.rows.length;
                                                                        var item2 = results.rows.item(0);
                                                                        app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                                                                        $("#personaCapacitada").val('');
                                                                        $("#puesto").val('');
                                                                        $("#temaCapacitacion").val('');
                                                                        $("#smallImage").attr("src","img/blank.png");
                                                                        $("#photoIcon").attr("src","img/camera.svg");
                                                                        $("#comentario").val('');
                                                                        $('#imagenC').val('');
                                                                        if(item2.Tipo == 1){
                                                                            var TipoCap = "Capacitacion en linea";
                                                                        }
                                                                        if(item2.Tipo == 2){
                                                                            var TipoCap = "Capacitacion presencial";
                                                                        }
                                                                        $("#tablaE tbody").append("<tr id='fila"+ item2.IdEntrenamiento +"'><td><a href='#' onclick='eliminarFila("+ item2.IdEntrenamiento +", 3);' style='border: none; outline:none;'><img src='img/borrar.png' width='30px' /></a></td><td><img src='"+item2.ImagenFirma+"' width='60px'/></td><td text-align: center;>" + TipoCap + "</td><td text-align: center;>" + item2.PersonaCapacitada+ "</td><td text-align: center;>" + item2.Puesto + "</td><td text-align: center;>" + item2.TemaCapacitacion + "</td><td text-align: center;>" + item2.Comentario + "</td></tr>");
                                                                        $("#personaCapacitada").css("background-color", "#FFFFFF");
                                                                        $("#puesto").css("background-color", "#FFFFFF");
                                                                        $("#temaCapacitacion").css("background-color", "#FFFFFF");
                                                                        $("#comentario").css("background-color", "#FFFFFF");
                                                                        app.preloader.hide();

                                                                    },
                                                                    function(tx5, error){
                                                                        console.log("Error al guardar registro: " + error.message);
                                                                        app.preloader.hide();
                                                                    }
                                                                );
                                                            },
                                                            function(error){},
                                                            function(){}
                                                        );
                                                        //Fin de consulgtar el producto
                                                    },
                                                    function(tx4, error){
                                                        console.log("Error al guardar registro: " + error.message);
                                                    }
                                                );
                                            },
                                            function(error){},
                                            function(){}
                                            ); //FIN DE Extraer el ultimo registro
                                        },
                                        function(tx2, error){
                                            console.log("Error al guardar el imagen: " + error.message);
                                        }
                                    );
                                },
                                function(error){},
                                function(){}
                            );

                    } else{
                        app.dialog.alert('El campo: Comentario. Es requerido.', 'Aviso');
                        app.preloader.hide();
                    }
                } else{
                    app.dialog.alert('El campo: Tema capacitaci\u00f3n. Es requerido.', 'Aviso');
                    app.preloader.hide();
                }
            } else{
               app.dialog.alert('El campo: Puesto. Es requerido.', 'Aviso');
               app.preloader.hide();
            }
        }else{
            app.dialog.alert('El campo: Persona capacitada. Es requerido.', 'Aviso');
            app.preloader.hide();
        }
    }else{
        app.dialog.alert('Favor de seleccionar un tipo de capacitacion.', 'Aviso');
        app.preloader.hide();
    }
}

//Pantalla vertical
function vertical(){
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
}
//Pantalla horizontal
function landsca(){
    screen.orientation.lock('landscape');
    //screen.orientation.unlock();
}
// Cerrar Popup
function gClose(){
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
}
var testFirma;

function createFirma(){
    screen.orientation.lock('landscape');
    var signaturePad = new SignaturePad(document.getElementById('signature-pad'), {
      backgroundColor: 'rgba(255, 255, 255, 0)',
      penColor: 'rgb(6, 62, 127)'
    });
    testFirma = signaturePad;
}
function gfirma(){
    var signaturePad = testFirma;
    var data = signaturePad.toDataURL('data:image/jpeg;base64,');
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $("#signate").val(data);
    $('#ImagenFirmaView').attr('src', data);
    $('#VolverFirmar').html("Evidencia");
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
    var hora_firma = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geo = $('#geolocation').val();
    var firma = geo + "|" + fecha_firma + "|" +hora_firma
    const firmaEn = window.btoa(geo + "|" + fecha_firma + "|" +hora_firma)
    $("#firmaElectro2").html(`<span style="color: gray;font-style: italic;">|${firma}|f-${firmaEn}-</span>`)
}
function gFotoFirmaServ(){
    var data2 = $('#imgSigPhoto').val();
    $("#signate").val(data2);
    $("#imgSigPhoto").val(data2);
    app.popup.close()
    app.popup.open(".popup-encuesta")
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $('#ImagenFirmaView').attr('src', data2);
 }

function cleanFirma(){
    var signaturePad = testFirma;
    signaturePad.clear();
}

// Tomar foto firma
function capturaFirma() {
    var camera = localStorage.getItem("camera");
        if(camera == 0){
          var camera = app.popup.create({
            content: `
            <div class="popup" id="camera">
                <div class="app">
                <div id="deviceready camera-Field-frame">
                    <div class="top"></div>
                    <canvas id="camera-frame" style="display: none;"></canvas>
                    <video id="camera-view" autoplay playsinline class="raster" style="display: none;"></video>
                    <img src="" id="phototaked">
                    <div class="camera">
                        <div class="take" id="take" onclick="onTake()">
                            <div class="bubble-take"></div>
                        </div>
                        <div class="select" id="select" style="display: none;" onClick="onDone()"><img id="img-select" src="img/validar_camera.svg"></div>
                    </div>
                    <div class="left-action">
                        <div class="cancel popup-close" id="cancelCamera" onClick="onCancelCamera()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                        <div class="cancel" id="cancelPicure" onClick="onCancelPicture()"><img class="image-cancel" src="img/cerrar_camera.svg"></div>
                    </div>
                    <div class="actions">
                        <div class="action torch" id="torch" onClick="onTorch()"><img id="flash" src="img/flash_off.svg" width="30px"></div>
                        <div class="action rotate-right" id="rotateRight" onClick="onRotateRight()" style="display:none"><img id="flash" src="img/rotate-right.svg" width="30px"></div>
                        <div class="action rotate-left" id="rotateLeft" onClick="onRotateLeft()" style="display:none"><img id="flash" src="img/rotate-left.svg" width="30px"></div>
                    </div>
                    <div class="right-action">
                        <div class="switch" id="switch" onClick="onSwitch()"><img class="image-switch" src="img/flip.svg"></div>
                    </div>
                    <audio id="audio" controls style="display: none;">
                        <source type="audio/mp3" src="img/camera.mp3">
                    </audio>
                    <input type="hidden" id="deviceOrientation" name="deviceOrientation"/>
                </div>
                <fwm></fwm>
                </div>
            </div>
        `,
        on: {
            open: function (popup) {
                var permissions = cordova.plugins.permissions;
                permissions.checkPermission(permissions.CAMERA, function( status ){
                    if (status.hasPermission){
                        cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                        function empresaCargada(){
                            cameraStart(onPhotoSingSuccess)
                        }
                        function cargarEmpresa(url, callback){
                            var pie = document.getElementsByTagName('fwm')[0];
                            var script = document.createElement('script');
                            script.type = 'text/javascript';
                            script.src = url;
                            script.id = "cameraSource";
                            script.onload = callback;
                            pie.appendChild(script);
                        }
                    }else{
                        permissions.requestPermission(permissions.CAMERA, success, error);
                        function error() {
                            app.sheet.close('.popup')
                            swal("Field Requiere los permisos","Para poder tomar las evidencias fotograficas necesitamos el permiso.","warning");
                        }
                        function success( status ){
                            if(!status.hasPermission){
                                error();
                            } else {
                                cargarEmpresa(`./js/camera-field.js`, empresaCargada);
                                function empresaCargada(){
                                    cameraStart(onPhotoSingSuccess)
                                }
                                function cargarEmpresa(url, callback){
                                    var pie = document.getElementsByTagName('fwm')[0];
                                    var script = document.createElement('script');
                                    script.type = 'text/javascript';
                                    script.src = url;
                                    script.id = "cameraSource";
                                    script.onload = callback;
                                    pie.appendChild(script);
                                }
                            }

                        }
                    }
                });
            },
            opened: function (popup) {
              localStorage.setItem("cameraField", "Active");
            },
            closed: function (popup) {
              window.localStorage.removeItem("cameraField");
            },
        }
            });
            camera.open();
        } else {
          navigator.camera.getPicture(onPhotoSingSuccess,onFail, {
              quality: 100,
              destinationType: destinationType.DATA_URL,
              targetWidth: 500,
              targetHeight: 500,
              correctOrientation: true
          });
        }
    $('#FotoYaLLegue').attr('src', "img/camara.png");
}
// Funcion si se logra tomar la foto a la firma
function onPhotoSingSuccess(imageData) {
    var camera = localStorage.getItem("camera");
      if(camera == 0){
        var smallImage = document.getElementById('smallImage');
        smallImage.style.display = 'flex';
        var nameima = imageData;
        smallImage.src = imageData;
        $('#imgSigPhoto').val(nameima);
        $("#photoIcon").attr("src","img/reload.svg");
      }else{
        var smallImage = document.getElementById('smallImage');
        smallImage.style.display = 'flex';
        var nameima = "data:image/jpeg;base64," + imageData;
        smallImage.src = "data:image/jpeg;base64," + imageData;
        $('#imgSigPhoto').val(nameima);
        $("#photoIcon").attr("src","img/reload.svg");
      }
}

// Guarda la fotografia de la firma tomada
function gFotoFirma(){
    var data2 = $('#imgSigPhoto').val();
    $("#signate").val(data2);
    $("#imgSigPhoto").val(data2);
    screen.orientation.lock('portrait');
    screen.orientation.unlock();
    $('#ImagenFirmaView').attr('src', data2);
    var fecha = new Date();
    var fecha_firma = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate();
    var hora_firma = fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    var geo = $('#geolocation').val();
    var firma = geo + "|" + fecha_firma + "|" +hora_firma
    const firmaEn = window.btoa(geo + "|" + fecha_firma + "|" +hora_firma)
    $("#firmaElectro2").html(`<span style="color: gray;font-style: italic;">|${firma}|f-${firmaEn}-</span>`)
 }

//CIERRE
function gcierre(){
    app.preloader.show('blue');
    var IdCte = localStorage.getItem("IdCte");
    var IdCed = localStorage.getItem("IdCedula");
    var file_data = $('#signate').val();
    var estre = $("#eval").val();
    var ccte = $("#text2").val();
    var envio = $('input[name="estado"]:checked').val();
    var geo = $("#geolocation").val();
    var NombreFirma = $("#NombreFirma").val();

    var NombreCuenta = $("#NombreCuenta").val();
    var CorreoCuenta = $("#CorreoCuenta").val();

    var nombre = document.getElementById('cli').innerHTML;
    var ArCadena = nombre.split(' ');
    var cliente = ArCadena[0];
    var ClienteMin = cliente.toLowerCase();

    databaseHandler.db.transaction(
        function(tx1){
            tx1.executeSql(
                "SELECT IdCedula FROM cierre WHERE IdCedula = ?",
                [IdCed],
                function(tx1, results){
                    var length = results.rows.length;

                    if(length > 0){
                        databaseHandler.db.transaction(
                            function(tx){
                                tx.executeSql(
                                    "UPDATE cierre SET eval = ?,cfirma = ?,coment = ?,NombreFirma = ?, NombreCuenta = ?, CorreoCuenta = ? WHERE IdCedula = ?",
                                    [estre,file_data,ccte,NombreFirma,NombreCuenta,CorreoCuenta,IdCed],
                                    function(tx, results){
                                        $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de Término</span><br/><br/><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'/></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificación:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                        app.preloader.hide();
                                        app.preloader.hide();
                                    },
                                    function(tx, error){
                                        console.log("add client error: " + error.message);
                                        app.dialog.alert('Error al enviar..', 'Error');
                                        app.preloader.hide();
                                    }
                                );
                            },
                            function(error){},
                            function(){}
                        );
                    }else{
                        if(estre == 0){
                             app.dialog.alert('Favor de evaluar la visita.', 'Importante');
                             app.preloader.hide();
                        }else if(estre == 1 || estre ==2 || estre ==3 || (ClienteMin == 'dominos')){
                            if(ccte == ''){
                               app.dialog.alert('Favor de colocar sus comentarios.', 'Importante');
                               app.preloader.hide();
                            }  else {
                                databaseHandler.db.transaction(
                                    function(tx1){
                                        tx1.executeSql(
                                            "INSERT INTO cierre (IdCedula,eval,cfirma,geolocalizacion,Solestado,coment,NombreFirma,NombreCuenta,CorreoCuenta) VALUES (?,?,?,?,?,?,?,?,?)",
                                            [IdCed,estre,file_data,geo,envio,ccte,NombreFirma,NombreCuenta,CorreoCuenta],
                                            function(tx1, results){

                                                $('.icon-back').remove();
                                                $('.back').remove();
                                                $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de Término</span><br /><br /><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificación:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                                app.preloader.hide();
                                                 $("#signate").val("");
                                            },
                                            function(tx1, error){
                                                console.log("add client error: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    }
                                    );
                                }
                            }else {
                                databaseHandler.db.transaction(
                                    function(tx1){
                                        tx1.executeSql(
                                            "INSERT INTO cierre (IdCedula,eval,cfirma,geolocalizacion,Solestado,coment,NombreFirma,NombreCuenta,CorreoCuenta) VALUES (?,?,?,?,?,?,?,?,?)",
                                            [IdCed,estre,file_data,geo,envio,ccte,NombreFirma,NombreCuenta,CorreoCuenta],
                                            function(tx1, results){

                                                $('.icon-back').remove();
                                                $('.back').remove();
                                                $("#adios").html("<input type='hidden' id='imagenC' name='imagenC'/><span style='font-weight: bold; color: #00A7B5;'>Hora de Término</span><br /><br /><center><div style='background-color: white;border-radius: 20px;width: 147.76px;height: 147.76px;border: solid 3px #00A7B5;'><a href='#' onclick='capturePhoto();'><img src='img/camera.svg' id='photoIcon' width='45px' style='position: absolute;position: fixed;z-index: 100;margin-top: 50px; position: relative;'/></a></div></center><input type='image' name='smallImage' style='margin: 0px auto; width: 147.76px; height: 147.76px; border-radius: 17px; display: none; margin-top: -150.65px;' id='smallImage' src='' /><br><br><label style='font-size: 12px;'><strong>Comentario de la calificación:</strong></label><center><textarea rows='5' style='color: grey;' disabled>"+ ccte +"</textarea></center><br><br><a href='#' onclick='gcierref();' style='border: none; outline:none;'><img src='img/save2.png' width='50px' /></a>");
                                                app.preloader.hide();
                                            },
                                            function(tx1, error){
                                                console.log("add client error: " + error.message);
                                                app.preloader.hide();
                                            }
                                        );
                                    }
                                    );
                            }
                    }
                },
                function(tx1, error){
                    console.log("add client error: " + error.message);
                    app.preloader.hide();
                }
            );
        }
    );
}
//CIERRE 2DA PARTE
function gcierref(){
    app.preloader.show('blue');
    var IdCte = localStorage.getItem("IdCte");
    var IdCed = localStorage.getItem("IdCedula");
    var imgF = $("#imagenC").val();
    var file_data = $('#imagenC').val();
    var env = 1;
    var fecha = new Date();
    var fFinal = fecha.getFullYear()+"-"+(fecha.getMonth()+1)+"-"+fecha.getDate()+" "+fecha.getHours()+":"+fecha.getMinutes()+":"+fecha.getSeconds();
    //VALIDACION DE CAMPOS
    if(file_data != ''){
        databaseHandler.db.transaction(
            function(tx){
                tx.executeSql(
                    "UPDATE cierre SET fcierre = ?, envio = ?, FechaCierre = ? WHERE IdCedula = ?",
                    [ imgF, env , fFinal ,IdCed ],
                    function(tx, results){
                        app.dialog.alert('El registro se guardo correctamente.', 'Aviso');
                        window.localStorage.removeItem("IdCedula");
                        window.localStorage.removeItem("IdCte");
                        window.localStorage.removeItem("IdInventario");
                        app.preloader.hide();
                        window.location.href = "./menu.html";
                        app.preloader.hide();
                    },
                    function(tx, error){
                        console.log("add client error: " + error.message);
                        app.dialog.alert('Error al enviar..', 'Error');
                        app.preloader.hide();
                    }
                );
            },
            function(error){},
            function(){}
        );
    }else{
        app.dialog.alert('El campo: Fotograf\u00eda. Es requerido.', 'Aviso');
        app.preloader.hide();
    }
}

function verpdf(IdCte, IdCed, TipoC) {
    var id_empresa = localStorage.getItem("id_empresa");
    if (TipoC == "levantamiento" || TipoC == "mantenimiento") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "sanitizacion") {
        app.views.main.router.navigate({
            name: "visualizars",
            params: { IdCte: IdCte, IdCed: IdCed },
        });
    } else if (TipoC == "fumigacion") {
        app.views.main.router.navigate({
            name: "visualizarf",
            params: { IdCte: IdCte, IdCed: IdCed },
        });
    } else if (TipoC == "baja") {
        localStorage.setItem("IdBennetts", IdCed);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "reporteTecnico" || TipoC == "minutaCoordinador") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if(TipoC == "sanitizacionSURO"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if(TipoC == "General"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "Checklist"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "AuditoriaTecnico" || TipoC == "AuditoriaSupervisorTecnico" || TipoC == "AuditoriaLider"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if(TipoC == "ventaSMC" || TipoC == "servicioSMC"){
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({name: "visualizar"});
    } else if (TipoC == "ApoyoVIC" || TipoC == "VIC") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "logistica" || TipoC == "servicio_tecnico") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "visitaDilimpio" || TipoC == "Entregas") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "Bitacora") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    }else if (TipoC == "Desasolve" || TipoC == "Mantenimiento" || TipoC == "Extraccion" ||TipoC == "Trampa") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "Reposicion" || TipoC == "Correctivo" || TipoC == "Instalacion" ||TipoC == "Preventivo") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "recorridoSURO" || TipoC == "visitaSURO" ||TipoC == "encuestaSURO" ||TipoC == "visitaBSURO" ||TipoC == "seguimientoSURO") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar",
        });
    } else if (TipoC == "Venta" || TipoC == "Entrega") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar", 
        });
    } else if (TipoC == "Prospeccion" || TipoC == "Clientes_zona") {
        localStorage.setItem("IdBennetts", IdCed);
        localStorage.setItem("TipoCedula", TipoC);
        app.views.main.router.navigate({
            name: "visualizar", 
        });
    } else {
        if(TipoC.includes("disabled")){
            swal("", "No cuentas con permisos para ver esta sección" , "warning");
        }
    }
  }
function clientSelected(clientName){
    var mes = $("#month").val();
    localStorage.setItem("id_cliente",clientName);
    localStorage.setItem("mes_detalle",mes);
    app.views.main.router.navigate({name: 'verVisita'});
}
function clientSelected2(clientName,fecha){
    let fechaDetalle = fecha.split("-");
    localStorage.setItem("id_cliente",clientName);
    localStorage.setItem("year_detalle",fechaDetalle[0]);
    localStorage.setItem("month_detalle",fechaDetalle[1]);
    localStorage.setItem("day_detalle",fechaDetalle[2]);
    app.views.main.router.navigate({name: 'calendar-page'});
}
//metodo regresar
function regresar(){
     window.location.href = "./menu.html";
     screen.orientation.lock('portrait');
}
function sumarDias(fecha, dias){
    var fecha = new Date();
    fecha.setDate(fecha.getDate() + dias);
    var options = { year: "numeric", month: "numeric", day: "numeric" };
    return fecha.toLocaleDateString( fecha.getTimezoneOffset(), options );
}

function regresarRecorrido(){
    app.views.main.router.back('/recorrido/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorrido2(){
    app.views.main.router.back('/recorrido2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorrido3(){
    app.views.main.router.back('/recorrido3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSEG(){
    app.views.main.router.back('/recorridoseg/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC1(){
    app.views.main.router.back('/recorridoSMC1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC2(){
    app.views.main.router.back('/recorridoSMC2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC3(){
    app.views.main.router.back('/recorridoSMC3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSMC4(){
    app.views.main.router.back('/recorridoSMC4/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC1(){
    app.views.main.router.back('/recorridoDIPREC1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoDIPREC2(){
    var tipoCedula = localStorage.getItem("TipoVisita");
    if (tipoCedula == "checklist_levantamiento"){
        app.views.main.router.back('/recorridoDIPREC2/', {force: true, ignoreCache: true, reload: true});
    } else if (tipoCedula == "checklist_liberacion"){
        app.views.main.router.back('/recorridoDIPREC4/', {force: true, ignoreCache: true, reload: true});
    } else if (tipoCedula == "checklist_inspeccion"){
        app.views.main.router.back('/recorridoDIPREC5/', {force: true, ignoreCache: true, reload: true});
    }
}
function regresarRecorridoDIPREC3(){
    app.views.main.router.back('/recorridoDIPREC3/', {force: true, ignoreCache: true, reload: true});
}
function regresarBennetts(){
    app.views.main.router.back('/menuBennetts/', {force: true, ignoreCache: true, reload: true});
}
function regresarBennetts2(){
    app.views.main.router.back('/recorridoBennetts2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoServInd1(){
    app.views.main.router.back('/recorridoServ1/', {force: true, ignoreCache: true, reload: true});
}
// function regresarRecorridoServInd2(){
//     app.views.main.router.back('/recorridoServ2/', {force: true, ignoreCache: true, reload: true});
// }
function regresarRecorridoMer1(){
    app.views.main.router.back('/recorridoMerGroup/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO1(){
    app.views.main.router.back('/recorridoSURO1/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO2(){
    app.views.main.router.back('/recorridoSURO2/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO3(){
    app.views.main.router.back('/recorridoSURO3/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO4(){
    app.views.main.router.back('/recorridoSURO4/', {force: true, ignoreCache: true, reload: true});
}
function regresarRecorridoSURO5(){
    app.views.main.router.back('/recorridoSURO5/', {force: true, ignoreCache: true, reload: true});
}
function horizontal(){
    screen.orientation.lock('landscape');
}

function Results(){
    $( "#Resultados" ) .show( "fast");
    $( "#LimSani" )    .hide( "fast");
    $( "#ManAli" )     .hide( "fast");
    $( "#higPerso" )   .hide( "fast");
    $( "#ContTemp" )   .hide( "fast");
    $( "#ContPlag" )   .hide( "fast");
    var valCheckuno = document.getElementById("uno").checked;
  //  alert(valCheckuno);
    var valCheckdos = document.getElementById("dos").checked;
  //  alert(valCheckdos);
    if(valCheckuno == true){var n1 = 10;}
    if(valCheckdos == true){ var n2 = 10;}

    var suma = parseInt(n1) + parseInt(n2);
   // alert("La suma es: "+suma);
    $("#res").html("<span>La suma es: "+suma+"</span");
}

function limpiar(){
    $("#NombreRecibe").val("");
    $("#PuestoRecibe").val("");
    $("#Telefono").val("");
    $("#Correo").val("");
    $("#NombreRecibe").css("background-color", "#ffffff");
    $("#PuestoRecibe").css("background-color", "#ffffff");
    $("#Telefono").css("background-color", "#ffffff");
    $("#Correo").css("background-color", "#ffffff");
}

function editar_fecha(fecha, intervalo, dma, separador) {
    var separador = separador || "-";
    var arrayFecha = fecha.split(separador);
    var dia = arrayFecha[2];
    var mes = arrayFecha[1];
    var anio = arrayFecha[0];

    var fechaInicial = new Date(anio, mes - 1, dia);
    var fechaFinal = fechaInicial;
    if(dma=="m" || dma=="M"){
      fechaFinal.setMonth(fechaInicial.getMonth()+parseInt(intervalo));
    }else if(dma=="y" || dma=="Y"){
      fechaFinal.setFullYear(fechaInicial.getFullYear()+parseInt(intervalo));
    }else if(dma=="d" || dma=="D"){
      fechaFinal.setDate(fechaInicial.getDate()+parseInt(intervalo));
    }else{
       return fecha;
    }
    dia = fechaFinal.getDate();
    mes = fechaFinal.getMonth() + 1;
    anio = fechaFinal.getFullYear();
    dia = (dia.toString().length == 1) ? "0" + dia.toString() : dia;
    mes = (mes.toString().length == 1) ? mes.toString() : mes;
    return anio + "-" + mes + "-" + dia;
}

function storageImages(valor){
   var imagen = $("#imagenC"+ valor).val();
   localStorage.setItem("imagenC"+ valor, imagen);
}

function gdatos(){
    var emblechicos = $("#emblechicos").val();
    localStorage.setItem("emblechicos", emblechicos);
    var emblegrandes = $("#emblegrandes").val();
    localStorage.setItem("emblegrandes", emblegrandes);
}
